<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 5 English - Direct & Indirect Speech | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for English/Language Arts Theme */
        :root {
            --primary-indigo: #3F51B5;
            --secondary-teal: #009688;
            --accent-orange: #FF9800;
            --accent-pink: #E91E63;
            --accent-purple: #9C27B0;
            --accent-green: #4CAF50;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(63, 81, 181, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Background Slideshow */
        .slideshow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(63, 81, 181, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-indigo);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-indigo);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-indigo);
            box-shadow: 0 0 0 3px rgba(63, 81, 181, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-indigo);
            color: white;
            box-shadow: 0 4px 15px rgba(63, 81, 181, 0.4);
        }

        .btn-primary:hover {
            background: #303F9F;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(63, 81, 181, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-teal);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 150, 136, 0.4);
        }

        .btn-secondary:hover {
            background: #00796B;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 150, 136, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-indigo);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-indigo), var(--secondary-teal));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(63, 81, 181, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .english-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-orange);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-indigo), var(--accent-purple));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(63, 81, 181, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-indigo);
            background: rgba(63, 81, 181, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(63, 81, 181, 0.1);
            border-color: var(--primary-indigo);
            color: var(--primary-indigo);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-teal);
        }

        .option.correct .option-letter {
            background: var(--primary-indigo);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(63, 81, 181, 0.1);
            border-left: 5px solid var(--primary-indigo);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-indigo);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-indigo);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
        }

        /* Speech Display */
        .speech-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid var(--secondary-teal);
            line-height: 1.6;
            font-size: 1.1rem;
        }

        .speech-title {
            color: var(--secondary-teal);
            margin-bottom: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .speech-text {
            color: var(--text-primary);
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-style: italic;
        }

        .speech-type {
            display: inline-block;
            padding: 5px 10px;
            background: var(--primary-indigo);
            color: white;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .direct-speech .speech-type { background: var(--accent-orange); }
        .indirect-speech .speech-type { background: var(--accent-green); }

        /* Comparison Display */
        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .comparison-container {
                grid-template-columns: 1fr;
            }
        }

        .speech-column {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid transparent;
        }

        .speech-column.direct {
            border-color: var(--accent-orange);
        }

        .speech-column.indirect {
            border-color: var(--accent-green);
        }

        .column-title {
            color: var(--accent-orange);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .speech-column.indirect .column-title {
            color: var(--accent-green);
        }

        /* Changes Display */
        .changes-display {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .changes-display {
                grid-template-columns: 1fr;
            }
        }

        .change-item {
            background: var(--dark-card);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .change-icon {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--accent-pink);
        }

        .change-title {
            font-weight: bold;
            color: var(--primary-indigo);
            margin-bottom: 8px;
        }

        .change-example {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Rule Cards */
        .rules-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .rules-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .rules-grid {
                grid-template-columns: 1fr;
            }
        }

        .rule-card {
            background: var(--dark-card);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid transparent;
            transition: transform 0.3s ease;
        }

        .rule-card:hover {
            transform: translateY(-3px);
        }

        .rule-card.active {
            border-color: var(--primary-indigo);
            background: rgba(63, 81, 181, 0.1);
        }

        .rule-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            text-align: center;
        }

        .rule-title {
            font-weight: bold;
            color: var(--primary-indigo);
            margin-bottom: 8px;
            text-align: center;
        }

        .rule-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-align: center;
        }

        /* Conversion Steps */
        .conversion-steps {
            margin: 20px 0;
        }

        .conversion-step {
            background: var(--dark-card);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid var(--accent-orange);
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .step-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--accent-orange);
            border-radius: 50%;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: bold;
            color: var(--primary-indigo);
            margin-bottom: 5px;
        }

        .step-example {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-style: italic;
            margin-top: 5px;
        }

        /* Time Reference Display */
        .time-reference {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .time-title {
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .time-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .time-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(156, 39, 176, 0.1);
            border-radius: 6px;
        }

        .time-from {
            font-weight: bold;
            color: var(--accent-orange);
            min-width: 60px;
        }

        .time-arrow {
            color: var(--text-secondary);
        }

        .time-to {
            font-weight: bold;
            color: var(--accent-green);
            min-width: 60px;
        }

        /* Examples Table */
        .examples-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .examples-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--primary-indigo);
            border-bottom: 2px solid var(--primary-indigo);
        }

        .examples-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .examples-table tr:hover {
            background: rgba(63, 81, 181, 0.05);
        }

        .direct-cell {
            border-left: 4px solid var(--accent-orange);
        }

        .indirect-cell {
            border-left: 4px solid var(--accent-green);
        }

        /* Practice Conversion */
        .practice-conversion {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .practice-title {
            color: var(--accent-orange);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .conversion-area {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
        }

        @media (max-width: 768px) {
            .conversion-area {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
            }
        }

        .input-box {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid var(--dark-border);
            min-height: 100px;
        }

        .conversion-arrow {
            font-size: 2rem;
            color: var(--accent-pink);
            text-align: center;
        }

        .output-box {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid var(--accent-green);
            min-height: 100px;
            color: var(--accent-green);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-indigo);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .rules-grid {
                grid-template-columns: 1fr;
            }
            
            .changes-display {
                grid-template-columns: 1fr;
            }
            
            .time-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes speechBubble {
            0% { transform: translateX(-10px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .speech-bubble {
            animation: speechBubble 0.5s ease forwards;
        }
        
        @keyframes conversionFlow {
            0% { transform: translateX(-20px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .conversion-flow {
            animation: conversionFlow 0.8s ease forwards;
        }
        
        @keyframes ruleHighlight {
            0%, 100% { background-color: rgba(63, 81, 181, 0.1); border-color: var(--primary-indigo); }
            50% { background-color: rgba(63, 81, 181, 0.3); border-color: var(--secondary-teal); }
        }
        
        .rule-highlight {
            animation: ruleHighlight 1s ease-in-out infinite;
        }
        
        @keyframes timeChange {
            0% { color: var(--accent-orange); }
            50% { color: var(--accent-pink); }
            100% { color: var(--accent-green); }
        }
        
        .time-change {
            animation: timeChange 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <!-- Background Slideshow -->
    <div class="slideshow" id="slideshow">
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1456513080510-34499c43696c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1481627834876-b7833e8f5570?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1524578271613-d550eacf6090?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 5 English</h1>
            <p class="welcome-subtitle">Master reporting speech! Learn to convert between direct speech (exact words) and indirect speech (reported words). Understand punctuation changes, pronoun adjustments, and tense transformations for clear communication!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üó£Ô∏èüìù</span>
                <span class="topic-name">Direct & Indirect Speech</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Speech Adventure</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- English fact display -->
                <div id="englishFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Speech Reporting Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize slideshow
        function initSlideshow() {
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }

        // Questions array - 100 Grade 5 Direct & Indirect Speech questions
        const questions = [
            // Identifying Direct Speech (1-15)
            {
                type: "identify_direct",
                question: "Which sentence shows direct speech?",
                options: ["John said, 'I am happy.'", "John said that he was happy.", "John was happy, he said.", "It was said John is happy."],
                answer: "A",
                explanation: "Direct speech shows exact words in quotation marks: 'I am happy.'"
            },
            {
                type: "identify_direct",
                question: "Identify the direct speech:",
                options: ["'I will come tomorrow,' she promised.", "She promised to come tomorrow.", "She said she would come tomorrow.", "Tomorrow was when she would come."],
                answer: "A",
                explanation: "Exact words in quotes with reporting verb 'promised'"
            },
            {
                type: "identify_direct",
                question: "Which has correct direct speech punctuation?",
                options: ["Mom asked, 'Are you hungry?'", "Mom asked 'Are you hungry?'", "Mom asked, 'are you hungry?'", "Mom asked 'are you hungry'"],
                answer: "A",
                explanation: "Comma before quote, capital letter in quote, question mark inside quotes"
            },
            {
                type: "identify_direct",
                question: "Find the direct speech:",
                options: ["He exclaimed, 'What a beautiful day!'", "He exclaimed that it was a beautiful day.", "He said it was beautiful.", "The day was beautiful, he exclaimed."],
                answer: "A",
                explanation: "Exact words with exclamation in quotation marks"
            },
            {
                type: "identify_direct",
                question: "Which is NOT direct speech?",
                options: ["She told me she was tired.", "She said, 'I am tired.'", "'I need help,' he cried.", "Mother asked, 'Where are you?'"],
                answer: "A",
                explanation: "No quotation marks - this is indirect/reported speech"
            },

            // Identifying Indirect Speech (16-30)
            {
                type: "identify_indirect",
                question: "Which sentence shows indirect speech?",
                options: ["Maria said that she was studying.", "Maria said, 'I am studying.'", "'I am studying,' said Maria.", "Maria: 'I am studying'"],
                answer: "A",
                explanation: "Indirect speech reports what was said without quotation marks"
            },
            {
                type: "identify_indirect",
                question: "Identify the indirect speech:",
                options: ["He told us that he would be late.", "He said, 'I will be late.'", "'I will be late,' he announced.", "He announced, 'I'm going to be late.'"],
                answer: "A",
                explanation: "Reports speech without exact words, uses 'that' clause"
            },
            {
                type: "identify_indirect",
                question: "Which is correct indirect speech?",
                options: ["She explained that she had finished her work.", "She explained, 'I have finished my work.'", "She explained 'I finished my work.'", "She explained that she has finished her work."],
                answer: "A",
                explanation: "Uses 'that' and appropriate tense (had finished)"
            },
            {
                type: "identify_indirect",
                question: "Find the indirect speech:",
                options: ["They mentioned that they were going shopping.", "They said, 'We are going shopping.'", "'We're going shopping,' they mentioned.", "They: 'We are going shopping.'"],
                answer: "A",
                explanation: "Reports speech indirectly without quotation marks"
            },
            {
                type: "identify_indirect",
                question: "Which is NOT indirect speech?",
                options: ["'Wait for me,' she called.", "She asked me to wait for her.", "He said that he was coming.", "They told us they had arrived."],
                answer: "A",
                explanation: "Uses quotation marks - this is direct speech"
            },

            // Direct to Indirect Conversion - Present to Past (31-45)
            {
                type: "convert_direct_indirect",
                question: "Convert to indirect: John said, 'I play football.'",
                options: ["John said that he played football.", "John said that he plays football.", "John said that he is playing football.", "John said that he was playing football."],
                answer: "A",
                explanation: "Present simple (play) ‚Üí Past simple (played) in indirect speech"
            },
            {
                type: "convert_direct_indirect",
                question: "Change to indirect: She said, 'I am reading a book.'",
                options: ["She said that she was reading a book.", "She said that she is reading a book.", "She said that she read a book.", "She said that she has been reading a book."],
                answer: "A",
                explanation: "Present continuous (am reading) ‚Üí Past continuous (was reading)"
            },
            {
                type: "convert_direct_indirect",
                question: "Convert: They said, 'We have finished our homework.'",
                options: ["They said that they had finished their homework.", "They said that they have finished their homework.", "They said that they finished their homework.", "They said that they were finishing their homework."],
                answer: "A",
                explanation: "Present perfect (have finished) ‚Üí Past perfect (had finished)"
            },
            {
                type: "convert_direct_indirect",
                question: "Change to indirect: He said, 'I will help you.'",
                options: ["He said that he would help me.", "He said that he will help me.", "He said that he helps me.", "He said that he helped me."],
                answer: "A",
                explanation: "Will ‚Üí Would in indirect speech"
            },
            {
                type: "convert_direct_indirect",
                question: "Convert: She said, 'I can swim.'",
                options: ["She said that she could swim.", "She said that she can swim.", "She said that she swam.", "She said that she was swimming."],
                answer: "A",
                explanation: "Can ‚Üí Could in indirect speech"
            },

            // Indirect to Direct Conversion - Past to Present (46-60)
            {
                type: "convert_indirect_direct",
                question: "Convert to direct: He said that he was tired.",
                options: ["He said, 'I am tired.'", "He said, 'I was tired.'", "He said, 'I have been tired.'", "He said, 'I will be tired.'"],
                answer: "A",
                explanation: "Past tense in indirect ‚Üí Present tense in direct speech"
            },
            {
                type: "convert_indirect_direct",
                question: "Change to direct: She said that she had seen the movie.",
                options: ["She said, 'I saw the movie.'", "She said, 'I have seen the movie.'", "She said, 'I see the movie.'", "She said, 'I was seeing the movie.'"],
                answer: "B",
                explanation: "Past perfect (had seen) ‚Üí Present perfect (have seen) or simple past"
            },
            {
                type: "convert_indirect_direct",
                question: "Convert: They said that they would come.",
                options: ["They said, 'We will come.'", "They said, 'We would come.'", "They said, 'We come.'", "They said, 'We are coming.'"],
                answer: "A",
                explanation: "Would ‚Üí Will in direct speech"
            },
            {
                type: "convert_indirect_direct",
                question: "Change to direct: He said that he could speak French.",
                options: ["He said, 'I can speak French.'", "He said, 'I could speak French.'", "He said, 'I speak French.'", "He said, 'I am speaking French.'"],
                answer: "A",
                explanation: "Could ‚Üí Can in direct speech"
            },
            {
                type: "convert_indirect_direct",
                question: "Convert: She said that she was going to the park.",
                options: ["She said, 'I am going to the park.'", "She said, 'I was going to the park.'", "She said, 'I go to the park.'", "She said, 'I have gone to the park.'"],
                answer: "A",
                explanation: "Past continuous ‚Üí Present continuous in direct speech"
            },

            // Pronoun Changes (61-75)
            {
                type: "pronoun_changes",
                question: "Convert: Tom said, 'I need my book.'",
                options: ["Tom said that he needed his book.", "Tom said that he needed my book.", "Tom said that I needed his book.", "Tom said that he needs his book."],
                answer: "A",
                explanation: "'I' changes to 'he', 'my' changes to 'his'"
            },
            {
                type: "pronoun_changes",
                question: "Change: Mary said, 'We love our school.'",
                options: ["Mary said that they loved their school.", "Mary said that we love our school.", "Mary said that they love their school.", "Mary said that we loved our school."],
                answer: "A",
                explanation: "'We' changes to 'they', 'our' changes to 'their'"
            },
            {
                type: "pronoun_changes",
                question: "Convert: 'You should finish your work,' she told me.",
                options: ["She told me that I should finish my work.", "She told me that you should finish your work.", "She told me that I should finish your work.", "She told me that you should finish my work."],
                answer: "A",
                explanation: "'You' changes to 'I', 'your' changes to 'my'"
            },
            {
                type: "pronoun_changes",
                question: "Change: He said to her, 'You are right.'",
                options: ["He told her that she was right.", "He told her that you were right.", "He told her that I was right.", "He told her that he was right."],
                answer: "A",
                explanation: "'You' (referring to her) changes to 'she'"
            },
            {
                type: "pronoun_changes",
                question: "Convert: They said, 'This is our house.'",
                options: ["They said that that was their house.", "They said that this was our house.", "They said that that is their house.", "They said that this is our house."],
                answer: "A",
                explanation: "'This' changes to 'that', 'our' changes to 'their'"
            },

            // Time and Place Changes (76-90)
            {
                type: "time_place_changes",
                question: "Convert: She said, 'I will do it today.'",
                options: ["She said that she would do it that day.", "She said that she will do it today.", "She said that she would do it today.", "She said that she will do it that day."],
                answer: "A",
                explanation: "'Today' changes to 'that day' in indirect speech"
            },
            {
                type: "time_place_changes",
                question: "Change: He said, 'I saw her yesterday.'",
                options: ["He said that he had seen her the day before.", "He said that he saw her yesterday.", "He said that he had seen her yesterday.", "He said that he saw her the day before."],
                answer: "A",
                explanation: "'Yesterday' changes to 'the day before' or 'the previous day'"
            },
            {
                type: "time_place_changes",
                question: "Convert: They said, 'We are here now.'",
                options: ["They said that they were there then.", "They said that they are here now.", "They said that they were here then.", "They said that they are there now."],
                answer: "A",
                explanation: "'Here' ‚Üí 'there', 'now' ‚Üí 'then'"
            },
            {
                type: "time_place_changes",
                question: "Change: She said, 'I will come tomorrow.'",
                options: ["She said that she would come the next day.", "She said that she will come tomorrow.", "She said that she would come tomorrow.", "She said that she will come the next day."],
                answer: "A",
                explanation: "'Tomorrow' changes to 'the next day' or 'the following day'"
            },
            {
                type: "time_place_changes",
                question: "Convert: He said, 'I did it last week.'",
                options: ["He said that he had done it the previous week.", "He said that he did it last week.", "He said that he had done it last week.", "He said that he did it the previous week."],
                answer: "A",
                explanation: "'Last week' changes to 'the previous week' or 'the week before'"
            },

            // Questions in Indirect Speech (91-100)
            {
                type: "questions_indirect",
                question: "Convert: She asked, 'Are you coming?'",
                options: ["She asked if I was coming.", "She asked am I coming.", "She asked that am I coming.", "She asked whether I am coming."],
                answer: "A",
                explanation: "Yes/no questions use 'if' or 'whether', change to statement word order"
            },
            {
                type: "questions_indirect",
                question: "Change: He asked, 'Where do you live?'",
                options: ["He asked where I lived.", "He asked where do I live.", "He asked that where I lived.", "He asked where I live."],
                answer: "A",
                explanation: "Wh-questions keep question word, change to statement order"
            },
            {
                type: "questions_indirect",
                question: "Convert: They asked, 'What time is it?'",
                options: ["They asked what time it was.", "They asked what time is it.", "They asked that what time it was.", "They asked what time was it."],
                answer: "A",
                explanation: "Question becomes statement: 'what time it was' not 'what time was it'"
            },
            {
                type: "questions_indirect",
                question: "Change: She asked, 'Can you help me?'",
                options: ["She asked if I could help her.", "She asked can I help her.", "She asked that can I help her.", "She asked whether can I help her."],
                answer: "A",
                explanation: "Use 'if', change to statement order, pronouns adjust"
            },
            {
                type: "questions_indirect",
                question: "Convert: He asked, 'Why are you late?'",
                options: ["He asked why I was late.", "He asked why are you late.", "He asked that why I was late.", "He asked why was I late."],
                answer: "A",
                explanation: "Keep 'why', change to statement order, adjust pronouns and tense"
            },

            // Commands and Requests (101-110)
            {
                type: "commands_requests",
                question: "Convert: She said, 'Close the door.'",
                options: ["She told me to close the door.", "She said to close the door.", "She told that close the door.", "She said me to close the door."],
                answer: "A",
                explanation: "Commands use 'told/asked + object + to + verb' structure"
            },
            {
                type: "commands_requests",
                question: "Change: He said, 'Please sit down.'",
                options: ["He asked me to sit down.", "He said to sit down.", "He told that sit down.", "He said me to sit down."],
                answer: "A",
                explanation: "Polite requests use 'asked + object + to + verb'"
            },
            {
                type: "commands_requests",
                question: "Convert: Mother said, 'Don't touch that!'",
                options: ["Mother told me not to touch that.", "Mother said not to touch that.", "Mother told that don't touch that.", "Mother said me not to touch that."],
                answer: "A",
                explanation: "Negative commands use 'told + object + not to + verb'"
            },
            {
                type: "commands_requests",
                question: "Change: The teacher said, 'Open your books.'",
                options: ["The teacher told us to open our books.", "The teacher said to open your books.", "The teacher told that open your books.", "The teacher said us to open our books."],
                answer: "A",
                explanation: "Use 'told + object + to + verb', adjust pronouns"
            },
            {
                type: "commands_requests",
                question: "Convert: He said, 'Be careful.'",
                options: ["He told me to be careful.", "He said to be careful.", "He told that be careful.", "He said me to be careful."],
                answer: "A",
                explanation: "Commands with 'be' also use 'to + be' structure"
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent speech conversion skills!",
            "Fantastic grammar transformation!",
            "Great job! You're a speech reporting expert!",
            "Amazing! Your tense changes are perfect!",
            "Well done! Perfect pronoun adjustment!",
            "You're a direct/indirect speech champion!",
            "Perfect! You understand speech reporting rules!",
            "Outstanding grammatical transformation!",
            "Brilliant! You think like a language expert!",
            "You're on fire! Great speech insight!"
        ];

        // Sample conversions for visualization
        const sampleConversions = [
            {
                direct: "John said, 'I am reading a book.'",
                indirect: "John said that he was reading a book.",
                changes: [
                    {from: "I", to: "he", type: "pronoun"},
                    {from: "am", to: "was", type: "tense"},
                    {from: "reading", to: "reading", type: "verb form"},
                    {from: "''", to: "that", type: "connector"}
                ]
            },
            {
                direct: "Mary said, 'I will visit tomorrow.'",
                indirect: "Mary said that she would visit the next day.",
                changes: [
                    {from: "I", to: "she", type: "pronoun"},
                    {from: "will", to: "would", type: "modal"},
                    {from: "tomorrow", to: "the next day", type: "time"},
                    {from: "''", to: "that", type: "connector"}
                ]
            },
            {
                direct: "They said, 'We have finished.'",
                indirect: "They said that they had finished.",
                changes: [
                    {from: "We", to: "they", type: "pronoun"},
                    {from: "have finished", to: "had finished", type: "tense"},
                    {from: "''", to: "that", type: "connector"}
                ]
            }
        ];

        // Rules for conversion
        const conversionRules = [
            {
                title: "Quotation Marks",
                icon: "„Äù„Äû",
                description: "Remove quotes in indirect speech",
                examples: ["Direct: '...'", "Indirect: (no quotes)"]
            },
            {
                title: "Reporting Verb",
                icon: "üì¢",
                description: "Add 'that' or change verb structure",
                examples: ["said ‚Üí said that", "asked ‚Üí asked if"]
            },
            {
                title: "Pronoun Changes",
                icon: "üë§‚Üíüë•",
                description: "Adjust pronouns to match speaker/listener",
                examples: ["I ‚Üí he/she", "we ‚Üí they", "my ‚Üí his/her"]
            },
            {
                title: "Tense Shift",
                icon: "‚è±Ô∏è",
                description: "Move tenses one step back in time",
                examples: ["Present ‚Üí Past", "Will ‚Üí Would", "Can ‚Üí Could"]
            },
            {
                title: "Time Words",
                icon: "üìÖ",
                description: "Adjust time references",
                examples: ["now ‚Üí then", "today ‚Üí that day", "tomorrow ‚Üí next day"]
            },
            {
                title: "Place Words",
                icon: "üìç",
                description: "Adjust place references",
                examples: ["here ‚Üí there", "this ‚Üí that", "these ‚Üí those"]
            }
        ];

        // Tense changes reference
        const tenseChanges = [
            {direct: "Present Simple (do)", indirect: "Past Simple (did)"},
            {direct: "Present Continuous (am doing)", indirect: "Past Continuous (was doing)"},
            {direct: "Present Perfect (have done)", indirect: "Past Perfect (had done)"},
            {direct: "Past Simple (did)", indirect: "Past Perfect (had done)"},
            {direct: "Will", indirect: "Would"},
            {direct: "Can", indirect: "Could"},
            {direct: "May", indirect: "Might"},
            {direct: "Must", indirect: "Had to"}
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const englishFact = document.getElementById('englishFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initSlideshow();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade5DirectIndirect');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade5DirectIndirect', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade5DirectIndirect_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade5DirectIndirect_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a speech reporting expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent grammar transformation skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing to become a speech conversion master!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review conversion rules and try again!";
            } else {
                scoreMessage.textContent = "Keep learning! Grammar skills grow with practice!";
            }
        }

        // Create English fact display
        function createEnglishFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'english-fact';
            
            const facts = [
                "The terms 'direct' and 'indirect' speech come from Latin roots meaning 'straight' and 'not straight' reporting!",
                "In some languages like Japanese, indirect speech is used much more frequently than in English!",
                "Journalists use indirect speech (reported speech) to summarize what people say without long quotes!",
                "The rules for tense changes in indirect speech are called 'sequence of tenses' or 'backshift'!",
                "Shakespeare used both direct and indirect speech creatively - Hamlet's 'To be or not to be' is direct speech!",
                "In legal documents, indirect speech is preferred to avoid misinterpretation of exact words!",
                "Some languages have special verb forms just for reported speech!",
                "The ability to convert between direct and indirect speech shows advanced language proficiency!"
            ];
            
            factDiv.innerHTML = `<strong>Grammar Fact:</strong> ${facts[Math.floor(Math.random() * facts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "identify_direct": "üó£Ô∏è",
                "identify_indirect": "üìù",
                "convert_direct_indirect": "‚Üí",
                "convert_indirect_direct": "‚Üê",
                "pronoun_changes": "üë§",
                "time_place_changes": "‚è∞",
                "questions_indirect": "‚ùì",
                "commands_requests": "‚ö°"
            };
            
            let conceptName = "Speech Reporting";
            let conceptIcon = "üó£Ô∏èüìù";
            
            if (question.type.includes("identify_direct")) {
                conceptName = "Identifying Direct Speech";
                conceptIcon = conceptIcons.identify_direct;
            } else if (question.type.includes("identify_indirect")) {
                conceptName = "Identifying Indirect Speech";
                conceptIcon = conceptIcons.identify_indirect;
            } else if (question.type.includes("convert_direct_indirect")) {
                conceptName = "Direct ‚Üí Indirect";
                conceptIcon = conceptIcons.convert_direct_indirect;
            } else if (question.type.includes("convert_indirect_direct")) {
                conceptName = "Indirect ‚Üí Direct";
                conceptIcon = conceptIcons.convert_indirect_direct;
            } else if (question.type.includes("pronoun_changes")) {
                conceptName = "Pronoun Changes";
                conceptIcon = conceptIcons.pronoun_changes;
            } else if (question.type.includes("time_place_changes")) {
                conceptName = "Time & Place Changes";
                conceptIcon = conceptIcons.time_place_changes;
            } else if (question.type.includes("questions_indirect")) {
                conceptName = "Questions in Indirect";
                conceptIcon = conceptIcons.questions_indirect;
            } else if (question.type.includes("commands_requests")) {
                conceptName = "Commands & Requests";
                conceptIcon = conceptIcons.commands_requests;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("identify_direct")) {
                label.textContent = "Recognizing exact words in quotation marks";
            } else if (question.type.includes("identify_indirect")) {
                label.textContent = "Recognizing reported speech without quotes";
            } else if (question.type.includes("convert_direct_indirect")) {
                label.textContent = "Changing exact words to reported speech";
            } else if (question.type.includes("convert_indirect_direct")) {
                label.textContent = "Changing reported speech back to exact words";
            } else if (question.type.includes("pronoun_changes")) {
                label.textContent = "Adjusting I, you, we, my, your, etc.";
            } else if (question.type.includes("time_place_changes")) {
                label.textContent = "Adjusting now, here, today, tomorrow, etc.";
            } else if (question.type.includes("questions_indirect")) {
                label.textContent = "Reporting questions properly";
            } else if (question.type.includes("commands_requests")) {
                label.textContent = "Reporting orders and polite requests";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create speech visualization
        function createSpeechVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const conversion = sampleConversions[Math.floor(Math.random() * sampleConversions.length)];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-indigo);">Direct vs Indirect Speech</h3>
                
                <div class="comparison-container">
                    <div class="speech-column direct">
                        <div class="column-title">Direct Speech</div>
                        <div class="speech-text">"${conversion.direct}"</div>
                        <div style="margin-top: 15px; color: var(--accent-orange); font-weight: bold;">
                            Features:
                        </div>
                        <ul style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 10px; padding-left: 20px;">
                            <li>Uses quotation marks</li>
                            <li>Shows exact words spoken</li>
                            <li>Has comma before quote</li>
                            <li>Keeps original pronouns</li>
                            <li>Uses present/future tenses</li>
                        </ul>
                    </div>
                    
                    <div class="speech-column indirect">
                        <div class="column-title">Indirect Speech</div>
                        <div class="speech-text">${conversion.indirect}</div>
                        <div style="margin-top: 15px; color: var(--accent-green); font-weight: bold;">
                            Features:
                        </div>
                        <ul style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 10px; padding-left: 20px;">
                            <li>No quotation marks</li>
                            <li>Reports what was said</li>
                            <li>Uses 'that' (often)</li>
                            <li>Changes pronouns</li>
                            <li>Shifts tenses back</li>
                        </ul>
                    </div>
                </div>
                
                <div class="changes-display">
                    ${conversion.changes.map((change, index) => `
                        <div class="change-item conversion-flow" style="animation-delay: ${index * 0.2}s">
                            <div class="change-icon">‚ÜîÔ∏è</div>
                            <div class="change-title">${change.type}</div>
                            <div class="change-example">${change.from} ‚Üí ${change.to}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="rules-grid">
                    ${conversionRules.map((rule, index) => `
                        <div class="rule-card rule-highlight" style="animation-delay: ${index * 0.1}s">
                            <div class="rule-icon">${rule.icon}</div>
                            <div class="rule-title">${rule.title}</div>
                            <div class="rule-description">${rule.description}</div>
                            <div style="font-size: 0.8rem; color: var(--accent-orange); margin-top: 8px;">
                                ${rule.examples.join(' ‚Üí ')}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="time-reference">
                    <div class="time-title">Tense Changes (Direct ‚Üí Indirect)</div>
                    <div class="time-grid">
                        ${tenseChanges.slice(0, 4).map((change, index) => `
                            <div class="time-item time-change" style="animation-delay: ${index * 0.3}s">
                                <div class="time-from">${change.direct}</div>
                                <div class="time-arrow">‚Üí</div>
                                <div class="time-to">${change.indirect}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <table class="examples-table">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Direct Speech</th>
                            <th>Indirect Speech</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Statement</td>
                            <td class="direct-cell">She said, "I am busy."</td>
                            <td class="indirect-cell">She said that she was busy.</td>
                        </tr>
                        <tr>
                            <td>Question</td>
                            <td class="direct-cell">He asked, "Are you coming?"</td>
                            <td class="indirect-cell">He asked if I was coming.</td>
                        </tr>
                        <tr>
                            <td>Command</td>
                            <td class="direct-cell">"Close the door," she said.</td>
                            <td class="indirect-cell">She told me to close the door.</td>
                        </tr>
                        <tr>
                            <td>Request</td>
                            <td class="direct-cell">"Please help me," he said.</td>
                            <td class="indirect-cell">He asked me to help him.</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="conversion-steps">
                    <div class="conversion-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Remove Quotation Marks</div>
                            <div class="step-example">"I am happy" ‚Üí I am happy</div>
                        </div>
                    </div>
                    <div class="conversion-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Add 'that' (optional for statements)</div>
                            <div class="step-example">He said ‚Üí He said that</div>
                        </div>
                    </div>
                    <div class="conversion-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">Change Pronouns</div>
                            <div class="step-example">I ‚Üí he/she, my ‚Üí his/her, etc.</div>
                        </div>
                    </div>
                    <div class="conversion-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">Shift Tenses Back</div>
                            <div class="step-example">Present ‚Üí Past, Will ‚Üí Would, etc.</div>
                        </div>
                    </div>
                    <div class="conversion-step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <div class="step-title">Adjust Time/Place Words</div>
                            <div class="step-example">Now ‚Üí then, here ‚Üí there, today ‚Üí that day</div>
                        </div>
                    </div>
                </div>
                
                <div class="practice-conversion">
                    <div class="practice-title">Quick Practice</div>
                    <div class="conversion-area">
                        <div class="input-box">
                            <strong>Direct:</strong><br>
                            "I need your help," she said.
                        </div>
                        <div class="conversion-arrow">‚Üí</div>
                        <div class="output-box">
                            <strong>Indirect:</strong><br>
                            She said that she needed my help.
                        </div>
                    </div>
                </div>
            `;
            
            return vizDiv;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            englishFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            englishFact.appendChild(createEnglishFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createSpeechVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
