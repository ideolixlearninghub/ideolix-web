<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 Science - Light, Sound & Heat | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Energy Theme */
        :root {
            --primary-blue: #2196F3;
            --secondary-yellow: #FFC107;
            --accent-red: #F44336;
            --accent-purple: #9C27B0;
            --accent-green: #4CAF50;
            --accent-orange: #FF9800;
            --accent-teal: #009688;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --light-glow: 0 0 20px rgba(33, 150, 243, 0.4);
            --sound-glow: 0 0 20px rgba(156, 39, 176, 0.4);
            --heat-glow: 0 0 20px rgba(255, 193, 7, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Energy Pattern Background */
        .energy-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(33, 150, 243, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(156, 39, 176, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 193, 7, 0.1) 0%, transparent 50%);
            opacity: 0.3;
        }

        .floating-element {
            position: absolute;
            font-size: 3rem;
            font-weight: bold;
            animation: floatElement 25s linear infinite;
        }

        @keyframes floatElement {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-150px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-150px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(150px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--light-glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(33, 150, 243, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-blue);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-yellow);
            color: #212121;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4);
        }

        .btn-secondary:hover {
            background: #FFA000;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 193, 7, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-blue), var(--secondary-yellow));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .science-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-red);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-yellow));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(33, 150, 243, 0.1);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-yellow);
            color: #212121;
        }

        .option.correct .option-letter {
            background: var(--primary-blue);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(33, 150, 243, 0.1);
            border-left: 5px solid var(--primary-blue);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-blue);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-blue);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Energy Display */
        .energy-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid var(--accent-red);
            text-align: center;
        }

        .display-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        /* Light, Sound, Heat Comparison */
        .comparison-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .comparison-box {
            background: var(--dark-card);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            min-width: 200px;
            transition: transform 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .comparison-box.light {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .comparison-box.sound {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .comparison-box.heat {
            border-color: var(--secondary-yellow);
            background: rgba(255, 193, 7, 0.1);
        }

        .comparison-box:hover {
            transform: scale(1.05);
        }

        .comparison-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .comparison-box.light .comparison-name {
            color: var(--primary-blue);
        }

        .comparison-box.sound .comparison-name {
            color: var(--accent-purple);
        }

        .comparison-box.heat .comparison-name {
            color: var(--secondary-yellow);
        }

        .comparison-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        /* Light Properties */
        .light-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--primary-blue);
        }

        .light-diagram {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 20px auto;
            background: radial-gradient(circle, rgba(33, 150, 243, 0.1), transparent 70%);
            border-radius: 50%;
        }

        .light-property {
            position: absolute;
            background: rgba(33, 150, 243, 0.2);
            border: 1px solid var(--primary-blue);
            border-radius: 4px;
            padding: 8px;
            font-size: 0.8rem;
            text-align: center;
            min-width: 80px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .light-property:hover {
            background: rgba(33, 150, 243, 0.4);
            transform: scale(1.1);
        }

        /* Sound Properties */
        .sound-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .sound-wave {
            position: relative;
            height: 100px;
            margin: 20px 0;
            overflow: hidden;
        }

        .wave-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: var(--accent-purple);
            animation: waveAnimation 2s linear infinite;
        }

        @keyframes waveAnimation {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Heat Transfer */
        .heat-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--secondary-yellow);
        }

        .transfer-methods {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .transfer-methods {
                grid-template-columns: 1fr;
            }
        }

        .transfer-box {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .transfer-box:hover {
            transform: translateY(-3px);
        }

        .transfer-box.conduction {
            border-color: var(--accent-red);
            background: rgba(244, 67, 54, 0.1);
        }

        .transfer-box.convection {
            border-color: var(--accent-orange);
            background: rgba(255, 152, 0, 0.1);
        }

        .transfer-box.radiation {
            border-color: var(--secondary-yellow);
            background: rgba(255, 193, 7, 0.1);
        }

        .transfer-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .transfer-name {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .transfer-box.conduction .transfer-name {
            color: var(--accent-red);
        }

        .transfer-box.convection .transfer-name {
            color: var(--accent-orange);
        }

        .transfer-box.radiation .transfer-name {
            color: var(--secondary-yellow);
        }

        /* Reflection and Refraction */
        .optics-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
        }

        .optics-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin: 15px 0;
        }

        .optics-box {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            min-width: 120px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .optics-box:hover {
            transform: scale(1.05);
            border-color: var(--accent-teal);
        }

        .optics-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .optics-name {
            font-weight: bold;
            color: var(--accent-teal);
            margin-bottom: 5px;
        }

        /* Energy Table */
        .energy-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .energy-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-red);
            border-bottom: 2px solid var(--accent-red);
        }

        .energy-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .energy-table tr:hover {
            background: rgba(255, 152, 0, 0.05);
        }

        /* Interactive Practice */
        .interactive-practice {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .practice-title {
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .practice-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .practice-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-purple);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-button:hover {
            background: rgba(156, 39, 176, 0.1);
            transform: translateY(-2px);
        }

        .practice-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .transfer-methods {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes lightRay {
            0% { transform: translateX(-100%) rotate(0deg); opacity: 0; }
            50% { transform: translateX(0) rotate(180deg); opacity: 1; }
            100% { transform: translateX(100%) rotate(360deg); opacity: 0; }
        }
        
        .light-ray {
            animation: lightRay 3s linear infinite;
        }
        
        @keyframes soundWave {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        
        .sound-wave-animation {
            animation: soundWave 2s ease-out infinite;
        }
        
        @keyframes heatFlow {
            0% { transform: translateY(0); background-color: rgba(255, 193, 7, 0.2); }
            50% { transform: translateY(-10px); background-color: rgba(255, 87, 34, 0.4); }
            100% { transform: translateY(0); background-color: rgba(255, 193, 7, 0.2); }
        }
        
        .heat-flow {
            animation: heatFlow 3s ease-in-out infinite;
        }
        
        @keyframes reflection {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(45deg); }
            100% { transform: rotate(0deg); }
        }
        
        .reflection-animation {
            animation: reflection 3s ease-in-out infinite;
        }
        
        @keyframes prismEffect {
            0% { background-color: rgba(255, 0, 0, 0.2); }
            33% { background-color: rgba(0, 255, 0, 0.2); }
            66% { background-color: rgba(0, 0, 255, 0.2); }
            100% { background-color: rgba(255, 0, 0, 0.2); }
        }
        
        .prism-animation {
            animation: prismEffect 5s linear infinite;
        }
    </style>
</head>
<body>
    <!-- Energy Pattern Background -->
    <div class="energy-bg" id="energyBg">
        <!-- Elements will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 6 Science</h1>
            <p class="welcome-subtitle">Discover the amazing world of energy! Explore light, sound, and heat - three fundamental forms of energy that shape our daily lives. Learn about reflection, refraction, sound waves, heat transfer, and how these energies interact with our world. Uncover the science behind what we see, hear, and feel!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üí°üéµüî•</span>
                <span class="topic-name">Light, Sound & Heat</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Energy Journey</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 120</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0.8%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Science fact display -->
                <div id="scienceFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Energy Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const energyBg = document.getElementById('energyBg');
            
            // Create floating energy symbols
            const elements = ['üí°', 'üåü', 'üîÜ', '‚ú®', 'üéµ', 'üé∂', 'üîä', 'üé§', 'üî•', 'üå°Ô∏è', '‚ô®Ô∏è', '‚òÄÔ∏è', 'üåà', 'üî≠'];
            
            for (let i = 0; i < 25; i++) {
                const element = document.createElement('div');
                element.className = 'floating-element';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = `${Math.random() * 100}%`;
                element.style.top = `${Math.random() * 100}%`;
                element.style.animationDelay = `${Math.random() * 20}s`;
                element.style.fontSize = `${2 + Math.random() * 3}rem`;
                
                // Color different types
                if (['üí°', 'üåü', 'üîÜ', '‚ú®', 'üåà', 'üî≠'].includes(element.textContent)) {
                    element.style.color = 'rgba(33, 150, 243, 0.1)'; // Blue for light
                } else if (['üéµ', 'üé∂', 'üîä', 'üé§'].includes(element.textContent)) {
                    element.style.color = 'rgba(156, 39, 176, 0.1)'; // Purple for sound
                } else if (['üî•', 'üå°Ô∏è', '‚ô®Ô∏è', '‚òÄÔ∏è'].includes(element.textContent)) {
                    element.style.color = 'rgba(255, 193, 7, 0.1)'; // Yellow for heat
                } else {
                    element.style.color = 'rgba(33, 150, 243, 0.1)'; // Default blue
                }
                
                energyBg.appendChild(element);
            }
        }

        // Questions array - 120+ Grade 6 Light, Sound, and Heat questions
        const questions = [
            // Light Basics (1-20)
            {
                type: "light_basics",
                question: "What is light?",
                options: ["Form of energy we can see", "Type of sound", "Heat energy", "Electrical energy"],
                answer: "A",
                explanation: "Light is a form of electromagnetic radiation that is visible to the human eye."
            },
            {
                type: "light_basics",
                question: "How does light travel?",
                options: ["In straight lines", "In circles", "In zig-zag patterns", "Only in water"],
                answer: "A",
                explanation: "Light travels in straight lines called rays, which is why we see shadows."
            },
            {
                type: "light_basics",
                question: "What is the speed of light?",
                options: ["300,000 km/s", "3,000 km/s", "30,000 km/s", "300 km/s"],
                answer: "A",
                explanation: "Light travels at approximately 300,000 kilometers per second in a vacuum."
            },
            {
                type: "light_basics",
                question: "Natural sources of light?",
                options: ["Sun, stars, fireflies", "Light bulbs, lamps", "TV screen, phone", "All electrical devices"],
                answer: "A",
                explanation: "The Sun is our main natural light source. Stars, fireflies, and lightning are also natural sources."
            },
            {
                type: "light_basics",
                question: "Artificial sources of light?",
                options: ["Light bulbs, candles, lamps", "Sun, stars", "Moon, planets", "Fireflies, glow worms"],
                answer: "A",
                explanation: "Artificial light is made by humans: light bulbs, candles, lamps, flashlights."
            },
            // Reflection & Refraction (21-40)
            {
                type: "reflection",
                question: "What is reflection of light?",
                options: ["Light bouncing off surfaces", "Light bending in water", "Light being absorbed", "Light changing color"],
                answer: "A",
                explanation: "Reflection occurs when light hits a surface and bounces back."
            },
            {
                type: "reflection",
                question: "What is a plane mirror?",
                options: ["Flat mirror giving clear image", "Curved mirror", "Broken mirror", "Water surface"],
                answer: "A",
                explanation: "Plane mirrors are flat and produce clear, same-sized virtual images."
            },
            {
                type: "reflection",
                question: "Law of reflection states:",
                options: ["Angle of incidence = Angle of reflection", "Light bends in water", "Light changes speed", "Light splits into colors"],
                answer: "A",
                explanation: "The angle at which light hits a surface equals the angle at which it reflects."
            },
            {
                type: "refraction",
                question: "What is refraction?",
                options: ["Bending of light when changing medium", "Light bouncing back", "Light splitting into colors", "Light being absorbed"],
                answer: "A",
                explanation: "Refraction occurs when light changes speed as it moves from one medium to another (air to water)."
            },
            {
                type: "refraction",
                question: "Example of refraction?",
                options: ["Pencil looking bent in water", "Mirror image", "Rainbow colors", "Shadow formation"],
                answer: "A",
                explanation: "Light bends at water-air interface, making objects appear shifted or bent."
            },
            // Colors & Spectrum (41-60)
            {
                type: "colors",
                question: "What creates a rainbow?",
                options: ["Sunlight refracted and dispersed by rain", "Moonlight reflection", "Artificial light", "Heat waves"],
                answer: "A",
                explanation: "Raindrops act like prisms, splitting white sunlight into its component colors."
            },
            {
                type: "colors",
                question: "Colors of the rainbow in order?",
                options: ["Red, Orange, Yellow, Green, Blue, Indigo, Violet", "Blue, Green, Yellow, Red", "All mixed colors", "Black and white only"],
                answer: "A",
                explanation: "Remember ROY G BIV: Red, Orange, Yellow, Green, Blue, Indigo, Violet."
            },
            {
                type: "colors",
                question: "What is a prism?",
                options: ["Transparent object that splits light", "Type of mirror", "Light source", "Heat conductor"],
                answer: "A",
                explanation: "A prism bends different colors of light by different amounts, creating a spectrum."
            },
            // Sound Basics (61-80)
            {
                type: "sound_basics",
                question: "What is sound?",
                options: ["Vibrations that travel through a medium", "Type of light", "Heat energy", "Electrical energy"],
                answer: "A",
                explanation: "Sound is produced by vibrating objects and travels as waves through air, water, or solids."
            },
            {
                type: "sound_basics",
                question: "How does sound travel?",
                options: ["As waves through a medium", "In straight lines only", "Only through air", "Faster than light"],
                answer: "A",
                explanation: "Sound needs a medium (air, water, solid) to travel. It cannot travel through vacuum."
            },
            {
                type: "sound_basics",
                question: "Speed of sound in air?",
                options: ["340 m/s", "3,000 m/s", "30,000 m/s", "3 m/s"],
                answer: "A",
                explanation: "Sound travels at about 340 meters per second in air at room temperature."
            },
            {
                type: "sound_basics",
                question: "What is vibration?",
                options: ["Rapid back-and-forth movement", "Slow movement", "Circular motion", "Upward movement only"],
                answer: "A",
                explanation: "Vibration creates sound waves. Without vibration, there is no sound."
            },
            // Sound Properties (81-100)
            {
                type: "sound_properties",
                question: "What is pitch?",
                options: ["How high or low a sound is", "Loudness of sound", "Quality of sound", "Speed of sound"],
                answer: "A",
                explanation: "High pitch = high frequency (more vibrations per second). Low pitch = low frequency."
            },
            {
                type: "sound_properties",
                question: "What is volume/loudness?",
                options: ["How loud or soft a sound is", "Highness or lowness", "Sound quality", "Sound direction"],
                answer: "A",
                explanation: "Loudness depends on amplitude of sound waves. Larger amplitude = louder sound."
            },
            {
                type: "sound_properties",
                question: "What is echo?",
                options: ["Sound reflection", "Sound absorption", "Sound creation", "Sound transmission"],
                answer: "A",
                explanation: "Echo is reflected sound that reaches our ears after the original sound."
            },
            // Heat Basics (101-120)
            {
                type: "heat_basics",
                question: "What is heat?",
                options: ["Form of energy that causes temperature change", "Type of light", "Kind of sound", "Electrical current"],
                answer: "A",
                explanation: "Heat is thermal energy transferred from hotter to colder objects."
            },
            {
                type: "heat_basics",
                question: "How is heat measured?",
                options: ["In degrees Celsius or Fahrenheit", "In decibels", "In lumens", "In hertz"],
                answer: "A",
                explanation: "Temperature measures heat intensity. Common units: Celsius (¬∞C) and Fahrenheit (¬∞F)."
            },
            {
                type: "heat_basics",
                question: "What is temperature?",
                options: ["Measure of how hot or cold something is", "Amount of heat energy", "Speed of molecules", "Type of energy"],
                answer: "A",
                explanation: "Temperature indicates the average kinetic energy of particles in a substance."
            },
            // Heat Transfer (121-140)
            {
                type: "heat_transfer",
                question: "What is conduction?",
                options: ["Heat transfer through direct contact", "Heat transfer through fluids", "Heat transfer through space", "Heat creation"],
                answer: "A",
                explanation: "Conduction: heat transfer through solids by direct contact (e.g., metal spoon in hot soup)."
            },
            {
                type: "heat_transfer",
                question: "What is convection?",
                options: ["Heat transfer through fluids (liquids/gases)", "Heat transfer through solids", "Heat transfer through space", "Heat absorption"],
                answer: "A",
                explanation: "Convection: hot fluids rise, cool fluids sink, creating currents (e.g., boiling water, air currents)."
            },
            {
                type: "heat_transfer",
                question: "What is radiation?",
                options: ["Heat transfer through space as waves", "Heat transfer through contact", "Heat transfer through fluids", "Heat storage"],
                answer: "A",
                explanation: "Radiation: heat travels as infrared waves through space (e.g., Sun's heat reaching Earth)."
            },
            // Applications (141-160)
            {
                type: "applications",
                question: "How do sunglasses protect eyes?",
                options: ["Polarized lenses reduce glare", "They make everything darker", "They block all light", "They magnify light"],
                answer: "A",
                explanation: "Polarized sunglasses reduce glare by blocking horizontally oriented light waves."
            },
            {
                type: "applications",
                question: "Why do we see lightning before hearing thunder?",
                options: ["Light travels faster than sound", "Sound travels faster than light", "They happen at same time", "Light is brighter"],
                answer: "A",
                explanation: "Light travels about 1 million times faster than sound in air."
            },
            {
                type: "applications",
                question: "Why do metals feel cold?",
                options: ["Good conductors of heat", "They store cold", "They produce cold", "They reflect heat"],
                answer: "A",
                explanation: "Metals conduct heat away from your hand quickly, making them feel cold."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Brilliant understanding of energy concepts!",
            "Perfect grasp of light behavior!",
            "Excellent sound wave knowledge!",
            "Outstanding heat transfer understanding!",
            "You're an energy expert!",
            "Physics champion!",
            "Master of light, sound, and heat!",
            "Perfect reflection knowledge!",
            "You think like a physicist!",
            "Energy mastery achieved!"
        ];

        // Science terms and definitions
        const scienceTerms = [
            {
                term: "Reflection",
                definition: "Light bouncing off surfaces",
                example: "Mirror image"
            },
            {
                term: "Refraction",
                definition: "Light bending in different mediums",
                example: "Pencil looking bent in water"
            },
            {
                term: "Vibration",
                definition: "Rapid back-and-forth motion",
                example: "Guitar string vibrating"
            },
            {
                term: "Conduction",
                definition: "Heat transfer through direct contact",
                example: "Metal spoon heating up in soup"
            },
            {
                term: "Convection",
                definition: "Heat transfer through fluid movement",
                example: "Boiling water circulation"
            },
            {
                term: "Radiation",
                definition: "Heat transfer through space as waves",
                example: "Sun's heat reaching Earth"
            }
        ];

        // Light properties and examples
        const lightProperties = [
            {
                property: "Travels in straight lines",
                example: "Shadows formed",
                icon: "üìè"
            },
            {
                property: "Can be reflected",
                example: "Mirrors, shiny surfaces",
                icon: "ü™û"
            },
            {
                property: "Can be refracted",
                example: "Lenses, water bending light",
                icon: "üíß"
            },
            {
                property: "Can be dispersed",
                example: "Rainbows, prisms",
                icon: "üåà"
            },
            {
                property: "Travels very fast",
                example: "300,000 km/s in vacuum",
                icon: "‚ö°"
            },
            {
                property: "Can be absorbed",
                example: "Black surfaces get hot",
                icon: "‚¨õ"
            }
        ];

        // Sound properties
        const soundProperties = [
            {
                property: "Needs a medium",
                example: "No sound in space (vacuum)",
                icon: "üö´"
            },
            {
                property: "Travels as waves",
                example: "Compression and rarefaction",
                icon: "üåä"
            },
            {
                property: "Can be reflected",
                example: "Echoes in caves",
                icon: "üó£Ô∏è"
            },
            {
                property: "Can be absorbed",
                example: "Soundproof rooms",
                icon: "üîá"
            },
            {
                property: "Has pitch",
                example: "High/low notes",
                icon: "üéº"
            },
            {
                property: "Has volume",
                example: "Loud/soft sounds",
                icon: "üîä"
            }
        ];

        // Heat transfer methods
        const heatTransferMethods = [
            {
                method: "Conduction",
                description: "Through direct contact",
                examples: "Metal spoon in hot soup, touching hot pan",
                icon: "ü§ù"
            },
            {
                method: "Convection",
                description: "Through fluid movement",
                examples: "Boiling water, sea breeze, heater in room",
                icon: "üå°Ô∏è"
            },
            {
                method: "Radiation",
                description: "Through space as waves",
                examples: "Sun's heat, radiator heat, campfire warmth",
                icon: "‚òÄÔ∏è"
            }
        ];

        // Light phenomena
        const lightPhenomena = [
            {
                phenomenon: "Rainbow",
                cause: "Sunlight refraction and dispersion in raindrops",
                colors: "ROYGBIV (Red, Orange, Yellow, Green, Blue, Indigo, Violet)",
                icon: "üåà"
            },
            {
                phenomenon: "Mirages",
                cause: "Light refraction in hot air layers",
                example: "Water illusion on hot roads",
                icon: "üèúÔ∏è"
            },
            {
                phenomenon: "Shadows",
                cause: "Light blocked by opaque objects",
                types: "Umbra (full shadow), Penumbra (partial shadow)",
                icon: "üë§"
            },
            {
                phenomenon: "Reflection",
                cause: "Light bouncing off surfaces",
                examples: "Mirrors, still water, shiny metals",
                icon: "ü™û"
            }
        ];

        // Sound phenomena
        const soundPhenomena = [
            {
                phenomenon: "Echo",
                cause: "Sound reflection from surfaces",
                requirement: "Hard, smooth, distant surfaces",
                icon: "üó£Ô∏è"
            },
            {
                phenomenon: "Resonance",
                cause: "Vibrations matching natural frequency",
                example: "Breaking glass with voice",
                icon: "üé∂"
            },
            {
                phenomenon: "Doppler Effect",
                cause: "Sound wave compression/expansion",
                example: "Ambulance siren pitch change",
                icon: "üöë"
            }
        ];

        // Heat conductors and insulators
        const thermalMaterials = [
            {
                type: "Good Conductors",
                examples: "Metals (copper, aluminum, iron)",
                use: "Cooking utensils, radiators",
                icon: "üî•"
            },
            {
                type: "Good Insulators",
                examples: "Wood, plastic, rubber, air",
                use: "Handles, clothing, buildings",
                icon: "‚ùÑÔ∏è"
            },
            {
                type: "Poor Conductors",
                examples: "Glass, ceramic, cloth",
                use: "Windows, mugs, clothing",
                icon: "üß§"
            }
        ];

        // Interesting science facts
        const scienceFacts = [
            "Light from the Sun takes about 8 minutes to reach Earth!",
            "Sound travels about 4 times faster in water than in air!",
            "A lightning bolt is hotter than the surface of the Sun!",
            "Some animals can see ultraviolet light that humans cannot!",
            "Whales can communicate with sound across entire oceans!",
            "The color black absorbs all light wavelengths, which is why black clothes get hot in the sun!",
            "Sound cannot travel in space because it's a vacuum - no air to carry the vibrations!",
            "Heat always moves from hotter objects to cooler ones, never the reverse!"
        ];

        // Energy examples in daily life
        const dailyExamples = [
            {
                area: "Home",
                light: "Light bulbs, windows",
                sound: "TV, music, talking",
                heat: "Heater, stove, sunlight"
            },
            {
                area: "School",
                light: "Projector, lights",
                sound: "Bell, teacher's voice",
                heat: "Radiators, body heat"
            },
            {
                area: "Nature",
                light: "Sun, stars, fireflies",
                sound: "Wind, animals, thunder",
                heat: "Sun, geothermal, forest fires"
            },
            {
                area: "Transport",
                light: "Headlights, traffic signals",
                sound: "Horns, engines",
                heat: "Engine heat, brakes"
            }
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const scienceFact = document.getElementById('scienceFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade6ScienceEnergy');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade6ScienceEnergy', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade6ScienceEnergy_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade6ScienceEnergy_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're an energy expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent knowledge of light, sound, and heat!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep learning about energy transfer!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review reflection, sound waves, and heat transfer!";
            } else {
                scoreMessage.textContent = "Keep exploring! Energy science is fascinating!";
            }
        }

        // Create science fact display
        function createScienceFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'science-fact';
            
            factDiv.innerHTML = `<strong>Amazing Energy Fact:</strong> ${scienceFacts[Math.floor(Math.random() * scienceFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "light_basics": "üí°",
                "reflection": "ü™û",
                "refraction": "üíß",
                "colors": "üåà",
                "sound_basics": "üéµ",
                "sound_properties": "üé∂",
                "heat_basics": "üî•",
                "heat_transfer": "üå°Ô∏è",
                "applications": "üî≠"
            };
            
            let conceptName = "Light Basics";
            let conceptIcon = "üí°";
            
            if (question.type.includes("light_basics")) {
                conceptName = "Light Basics";
                conceptIcon = conceptIcons.light_basics;
            } else if (question.type.includes("reflection")) {
                conceptName = "Light Reflection";
                conceptIcon = conceptIcons.reflection;
            } else if (question.type.includes("refraction")) {
                conceptName = "Light Refraction";
                conceptIcon = conceptIcons.refraction;
            } else if (question.type.includes("colors")) {
                conceptName = "Colors & Spectrum";
                conceptIcon = conceptIcons.colors;
            } else if (question.type.includes("sound_basics")) {
                conceptName = "Sound Basics";
                conceptIcon = conceptIcons.sound_basics;
            } else if (question.type.includes("sound_properties")) {
                conceptName = "Sound Properties";
                conceptIcon = conceptIcons.sound_properties;
            } else if (question.type.includes("heat_basics")) {
                conceptName = "Heat Basics";
                conceptIcon = conceptIcons.heat_basics;
            } else if (question.type.includes("heat_transfer")) {
                conceptName = "Heat Transfer";
                conceptIcon = conceptIcons.heat_transfer;
            } else if (question.type.includes("applications")) {
                conceptName = "Real Applications";
                conceptIcon = conceptIcons.applications;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("light_basics")) {
                label.textContent = "Understanding light sources and properties";
            } else if (question.type.includes("reflection")) {
                label.textContent = "How light bounces off surfaces";
            } else if (question.type.includes("refraction")) {
                label.textContent = "Light bending in different mediums";
            } else if (question.type.includes("colors")) {
                label.textContent = "Rainbows, prisms, and color spectrum";
            } else if (question.type.includes("sound_basics")) {
                label.textContent = "Sound production and transmission";
            } else if (question.type.includes("sound_properties")) {
                label.textContent = "Pitch, volume, and sound behavior";
            } else if (question.type.includes("heat_basics")) {
                label.textContent = "Heat energy and temperature";
            } else if (question.type.includes("heat_transfer")) {
                label.textContent = "Conduction, convection, and radiation";
            } else if (question.type.includes("applications")) {
                label.textContent = "Real-world applications of energy";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create energy visualization
        function createEnergyVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const dailyExample = dailyExamples[Math.floor(Math.random() * dailyExamples.length)];
            const lightPhenomenon = lightPhenomena[Math.floor(Math.random() * lightPhenomena.length)];
            const soundPhenomenon = soundPhenomena[Math.floor(Math.random() * soundPhenomena.length)];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-red);">Light, Sound & Heat Explorer</h3>
                
                <div class="comparison-container">
                    <div class="comparison-box light" onclick="showLightDetails()">
                        <div class="comparison-icon">üí°</div>
                        <div class="comparison-name">Light</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Travels at 300,000 km/s
                        </div>
                    </div>
                    <div class="comparison-box sound" onclick="showSoundDetails()">
                        <div class="comparison-icon">üéµ</div>
                        <div class="comparison-name">Sound</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Travels at 340 m/s in air
                        </div>
                    </div>
                    <div class="comparison-box heat" onclick="showHeatDetails()">
                        <div class="comparison-icon">üî•</div>
                        <div class="comparison-name">Heat</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Thermal energy transfer
                        </div>
                    </div>
                </div>
                
                <div class="energy-display">
                    <div style="font-size: 1.5rem; margin-bottom: 15px;">
                        Daily Life: <span style="color: var(--primary-blue); font-weight: bold;">${dailyExample.area}</span>
                    </div>
                    <div style="display: flex; justify-content: center; gap: 30px; margin: 20px 0; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="font-size: 3rem;">üí°</div>
                            <div style="margin-top: 10px; color: var(--primary-blue); font-weight: bold;">Light</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">${dailyExample.light}</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 3rem;">üéµ</div>
                            <div style="margin-top: 10px; color: var(--accent-purple); font-weight: bold;">Sound</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">${dailyExample.sound}</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 3rem;">üî•</div>
                            <div style="margin-top: 10px; color: var(--secondary-yellow); font-weight: bold;">Heat</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">${dailyExample.heat}</div>
                        </div>
                    </div>
                </div>
                
                <div class="light-container">
                    <div class="display-title">Light Properties - How Light Behaves</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        Click on properties to learn more
                    </div>
                    
                    <div class="light-diagram prism-animation">
                        <div class="light-property" style="top: 10%; left: 50%; transform: translateX(-50%);" onclick="showLightProperty('Travels straight')">
                            Straight Lines
                        </div>
                        <div class="light-property" style="top: 30%; left: 20%;" onclick="showLightProperty('Reflection')">
                            Reflection
                        </div>
                        <div class="light-property" style="top: 30%; left: 80%;" onclick="showLightProperty('Refraction')">
                            Refraction
                        </div>
                        <div class="light-property" style="top: 70%; left: 20%;" onclick="showLightProperty('Dispersion')">
                            Dispersion
                        </div>
                        <div class="light-property" style="top: 70%; left: 80%;" onclick="showLightProperty('Absorption')">
                            Absorption
                        </div>
                        <div class="light-property" style="top: 90%; left: 50%; transform: translateX(-50%);" onclick="showLightProperty('Speed')">
                            Super Fast!
                        </div>
                    </div>
                    
                    <div class="process-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 20px;">
                        ${lightProperties.slice(0, 6).map((property, idx) => `
                            <div class="process-box" onclick="showLightProperty('${property.property}')">
                                <div class="process-icon">${property.icon}</div>
                                <div class="process-name">${property.property.split(' ')[0]}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">${property.example}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="sound-container">
                    <div class="display-title">Sound Waves - How Sound Travels</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        Visualizing sound wave patterns
                    </div>
                    
                    <div class="sound-wave">
                        <div class="wave-line" style="top: 20px; animation-delay: 0s;"></div>
                        <div class="wave-line" style="top: 40px; animation-delay: 0.5s;"></div>
                        <div class="wave-line" style="top: 60px; animation-delay: 1s;"></div>
                        <div class="wave-line" style="top: 80px; animation-delay: 1.5s;"></div>
                    </div>
                    
                    <div class="process-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 20px;">
                        ${soundProperties.slice(0, 6).map((property, idx) => `
                            <div class="type-box sexual" onclick="showSoundProperty('${property.property}')">
                                <div class="type-icon">${property.icon}</div>
                                <div class="type-name">${property.property.split(' ')[0]}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">${property.example}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="heat-container heat-flow">
                    <div class="display-title">Heat Transfer - Three Methods</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        How heat moves from hot to cold
                    </div>
                    
                    <div class="transfer-methods">
                        ${heatTransferMethods.map((method, idx) => `
                            <div class="transfer-box ${method.method.toLowerCase()}" onclick="showHeatTransfer('${method.method}')">
                                <div class="transfer-icon">${method.icon}</div>
                                <div class="transfer-name">${method.method}</div>
                                <div style="font-size: 0.9rem; margin: 10px 0;">${method.description}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">Example: ${method.examples}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="optics-container reflection-animation">
                    <div class="display-title">Light Phenomena - Amazing Effects</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        ${lightPhenomenon.phenomenon}: ${lightPhenomenon.cause}
                    </div>
                    
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin: 20px 0;">
                        ${lightPhenomena.map((phenomenon, idx) => `
                            <div class="optics-box" onclick="showLightPhenomenon('${phenomenon.phenomenon}')">
                                <div class="optics-icon">${phenomenon.icon}</div>
                                <div class="optics-name">${phenomenon.phenomenon}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">${phenomenon.cause.split(' ')[0]}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="sound-container">
                    <div class="display-title">Sound Phenomena - How Sound Behaves</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        ${soundPhenomenon.phenomenon}: ${soundPhenomenon.cause}
                    </div>
                    
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin: 20px 0;">
                        ${soundPhenomena.map((phenomenon, idx) => `
                            <div class="type-box sexual" onclick="showSoundPhenomenon('${phenomenon.phenomenon}')">
                                <div class="type-icon">${phenomenon.icon}</div>
                                <div class="type-name">${phenomenon.phenomenon}</div>
                                <div style="font-size: 0.9rem; margin: 10px 0;">${phenomenon.cause}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">Example: ${phenomenon.example}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <table class="energy-table">
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Light</th>
                            <th>Sound</th>
                            <th>Heat</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-red);">Type</td>
                            <td>Electromagnetic wave</td>
                            <td>Mechanical wave</td>
                            <td>Thermal energy</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-red);">Needs Medium?</td>
                            <td>No (travels in vacuum)</td>
                            <td>Yes (needs air/water/solid)</td>
                            <td>No (radiation in space)</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-red);">Speed</td>
                            <td>300,000 km/s</td>
                            <td>340 m/s (in air)</td>
                            <td>Depends on material</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-red);">Can be reflected?</td>
                            <td>Yes (mirrors)</td>
                            <td>Yes (echoes)</td>
                            <td>Yes (shiny surfaces)</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-red);">Can be absorbed?</td>
                            <td>Yes (dark colors)</td>
                            <td>Yes (soundproofing)</td>
                            <td>Yes (dark materials)</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-red);">Travel direction</td>
                            <td>Straight lines</td>
                            <td>All directions</td>
                            <td>Hot ‚Üí Cold</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="real-world-example" style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid var(--accent-teal); font-style: italic; color: var(--text-secondary);">
                    <div style="color: var(--accent-teal); font-weight: bold; margin-bottom: 10px;">Real-World Energy Transfer:</div>
                    "On a sunny day at the beach: Light from the Sun reaches Earth in 8 minutes, heating the sand (radiation). The hot sand conducts heat to your feet when you walk on it (conduction). Hot air above the sand rises, creating a breeze (convection). You hear waves crashing (sound waves through air) and seagulls calling. Sunglasses reduce glare (light polarization) while sunscreen protects from UV radiation."
                    <div style="margin-top: 10px;">
                        <strong>Key concepts:</strong> Light travels fastest, sound needs medium, heat always moves from hot to cold.
                    </div>
                </div>
                
                <div class="interactive-practice">
                    <div class="practice-title">Interactive Energy Practice</div>
                    <div class="practice-controls">
                        <div class="practice-button" onclick="labelLightDiagram()">Label Light Diagram</div>
                        <div class="practice-button" onclick="matchHeatTransfer()">Match Heat Transfer</div>
                        <div class="practice-button" onclick="soundPropertiesQuiz()">Sound Properties Quiz</div>
                        <div class="practice-button" onclick="energyChallenge()">Energy Challenge</div>
                    </div>
                    <div class="practice-display" id="practiceDisplay">
                        Click buttons above to practice energy concepts
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-red);">
                    <div style="color: var(--accent-red); font-weight: bold; margin-bottom: 10px;">Quick Practice:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. Name three properties of light.<br>
                        2. What is the main difference between how light and sound travel?<br>
                        3. List the three methods of heat transfer.<br>
                        4. Why do we see lightning before hearing thunder?<br>
                        5. Give examples of good conductors and insulators of heat.
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--primary-blue);">
                    <div style="color: var(--primary-blue); font-weight: bold; margin-bottom: 10px; text-align: center;">Energy Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Light:</strong> Travels straight, very fast, can be reflected/refracted<br>
                        <strong>Sound:</strong> Needs medium, travels as waves, has pitch/volume<br>
                        <strong>Heat:</strong> Always moves hot‚Üícold, transfers 3 ways
                    </div>
                </div>
            `;
            
            return vizDiv;
        }

        // Helper functions
        function getIconForProperty(propertyName) {
            const iconMap = {
                "Reflection": "ü™û",
                "Refraction": "üíß",
                "Dispersion": "üåà",
                "Absorption": "‚¨õ",
                "Vibration": "üéµ",
                "Echo": "üó£Ô∏è",
                "Conduction": "ü§ù",
                "Convection": "üå°Ô∏è",
                "Radiation": "‚òÄÔ∏è"
            };
            return iconMap[propertyName] || "üí°";
        }

        // Global functions for interactive practice
        window.showLightDetails = function() {
            const lightFacts = [
                "Light travels at 300,000 km/s - the fastest thing in the universe!",
                "Light from the Sun takes 8 minutes to reach Earth.",
                "Light travels in straight lines - that's why we see shadows.",
                "White light contains all colors of the rainbow (ROYGBIV).",
                "Some animals can see ultraviolet or infrared light that humans cannot."
            ];
            
            alert(`üí° Light Facts:\n\n${lightFacts[Math.floor(Math.random() * lightFacts.length)]}\n\nKey Properties:\n‚Ä¢ Travels in straight lines\n‚Ä¢ Can be reflected\n‚Ä¢ Can be refracted\n‚Ä¢ Very fast (300,000 km/s)`);
        };

        window.showSoundDetails = function() {
            const soundFacts = [
                "Sound cannot travel in space - it needs air or another medium!",
                "Sound travels about 4 times faster in water than in air.",
                "Whales can communicate across entire oceans with low-frequency sounds.",
                "The loudest sound ever recorded was the Krakatoa volcanic eruption in 1883.",
                "Bats use echolocation (sound reflection) to navigate in the dark."
            ];
            
            alert(`üéµ Sound Facts:\n\n${soundFacts[Math.floor(Math.random() * soundFacts.length)]}\n\nKey Properties:\n‚Ä¢ Needs a medium to travel\n‚Ä¢ Travels as waves\n‚Ä¢ Has pitch (high/low) and volume (loud/soft)\n‚Ä¢ Speed in air: 340 m/s`);
        };

        window.showHeatDetails = function() {
            const heatFacts = [
                "Heat always moves from hotter objects to cooler ones!",
                "A lightning bolt is 5 times hotter than the surface of the Sun.",
                "The color black absorbs heat best, white reflects it.",
                "Metals feel cold because they conduct heat away from your hand quickly.",
                "Space is cold because there's no air to conduct or convect heat."
            ];
            
            alert(`üî• Heat Facts:\n\n${heatFacts[Math.floor(Math.random() * heatFacts.length)]}\n\nKey Properties:\n‚Ä¢ Form of thermal energy\n‚Ä¢ Measured in ¬∞C or ¬∞F\n‚Ä¢ Always moves hot ‚Üí cold\n‚Ä¢ Transfers by: Conduction, Convection, Radiation`);
        };

        window.showLightProperty = function(propertyName) {
            const property = lightProperties.find(p => p.property.includes(propertyName));
            if (property) {
                alert(`${property.property}\n\nExample: ${property.example}\n\nImportance: This property explains how light behaves in different situations.`);
            } else if (propertyName === "Travels straight") {
                alert("Light Travels in Straight Lines\n\n‚Ä¢ Why we see shadows\n‚Ä¢ Why we need line of sight to see things\n‚Ä¢ Explains how pinhole cameras work\n‚Ä¢ Light rays don't bend around corners");
            } else if (propertyName === "Super Fast!") {
                alert("Light Speed: 300,000 km/s\n\n‚Ä¢ Fastest thing in the universe\n‚Ä¢ Sunlight reaches Earth in 8 minutes\n‚Ä¢ Could circle Earth 7.5 times in 1 second\n‚Ä¢ Much faster than sound");
            }
        };

        window.showSoundProperty = function(propertyName) {
            const property = soundProperties.find(p => p.property.includes(propertyName));
            if (property) {
                alert(`${property.property}\n\nExample: ${property.example}\n\nImportance: This affects how we hear and use sound in daily life.`);
            } else if (propertyName === "Needs a medium") {
                alert("Sound Needs a Medium\n\n‚Ä¢ Cannot travel in vacuum (space)\n‚Ä¢ Needs air, water, or solids\n‚Ä¢ Explains why there's no sound in space\n‚Ä¢ Travels faster in solids than in gases");
            }
        };

        window.showHeatTransfer = function(methodName) {
            const method = heatTransferMethods.find(m => m.method === methodName);
            if (!method) return;
            
            alert(`${method.method}\n\nDescription: ${method.description}\n\nExamples: ${method.examples}\n\nKey Point: Heat always transfers from hotter to colder objects.`);
        };

        window.showLightPhenomenon = function(phenomenonName) {
            const phenomenon = lightPhenomena.find(p => p.phenomenon === phenomenonName);
            if (!phenomenon) return;
            
            alert(`${phenomenon.phenomenon}\n\nCause: ${phenomenon.cause}\n\n${phenomenon.colors ? 'Colors: ' + phenomenon.colors : ''}${phenomenon.types ? 'Types: ' + phenomenon.types : ''}${phenomenon.example ? 'Example: ' + phenomenon.example : ''}`);
        };

        window.showSoundPhenomenon = function(phenomenonName) {
            const phenomenon = soundPhenomena.find(p => p.phenomenon === phenomenonName);
            if (!phenomenon) return;
            
            alert(`${phenomenon.phenomenon}\n\nCause: ${phenomenon.cause}\n\n${phenomenon.requirement ? 'Requires: ' + phenomenon.requirement : ''}${phenomenon.example ? '\nExample: ' + phenomenon.example : ''}`);
        };

        window.labelLightDiagram = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary-blue);">Label Light Diagram</div>
                    <div style="margin-bottom: 15px;">
                        Drag labels to the correct light properties:
                    </div>
                    
                    <div style="position: relative; width: 250px; height: 250px; margin: 20px auto; background: radial-gradient(circle, rgba(33, 150, 243, 0.1), transparent 70%); border-radius: 50%; border: 2px solid var(--primary-blue);">
                        <div id="lightCenter" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60px; height: 60px; background: rgba(33, 150, 243, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            ?
                        </div>
                        <div id="lightTop" style="position: absolute; top: 20%; left: 50%; transform: translateX(-50%); width: 80px; height: 40px; background: rgba(33, 150, 243, 0.2); border-radius: 20px; display: flex; align-items: center; justify-content: center;">
                            ?
                        </div>
                        <div id="lightLeft" style="position: absolute; top: 35%; left: 25%; width: 60px; height: 60px; background: rgba(33, 150, 243, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            ?
                        </div>
                        <div id="lightRight" style="position: absolute; top: 35%; right: 25%; width: 60px; height: 60px; background: rgba(33, 150, 243, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            ?
                        </div>
                        <div id="lightBottomLeft" style="position: absolute; bottom: 25%; left: 25%; width: 50px; height: 30px; background: rgba(33, 150, 243, 0.2); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                            ?
                        </div>
                        <div id="lightBottomRight" style="position: absolute; bottom: 25%; right: 25%; width: 50px; height: 30px; background: rgba(33, 150, 243, 0.2); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                            ?
                        </div>
                    </div>
                    
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0;">
                        <div class="draggable-item" draggable="true" ondragstart="dragLightLabel(event, 'Reflection')" style="cursor: move;">
                            Reflection
                        </div>
                        <div class="draggable-item" draggable="true" ondragstart="dragLightLabel(event, 'Refraction')" style="cursor: move;">
                            Refraction
                        </div>
                        <div class="draggable-item" draggable="true" ondragstart="dragLightLabel(event, 'Dispersion')" style="cursor: move;">
                            Dispersion
                        </div>
                        <div class="draggable-item" draggable="true" ondragstart="dragLightLabel(event, 'Absorption')" style="cursor: move;">
                            Absorption
                        </div>
                        <div class="draggable-item" draggable="true" ondragstart="dragLightLabel(event, 'Straight Lines')" style="cursor: move;">
                            Straight Lines
                        </div>
                        <div class="draggable-item" draggable="true" ondragstart="dragLightLabel(event, 'Fast Travel')" style="cursor: move;">
                            Fast Travel
                        </div>
                    </div>
                    
                    <div id="lightLabelResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Hint:</strong> Reflection = bouncing, Refraction = bending
                    </div>
                </div>
            `;
        };

        window.dragLightLabel = function(ev, labelName) {
            ev.dataTransfer.setData("text/plain", labelName);
        };

        // Set up drop zones for light properties
        function setupLightDropZones() {
            const zones = ['lightCenter', 'lightTop', 'lightLeft', 'lightRight', 'lightBottomLeft', 'lightBottomRight'];
            zones.forEach(zoneId => {
                const zone = document.getElementById(zoneId);
                if (zone) {
                    zone.ondragover = function(ev) {
                        ev.preventDefault();
                    };
                    zone.ondrop = function(ev) {
                        ev.preventDefault();
                        const label = ev.dataTransfer.getData("text/plain");
                        
                        let isCorrect = false;
                        if (zoneId === 'lightCenter' && label === 'Fast Travel') isCorrect = true;
                        if (zoneId === 'lightTop' && label === 'Straight Lines') isCorrect = true;
                        if (zoneId === 'lightLeft' && label === 'Reflection') isCorrect = true;
                        if (zoneId === 'lightRight' && label === 'Refraction') isCorrect = true;
                        if (zoneId === 'lightBottomLeft' && label === 'Dispersion') isCorrect = true;
                        if (zoneId === 'lightBottomRight' && label === 'Absorption') isCorrect = true;
                        
                        if (isCorrect) {
                            zone.style.backgroundColor = 'rgba(33, 150, 243, 0.4)';
                            zone.textContent = label;
                            
                            const resultDiv = document.getElementById('lightLabelResult');
                            if (resultDiv) {
                                resultDiv.textContent = `Correct! ${label} placed correctly!`;
                                resultDiv.style.color = 'var(--primary-blue)';
                            }
                        } else {
                            zone.style.backgroundColor = 'rgba(244, 67, 54, 0.4)';
                            
                            const resultDiv = document.getElementById('lightLabelResult');
                            if (resultDiv) {
                                resultDiv.textContent = 'Try again!';
                                resultDiv.style.color = 'var(--accent-red)';
                            }
                        }
                    };
                }
            });
        }

        window.matchHeatTransfer = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--secondary-yellow);">Match Heat Transfer Methods</div>
                    <div style="margin-bottom: 15px;">
                        Match examples with heat transfer methods:
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
                        <div style="text-align: right;">
                            ${heatTransferMethods.map(method => `
                                <div class="draggable-item" style="margin-bottom: 10px; cursor: move;" 
                                     draggable="true" ondragstart="dragHeatMethod(event, '${method.method}')">
                                    <div style="display: flex; align-items: center; gap: 10px; justify-content: flex-end;">
                                        <span style="font-weight: bold;">${method.method}</span>
                                        <span style="font-size: 1.5rem;">${method.icon}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="text-align: left;">
                            ${shuffleArray([...heatTransferMethods]).map(method => `
                                <div class="draggable-item" style="margin-bottom: 10px; min-height: 60px; display: flex; align-items: center;"
                                     ondrop="dropHeatMethod(event)" ondragover="allowDrop(event)">
                                    <div>
                                        <div><strong>Example:</strong> ${method.examples.split(',')[0]}</div>
                                        <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                                            ${method.description}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div id="heatMatchResult" style="margin-top: 20px; min-height: 30px;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Remember:</strong> Conduction = contact, Convection = fluids, Radiation = waves
                    </div>
                </div>
            `;
        };

        window.dragHeatMethod = function(ev, methodName) {
            ev.dataTransfer.setData("text/plain", methodName);
        };

        window.dropHeatMethod = function(ev) {
            ev.preventDefault();
            const methodName = ev.dataTransfer.getData("text/plain");
            const target = ev.target.closest('.draggable-item') || ev.target;
            
            const method = heatTransferMethods.find(m => m.method === methodName);
            const targetExample = target.textContent.split('Example:')[1]?.split('Conduction')[0]?.split('Convection')[0]?.split('Radiation')[0]?.trim();
            
            if (method && targetExample && method.examples.includes(targetExample)) {
                target.style.borderColor = 'var(--primary-blue)';
                target.style.backgroundColor = 'rgba(33, 150, 243, 0.2)';
                
                const resultDiv = document.getElementById('heatMatchResult');
                if (resultDiv) {
                    resultDiv.textContent = "Correct match!";
                    resultDiv.style.color = 'var(--primary-blue)';
                }
            } else {
                target.style.borderColor = 'var(--accent-red)';
                target.style.backgroundColor = 'rgba(244, 67, 54, 0.2)';
                
                const resultDiv = document.getElementById('heatMatchResult');
                if (resultDiv) {
                    resultDiv.textContent = "Try again!";
                    resultDiv.style.color = 'var(--accent-red)';
                }
            }
        };

        window.allowDrop = function(ev) {
            ev.preventDefault();
        };

        window.soundPropertiesQuiz = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const quizQuestions = [
                {
                    question: "What does sound need to travel?",
                    options: ["A medium (air/water/solid)", "Light", "Heat", "Electricity"],
                    answer: 0
                },
                {
                    question: "What is pitch?",
                    options: ["How high or low a sound is", "How loud a sound is", "Sound quality", "Sound direction"],
                    answer: 0
                },
                {
                    question: "What is an echo?",
                    options: ["Reflected sound", "Absorbed sound", "Created sound", "Transmitted sound"],
                    answer: 0
                }
            ];
            
            const currentQuestion = quizQuestions[Math.floor(Math.random() * quizQuestions.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-purple);">Sound Properties Quiz</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px;">
                        ${currentQuestion.question}
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr; gap: 10px; margin: 20px 0;">
                        ${currentQuestion.options.map((option, idx) => `
                            <div class="option" onclick="checkSoundQuizAnswer(this, ${idx}, ${currentQuestion.answer})">
                                <div class="option-letter">${String.fromCharCode(65 + idx)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div id="soundQuizResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                </div>
            `;
        };

        window.checkSoundQuizAnswer = function(element, selectedIndex, correctIndex) {
            const resultDiv = document.getElementById('soundQuizResult');
            if (!resultDiv) return;
            
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            if (selectedIndex === correctIndex) {
                element.classList.add('correct');
                resultDiv.textContent = "Correct! Well done!";
                resultDiv.style.color = 'var(--accent-purple)';
            } else {
                element.classList.add('incorrect');
                options[correctIndex].classList.add('correct');
                resultDiv.textContent = `Correct answer: ${String.fromCharCode(65 + correctIndex)}`;
                resultDiv.style.color = 'var(--accent-orange)';
            }
            
            resultDiv.classList.add('pulse');
            setTimeout(() => resultDiv.classList.remove('pulse'), 500);
        };

        window.energyChallenge = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const challenges = [
                {
                    type: "Light",
                    challenge: "Explain why a pencil looks bent in water.",
                    answer: "Light refraction - light bends when moving from air to water."
                },
                {
                    type: "Sound",
                    challenge: "Why can't we hear sounds in space?",
                    answer: "Sound needs a medium (air) to travel. Space is a vacuum."
                },
                {
                    type: "Heat",
                    challenge: "Why does metal feel colder than wood at room temperature?",
                    answer: "Metal is a better heat conductor, so it draws heat from your hand faster."
                }
            ];
            
            const currentChallenge = challenges[Math.floor(Math.random() * challenges.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-red);">Energy Challenge: ${currentChallenge.type}</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-style: italic;">
                        "${currentChallenge.challenge}"
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <textarea id="challengeAnswer" placeholder="Type your explanation here..." style="width: 100%; min-height: 100px; padding: 15px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary); font-size: 1rem; resize: vertical;"></textarea>
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="checkChallengeAnswer()">Check Answer</button>
                        <button class="btn btn-small btn-outline" onclick="showChallengeAnswer()">Show Answer</button>
                    </div>
                    
                    <div id="challengeResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                </div>
            `;
            
            window.currentChallengeAnswer = currentChallenge.answer;
        };

        window.checkChallengeAnswer = function() {
            const answerInput = document.getElementById('challengeAnswer');
            const resultDiv = document.getElementById('challengeResult');
            
            if (!answerInput || !resultDiv) return;
            
            const userAnswer = answerInput.value.trim().toLowerCase();
            const correctAnswer = window.currentChallengeAnswer.toLowerCase();
            
            // Simple keyword checking
            const keywords = correctAnswer.split(' ').filter(word => word.length > 3);
            let matchCount = 0;
            
            keywords.forEach(keyword => {
                if (userAnswer.includes(keyword.toLowerCase())) {
                    matchCount++;
                }
            });
            
            const matchPercentage = (matchCount / keywords.length) * 100;
            
            if (matchPercentage > 50) {
                resultDiv.textContent = "Good answer! You understand the concept!";
                resultDiv.style.color = 'var(--primary-blue)';
            } else {
                resultDiv.textContent = "Close! Check the correct answer for comparison.";
                resultDiv.style.color = 'var(--accent-orange)';
            }
        };

        window.showChallengeAnswer = function() {
            const resultDiv = document.getElementById('challengeResult');
            if (resultDiv && window.currentChallengeAnswer) {
                resultDiv.textContent = `Correct answer: ${window.currentChallengeAnswer}`;
                resultDiv.style.color = 'var(--secondary-yellow)';
            }
        };

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            scienceFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            scienceFact.appendChild(createScienceFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createEnergyVisualization());
            
            // Set up drop zones after visualization is created
            setTimeout(setupLightDropZones, 100);
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
