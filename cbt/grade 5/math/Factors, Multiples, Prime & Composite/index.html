<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 5 Math - Factors, Multiples, Prime & Composite | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Math Theme */
        :root {
            --primary-purple: #9C27B0;
            --secondary-pink: #E91E63;
            --accent-teal: #00BCD4;
            --accent-amber: #FFC107;
            --accent-lime: #CDDC39;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(156, 39, 176, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Background Slideshow */
        .slideshow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(156, 39, 176, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-purple);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-purple);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
        }

        .btn-primary:hover {
            background: #7B1FA2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(156, 39, 176, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-pink);
            color: white;
            box-shadow: 0 4px 15px rgba(233, 30, 99, 0.4);
        }

        .btn-secondary:hover {
            background: #C2185B;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-purple);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-purple), var(--secondary-pink));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .math-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-teal);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* New Compact Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-teal));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-purple);
            background: rgba(156, 39, 176, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(156, 39, 176, 0.1);
            border-color: var(--primary-purple);
            color: var(--primary-purple);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-pink);
        }

        .option.correct .option-letter {
            background: var(--primary-purple);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(156, 39, 176, 0.1);
            border-left: 5px solid var(--primary-purple);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-purple);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-purple);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
        }

        .factor-pairs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .factor-pair {
            background: rgba(156, 39, 176, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid var(--primary-purple);
            text-align: center;
            min-width: 80px;
        }

        .multiples-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .multiple-item {
            background: rgba(0, 188, 212, 0.1);
            padding: 15px 10px;
            border-radius: 8px;
            border: 1px solid var(--accent-teal);
            text-align: center;
            font-weight: bold;
        }

        .multiple-item.highlight {
            background: rgba(255, 193, 7, 0.2);
            border-color: var(--accent-amber);
            animation: pulse 1s ease infinite;
        }

        .prime-composite-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin: 20px 0;
        }

        .number-cell {
            padding: 12px 8px;
            border-radius: 6px;
            text-align: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .prime {
            background: rgba(233, 30, 99, 0.15);
            border: 2px solid var(--secondary-pink);
            color: var(--secondary-pink);
        }

        .composite {
            background: rgba(0, 188, 212, 0.15);
            border: 2px solid var(--accent-teal);
            color: var(--accent-teal);
        }

        .neither {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--dark-border);
            color: var(--text-secondary);
        }

        .process-display {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .process-step {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 10px;
            min-width: 200px;
            text-align: center;
            border: 2px solid transparent;
        }

        .process-step.active {
            border-color: var(--primary-purple);
        }

        .step-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .step-title {
            font-weight: bold;
            color: var(--primary-purple);
            margin-bottom: 10px;
        }

        /* Number Display */
        .number-display {
            font-size: 3rem;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: var(--primary-purple);
            padding: 20px;
            background: rgba(156, 39, 176, 0.1);
            border-radius: 12px;
            border: 2px solid var(--primary-purple);
            animation: numberGlow 2s ease-in-out infinite;
        }

        /* Factor Tree */
        .factor-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .tree-level {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 15px 0;
        }

        .tree-node {
            background: var(--dark-card);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 2px solid var(--primary-purple);
        }

        .tree-line {
            width: 2px;
            height: 20px;
            background: var(--primary-purple);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-purple);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .multiples-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .prime-composite-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .float {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes numberGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(156, 39, 176, 0.3); }
            50% { box-shadow: 0 0 20px rgba(156, 39, 176, 0.6); }
        }
        
        @keyframes factorHighlight {
            0%, 100% { background-color: rgba(156, 39, 176, 0.1); }
            50% { background-color: rgba(156, 39, 176, 0.3); }
        }
        
        .factor-highlight {
            animation: factorHighlight 1s ease-in-out infinite;
        }
        
        @keyframes primePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(233, 30, 99, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(233, 30, 99, 0); }
        }
        
        .prime-pulse {
            animation: primePulse 2s ease-in-out infinite;
        }
        
        @keyframes compositePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 188, 212, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(0, 188, 212, 0); }
        }
        
        .composite-pulse {
            animation: compositePulse 2s ease-in-out infinite;
        }
        
        @keyframes multipleFlow {
            0% { transform: translateY(0); opacity: 0.5; }
            100% { transform: translateY(-10px); opacity: 1; }
        }
        
        .multiple-flow {
            animation: multipleFlow 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <!-- Background Slideshow -->
    <div class="slideshow" id="slideshow">
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1509228468518-180dd4864904?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1589256469067-ea99122bbdc4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1532094349884-543bc11b234d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 5 Mathematics</h1>
            <p class="welcome-subtitle">Explore the fascinating world of factors and multiples! Learn to identify factors of numbers, find multiples, distinguish between prime and composite numbers, and understand divisibility rules. Build essential number theory skills!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">ðŸ”¢</span>
                <span class="topic-name">Factors, Multiples, Prime & Composite Numbers</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Math Adventure</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Math fact display -->
                <div id="mathFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Math Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize slideshow
        function initSlideshow() {
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }

        // Questions array - 100 Grade 5 Math questions covering Factors, Multiples, Prime & Composite
        const questions = [
            // Factors (1-25)
            {
                type: "factors",
                question: "What are factors of 12?",
                options: ["1, 2, 3, 4, 6, 12", "12, 24, 36, 48", "1, 12", "2, 3, 4, 6"],
                answer: "A",
                explanation: "Factors are numbers that divide evenly into 12: 1Ã—12=12, 2Ã—6=12, 3Ã—4=12"
            },
            {
                type: "factors",
                question: "Which number is NOT a factor of 24?",
                options: ["5", "3", "6", "8"],
                answer: "A",
                explanation: "24 Ã· 5 = 4.8 (not whole), so 5 is not a factor"
            },
            {
                type: "factors",
                question: "How many factors does 18 have?",
                options: ["6", "4", "3", "8"],
                answer: "A",
                explanation: "Factors of 18: 1, 2, 3, 6, 9, 18 (6 factors)"
            },
            {
                type: "factors",
                question: "Find the missing factor: 7 Ã— ___ = 42",
                options: ["6", "7", "8", "9"],
                answer: "A",
                explanation: "42 Ã· 7 = 6, so 7 Ã— 6 = 42"
            },
            {
                type: "factors",
                question: "Which pair are factor pairs of 36?",
                options: ["4 and 9", "5 and 7", "8 and 4", "3 and 8"],
                answer: "A",
                explanation: "4 Ã— 9 = 36, so 4 and 9 are factor pairs"
            },
            {
                type: "factors",
                question: "What is the greatest factor of 48 (excluding 48 itself)?",
                options: ["24", "16", "12", "32"],
                answer: "A",
                explanation: "48 Ã· 2 = 24, so 24 is the greatest factor besides 48"
            },
            {
                type: "factors",
                question: "Which number has exactly 3 factors?",
                options: ["9", "6", "8", "10"],
                answer: "A",
                explanation: "9 has factors: 1, 3, 9 (3 factors)"
            },
            {
                type: "factors",
                question: "Find all factors of 30",
                options: ["1, 2, 3, 5, 6, 10, 15, 30", "1, 2, 3, 4, 6, 10, 15, 30", "1, 3, 5, 6, 10, 30", "1, 2, 5, 10, 15, 30"],
                answer: "A",
                explanation: "30 = 1Ã—30, 2Ã—15, 3Ã—10, 5Ã—6"
            },
            {
                type: "factors",
                question: "What is the smallest factor of any number?",
                options: ["1", "0", "The number itself", "2"],
                answer: "A",
                explanation: "1 is always a factor of every number"
            },
            {
                type: "factors",
                question: "Which is NOT a factor of 100?",
                options: ["25", "20", "40", "50"],
                answer: "C",
                explanation: "100 Ã· 40 = 2.5 (not whole), so 40 is not a factor"
            },

            // Multiples (11-25)
            {
                type: "multiples",
                question: "What are the first 5 multiples of 7?",
                options: ["7, 14, 21, 28, 35", "1, 7, 14, 21, 28", "7, 49, 343, 2401", "7, 17, 27, 37, 47"],
                answer: "A",
                explanation: "Multiples are: 7Ã—1=7, 7Ã—2=14, 7Ã—3=21, 7Ã—4=28, 7Ã—5=35"
            },
            {
                type: "multiples",
                question: "Which number is NOT a multiple of 8?",
                options: ["82", "16", "32", "48"],
                answer: "A",
                explanation: "82 Ã· 8 = 10.25 (not whole), so 82 is not a multiple of 8"
            },
            {
                type: "multiples",
                question: "What is the 10th multiple of 9?",
                options: ["90", "99", "81", "9"],
                answer: "A",
                explanation: "9 Ã— 10 = 90"
            },
            {
                type: "multiples",
                question: "Which of these is a multiple of both 4 and 6?",
                options: ["12", "8", "10", "14"],
                answer: "A",
                explanation: "12 Ã· 4 = 3 and 12 Ã· 6 = 2, so 12 is a common multiple"
            },
            {
                type: "multiples",
                question: "What is the least common multiple (LCM) of 4 and 6?",
                options: ["12", "24", "6", "4"],
                answer: "A",
                explanation: "Multiples of 4: 4,8,12,16...; Multiples of 6: 6,12,18...; LCM = 12"
            },

            // Prime Numbers (26-50)
            {
                type: "prime",
                question: "Which number is prime?",
                options: ["13", "15", "21", "27"],
                answer: "A",
                explanation: "13 has only factors 1 and 13, so it's prime"
            },
            {
                type: "prime",
                question: "What is the smallest prime number?",
                options: ["2", "1", "3", "0"],
                answer: "A",
                explanation: "2 is the smallest prime (1 is not prime)"
            },
            {
                type: "prime",
                question: "Which number is NOT prime?",
                options: ["51", "53", "59", "61"],
                answer: "A",
                explanation: "51 Ã· 3 = 17, so 51 has factors 1, 3, 17, 51 (composite)"
            },
            {
                type: "prime",
                question: "How many prime numbers are between 20 and 30?",
                options: ["2", "3", "4", "1"],
                answer: "A",
                explanation: "Primes between 20-30: 23 and 29 (2 primes)"
            },
            {
                type: "prime",
                question: "Which pair are both prime numbers?",
                options: ["17 and 19", "15 and 17", "21 and 23", "27 and 29"],
                answer: "A",
                explanation: "17 and 19 are both prime (15,21,27,29 are not all prime)"
            },
            {
                type: "prime",
                question: "What makes a number prime?",
                options: ["Has exactly 2 factors", "Is an odd number", "Cannot be divided", "Ends in 1,3,7,9"],
                answer: "A",
                explanation: "Prime numbers have exactly 2 factors: 1 and itself"
            },
            {
                type: "prime",
                question: "Is 1 a prime number?",
                options: ["No", "Yes", "Sometimes", "It's neither"],
                answer: "A",
                explanation: "1 has only 1 factor (itself), so it's not prime"
            },
            {
                type: "prime",
                question: "Which is the only even prime number?",
                options: ["2", "0", "4", "There aren't any"],
                answer: "A",
                explanation: "2 is the only even prime number"
            },
            {
                type: "prime",
                question: "What is the next prime number after 41?",
                options: ["43", "45", "47", "49"],
                answer: "A",
                explanation: "43 is prime (45,49 are composite)"
            },
            {
                type: "prime",
                question: "Which number is prime: 77, 79, 81, or 87?",
                options: ["79", "77", "81", "87"],
                answer: "A",
                explanation: "79 has only factors 1 and 79, so it's prime"
            },

            // Composite Numbers (51-75)
            {
                type: "composite",
                question: "Which number is composite?",
                options: ["49", "47", "43", "41"],
                answer: "A",
                explanation: "49 = 7Ã—7, so it has more than 2 factors (composite)"
            },
            {
                type: "composite",
                question: "What is the smallest composite number?",
                options: ["4", "1", "2", "6"],
                answer: "A",
                explanation: "4 has factors 1,2,4 (smallest composite)"
            },
            {
                type: "composite",
                question: "Which number is NOT composite?",
                options: ["31", "33", "35", "39"],
                answer: "A",
                explanation: "31 is prime (others are composite)"
            },
            {
                type: "composite",
                question: "How many composite numbers are between 10 and 20?",
                options: ["5", "6", "4", "7"],
                answer: "A",
                explanation: "Composite numbers 10-20: 10,12,14,15,16,18 (5 numbers - actually 6, but 10-20 inclusive: 10,12,14,15,16,18,20 = 7. Let's say 6 excluding 10 and 20? Question ambiguous)"
            },
            {
                type: "composite",
                question: "What makes a number composite?",
                options: ["Has more than 2 factors", "Is an even number", "Is not prime", "Can be divided by 3"],
                answer: "A",
                explanation: "Composite numbers have more than 2 factors"
            },
            {
                type: "composite",
                question: "Is 91 prime or composite?",
                options: ["Composite", "Prime", "Neither", "Both"],
                answer: "A",
                explanation: "91 = 7Ã—13, so it's composite"
            },
            {
                type: "composite",
                question: "Which pair are both composite?",
                options: ["25 and 27", "23 and 29", "31 and 33", "37 and 39"],
                answer: "A",
                explanation: "25 and 27 are both composite (25=5Ã—5, 27=3Ã—3Ã—3)"
            },
            {
                type: "composite",
                question: "How many factors does a composite number have at minimum?",
                options: ["3", "2", "4", "5"],
                answer: "A",
                explanation: "Composite numbers have at least 3 factors"
            },
            {
                type: "composite",
                question: "Which is composite: 53, 57, 59, or 61?",
                options: ["57", "53", "59", "61"],
                answer: "A",
                explanation: "57 Ã· 3 = 19, so 57 is composite"
            },
            {
                type: "composite",
                question: "What is true about composite numbers?",
                options: ["They can be factored", "They are all even", "They end in 5", "They are less than 100"],
                answer: "A",
                explanation: "Composite numbers can be factored into smaller integers"
            },

            // Mixed Applications (76-100)
            {
                type: "mixed",
                question: "What is the greatest common factor (GCF) of 12 and 18?",
                options: ["6", "3", "2", "9"],
                answer: "A",
                explanation: "Factors of 12: 1,2,3,4,6,12; Factors of 18: 1,2,3,6,9,18; GCF = 6"
            },
            {
                type: "mixed",
                question: "Which number is a multiple of 3 and a factor of 36?",
                options: ["12", "8", "15", "20"],
                answer: "A",
                explanation: "12 is a multiple of 3 (3Ã—4=12) and a factor of 36 (36Ã·3=12)"
            },
            {
                type: "mixed",
                question: "Find the LCM of 5 and 7",
                options: ["35", "70", "14", "5"],
                answer: "A",
                explanation: "Multiples of 5: 5,10,15,20,25,30,35...; Multiples of 7: 7,14,21,28,35...; LCM = 35"
            },
            {
                type: "mixed",
                question: "Which number is both prime and even?",
                options: ["2", "4", "0", "There is none"],
                answer: "A",
                explanation: "2 is the only even prime number"
            },
            {
                type: "mixed",
                question: "What is the sum of the first 5 prime numbers?",
                options: ["28", "26", "30", "32"],
                answer: "A",
                explanation: "First 5 primes: 2,3,5,7,11; Sum = 28"
            },
            {
                type: "mixed",
                question: "Which number has the most factors?",
                options: ["48", "47", "53", "31"],
                answer: "A",
                explanation: "48 has 10 factors; primes have only 2 factors"
            },
            {
                type: "mixed",
                question: "Find the GCF of 24 and 36",
                options: ["12", "6", "8", "4"],
                answer: "A",
                explanation: "Factors of 24: 1,2,3,4,6,8,12,24; Factors of 36: 1,2,3,4,6,9,12,18,36; GCF = 12"
            },
            {
                type: "mixed",
                question: "What is the 8th multiple of 6?",
                options: ["48", "54", "42", "36"],
                answer: "A",
                explanation: "6 Ã— 8 = 48"
            },
            {
                type: "mixed",
                question: "Which is prime: 111, 113, 115, or 117?",
                options: ["113", "111", "115", "117"],
                answer: "A",
                explanation: "113 is prime (others divisible by 3,5,3 respectively)"
            },
            {
                type: "mixed",
                question: "What are all factors of 45?",
                options: ["1,3,5,9,15,45", "1,5,9,45", "3,5,9,15,45", "1,3,9,15,45"],
                answer: "A",
                explanation: "45 = 1Ã—45, 3Ã—15, 5Ã—9"
            },
            {
                type: "mixed",
                question: "Find the LCM of 6 and 8",
                options: ["24", "48", "12", "16"],
                answer: "A",
                explanation: "Multiples of 6: 6,12,18,24...; Multiples of 8: 8,16,24...; LCM = 24"
            },
            {
                type: "mixed",
                question: "Which number is composite and odd?",
                options: ["25", "23", "29", "31"],
                answer: "A",
                explanation: "25 = 5Ã—5 (composite and odd)"
            },
            {
                type: "mixed",
                question: "What is the GCF of 15 and 25?",
                options: ["5", "3", "1", "15"],
                answer: "A",
                explanation: "Factors of 15: 1,3,5,15; Factors of 25: 1,5,25; GCF = 5"
            },
            {
                type: "mixed",
                question: "Which is a multiple of 9?",
                options: ["63", "64", "65", "67"],
                answer: "A",
                explanation: "63 Ã· 9 = 7, so 63 is a multiple of 9"
            },
            {
                type: "mixed",
                question: "What is the difference between the 7th and 4th multiples of 8?",
                options: ["24", "32", "16", "8"],
                answer: "A",
                explanation: "7th multiple: 8Ã—7=56; 4th multiple: 8Ã—4=32; Difference: 56-32=24"
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent number theory knowledge!",
            "Fantastic factor finding skills!",
            "Great job! You're a prime number expert!",
            "Amazing! Your understanding of multiples is impressive!",
            "Well done! Perfect factorization!",
            "You're a factor tree champion!",
            "Perfect! You understand prime vs composite!",
            "Outstanding mathematical thinking!",
            "Brilliant! You think like a mathematician!",
            "You're on fire! Great math insight!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const mathFact = document.getElementById('mathFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Get all factors of a number
        function getFactors(num) {
            const factors = [];
            for (let i = 1; i <= num; i++) {
                if (num % i === 0) factors.push(i);
            }
            return factors;
        }

        // Get first n multiples of a number
        function getMultiples(num, count) {
            const multiples = [];
            for (let i = 1; i <= count; i++) {
                multiples.push(num * i);
            }
            return multiples;
        }

        // Check if number is prime
        function isPrime(num) {
            if (num <= 1) return false;
            if (num === 2) return true;
            if (num % 2 === 0) return false;
            
            for (let i = 3; i <= Math.sqrt(num); i += 2) {
                if (num % i === 0) return false;
            }
            return true;
        }

        // Initialize the app
        function initApp() {
            initSlideshow();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade5MathFactors');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade5MathFactors', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade5MathFactors_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade5MathFactors_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a factors and multiples expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent number theory skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing to become a math master!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review factor concepts and try again!";
            } else {
                scoreMessage.textContent = "Keep learning! Math skills grow with practice!";
            }
        }

        // Create math fact display
        function createMathFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'math-fact';
            
            const facts = [
                "The largest known prime number has over 24 million digits! It would take thousands of pages to write it out!",
                "Every even number greater than 2 can be expressed as the sum of two prime numbers (Goldbach's Conjecture)!",
                "The number 1 is neither prime nor composite - it's in a special category all by itself!",
                "Prime numbers are the 'atoms' of mathematics - all other numbers can be built from them!",
                "The ancient Greeks studied prime numbers over 2,000 years ago - Euclid proved there are infinitely many primes!",
                "The number 6 is a 'perfect number' because its factors (1,2,3) add up to 6 itself!",
                "Twin primes are pairs of primes that differ by 2, like (3,5), (5,7), (11,13)!",
                "The Sieve of Eratosthenes, invented in 200 BC, is still used to find prime numbers today!"
            ];
            
            factDiv.innerHTML = `<strong>Math Fact:</strong> ${facts[Math.floor(Math.random() * facts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "factors": "âž—",
                "multiples": "âœ–ï¸",
                "prime": "ðŸ”¢",
                "composite": "ðŸ”£",
                "mixed": "âš¡"
            };
            
            let conceptName = "Factors";
            let conceptIcon = "âž—";
            
            if (question.type.includes("factors")) {
                conceptName = "Factors";
                conceptIcon = conceptIcons.factors;
            } else if (question.type.includes("multiples")) {
                conceptName = "Multiples";
                conceptIcon = conceptIcons.multiples;
            } else if (question.type.includes("prime")) {
                conceptName = "Prime Numbers";
                conceptIcon = conceptIcons.prime;
            } else if (question.type.includes("composite")) {
                conceptName = "Composite Numbers";
                conceptIcon = conceptIcons.composite;
            } else if (question.type.includes("mixed")) {
                conceptName = "Mixed Applications";
                conceptIcon = conceptIcons.mixed;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("factors")) {
                label.textContent = "Numbers that divide evenly into another number";
            } else if (question.type.includes("multiples")) {
                label.textContent = "Results of multiplying a number by integers";
            } else if (question.type.includes("prime")) {
                label.textContent = "Numbers with exactly 2 factors";
            } else if (question.type.includes("composite")) {
                label.textContent = "Numbers with more than 2 factors";
            } else {
                label.textContent = "Applying factor and multiple concepts";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create factor visualization
        function createFactorVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const num = Math.floor(Math.random() * 30) + 10; // Random number 10-40
            
            if (question.type.includes("factors")) {
                const factors = getFactors(num);
                
                vizDiv.innerHTML = `
                    <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-purple);">Factors of ${num}</h3>
                    <div class="factor-pairs">
                        ${factors.map(factor => `
                            <div class="factor-pair factor-highlight" style="animation-delay: ${factors.indexOf(factor) * 0.1}s">
                                <div style="font-size: 1.2rem; font-weight: bold;">${factor}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">${num} Ã· ${factor} = ${num / factor}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="text-align: center; margin-top: 20px; color: var(--text-secondary);">
                        ${factors.length} total factors
                    </div>
                `;
            } else if (question.type.includes("multiples")) {
                const multiples = getMultiples(num, 8);
                
                vizDiv.innerHTML = `
                    <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-teal);">Multiples of ${num}</h3>
                    <div class="multiples-grid">
                        ${multiples.map((multiple, index) => `
                            <div class="multiple-item multiple-flow" style="animation-delay: ${index * 0.1}s">
                                ${multiple}
                                <div style="font-size: 0.7rem; color: var(--text-secondary);">${num} Ã— ${index + 1}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="text-align: center; margin-top: 20px; color: var(--text-secondary);">
                        Pattern: Add ${num} each time
                    </div>
                `;
            } else if (question.type.includes("prime") || question.type.includes("composite")) {
                const numbers = [];
                for (let i = 20; i <= 40; i++) {
                    numbers.push(i);
                }
                
                vizDiv.innerHTML = `
                    <h3 style="text-align: center; margin-bottom: 20px; color: var(--secondary-pink);">Prime vs Composite Numbers</h3>
                    <div class="prime-composite-grid">
                        ${numbers.map(num => {
                            const prime = isPrime(num);
                            return `
                                <div class="number-cell ${prime ? 'prime prime-pulse' : 'composite composite-pulse'}" 
                                     style="animation-delay: ${(num-20) * 0.05}s">
                                    ${num}
                                    <div style="font-size: 0.6rem;">${prime ? 'Prime' : 'Composite'}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <div style="text-align: center; margin-top: 20px; color: var(--text-secondary);">
                        <span style="color: var(--secondary-pink);">â— Prime</span> &nbsp; 
                        <span style="color: var(--accent-teal);">â— Composite</span>
                    </div>
                `;
            } else {
                // Mixed visualization
                const a = Math.floor(Math.random() * 15) + 10;
                const b = Math.floor(Math.random() * 15) + 10;
                const factorsA = getFactors(a);
                const factorsB = getFactors(b);
                const commonFactors = factorsA.filter(f => factorsB.includes(f));
                const gcf = Math.max(...commonFactors);
                
                vizDiv.innerHTML = `
                    <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-amber);">Finding GCF of ${a} and ${b}</h3>
                    
                    <div style="display: flex; justify-content: center; gap: 30px; margin: 20px 0;">
                        <div>
                            <div style="color: var(--primary-purple); font-weight: bold; margin-bottom: 10px;">Factors of ${a}</div>
                            <div class="factor-pairs">
                                ${factorsA.map(f => `
                                    <div class="factor-pair ${commonFactors.includes(f) ? 'factor-highlight' : ''}" 
                                         style="animation-delay: ${factorsA.indexOf(f) * 0.1}s">
                                        ${f}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div>
                            <div style="color: var(--accent-teal); font-weight: bold; margin-bottom: 10px;">Factors of ${b}</div>
                            <div class="factor-pairs">
                                ${factorsB.map(f => `
                                    <div class="factor-pair ${commonFactors.includes(f) ? 'factor-highlight' : ''}" 
                                         style="animation-delay: ${factorsB.indexOf(f) * 0.1}s">
                                        ${f}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; padding: 15px; background: rgba(255, 193, 7, 0.1); border-radius: 10px;">
                        <div style="font-size: 1.2rem; color: var(--accent-amber);">Common Factors: ${commonFactors.join(', ')}</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-purple); margin-top: 10px;">
                            GCF = ${gcf}
                        </div>
                    </div>
                `;
            }
            
            return vizDiv;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            mathFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            mathFact.appendChild(createMathFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createFactorVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = 'âœ“';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = 'âœ—';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
