<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 English - Direct & Indirect Speech | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for English/Language Arts Theme */
        :root {
            --primary-purple: #7B1FA2;
            --secondary-indigo: #303F9F;
            --accent-teal: #00796B;
            --accent-amber: #FFA000;
            --accent-pink: #C2185B;
            --accent-deep-orange: #D84315;
            --dark-bg: #1A1B2E;
            --dark-surface: #2A2B3E;
            --dark-card: #353648;
            --dark-border: #4A4B5E;
            --text-primary: #FFFFFF;
            --text-secondary: #D1C4E9;
            --text-muted: #9FA8DA;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            --glow: 0 0 20px rgba(123, 31, 162, 0.3);
            --direct-glow: 0 0 15px rgba(123, 31, 162, 0.4);
            --indirect-glow: 0 0 15px rgba(48, 63, 159, 0.4);
            --transformation-glow: 0 0 15px rgba(0, 121, 107, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Language Pattern Background */
        .language-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(123, 31, 162, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(48, 63, 159, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(0, 121, 107, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #1A1B2E, #2A2B3E);
            opacity: 0.8;
        }

        .floating-symbols {
            position: absolute;
            color: rgba(255, 255, 255, 0.05);
            font-size: 3rem;
            font-weight: bold;
            animation: floatSymbols 20s linear infinite;
        }

        @keyframes floatSymbols {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-100px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-100px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(100px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 27, 46, 0.9);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-indigo), var(--accent-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(123, 31, 162, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-purple);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-purple);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(123, 31, 162, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(123, 31, 162, 0.4);
        }

        .btn-primary:hover {
            background: #6A1B9A;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(123, 31, 162, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-indigo);
            color: white;
            box-shadow: 0 4px 15px rgba(48, 63, 159, 0.4);
        }

        .btn-secondary:hover {
            background: #283593;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(48, 63, 159, 0.5);
        }

        .btn-teal {
            background: var(--accent-teal);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 121, 107, 0.4);
        }

        .btn-teal:hover {
            background: #00695C;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 121, 107, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-purple);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-purple), var(--secondary-indigo), var(--accent-teal));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(123, 31, 162, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .language-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-amber);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-indigo), var(--accent-teal));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(123, 31, 162, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-purple);
            background: rgba(123, 31, 162, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: #4CAF50;
            color: #4CAF50;
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--accent-deep-orange);
            color: var(--accent-deep-orange);
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-indigo);
        }

        .option.correct .option-letter {
            background: #4CAF50;
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--accent-deep-orange);
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 5px solid #4CAF50;
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid var(--accent-deep-orange);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: #4CAF50;
        }

        .feedback-incorrect .feedback-icon {
            background: var(--accent-deep-orange);
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: #4CAF50;
        }

        .feedback-incorrect .feedback-title {
            color: var(--accent-deep-orange);
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Speech Display */
        .speech-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .display-title {
            color: var(--primary-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        .language-container {
            padding: 20px;
            background: var(--dark-surface);
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-amber);
        }

        .language-scenario {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .language-highlight {
            background: rgba(255, 160, 0, 0.1);
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            border: 1px solid var(--accent-amber);
        }

        .highlight-text {
            color: var(--accent-amber);
            font-weight: bold;
        }

        /* Speech Transformation Diagram */
        .transformation-diagram {
            width: 100%;
            height: 250px;
            background: var(--dark-surface);
            border-radius: 12px;
            position: relative;
            margin: 20px 0;
            overflow: hidden;
            border: 2px solid var(--primary-purple);
            padding: 20px;
        }

        .speech-element {
            position: absolute;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .transformation-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 30px solid var(--accent-teal);
            transform: rotate(90deg);
        }

        /* Speech Types Grid */
        .speech-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .speech-grid {
                grid-template-columns: 1fr;
            }
        }

        .speech-card {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid transparent;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .speech-card:hover {
            transform: translateY(-5px);
        }

        .speech-card.direct {
            border-color: var(--primary-purple);
        }

        .speech-card.indirect {
            border-color: var(--secondary-indigo);
        }

        .speech-card.reported {
            border-color: var(--accent-teal);
        }

        .speech-card.command {
            border-color: var(--accent-pink);
        }

        .speech-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .direct .speech-icon {
            color: var(--primary-purple);
        }

        .indirect .speech-icon {
            color: var(--secondary-indigo);
        }

        .reported .speech-icon {
            color: var(--accent-teal);
        }

        .command .speech-icon {
            color: var(--accent-pink);
        }

        .speech-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .direct .speech-title {
            color: var(--primary-purple);
        }

        .indirect .speech-title {
            color: var(--secondary-indigo);
        }

        .reported .speech-title {
            color: var(--accent-teal);
        }

        .command .speech-title {
            color: var(--accent-pink);
        }

        .speech-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .speech-examples {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 10px;
            background: var(--dark-surface);
            padding: 8px;
            border-radius: 4px;
        }

        /* Rules Table */
        .rules-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .rules-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-amber);
            border-bottom: 2px solid var(--accent-amber);
        }

        .rules-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .rules-table tr:hover {
            background: rgba(255, 160, 0, 0.05);
        }

        /* Tense Changes Display */
        .tense-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
        }

        .tense-title {
            color: var(--accent-teal);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .tense-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .tense-grid {
                grid-template-columns: 1fr;
            }
        }

        .tense-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .tense-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent-teal);
        }

        .tense-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-teal);
        }

        .tense-change {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Pronoun Changes Display */
        .pronoun-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-pink);
        }

        .pronoun-title {
            color: var(--accent-pink);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .pronoun-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .pronoun-grid {
                grid-template-columns: 1fr;
            }
        }

        .pronoun-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--accent-pink);
        }

        .pronoun-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent-pink);
        }

        .pronoun-direct {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-pink);
        }

        .pronoun-indirect {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Interactive Speech Transformer */
        .transformer-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--primary-purple);
        }

        .transformer-title {
            color: var(--primary-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .transformer-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .transformer-input {
            padding: 15px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-purple);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            resize: vertical;
            min-height: 80px;
        }

        .transformer-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .transformer-btn {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-purple);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .transformer-btn:hover {
            background: rgba(123, 31, 162, 0.1);
            transform: translateY(-2px);
        }

        .transformer-display {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        /* Common Errors Display */
        .errors-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .errors-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .errors-grid {
                grid-template-columns: 1fr;
            }
        }

        .error-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--accent-deep-orange);
        }

        .error-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent-deep-orange);
        }

        .error-name {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent-deep-orange);
        }

        .error-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-indigo), var(--accent-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-indigo), var(--accent-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-purple);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .speech-grid {
                grid-template-columns: 1fr;
            }
            
            .tense-grid {
                grid-template-columns: 1fr;
            }
            
            .pronoun-grid {
                grid-template-columns: 1fr;
            }
            
            .errors-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 0.7; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes languageReveal {
            0% { transform: translateX(-100px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .language-reveal {
            animation: languageReveal 0.5s ease forwards;
        }
        
        @keyframes speechFlow {
            0% { transform: translateX(-100px) scale(0.8); opacity: 0; }
            50% { transform: translateX(0) scale(1.1); opacity: 1; }
            100% { transform: translateX(100px) scale(0.8); opacity: 0; }
        }
        
        .speech-flow {
            animation: speechFlow 3s linear infinite;
        }
        
        @keyframes directGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(123, 31, 162, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(123, 31, 162, 0.2); }
        }
        
        .direct-glow {
            animation: directGlow 2s ease-in-out infinite;
        }
        
        @keyframes indirectGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(48, 63, 159, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(48, 63, 159, 0.2); }
        }
        
        .indirect-glow {
            animation: indirectGlow 2s ease-in-out infinite;
        }
        
        @keyframes transformationGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(0, 121, 107, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(0, 121, 107, 0.2); }
        }
        
        .transformation-glow {
            animation: transformationGlow 2s ease-in-out infinite;
        }
        
        @keyframes floatSymbol {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        
        .float-symbol {
            animation: floatSymbol 3s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <!-- Language Pattern Background -->
    <div class="language-bg" id="languageBg">
        <!-- Language symbols will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 6 English - Direct & Indirect Speech</h1>
            <p class="welcome-subtitle">Master the art of reporting speech! Learn how to transform direct speech into indirect speech, understand tense changes, pronoun shifts, and reporting verbs. Become proficient in conveying messages accurately while maintaining grammatical correctness!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üí¨üîÑüìù‚úèÔ∏èüìö</span>
                <span class="topic-name">Direct Speech, Indirect Speech & Reported Speech</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Speech Mastery</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 80</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1.25%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Language fact display -->
                <div id="languageFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Speech Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Practice Again</button>
                <button class="btn btn-secondary" id="viewTopics">Other English Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const languageBg = document.getElementById('languageBg');
            
            // Create floating language symbols
            const symbols = ['üí¨', 'üìù', '‚úèÔ∏è', 'üìö', 'üó£Ô∏è', 'üé≠', 'üìñ', 'üî§', 'üîÑ', '‚úçÔ∏è', 'üìã', 'üìÑ'];
            
            for (let i = 0; i < 20; i++) {
                const symbol = document.createElement('div');
                symbol.className = 'floating-symbols float-symbol';
                symbol.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                symbol.style.left = `${Math.random() * 100}%`;
                symbol.style.top = `${Math.random() * 100}%`;
                symbol.style.animationDelay = `${Math.random() * 5}s`;
                symbol.style.fontSize = `${2 + Math.random() * 4}rem`;
                
                // Color based on symbol type
                if (symbol.textContent === 'üí¨' || symbol.textContent === 'üó£Ô∏è') {
                    symbol.style.color = 'rgba(123, 31, 162, 0.1)';
                } else if (symbol.textContent === 'üìù' || symbol.textContent === '‚úèÔ∏è') {
                    symbol.style.color = 'rgba(48, 63, 159, 0.1)';
                } else if (symbol.textContent === 'üìö' || symbol.textContent === 'üìñ') {
                    symbol.style.color = 'rgba(0, 121, 107, 0.1)';
                } else {
                    symbol.style.color = 'rgba(255, 160, 0, 0.1)';
                }
                
                languageBg.appendChild(symbol);
            }
        }

        // Questions array - 80+ Grade 6 Direct & Indirect Speech Questions
        const questions = [
            // Direct Speech Basics (1-20)
            {
                type: "direct_basics",
                question: "What is direct speech?",
                options: ["The exact words spoken by someone, enclosed in quotation marks", "A summary of what someone said", "A story about someone", "A written report"],
                answer: "A",
                explanation: "Direct speech shows the exact words spoken by someone, enclosed in quotation marks."
            },
            {
                type: "direct_basics",
                question: "Which punctuation marks are used to enclose direct speech?",
                options: ["Quotation marks", "Brackets", "Commas", "Dashes"],
                answer: "A",
                explanation: "Quotation marks (\" \") or inverted commas (' ') are used to enclose direct speech."
            },
            {
                type: "direct_basics",
                question: "What is the correct way to write direct speech?",
                options: ["He said, \"I am going to the park.\"", "He said I am going to the park.", "He said: I am going to the park.", "\"He said I am going to the park.\""],
                answer: "A",
                explanation: "Direct speech should have the speaker's words enclosed in quotation marks with appropriate punctuation."
            },
            {
                type: "direct_basics",
                question: "In direct speech, where does the comma go?",
                options: ["Before the opening quotation mark", "After the closing quotation mark", "In the middle of the sentence", "No comma is needed"],
                answer: "A",
                explanation: "A comma usually separates the reporting verb (said, asked) from the quoted speech."
            },
            // Indirect Speech Basics (21-40)
            {
                type: "indirect_basics",
                question: "What is indirect speech?",
                options: ["Reporting what someone said without using their exact words", "Using someone's exact words", "Writing a story", "Speaking loudly"],
                answer: "A",
                explanation: "Indirect speech (reported speech) reports what someone said without using their exact words."
            },
            {
                type: "indirect_basics",
                question: "Which of these is indirect speech?",
                options: ["She said that she was tired.", "She said, \"I am tired.\"", "\"I am tired,\" she said.", "She: \"I am tired.\""],
                answer: "A",
                explanation: "Indirect speech doesn't use quotation marks and often includes 'that' after the reporting verb."
            },
            {
                type: "indirect_basics",
                question: "What changes when converting direct to indirect speech?",
                options: ["Pronouns, tenses, and time expressions", "Only punctuation", "Only the speaker's name", "Nothing changes"],
                answer: "A",
                explanation: "When converting to indirect speech, pronouns, tenses, and time expressions usually change."
            },
            // Tense Changes (41-60)
            {
                type: "tense_changes",
                question: "What happens to present tense in indirect speech?",
                options: ["It usually changes to past tense", "It stays the same", "It changes to future tense", "It becomes present perfect"],
                answer: "A",
                explanation: "Present tense in direct speech usually changes to past tense in indirect speech."
            },
            {
                type: "tense_changes",
                question: "Direct: \"I like pizza.\" Indirect: He said that...",
                options: ["he liked pizza", "he likes pizza", "he is liking pizza", "he will like pizza"],
                answer: "A",
                explanation: "Present simple (like) changes to past simple (liked) in indirect speech."
            },
            {
                type: "tense_changes",
                question: "Direct: \"I am reading a book.\" Indirect: She said that...",
                options: ["she was reading a book", "she is reading a book", "she reads a book", "she read a book"],
                answer: "A",
                explanation: "Present continuous (am reading) changes to past continuous (was reading)."
            },
            {
                type: "tense_changes",
                question: "Direct: \"I have finished my homework.\" Indirect: He said that...",
                options: ["he had finished his homework", "he has finished his homework", "he finished his homework", "he was finishing his homework"],
                answer: "A",
                explanation: "Present perfect (have finished) changes to past perfect (had finished)."
            },
            // Pronoun Changes (61-80)
            {
                type: "pronoun_changes",
                question: "Direct: \"I need help.\" Indirect: She said that...",
                options: ["she needed help", "I needed help", "you needed help", "we needed help"],
                answer: "A",
                explanation: "First person pronoun 'I' changes according to the speaker - here it becomes 'she'."
            },
            {
                type: "pronoun_changes",
                question: "Direct: \"You are my friend.\" Indirect: He told me that...",
                options: ["I was his friend", "you were his friend", "he was my friend", "they were his friend"],
                answer: "A",
                explanation: "Second person 'you' changes according to who is being spoken to - here it becomes 'I'."
            },
            {
                type: "pronoun_changes",
                question: "Direct: \"We will come tomorrow.\" Indirect: They said that...",
                options: ["they would come the next day", "we would come tomorrow", "you would come tomorrow", "he would come tomorrow"],
                answer: "A",
                explanation: "First person plural 'we' changes according to the speakers - here it becomes 'they'."
            },
            // Time Expression Changes (81-100)
            {
                type: "time_changes",
                question: "Direct: \"I saw him yesterday.\" Indirect: She said that...",
                options: ["she had seen him the day before", "she saw him yesterday", "she sees him yesterday", "she was seeing him the day before"],
                answer: "A",
                explanation: "'Yesterday' changes to 'the day before' or 'the previous day' in indirect speech."
            },
            {
                type: "time_changes",
                question: "Direct: \"I will do it tomorrow.\" Indirect: He said that...",
                options: ["he would do it the next day", "he will do it tomorrow", "he does it tomorrow", "he did it the next day"],
                answer: "A",
                explanation: "'Tomorrow' changes to 'the next day' or 'the following day' in indirect speech."
            },
            {
                type: "time_changes",
                question: "Direct: \"I am busy now.\" Indirect: She said that...",
                options: ["she was busy then", "she is busy now", "she was busy now", "she is busy then"],
                answer: "A",
                explanation: "'Now' usually changes to 'then' in indirect speech."
            },
            // Question Reporting (101-120)
            {
                type: "question_reporting",
                question: "Direct: \"Are you coming?\" Indirect: She asked...",
                options: ["if I was coming", "am I coming", "are you coming", "was I coming"],
                answer: "A",
                explanation: "Yes/no questions in indirect speech use 'if' or 'whether' and change to statement word order."
            },
            {
                type: "question_reporting",
                question: "Direct: \"Where do you live?\" Indirect: He asked...",
                options: ["where I lived", "where do I live", "where I live", "where did I live"],
                answer: "A",
                explanation: "Wh-questions in indirect speech keep the question word but change to statement word order."
            },
            // Command Reporting (121-140)
            {
                type: "command_reporting",
                question: "Direct: \"Close the door.\" Indirect: She told me...",
                options: ["to close the door", "close the door", "that I close the door", "closing the door"],
                answer: "A",
                explanation: "Commands in indirect speech use 'to + verb' (infinitive) structure."
            },
            {
                type: "command_reporting",
                question: "Direct: \"Don't make noise.\" Indirect: The teacher told us...",
                options: ["not to make noise", "don't make noise", "to not make noise", "that we don't make noise"],
                answer: "A",
                explanation: "Negative commands use 'not to + verb' in indirect speech."
            },
            // Mixed Practice (141-160)
            {
                type: "mixed_practice",
                question: "Direct: \"I can swim well.\" Indirect: He said that...",
                options: ["he could swim well", "he can swim well", "he swims well", "he is swimming well"],
                answer: "A",
                explanation: "Modal 'can' changes to 'could' in indirect speech."
            },
            {
                type: "mixed_practice",
                question: "Direct: \"I may be late.\" Indirect: She said that...",
                options: ["she might be late", "she may be late", "she will be late", "she was late"],
                answer: "A",
                explanation: "Modal 'may' often changes to 'might' in indirect speech."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent speech transformation!",
            "Perfect understanding of direct and indirect speech!",
            "Great job identifying speech changes!",
            "Amazing! You're a language master!",
            "Perfect recall of grammar rules!",
            "You're a future linguist in the making!",
            "Outstanding language comprehension!",
            "Brilliant speech analysis!",
            "You think like an English expert!",
            "Speech mastery achieved!"
        ];

        // Speech concepts
        const speechConcepts = [
            {
                name: "Direct Speech",
                description: "Exact words spoken with quotation marks",
                icon: "üí¨"
            },
            {
                name: "Indirect Speech",
                description: "Reported speech without exact words",
                icon: "üîÑ"
            },
            {
                name: "Tense Changes",
                description: "How tenses transform in reported speech",
                icon: "‚è∞"
            },
            {
                name: "Pronoun Changes",
                description: "How pronouns shift in reported speech",
                icon: "üë§"
            },
            {
                name: "Time Expressions",
                description: "Changes in time references",
                icon: "üìÖ"
            },
            {
                name: "Questions & Commands",
                description: "Reporting questions and commands",
                icon: "‚ùì"
            }
        ];

        // Speech types
        const speechTypes = [
            {
                name: "Direct Speech",
                description: "Exact words spoken by someone",
                examples: "She said, \"I am happy.\"",
                characteristics: "Uses quotation marks, exact words, original tense",
                icon: "üí¨",
                color: "#7B1FA2"
            },
            {
                name: "Indirect Speech",
                description: "Reported speech without exact words",
                examples: "She said that she was happy.",
                characteristics: "No quotation marks, tense changes, pronoun changes",
                icon: "üîÑ",
                color: "#303F9F"
            },
            {
                name: "Reported Questions",
                description: "Reporting questions indirectly",
                examples: "He asked if I was coming.",
                characteristics: "Uses 'if' or 'whether', statement word order",
                icon: "‚ùì",
                color: "#00796B"
            },
            {
                name: "Reported Commands",
                description: "Reporting commands and requests",
                examples: "She told me to close the door.",
                characteristics: "Uses 'to + verb' (infinitive), no quotation marks",
                icon: "üì¢",
                color: "#C2185B"
            }
        ];

        // Tense changes
        const tenseChanges = [
            {
                directTense: "Present Simple",
                example: "I like apples.",
                indirectTense: "Past Simple",
                example: "He said that he liked apples.",
                change: "like ‚Üí liked"
            },
            {
                directTense: "Present Continuous",
                example: "I am reading.",
                indirectTense: "Past Continuous",
                example: "She said that she was reading.",
                change: "am reading ‚Üí was reading"
            },
            {
                directTense: "Present Perfect",
                example: "I have finished.",
                indirectTense: "Past Perfect",
                example: "He said that he had finished.",
                change: "have finished ‚Üí had finished"
            },
            {
                directTense: "Past Simple",
                example: "I saw a movie.",
                indirectTense: "Past Perfect",
                example: "She said that she had seen a movie.",
                change: "saw ‚Üí had seen"
            },
            {
                directTense: "Future (will)",
                example: "I will help you.",
                indirectTense: "Conditional (would)",
                example: "He said that he would help me.",
                change: "will ‚Üí would"
            },
            {
                directTense: "Can",
                example: "I can swim.",
                indirectTense: "Could",
                example: "She said that she could swim.",
                change: "can ‚Üí could"
            }
        ];

        // Pronoun changes
        const pronounChanges = [
            {
                direct: "I, me, my, mine",
                indirect: "Changes according to speaker",
                example: "I am tired ‚Üí He said he was tired"
            },
            {
                direct: "You, your, yours",
                indirect: "Changes according to listener",
                example: "You are right ‚Üí She told me I was right"
            },
            {
                direct: "We, us, our, ours",
                indirect: "They, them, their, theirs",
                example: "We are ready ‚Üí They said they were ready"
            },
            {
                direct: "He/she, him/her, his/her",
                indirect: "Usually stays the same",
                example: "He is here ‚Üí She said he was there"
            }
        ];

        // Time expression changes
        const timeChanges = [
            {
                direct: "now",
                indirect: "then",
                example: "I'm busy now ‚Üí He said he was busy then"
            },
            {
                direct: "today",
                indirect: "that day",
                example: "I saw her today ‚Üí She said she had seen her that day"
            },
            {
                direct: "yesterday",
                indirect: "the day before",
                example: "I went yesterday ‚Üí He said he had gone the day before"
            },
            {
                direct: "tomorrow",
                indirect: "the next day",
                example: "I'll come tomorrow ‚Üí She said she would come the next day"
            },
            {
                direct: "ago",
                indirect: "before",
                example: "I saw him a week ago ‚Üí He said he had seen him a week before"
            },
            {
                direct: "here",
                indirect: "there",
                example: "I live here ‚Üí She said she lived there"
            }
        ];

        // Reporting verbs
        const reportingVerbs = [
            {
                verb: "said",
                usage: "General reporting, no specific listener",
                example: "He said he was tired."
            },
            {
                verb: "told",
                usage: "Reporting to specific person",
                example: "She told me she was coming."
            },
            {
                verb: "asked",
                usage: "Reporting questions",
                example: "He asked if I was ready."
            },
            {
                verb: "ordered",
                usage: "Reporting commands",
                example: "She ordered him to leave."
            },
            {
                verb: "suggested",
                usage: "Reporting suggestions",
                example: "He suggested that we go early."
            },
            {
                verb: "explained",
                usage: "Reporting explanations",
                example: "She explained why she was late."
            }
        ];

        // Common errors
        const commonErrors = [
            {
                error: "Wrong tense change",
                example: "She said she is coming. (Wrong) ‚Üí She said she was coming. (Correct)",
                correction: "Remember to change present to past tense"
            },
            {
                error: "Missing 'that'",
                example: "He said he will come. (Acceptable) ‚Üí He said that he would come. (Better)",
                correction: "Using 'that' makes the sentence clearer"
            },
            {
                error: "Wrong pronoun",
                example: "She said, 'I am happy.' ‚Üí She said I was happy. (Wrong) ‚Üí She said she was happy. (Correct)",
                correction: "Change pronouns according to the speaker"
            },
            {
                error: "Keeping quotation marks",
                example: "He said that \"he was tired.\" (Wrong) ‚Üí He said that he was tired. (Correct)",
                correction: "No quotation marks in indirect speech"
            },
            {
                error: "Wrong question structure",
                example: "He asked was I coming. (Wrong) ‚Üí He asked if I was coming. (Correct)",
                correction: "Use 'if' or 'whether' for yes/no questions"
            }
        ];

        // Language facts
        const languageFacts = [
            "In English, we change present tense to past tense when reporting speech!",
            "The word 'that' is often optional in indirect speech!",
            "Quotation marks are also called 'inverted commas' in British English!",
            "Indirect speech is sometimes called 'reported speech'!",
            "Time expressions like 'yesterday' change to 'the day before' in reported speech!",
            "Modal verbs like 'can' change to 'could' in indirect speech!",
            "Direct speech is more common in fiction writing!",
            "Indirect speech is more common in formal writing and news reports!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const languageFact = document.getElementById('languageFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade6DirectIndirectSpeech');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade6DirectIndirectSpeech', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade6DirectIndirectSpeech_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade6DirectIndirectSpeech_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a speech transformation expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent grammar skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing speech transformations!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review the rules and try again!";
            } else {
                scoreMessage.textContent = "Keep learning! Mastering speech takes practice!";
            }
        }

        // Create language fact display
        function createLanguageFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'language-fact';
            
            factDiv.innerHTML = `<strong>Interesting Language Fact:</strong> ${languageFacts[Math.floor(Math.random() * languageFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "direct_basics": "üí¨",
                "indirect_basics": "üîÑ",
                "tense_changes": "‚è∞",
                "pronoun_changes": "üë§",
                "time_changes": "üìÖ",
                "question_reporting": "‚ùì",
                "command_reporting": "üì¢",
                "mixed_practice": "‚úèÔ∏è"
            };
            
            let conceptName = "Direct Speech Basics";
            let conceptIcon = "üí¨";
            
            if (question.type.includes("direct_basics")) {
                conceptName = "Direct Speech Basics";
                conceptIcon = conceptIcons.direct_basics;
            } else if (question.type.includes("indirect_basics")) {
                conceptName = "Indirect Speech Basics";
                conceptIcon = conceptIcons.indirect_basics;
            } else if (question.type.includes("tense_changes")) {
                conceptName = "Tense Changes";
                conceptIcon = conceptIcons.tense_changes;
            } else if (question.type.includes("pronoun_changes")) {
                conceptName = "Pronoun Changes";
                conceptIcon = conceptIcons.pronoun_changes;
            } else if (question.type.includes("time_changes")) {
                conceptName = "Time Expressions";
                conceptIcon = conceptIcons.time_changes;
            } else if (question.type.includes("question_reporting")) {
                conceptName = "Question Reporting";
                conceptIcon = conceptIcons.question_reporting;
            } else if (question.type.includes("command_reporting")) {
                conceptName = "Command Reporting";
                conceptIcon = conceptIcons.command_reporting;
            } else if (question.type.includes("mixed_practice")) {
                conceptName = "Mixed Practice";
                conceptIcon = conceptIcons.mixed_practice;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("direct_basics")) {
                label.textContent = "Understanding direct speech with exact words";
            } else if (question.type.includes("indirect_basics")) {
                label.textContent = "Reporting speech without exact words";
            } else if (question.type.includes("tense_changes")) {
                label.textContent = "How tenses transform in reported speech";
            } else if (question.type.includes("pronoun_changes")) {
                label.textContent = "How pronouns shift in reported speech";
            } else if (question.type.includes("time_changes")) {
                label.textContent = "Changes in time references and expressions";
            } else if (question.type.includes("question_reporting")) {
                label.textContent = "Reporting questions indirectly";
            } else if (question.type.includes("command_reporting")) {
                label.textContent = "Reporting commands and requests";
            } else if (question.type.includes("mixed_practice")) {
                label.textContent = "Applying all speech transformation rules";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create speech visualization
        function createSpeechVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const currentQuestion = appState.currentQuestions[appState.currentQuestionIndex];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-purple);">Direct & Indirect Speech Explorer</h3>
                
                <div class="speech-display">
                    <div class="display-title">Current Speech Concept</div>
                    <div class="language-container">
                        <div class="language-scenario">${currentQuestion.question}</div>
                        <div class="language-highlight">
                            <strong>Key Concept:</strong> <span class="highlight-text">${getSpeechConcept(currentQuestion.type)}</span>
                        </div>
                    </div>
                </div>
                
                <!-- Speech Transformation Diagram -->
                <div class="transformation-diagram" id="transformationDiagram">
                    <!-- Transformation diagram will be animated by JavaScript -->
                </div>
                <div style="text-align: center; margin-bottom: 20px; color: var(--text-secondary); font-size: 0.9rem;">
                    Interactive Speech Transformation Model
                </div>
                
                <div class="speech-grid">
                    ${speechTypes.map(type => `
                        <div class="speech-card ${type.name.toLowerCase().split(' ')[0]}" style="border-color: ${type.color}" onclick="showSpeechDemo('${type.name}')">
                            <div class="speech-icon" style="color: ${type.color}">${type.icon}</div>
                            <div class="speech-title" style="color: ${type.color}">${type.name}</div>
                            <div class="speech-description">${type.description}</div>
                            <div class="speech-examples">
                                <strong>Example:</strong> ${type.examples}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <table class="rules-table">
                    <thead>
                        <tr>
                            <th>Direct Tense</th>
                            <th>Example (Direct)</th>
                            <th>Indirect Tense</th>
                            <th>Example (Indirect)</th>
                            <th>Change</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tenseChanges.map(change => `
                            <tr>
                                <td style="font-weight: bold; color: var(--accent-amber);">${change.directTense}</td>
                                <td style="color: var(--primary-purple); font-style: italic;">"${change.example}"</td>
                                <td style="font-weight: bold; color: var(--accent-teal);">${change.indirectTense}</td>
                                <td style="color: var(--secondary-indigo); font-style: italic;">${change.example}</td>
                                <td style="font-size: 0.9rem; color: var(--text-muted);">${change.change}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
                
                <div class="tense-container transformation-glow">
                    <div class="tense-title">Tense Transformation Rules</div>
                    <div class="tense-grid">
                        ${tenseChanges.slice(0, 4).map(change => `
                            <div class="tense-card">
                                <div class="tense-icon">‚è∞</div>
                                <div class="tense-name">${change.directTense} ‚Üí ${change.indirectTense}</div>
                                <div class="tense-change">
                                    <strong>Example:</strong> ${change.example}<br>
                                    <strong>Change:</strong> ${change.change}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="pronoun-container">
                    <div class="pronoun-title">Pronoun Changes in Reported Speech</div>
                    <div class="pronoun-grid">
                        ${pronounChanges.map(pronoun => `
                            <div class="pronoun-card">
                                <div class="pronoun-icon">üë§</div>
                                <div class="pronoun-direct">Direct: ${pronoun.direct}</div>
                                <div class="pronoun-indirect">
                                    <strong>Indirect:</strong> ${pronoun.indirect}<br>
                                    <em>${pronoun.example}</em>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="transformer-container direct-glow">
                    <div class="transformer-title">Interactive Speech Transformer</div>
                    <div class="transformer-controls">
                        <textarea class="transformer-input" id="directInput" placeholder="Enter direct speech here... Example: She said, 'I am reading a book.'"></textarea>
                        <div class="transformer-buttons">
                            <button class="transformer-btn" onclick="transformToIndirect()">Convert to Indirect Speech</button>
                            <button class="transformer-btn" onclick="transformToDirect()">Convert to Direct Speech</button>
                            <button class="transformer-btn" onclick="clearTransformer()">Clear</button>
                        </div>
                    </div>
                    <div class="transformer-display" id="transformerDisplay">
                        Your transformed speech will appear here...
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-amber);">
                    <div style="color: var(--accent-amber); font-weight: bold; margin-bottom: 10px;">Quick Speech Guide:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. Direct speech: Exact words in quotation marks<br>
                        2. Indirect speech: Reported without exact words<br>
                        3. Tense changes: Present ‚Üí Past, Present Perfect ‚Üí Past Perfect<br>
                        4. Pronoun changes: I ‚Üí he/she, you ‚Üí I/he/she<br>
                        5. Time changes: now ‚Üí then, today ‚Üí that day, tomorrow ‚Üí next day
                    </div>
                </div>
                
                <div class="errors-container">
                    <div class="display-title">Common Errors to Avoid</div>
                    <div class="errors-grid">
                        ${commonErrors.map(error => `
                            <div class="error-card">
                                <div class="error-icon">‚ö†Ô∏è</div>
                                <div class="error-name">${error.error}</div>
                                <div class="error-description">
                                    ${error.example}<br>
                                    <strong>Correction:</strong> ${error.correction}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="solution-container">
                    <div class="display-title">Step-by-Step Learning Path</div>
                    <div class="solution-steps" id="solutionSteps">
                        ${generateLearningPath(currentQuestion)}
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--secondary-indigo);">
                    <div style="color: var(--secondary-indigo); font-weight: bold; margin-bottom: 10px; text-align: center;">Speech Transformation Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Identify:</strong> First, identify if it's direct or indirect speech<br>
                        <strong>Remember:</strong> Tense changes are crucial - present becomes past<br>
                        <strong>Check:</strong> Always check pronoun changes based on speaker and listener<br>
                        <strong>Adjust:</strong> Change time expressions (now ‚Üí then, today ‚Üí that day)<br>
                        <strong>Practice:</strong> The more you practice, the easier it becomes<br>
                        <em>Mastering speech transformation improves your writing and communication skills!</em>
                    </div>
                </div>
            `;
            
            // Initialize transformation diagram
            initializeTransformationDiagram();
            
            return vizDiv;
        }

        // Helper functions
        function getSpeechConcept(typeString) {
            const conceptMap = {
                "direct_basics": "Direct speech with exact words and quotation marks",
                "indirect_basics": "Indirect speech without exact words",
                "tense_changes": "Tense transformations in reported speech",
                "pronoun_changes": "Pronoun shifts based on speaker and listener",
                "time_changes": "Time expression adjustments",
                "question_reporting": "Reporting questions indirectly",
                "command_reporting": "Reporting commands and requests",
                "mixed_practice": "Applying all speech transformation rules"
            };
            
            return conceptMap[typeString] || "Speech Transformation";
        }

        function generateLearningPath(question) {
            let steps = [];
            
            if (question.type.includes("direct_basics")) {
                steps = [
                    "Step 1: Identify if the sentence shows exact spoken words",
                    "Step 2: Look for quotation marks around the spoken words",
                    "Step 3: Check for reporting verbs (said, asked, told)",
                    "Step 4: Verify punctuation placement",
                    "Step 5: Select the correct direct speech example"
                ];
            } else if (question.type.includes("indirect_basics")) {
                steps = [
                    "Step 1: Identify if the sentence reports speech indirectly",
                    "Step 2: Look for absence of quotation marks",
                    "Step 3: Check for tense and pronoun changes",
                    "Step 4: Verify use of 'that' (optional)",
                    "Step 5: Select the correct indirect speech example"
                ];
            } else if (question.type.includes("tense_changes")) {
                steps = [
                    "Step 1: Identify the tense in the direct speech",
                    "Step 2: Apply the tense change rule",
                    "Step 3: Check pronoun changes if needed",
                    "Step 4: Adjust time expressions",
                    "Step 5: Select the correctly transformed sentence"
                ];
            } else {
                steps = [
                    "Step 1: Read the question carefully",
                    "Step 2: Identify key speech transformation concepts",
                    "Step 3: Recall relevant grammar rules",
                    "Step 4: Apply the transformation rules",
                    "Step 5: Select the most accurate answer"
                ];
            }
            
            return steps.map((step, index) => `
                <div class="solution-step language-reveal" style="animation-delay: ${index * 0.1}s">
                    <span class="step-number">${index + 1}</span>
                    <span class="step-description">${step}</span>
                    ${index === steps.length - 1 ? `
                        <div class="step-calculation">
                            <strong>Correct Answer:</strong> ${question.options[question.answer.charCodeAt(0) - 65]}
                        </div>
                        <div class="step-explanation">
                            ${question.explanation}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Global functions for interactive features
        window.showSpeechDemo = function(speechType) {
            const transformationDiagram = document.getElementById('transformationDiagram');
            if (!transformationDiagram) return;
            
            const type = speechTypes.find(t => t.name === speechType);
            if (!type) return;
            
            // Show the selected speech type
            transformationDiagram.innerHTML = '';
            
            if (speechType === "Direct Speech") {
                transformationDiagram.innerHTML = `
                    <div class="speech-element" style="background-color: ${type.color}; width: 80%; height: 80px; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div style="font-size: 1.5rem;">üí¨</div>
                        <div style="font-size: 1.2rem; margin-top: 5px;">${type.name}</div>
                        <div style="font-size: 0.9rem; margin-top: 5px;">${type.examples}</div>
                    </div>
                    
                    <div style="position: absolute; bottom: 20px; left: 0; right: 0; text-align: center; color: var(--text-secondary);">
                        <strong>Characteristics:</strong> ${type.characteristics}
                    </div>
                `;
            } else if (speechType === "Indirect Speech") {
                transformationDiagram.innerHTML = `
                    <div class="speech-element" style="background-color: ${type.color}; width: 80%; height: 80px; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        <div style="font-size: 1.5rem;">üîÑ</div>
                        <div style="font-size: 1.2rem; margin-top: 5px;">${type.name}</div>
                        <div style="font-size: 0.9rem; margin-top: 5px;">${type.examples}</div>
                    </div>
                    
                    <div style="position: absolute; bottom: 20px; left: 0; right: 0; text-align: center; color: var(--text-secondary);">
                        <strong>Characteristics:</strong> ${type.characteristics}
                    </div>
                `;
            }
        };

        window.transformToIndirect = function() {
            const directInput = document.getElementById('directInput');
            const transformerDisplay = document.getElementById('transformerDisplay');
            
            if (!directInput || !transformerDisplay) return;
            
            const directText = directInput.value.trim();
            
            if (!directText) {
                transformerDisplay.innerHTML = "Please enter some direct speech to transform.";
                return;
            }
            
            // Simple transformation examples
            const transformations = {
                "I am": "he/she was",
                "I'm": "he/she was",
                "I have": "he/she had",
                "I will": "he/she would",
                "I can": "he/she could",
                "my": "his/her",
                "me": "him/her",
                "you": {
                    "subject": "I/he/she",
                    "object": "me/him/her",
                    "possessive": "my/his/her"
                },
                "your": "my/his/her",
                "we": "they",
                "our": "their",
                "us": "them",
                "today": "that day",
                "yesterday": "the day before",
                "tomorrow": "the next day",
                "now": "then",
                "here": "there",
                "this": "that",
                "these": "those"
            };
            
            let indirectText = directText;
            
            // Simple transformation (for demonstration)
            indirectText = indirectText.replace(/"/g, ''); // Remove quotes
            indirectText = indirectText.replace(/'/g, ''); // Remove single quotes
            
            // Change common patterns
            for (const [direct, indirect] of Object.entries(transformations)) {
                if (typeof indirect === 'string') {
                    const regex = new RegExp(`\\b${direct}\\b`, 'gi');
                    indirectText = indirectText.replace(regex, indirect);
                }
            }
            
            // Change verb tenses (simple examples)
            indirectText = indirectText.replace(/\bam\b|\bis\b|\bare\b/gi, 'was/were');
            indirectText = indirectText.replace(/\bhas\b|\bhave\b/gi, 'had');
            indirectText = indirectText.replace(/\bwill\b/gi, 'would');
            indirectText = indirectText.replace(/\bcan\b/gi, 'could');
            
            transformerDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; margin-bottom: 10px; color: var(--secondary-indigo);">
                        Transformed to Indirect Speech
                    </div>
                    
                    <div style="background: var(--dark-surface); padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <strong>Original (Direct):</strong><br>
                        <span style="color: var(--primary-purple); font-style: italic;">"${directText}"</span>
                    </div>
                    
                    <div style="background: rgba(48, 63, 159, 0.1); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid var(--secondary-indigo);">
                        <strong style="color: var(--secondary-indigo);">Transformed (Indirect):</strong><br>
                        <span style="color: var(--secondary-indigo);">${indirectText}</span>
                    </div>
                    
                    <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 15px;">
                        <strong>Remember:</strong> Always check tense changes, pronoun shifts, and time expressions!
                    </div>
                </div>
            `;
        };

        window.transformToDirect = function() {
            const directInput = document.getElementById('directInput');
            const transformerDisplay = document.getElementById('transformerDisplay');
            
            if (!directInput || !transformerDisplay) return;
            
            const indirectText = directInput.value.trim();
            
            if (!indirectText) {
                transformerDisplay.innerHTML = "Please enter some indirect speech to transform.";
                return;
            }
            
            // Simple reverse transformation examples
            const reverseTransformations = {
                "was": "am/is",
                "were": "am/are",
                "had": "have/has",
                "would": "will",
                "could": "can",
                "his": "my",
                "her": "my",
                "their": "our",
                "them": "us",
                "that day": "today",
                "the day before": "yesterday",
                "the next day": "tomorrow",
                "then": "now",
                "there": "here",
                "that": "this",
                "those": "these"
            };
            
            let directText = indirectText;
            
            // Add quotes
            directText = `"${directText}"`;
            
            // Change common patterns (reverse)
            for (const [indirect, direct] of Object.entries(reverseTransformations)) {
                const regex = new RegExp(`\\b${indirect}\\b`, 'gi');
                directText = directText.replace(regex, direct);
            }
            
            // Change verb tenses back (simple examples)
            directText = directText.replace(/\bwas\b|\bwere\b/gi, 'am/is/are');
            directText = directText.replace(/\bhad\b/gi, 'have/has');
            directText = directText.replace(/\bwould\b/gi, 'will');
            directText = directText.replace(/\bcould\b/gi, 'can');
            
            transformerDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; margin-bottom: 10px; color: var(--primary-purple);">
                        Transformed to Direct Speech
                    </div>
                    
                    <div style="background: var(--dark-surface); padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <strong>Original (Indirect):</strong><br>
                        <span style="color: var(--secondary-indigo);">${indirectText}</span>
                    </div>
                    
                    <div style="background: rgba(123, 31, 162, 0.1); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid var(--primary-purple);">
                        <strong style="color: var(--primary-purple);">Transformed (Direct):</strong><br>
                        <span style="color: var(--primary-purple); font-style: italic;">${directText}</span>
                    </div>
                    
                    <div style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 15px;">
                        <strong>Remember:</strong> Direct speech uses exact words in quotation marks!
                    </div>
                </div>
            `;
        };

        window.clearTransformer = function() {
            const directInput = document.getElementById('directInput');
            const transformerDisplay = document.getElementById('transformerDisplay');
            
            if (directInput) directInput.value = '';
            if (transformerDisplay) {
                transformerDisplay.innerHTML = "Your transformed speech will appear here...";
            }
        };

        function initializeTransformationDiagram() {
            const transformationDiagram = document.getElementById('transformationDiagram');
            if (!transformationDiagram) return;
            
            // Create a speech transformation diagram
            transformationDiagram.innerHTML = `
                <!-- Direct Speech -->
                <div class="speech-element direct-glow" style="background-color: ${speechTypes[0].color}; width: 180px; height: 60px; top: 30%; left: 30%;">
                    <div style="font-size: 1.5rem;">üí¨</div>
                    <div style="font-size: 0.9rem;">Direct Speech</div>
                </div>
                
                <!-- Arrow -->
                <div class="transformation-arrow" style="top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(90deg);"></div>
                
                <!-- Indirect Speech -->
                <div class="speech-element indirect-glow" style="background-color: ${speechTypes[1].color}; width: 180px; height: 60px; top: 70%; left: 70%;">
                    <div style="font-size: 1.5rem;">üîÑ</div>
                    <div style="font-size: 0.9rem;">Indirect Speech</div>
                </div>
                
                <!-- Examples -->
                <div style="position: absolute; top: 25%; left: 5%; color: var(--text-secondary); font-size: 0.8rem; width: 200px;">
                    <strong>Example:</strong><br>
                    She said, "I am happy."
                </div>
                
                <div style="position: absolute; top: 65%; right: 5%; color: var(--text-secondary); font-size: 0.8rem; width: 200px; text-align: right;">
                    <strong>Transformed:</strong><br>
                    She said that she was happy.
                </div>
                
                <!-- Changes -->
                <div style="position: absolute; top: 45%; left: 40%; color: var(--accent-teal); font-size: 0.7rem;">
                    Tense: am ‚Üí was<br>
                    Pronoun: I ‚Üí she<br>
                    Punctuation: " " removed
                </div>
            `;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            languageFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            languageFact.appendChild(createLanguageFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createSpeechVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin your speech mastery journey!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
