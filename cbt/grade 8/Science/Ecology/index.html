<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 8 Science - Ecology | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Ecology Theme */
        :root {
            --primary-green: #4CAF50;
            --primary-blue: #2196F3;
            --primary-brown: #795548;
            --primary-orange: #FF9800;
            --accent-teal: #009688;
            --accent-yellow: #FFC107;
            --accent-red: #F44336;
            --accent-purple: #9C27B0;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --producer-green: rgba(76, 175, 80, 0.3);
            --consumer-blue: rgba(33, 150, 243, 0.3);
            --decomposer-brown: rgba(121, 85, 72, 0.3);
            --ecosystem-orange: rgba(255, 152, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(76, 175, 80, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(33, 150, 243, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(121, 85, 72, 0.05) 0%, transparent 70%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            border-radius: 10px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info h1 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 30px 20px;
        }

        .welcome-title {
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue), var(--primary-brown));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 25px;
            max-width: 800px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(76, 175, 80, 0.15);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 20px;
            border: 2px solid var(--primary-green);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-green);
        }

        .input-group {
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            font-size: 1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-green);
            color: white;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .btn-primary:hover {
            background: #388E3C;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
        }

        .btn-secondary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }

        .btn-secondary:hover {
            background: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(33, 150, 243, 0.4);
        }

        .btn-brown {
            background: var(--primary-brown);
            color: white;
            box-shadow: 0 4px 12px rgba(121, 85, 72, 0.3);
        }

        .btn-brown:hover {
            background: #5D4037;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(121, 85, 72, 0.4);
        }

        .btn-orange {
            background: var(--primary-orange);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }

        .btn-orange:hover {
            background: #F57C00;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 152, 0, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-green);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Topics Grid */
        .topics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .topics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 576px) {
            .topics-grid {
                grid-template-columns: 1fr;
            }
        }

        .topic-card {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .topic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .topic-card.food-chains {
            border-color: var(--primary-green);
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), transparent);
        }

        .topic-card.food-webs {
            border-color: var(--primary-blue);
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), transparent);
        }

        .topic-card.balance {
            border-color: var(--primary-brown);
            background: linear-gradient(135deg, rgba(121, 85, 72, 0.1), transparent);
        }

        .topic-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .topic-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .topic-card.food-chains .topic-title {
            color: var(--primary-green);
        }

        .topic-card.food-webs .topic-title {
            color: var(--primary-blue);
        }

        .topic-card.balance .topic-title {
            color: var(--primary-brown);
        }

        .topic-features {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--dark-border);
        }

        .topic-features h4 {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .feature-list {
            list-style-type: none;
        }

        .feature-list li {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-bottom: 4px;
            padding-left: 15px;
            position: relative;
        }

        .feature-list li:before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            color: var(--accent-teal);
        }

        /* Practice Page */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 20px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 8px;
            background: var(--dark-surface);
            border-radius: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-green), var(--primary-blue), var(--primary-brown));
            border-radius: 8px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .question-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .ecology-tip {
            background: rgba(121, 85, 72, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid var(--primary-brown);
            font-style: italic;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Options */
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .option {
            padding: 15px;
            background: var(--dark-card);
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-green);
            background: rgba(76, 175, 80, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 25px;
            height: 25px;
            background: var(--primary-green);
            border-radius: 50%;
            margin-right: 12px;
            font-weight: bold;
            color: white;
        }

        .option.correct .option-letter {
            background: var(--primary-green);
        }

        .option.incorrect .option-letter {
            background: var(--accent-red);
        }

        /* Feedback */
        .feedback-container {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid var(--primary-green);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 4px solid var(--accent-red);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-green);
        }

        .feedback-incorrect .feedback-icon {
            background: var(--accent-red);
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-green);
        }

        .feedback-incorrect .feedback-title {
            color: var(--accent-red);
        }

        .feedback-explanation {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Navigation */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        /* Visualization Area */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--dark-border);
            overflow: auto;
        }

        /* Food Chain Visualizer */
        .chain-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-green);
        }

        .visualizer-title {
            color: var(--primary-green);
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .chain-canvas-container {
            width: 100%;
            height: 200px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .chain-canvas {
            width: 100%;
            height: 100%;
        }

        .organism-info {
            background: var(--dark-surface);
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            display: none;
        }

        .organism-info.show {
            display: block;
        }

        .chain-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .chain-controls {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .chain-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .chain-btn:hover {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--primary-green);
        }

        .chain-btn.active {
            background: var(--primary-green);
            color: white;
        }

        /* Food Web Visualizer */
        .web-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-blue);
        }

        .web-canvas-container {
            width: 100%;
            height: 250px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .web-canvas {
            width: 100%;
            height: 100%;
        }

        .web-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .web-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .web-btn:hover {
            background: rgba(33, 150, 243, 0.1);
            border-color: var(--primary-blue);
        }

        .web-btn.active {
            background: var(--primary-blue);
            color: white;
        }

        /* Ecosystem Balance Visualizer */
        .balance-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-brown);
        }

        .balance-canvas-container {
            width: 100%;
            height: 250px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .balance-canvas {
            width: 100%;
            height: 100%;
        }

        .balance-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .balance-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .balance-btn:hover {
            background: rgba(121, 85, 72, 0.1);
            border-color: var(--primary-brown);
        }

        .balance-btn.active {
            background: var(--primary-brown);
            color: white;
        }

        /* Energy Pyramid Visualizer */
        .pyramid-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-orange);
        }

        .pyramid-canvas-container {
            width: 100%;
            height: 250px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .pyramid-canvas {
            width: 100%;
            height: 100%;
        }

        .pyramid-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .pyramid-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pyramid-btn:hover {
            background: rgba(255, 152, 0, 0.1);
            border-color: var(--primary-orange);
        }

        .pyramid-btn.active {
            background: var(--primary-orange);
            color: white;
        }

        /* Comparison Table */
        .comparison-table {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-teal);
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        th {
            background: var(--dark-surface);
            padding: 10px;
            text-align: left;
            color: var(--text-primary);
            border-bottom: 2px solid var(--dark-border);
        }

        td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-secondary);
        }

        tr:hover td {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Roles Display */
        .roles-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-yellow);
        }

        .roles-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .roles-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .role-card {
            background: var(--dark-surface);
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .role-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .role-card.producer {
            border-left-color: var(--primary-green);
        }

        .role-card.consumer {
            border-left-color: var(--primary-blue);
        }

        .role-card.decomposer {
            border-left-color: var(--primary-brown);
        }

        .role-title {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .role-value {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Ecosystem Simulator */
        .ecosystem-simulator {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-purple);
        }

        .ecosystem-container {
            width: 100%;
            height: 200px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .ecosystem-canvas {
            width: 100%;
            height: 100%;
        }

        .ecosystem-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .ecosystem-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .ecosystem-btn:hover {
            background: rgba(156, 39, 176, 0.1);
            border-color: var(--accent-purple);
        }

        .ecosystem-btn.active {
            background: var(--accent-purple);
            color: white;
        }

        /* Interactive Quiz */
        .interactive-quiz {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-red);
        }

        .quiz-question {
            margin: 10px 0;
            color: var(--text-primary);
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 5px;
            margin: 10px 0;
        }

        .quiz-option {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quiz-option:hover {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--accent-red);
        }

        .quiz-option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        .quiz-option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 30px 20px;
        }

        .results-title {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue), var(--primary-brown));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            margin: 0 auto 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-green), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-green);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        @keyframes grow {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .grow-animate {
            animation: grow 0.5s ease forwards;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 1.8rem;
            }
            
            .topics-grid {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .chain-controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .pyramid-controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .ecosystem-controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .roles-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <h1 class="welcome-title">Grade 8 Science: Ecology & Environmental Balance</h1>
            <p class="welcome-subtitle">Explore the intricate relationships in nature! Discover food chains, understand complex food webs, learn about energy pyramids, and examine how ecosystems maintain balance through interactive simulations and ecological principles.</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üåøü¶Åüå≥</span>
                <span class="topic-name">Ecology Fundamentals</span>
            </div>
            
            <div class="topics-grid">
                <div class="topic-card food-chains" onclick="showTopicInfo('food-chains')">
                    <div class="topic-icon">üîÑ</div>
                    <h3 class="topic-title">Food Chains & Energy Flow</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">Linear feeding relationships showing energy transfer</p>
                    <div class="topic-features">
                        <h4>Key Concepts:</h4>
                        <ul class="feature-list">
                            <li>Trophic levels</li>
                            <li>Producers & consumers</li>
                            <li>Energy transfer</li>
                            <li>10% energy rule</li>
                        </ul>
                    </div>
                </div>
                
                <div class="topic-card food-webs" onclick="showTopicInfo('food-webs')">
                    <div class="topic-icon">üï∏Ô∏è</div>
                    <h3 class="topic-title">Food Webs & Interdependence</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">Complex networks of feeding relationships</p>
                    <div class="topic-features">
                        <h4>Key Concepts:</h4>
                        <ul class="feature-list">
                            <li>Interconnected chains</li>
                            <li>Predator-prey relationships</li>
                            <li>Species interdependence</li>
                            <li>Biodiversity importance</li>
                        </ul>
                    </div>
                </div>
                
                <div class="topic-card balance" onclick="showTopicInfo('balance')">
                    <div class="topic-icon">‚öñÔ∏è</div>
                    <h3 class="topic-title">Ecosystem Balance</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">Maintaining stability in natural systems</p>
                    <div class="topic-features">
                        <h4>Key Concepts:</h4>
                        <ul class="feature-list">
                            <li>Carrying capacity</li>
                            <li>Cycles (water, carbon, nitrogen)</li>
                            <li>Human impacts</li>
                            <li>Conservation methods</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your name:</label>
                <input type="text" id="studentName" placeholder="Your name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>üåø Begin Ecology Study</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 25</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 4%"></div>
                </div>
            </div>

            <div class="question-container">
                <div id="ecologyTip"></div>
                
                <h2 class="question-text" id="questionText"></h2>
                
                <div class="options-container" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-explanation" id="feedbackExplanation"></div>
                </div>
            </div>
            
            <!-- Visualization Area -->
            <div class="content-wrapper">
                <div class="visualization-container">
                    <!-- Food Chain Visualizer -->
                    <div class="chain-visualizer">
                        <div class="visualizer-title">Food Chains - Energy Transfer</div>
                        <div class="chain-canvas-container">
                            <canvas class="chain-canvas" id="chainCanvas"></canvas>
                        </div>
                        <div class="organism-info" id="organismInfo">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <div style="font-weight: bold; color: var(--primary-green);" id="organismName"></div>
                                    <div style="font-size: 0.9rem;" id="organismType"></div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Trophic Level</div>
                                    <div style="font-weight: bold;" id="trophicLevel"></div>
                                </div>
                            </div>
                            <div style="margin-top: 10px; font-size: 0.85rem; color: var(--text-secondary);" id="organismDescription"></div>
                        </div>
                        <div class="chain-controls">
                            <div class="chain-btn active" onclick="showChain('grassland')">Grassland</div>
                            <div class="chain-btn" onclick="showChain('forest')">Forest</div>
                            <div class="chain-btn" onclick="showChain('aquatic')">Aquatic</div>
                            <div class="chain-btn" onclick="showChain('desert')">Desert</div>
                            <div class="chain-btn" onclick="showEnergyFlow()">Energy Flow</div>
                            <div class="chain-btn" onclick="showTrophicLevels()">Trophic Levels</div>
                            <div class="chain-btn" onclick="animateChain()">Animate</div>
                            <div class="chain-btn" onclick="resetChain()">Reset</div>
                        </div>
                    </div>
                    
                    <!-- Food Web Visualizer -->
                    <div class="web-visualizer">
                        <div class="visualizer-title">Food Webs - Interconnected Chains</div>
                        <div class="web-canvas-container">
                            <canvas class="web-canvas" id="webCanvas"></canvas>
                        </div>
                        <div class="web-controls">
                            <div class="web-btn active" onclick="showWeb('grassland')">Grassland Web</div>
                            <div class="web-btn" onclick="showWeb('forest')">Forest Web</div>
                            <div class="web-btn" onclick="showWeb('pond')">Pond Web</div>
                            <div class="web-btn" onclick="showWeb('ocean')">Ocean Web</div>
                            <div class="web-btn" onclick="showInterconnections()">Show Links</div>
                            <div class="web-btn" onclick="removeSpecies()">Remove Species</div>
                            <div class="web-btn" onclick="addSpecies()">Add Species</div>
                            <div class="web-btn" onclick="showKeystone()">Keystone Species</div>
                            <div class="web-btn" onclick="animateWeb()">Animate Web</div>
                        </div>
                    </div>
                    
                    <!-- Comparison Table -->
                    <div class="comparison-table">
                        <div class="visualizer-title">Food Chains vs Food Webs vs Energy Pyramids</div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Feature</th>
                                        <th>Food Chains</th>
                                        <th>Food Webs</th>
                                        <th>Energy Pyramids</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Structure</td>
                                        <td>Linear sequence</td>
                                        <td>Complex network</td>
                                        <td>Triangular hierarchy</td>
                                    </tr>
                                    <tr>
                                        <td>Relationships</td>
                                        <td>Simple feeding</td>
                                        <td>Multiple connections</td>
                                        <td>Energy transfer</td>
                                    </tr>
                                    <tr>
                                        <td>Realism</td>
                                        <td>Simplified model</td>
                                        <td>More realistic</td>
                                        <td>Quantitative model</td>
                                    </tr>
                                    <tr>
                                        <td>Shows</td>
                                        <td>Who eats whom</td>
                                        <td>Ecosystem complexity</td>
                                        <td>Energy loss (10% rule)</td>
                                    </tr>
                                    <tr>
                                        <td>Example</td>
                                        <td>Grass ‚Üí Rabbit ‚Üí Fox</td>
                                        <td>Multiple chains interconnected</td>
                                        <td>Base: Producers, Top: Top predators</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="showMoreExamples()">More Examples</button>
                            <button class="btn btn-small btn-orange" onclick="testYourKnowledge()">Quick Quiz</button>
                        </div>
                    </div>
                    
                    <!-- Interactive Quiz -->
                    <div class="interactive-quiz">
                        <div class="visualizer-title">Quick Knowledge Check</div>
                        <div class="quiz-question" id="quizQuestion">What organisms are at the base of most food chains?</div>
                        <div class="quiz-options" id="quizOptions">
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'A')">A) Producers</div>
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'B')">B) Primary Consumers</div>
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'C')">C) Secondary Consumers</div>
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'D')">D) Decomposers</div>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="nextQuizQuestion()">Next Question</button>
                        </div>
                    </div>
                </div>
                
                <div class="visualization-container">
                    <!-- Ecosystem Balance Visualizer -->
                    <div class="balance-visualizer">
                        <div class="visualizer-title">Ecosystem Balance & Cycles</div>
                        <div class="balance-canvas-container">
                            <canvas class="balance-canvas" id="balanceCanvas"></canvas>
                        </div>
                        <div class="balance-controls">
                            <div class="balance-btn active" onclick="showBalance('carbon')">Carbon Cycle</div>
                            <div class="balance-btn" onclick="showBalance('water')">Water Cycle</div>
                            <div class="balance-btn" onclick="showBalance('nitrogen')">Nitrogen Cycle</div>
                            <div class="balance-btn" onclick="showBalance('population')">Population Balance</div>
                            <div class="balance-btn" onclick="showBalance('predatorPrey')">Predator-Prey</div>
                            <div class="balance-btn" onclick="showBalance('carrying')">Carrying Capacity</div>
                            <div class="balance-btn" onclick="runCycle()">Run Cycle</div>
                            <div class="balance-btn" onclick="pauseCycle()">Pause</div>
                            <div class="balance-btn" onclick="resetCycle()">Reset</div>
                        </div>
                    </div>
                    
                    <!-- Energy Pyramid Visualizer -->
                    <div class="pyramid-visualizer">
                        <div class="visualizer-title">Energy Pyramids & 10% Rule</div>
                        <div class="pyramid-canvas-container">
                            <canvas class="pyramid-canvas" id="pyramidCanvas"></canvas>
                        </div>
                        <div class="pyramid-controls">
                            <div class="pyramid-btn active" onclick="showPyramid('numbers')">Numbers Pyramid</div>
                            <div class="pyramid-btn" onclick="showPyramid('biomass')">Biomass Pyramid</div>
                            <div class="pyramid-btn" onclick="showPyramid('energy')">Energy Pyramid</div>
                            <div class="pyramid-btn" onclick="showPyramid('grassland')">Grassland Example</div>
                            <div class="pyramid-btn" onclick="showPyramid('forest')">Forest Example</div>
                            <div class="pyramid-btn" onclick="showPyramid('aquatic')">Aquatic Example</div>
                            <div class="pyramid-btn" onclick="showEnergyLoss()">Show 10% Rule</div>
                            <div class="pyramid-btn" onclick="comparePyramids()">Compare Types</div>
                        </div>
                    </div>
                    
                    <!-- Roles Display -->
                    <div class="roles-display">
                        <div class="visualizer-title">Organism Roles in Ecosystems</div>
                        <div class="roles-grid">
                            <div class="role-card producer" onclick="showRole('producer')">
                                <div class="role-title">üåø Producers</div>
                                <div class="role-value">Make food via photosynthesis</div>
                            </div>
                            <div class="role-card consumer" onclick="showRole('primaryConsumer')">
                                <div class="role-title">üêá Primary Consumers</div>
                                <div class="role-value">Herbivores that eat plants</div>
                            </div>
                            <div class="role-card consumer" onclick="showRole('secondaryConsumer')">
                                <div class="role-title">ü¶ä Secondary Consumers</div>
                                <div class="role-value">Carnivores that eat herbivores</div>
                            </div>
                            <div class="role-card consumer" onclick="showRole('tertiaryConsumer')">
                                <div class="role-title">ü¶Ö Tertiary Consumers</div>
                                <div class="role-value">Top carnivores</div>
                            </div>
                            <div class="role-card decomposer" onclick="showRole('decomposer')">
                                <div class="role-title">üçÑ Decomposers</div>
                                <div class="role-value">Break down dead organisms</div>
                            </div>
                            <div class="role-card decomposer" onclick="showRole('scavenger')">
                                <div class="role-title">ü¶Ö Scavengers</div>
                                <div class="role-value">Eat dead animals</div>
                            </div>
                            <div class="role-card producer" onclick="showRole('autotroph')">
                                <div class="role-title">‚òÄÔ∏è Autotrophs</div>
                                <div class="role-value">Self-feeders (producers)</div>
                            </div>
                            <div class="role-card consumer" onclick="showRole('heterotroph')">
                                <div class="role-title">üçñ Heterotrophs</div>
                                <div class="role-value">Consumers (cannot make food)</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="compareRoles()">Compare Roles</button>
                            <button class="btn btn-small btn-brown" onclick="showAdaptations()">Adaptations</button>
                        </div>
                    </div>
                    
                    <!-- Ecosystem Simulator -->
                    <div class="ecosystem-simulator">
                        <div class="visualizer-title">Ecosystem Dynamics Simulator</div>
                        <div class="ecosystem-container">
                            <canvas class="ecosystem-canvas" id="ecosystemCanvas"></canvas>
                        </div>
                        <div class="ecosystem-controls">
                            <div class="ecosystem-btn active" onclick="runSimulation('predatorPrey')">Predator-Prey</div>
                            <div class="ecosystem-btn" onclick="runSimulation('population')">Population Growth</div>
                            <div class="ecosystem-btn" onclick="runSimulation('competition')">Competition</div>
                            <div class="ecosystem-btn" onclick="runSimulation('invasive')">Invasive Species</div>
                            <div class="ecosystem-btn" onclick="runSimulation('pollution')">Pollution Impact</div>
                            <div class="ecosystem-btn" onclick="runSimulation('conservation')">Conservation</div>
                            <div class="ecosystem-btn" onclick="pauseSimulation()">Pause</div>
                            <div class="ecosystem-btn" onclick="resetSimulation()">Reset</div>
                        </div>
                    </div>
                    
                    <!-- Real-World Applications -->
                    <div class="comparison-table" style="border-color: var(--accent-teal);">
                        <div class="visualizer-title">Real-World Applications</div>
                        <div style="margin: 10px 0; padding: 10px; background: var(--dark-surface); border-radius: 6px;">
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">üåæ Agriculture</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Crop-pest food chains</div>
                                </div>
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">üé£ Fisheries Management</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Maintaining aquatic food webs</div>
                                </div>
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">üèûÔ∏è Conservation</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Protecting keystone species</div>
                                </div>
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">üå°Ô∏è Climate Change</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Disrupting ecosystem balance</div>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="showMoreApplications()">More Applications</button>
                            <button class="btn btn-small btn-blue" onclick="showEnvironmentalImpact()">Environmental Impact</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn btn-orange" id="skipQuestion">Skip Question</button>
                <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Ecology Study Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="timeSpent">0min</div>
                        <div class="stat-label">Time Spent</div>
                    </div>
                </div>
                
                <div class="btn-group" style="margin-top: 20px;">
                    <button class="btn btn-primary" id="retryTopic">Try Again</button>
                    <button class="btn btn-secondary" id="viewTopics">Other Topics</button>
                    <button class="btn btn-brown" id="printCertificate">Print Certificate</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Questions array - 25 focused questions on Ecology
        const questions = [
            {
                question: "What organisms are at the base of most food chains?",
                options: ["Producers (plants)", "Primary consumers", "Secondary consumers", "Decomposers"],
                answer: "A",
                explanation: "Producers (plants and algae) form the base of food chains by converting sunlight into chemical energy through photosynthesis."
            },
            {
                question: "What percentage of energy is typically transferred from one trophic level to the next?",
                options: ["10%", "25%", "50%", "90%"],
                answer: "A",
                explanation: "Only about 10% of energy is transferred to the next trophic level due to energy loss as heat, waste, and through life processes."
            },
            {
                question: "Which organism would be a primary consumer?",
                options: ["Rabbit eating grass", "Fox eating rabbit", "Snake eating frog", "Mushroom decomposing log"],
                answer: "A",
                explanation: "Primary consumers are herbivores that eat producers (plants). Rabbits eating grass are primary consumers."
            },
            {
                question: "What is the main difference between a food chain and a food web?",
                options: ["Food webs show multiple interconnected chains", "Food chains are longer", "Food webs only include animals", "Food chains include decomposers"],
                answer: "A",
                explanation: "Food webs show the complex network of interconnected food chains in an ecosystem, while a food chain shows a single linear path."
            },
            {
                question: "What process do producers use to make their own food?",
                options: ["Photosynthesis", "Respiration", "Decomposition", "Consumption"],
                answer: "A",
                explanation: "Producers (plants, algae) use photosynthesis to convert sunlight, water, and carbon dioxide into glucose (food) and oxygen."
            },
            {
                question: "Which organism is a decomposer?",
                options: ["Fungi breaking down dead leaves", "Hawk eating mouse", "Deer eating grass", "Fish eating algae"],
                answer: "A",
                explanation: "Decomposers like fungi and bacteria break down dead organisms and waste, returning nutrients to the ecosystem."
            },
            {
                question: "What is the term for an organism's role in its ecosystem?",
                options: ["Niche", "Habitat", "Community", "Population"],
                answer: "A",
                explanation: "An organism's niche includes its role in the ecosystem - what it eats, what eats it, and how it interacts with the environment."
            },
            {
                question: "Which is an example of a biotic factor in an ecosystem?",
                options: ["Plants", "Sunlight", "Water", "Temperature"],
                answer: "A",
                explanation: "Biotic factors are living components of an ecosystem (plants, animals, bacteria). Abiotic factors are non-living (sunlight, water, temperature)."
            },
            {
                question: "What happens if a keystone species is removed from an ecosystem?",
                options: ["The ecosystem may collapse", "Nothing changes", "Only one other species is affected", "It always improves biodiversity"],
                answer: "A",
                explanation: "Keystone species have disproportionately large effects on their ecosystems. Their removal can cause major changes or collapse."
            },
            {
                question: "Which trophic level has the most biomass in a healthy ecosystem?",
                options: ["Producers", "Primary consumers", "Secondary consumers", "Tertiary consumers"],
                answer: "A",
                explanation: "Producers have the most biomass because energy decreases at each trophic level (10% rule)."
            },
            {
                question: "What is the source of energy for almost all ecosystems?",
                options: ["Sun", "Heat from Earth's core", "Chemical reactions", "Decomposers"],
                answer: "A",
                explanation: "The sun is the primary energy source for almost all ecosystems through photosynthesis by producers."
            },
            {
                question: "Which term describes the maximum population an ecosystem can support?",
                options: ["Carrying capacity", "Population density", "Limiting factor", "Biotic potential"],
                answer: "A",
                explanation: "Carrying capacity is the maximum population size an environment can sustain indefinitely."
            },
            {
                question: "What do arrows represent in a food chain diagram?",
                options: ["Flow of energy", "Movement of organisms", "Direction of growth", "Water flow"],
                answer: "A",
                explanation: "Arrows in food chains show the direction of energy flow from the organism being eaten to the organism eating it."
            },
            {
                question: "Which is an example of a secondary consumer?",
                options: ["Snake eating frog", "Grasshopper eating plant", "Eagle eating snake", "Bacteria decomposing waste"],
                answer: "A",
                explanation: "Secondary consumers eat primary consumers. A snake eating a frog (which eats insects) is a secondary consumer."
            },
            {
                question: "What is biodiversity?",
                options: ["Variety of life in an ecosystem", "Number of individuals in a population", "Amount of sunlight available", "Speed of energy transfer"],
                answer: "A",
                explanation: "Biodiversity refers to the variety of different species living in an ecosystem."
            },
            {
                question: "Which process returns carbon to the atmosphere?",
                options: ["Respiration", "Photosynthesis", "Nitrogen fixation", "Precipitation"],
                answer: "A",
                explanation: "Respiration by plants, animals, and decomposers releases carbon dioxide back into the atmosphere."
            },
            {
                question: "What is an omnivore?",
                options: ["Organism that eats both plants and animals", "Organism that only eats plants", "Organism that only eats animals", "Organism that makes its own food"],
                answer: "A",
                explanation: "Omnivores eat both plant and animal matter. Humans, bears, and raccoons are examples."
            },
            {
                question: "Which level of an energy pyramid has the most energy?",
                options: ["Producers (base)", "Primary consumers", "Secondary consumers", "Tertiary consumers (top)"],
                answer: "A",
                explanation: "Producers at the base of the energy pyramid have the most energy available."
            },
            {
                question: "What is a scavenger?",
                options: ["Organism that eats dead animals", "Organism that hunts live prey", "Organism that eats only plants", "Organism that breaks down waste"],
                answer: "A",
                explanation: "Scavengers like vultures and hyenas feed on dead animals they find rather than hunting live prey."
            },
            {
                question: "Which human activity most threatens ecosystem balance?",
                options: ["Deforestation", "Bird watching", "Hiking", "Nature photography"],
                answer: "A",
                explanation: "Deforestation destroys habitats, reduces biodiversity, and disrupts ecosystem balance more than recreational activities."
            },
            {
                question: "What is a population?",
                options: ["All members of one species in an area", "All living things in an area", "The physical environment", "Multiple species interacting"],
                answer: "A",
                explanation: "A population includes all individuals of the same species living in a particular area."
            },
            {
                question: "Which is an abiotic factor?",
                options: ["Soil type", "Plants", "Animals", "Fungi"],
                answer: "A",
                explanation: "Abiotic factors are non-living components like soil, water, sunlight, and temperature."
            },
            {
                question: "What is the term for organisms that make their own food?",
                options: ["Autotrophs", "Heterotrophs", "Decomposers", "Consumers"],
                answer: "A",
                explanation: "Autotrophs (producers) make their own food through photosynthesis or chemosynthesis."
            },
            {
                question: "Which describes mutualism?",
                options: ["Both species benefit", "One benefits, one is harmed", "One benefits, one unaffected", "Both compete for resources"],
                answer: "A",
                explanation: "Mutualism is a symbiotic relationship where both species benefit, like bees and flowers."
            },
            {
                question: "What is conservation?",
                options: ["Protecting natural resources", "Using resources rapidly", "Ignoring environmental issues", "Increasing pollution"],
                answer: "A",
                explanation: "Conservation involves protecting and preserving natural resources and ecosystems for future generations."
            }
        ];

        // Ecology tips and facts
        const ecologyTips = [
            "A single teaspoon of soil can contain up to 1 billion bacteria!",
            "Rainforests cover only 6% of Earth but contain over 50% of all plant and animal species.",
            "The Great Barrier Reef is the largest living structure on Earth, visible from space.",
            "An oak tree can support over 500 different species of insects and animals.",
            "Bees pollinate about one-third of the food we eat!",
            "A single mature tree can absorb up to 48 pounds of carbon dioxide per year.",
            "The ocean produces over half of the world's oxygen through phytoplankton.",
            "Ants outnumber humans by about 1.5 million to one.",
            "The Amazon rainforest creates its own rainfall through transpiration.",
            "Fungi have their own kingdom separate from plants and animals!"
        ];

        // Quiz questions
        const quizQuestions = [
            {
                question: "What organisms are at the base of most food chains?",
                options: ["Producers (plants)", "Primary consumers", "Secondary consumers", "Decomposers"],
                answer: "A"
            },
            {
                question: "What percentage of energy transfers between trophic levels?",
                options: ["10%", "25%", "50%", "90%"],
                answer: "A"
            },
            {
                question: "What is the main difference between food chains and food webs?",
                options: ["Webs show interconnected chains", "Chains are longer", "Webs only include animals", "Chains include decomposers"],
                answer: "A"
            },
            {
                question: "What process do producers use to make food?",
                options: ["Photosynthesis", "Respiration", "Decomposition", "Consumption"],
                answer: "A"
            },
            {
                question: "What is an organism's role in its ecosystem called?",
                options: ["Niche", "Habitat", "Community", "Population"],
                answer: "A"
            }
        ];

        // Food chain data
        const foodChains = {
            grassland: [
                { name: "Grass", type: "Producer", trophic: 1, color: "#4CAF50" },
                { name: "Rabbit", type: "Primary Consumer", trophic: 2, color: "#9E9E9E" },
                { name: "Fox", type: "Secondary Consumer", trophic: 3, color: "#FF9800" },
                { name: "Mountain Lion", type: "Tertiary Consumer", trophic: 4, color: "#795548" }
            ],
            forest: [
                { name: "Oak Tree", type: "Producer", trophic: 1, color: "#4CAF50" },
                { name: "Caterpillar", type: "Primary Consumer", trophic: 2, color: "#8BC34A" },
                { name: "Blue Jay", type: "Secondary Consumer", trophic: 3, color: "#2196F3" },
                { name: "Hawk", type: "Tertiary Consumer", trophic: 4, color: "#607D8B" }
            ],
            aquatic: [
                { name: "Phytoplankton", type: "Producer", trophic: 1, color: "#4CAF50" },
                { name: "Zooplankton", type: "Primary Consumer", trophic: 2, color: "#00BCD4" },
                { name: "Small Fish", type: "Secondary Consumer", trophic: 3, color: "#03A9F4" },
                { name: "Shark", type: "Tertiary Consumer", trophic: 4, color: "#3F51B5" }
            ],
            desert: [
                { name: "Cactus", type: "Producer", trophic: 1, color: "#4CAF50" },
                { name: "Kangaroo Rat", type: "Primary Consumer", trophic: 2, color: "#795548" },
                { name: "Rattlesnake", type: "Secondary Consumer", trophic: 3, color: "#8BC34A" },
                { name: "Coyote", type: "Tertiary Consumer", trophic: 4, color: "#FF9800" }
            ]
        };

        // Food web data
        const foodWebs = {
            grassland: {
                organisms: [
                    { name: "Grass", type: "producer", x: 50, y: 50 },
                    { name: "Clover", type: "producer", x: 150, y: 50 },
                    { name: "Rabbit", type: "primary", x: 100, y: 120 },
                    { name: "Mouse", type: "primary", x: 50, y: 120 },
                    { name: "Grasshopper", type: "primary", x: 150, y: 120 },
                    { name: "Fox", type: "secondary", x: 100, y: 190 },
                    { name: "Snake", type: "secondary", x: 50, y: 190 },
                    { name: "Hawk", type: "tertiary", x: 100, y: 260 }
                ],
                connections: [
                    ["Grass", "Rabbit"], ["Grass", "Mouse"], ["Grass", "Grasshopper"],
                    ["Clover", "Rabbit"], ["Clover", "Mouse"],
                    ["Rabbit", "Fox"], ["Mouse", "Fox"], ["Mouse", "Snake"],
                    ["Grasshopper", "Snake"], ["Grasshopper", "Hawk"],
                    ["Rabbit", "Hawk"], ["Snake", "Hawk"], ["Fox", "Hawk"]
                ]
            },
            forest: {
                organisms: [
                    { name: "Oak", type: "producer", x: 50, y: 50 },
                    { name: "Maple", type: "producer", x: 150, y: 50 },
                    { name: "Caterpillar", type: "primary", x: 100, y: 120 },
                    { name: "Deer", type: "primary", x: 50, y: 120 },
                    { name: "Squirrel", type: "primary", x: 150, y: 120 },
                    { name: "Blue Jay", type: "secondary", x: 100, y: 190 },
                    { name: "Owl", type: "secondary", x: 50, y: 190 },
                    { name: "Bear", type: "tertiary", x: 150, y: 190 },
                    { name: "Wolf", type: "tertiary", x: 100, y: 260 }
                ],
                connections: [
                    ["Oak", "Caterpillar"], ["Oak", "Deer"], ["Oak", "Squirrel"],
                    ["Maple", "Caterpillar"], ["Maple", "Deer"], ["Maple", "Squirrel"],
                    ["Caterpillar", "Blue Jay"], ["Squirrel", "Blue Jay"], ["Squirrel", "Owl"],
                    ["Deer", "Wolf"], ["Squirrel", "Bear"], ["Blue Jay", "Wolf"],
                    ["Owl", "Wolf"], ["Bear", "Wolf"]
                ]
            }
        };

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            studentName: "",
            startTime: null,
            currentChain: 'grassland',
            currentWeb: 'grassland',
            currentBalance: 'carbon',
            currentPyramid: 'numbers',
            currentSimulation: 'predatorPrey',
            animationRunning: true,
            quizIndex: 0,
            chainCanvas: null,
            chainCtx: null,
            webCanvas: null,
            webCtx: null,
            balanceCanvas: null,
            balanceCtx: null,
            pyramidCanvas: null,
            pyramidCtx: null,
            ecosystemCanvas: null,
            ecosystemCtx: null,
            animationFrame: null
        };

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const backToHomeBtn = document.getElementById('backToHome');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const ecologyTip = document.getElementById('ecologyTip');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const feedbackExplanation = document.getElementById('feedbackExplanation');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const printCertificateBtn = document.getElementById('printCertificate');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const timeSpent = document.getElementById('timeSpent');
        const organismInfo = document.getElementById('organismInfo');
        const organismName = document.getElementById('organismName');
        const organismType = document.getElementById('organismType');
        const trophicLevel = document.getElementById('trophicLevel');
        const organismDescription = document.getElementById('organismDescription');
        const quizQuestion = document.getElementById('quizQuestion');
        const quizOptions = document.getElementById('quizOptions');

        // Initialize
        function initApp() {
            setupEventListeners();
            showWelcomePage();
            initializeCanvases();
            loadQuizQuestion();
            drawFoodChain();
            drawFoodWeb();
            drawBalanceCycle();
            drawEnergyPyramid();
            drawEcosystemSimulation();
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', showWelcomePage);
            printCertificateBtn.addEventListener('click', printCertificate);
            viewTopicsBtn.addEventListener('click', () => alert("Other science topics would be available here."));
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') startPractice();
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            appState.startTime = new Date();
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const percentage = Math.round((appState.score / questions.length) * 100);
            const timeDiff = new Date() - appState.startTime;
            const minutes = Math.floor(timeDiff / 60000);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            timeSpent.textContent = `${minutes}min`;
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Excellent! You're an ecology expert!";
            } else if (percentage >= 75) {
                scoreMessage.textContent = "Great job! You understand ecosystem relationships well!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Good work! You're getting the hang of ecology!";
            } else {
                scoreMessage.textContent = "Keep learning! Ecology is fascinating - review and try again!";
            }
        }

        // Create ecology tip display
        function createEcologyTip() {
            const tipDiv = document.createElement('div');
            tipDiv.className = 'ecology-tip';
            tipDiv.innerHTML = `<strong>Ecology Tip:</strong> ${ecologyTips[Math.floor(Math.random() * ecologyTips.length)]}`;
            return tipDiv;
        }

        // Load question
        function loadQuestion() {
            const question = questions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${questions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / questions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            ecologyTip.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            ecologyTip.appendChild(createEcologyTip());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = questions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation);
            }
            
            nextQuestionBtn.disabled = false;
        }

        // Show feedback
        function showFeedback(isCorrect, explanation) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Skip question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Retry topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            showPracticePage();
        }

        // Print certificate
        function printCertificate() {
            const percentage = Math.round((appState.score / questions.length) * 100);
            const certificateWindow = window.open('', '_blank');
            certificateWindow.document.write(`
                <html>
                <head>
                    <title>Certificate of Achievement</title>
                    <style>
                        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
                        .certificate { border: 20px solid #4CAF50; padding: 50px; max-width: 800px; margin: 0 auto; }
                        h1 { color: #4CAF50; }
                        .name { font-size: 2em; margin: 20px 0; }
                        .grade { font-size: 1.5em; margin: 20px 0; }
                        .score { font-size: 1.2em; margin: 20px 0; }
                        .date { margin-top: 50px; }
                    </style>
                </head>
                <body>
                    <div class="certificate">
                        <h1>Certificate of Achievement</h1>
                        <p>This certifies that</p>
                        <div class="name">${appState.studentName}</div>
                        <p>has successfully completed the Grade 8 Ecology module</p>
                        <div class="grade">Grade 8 Science - Ecology: Food Chains & Environmental Balance</div>
                        <div class="score">Score: ${appState.score}/${questions.length} (${percentage}%)</div>
                        <div class="date">Date: ${new Date().toLocaleDateString()}</div>
                        <p>Ideolix Learning Hub</p>
                    </div>
                </body>
                </html>
            `);
            certificateWindow.document.close();
            certificateWindow.print();
        }

        // Start practice
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin studying ecology!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            showPracticePage();
        }

        // Initialize canvases
        function initializeCanvases() {
            // Chain canvas
            const chainCanvas = document.getElementById('chainCanvas');
            const chainContainer = document.querySelector('.chain-canvas-container');
            chainCanvas.width = chainContainer.clientWidth;
            chainCanvas.height = chainContainer.clientHeight;
            appState.chainCanvas = chainCanvas;
            appState.chainCtx = chainCanvas.getContext('2d');
            
            // Web canvas
            const webCanvas = document.getElementById('webCanvas');
            const webContainer = document.querySelector('.web-canvas-container');
            webCanvas.width = webContainer.clientWidth;
            webCanvas.height = webContainer.clientHeight;
            appState.webCanvas = webCanvas;
            appState.webCtx = webCanvas.getContext('2d');
            
            // Balance canvas
            const balanceCanvas = document.getElementById('balanceCanvas');
            const balanceContainer = document.querySelector('.balance-canvas-container');
            balanceCanvas.width = balanceContainer.clientWidth;
            balanceCanvas.height = balanceContainer.clientHeight;
            appState.balanceCanvas = balanceCanvas;
            appState.balanceCtx = balanceCanvas.getContext('2d');
            
            // Pyramid canvas
            const pyramidCanvas = document.getElementById('pyramidCanvas');
            const pyramidContainer = document.querySelector('.pyramid-canvas-container');
            pyramidCanvas.width = pyramidContainer.clientWidth;
            pyramidCanvas.height = pyramidContainer.clientHeight;
            appState.pyramidCanvas = pyramidCanvas;
            appState.pyramidCtx = pyramidCanvas.getContext('2d');
            
            // Ecosystem canvas
            const ecosystemCanvas = document.getElementById('ecosystemCanvas');
            const ecosystemContainer = document.querySelector('.ecosystem-container');
            ecosystemCanvas.width = ecosystemContainer.clientWidth;
            ecosystemCanvas.height = ecosystemContainer.clientHeight;
            appState.ecosystemCanvas = ecosystemCanvas;
            appState.ecosystemCtx = ecosystemCanvas.getContext('2d');
        }

        // Show food chain
        window.showChain = function(chain) {
            appState.currentChain = chain;
            
            // Update active button
            const chainBtns = document.querySelectorAll('.chain-btn');
            chainBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawFoodChain();
        };

        // Draw food chain
        function drawFoodChain() {
            const ctx = appState.chainCtx;
            const canvas = appState.chainCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentChain === 'grassland') title = "Grassland Food Chain";
            else if (appState.currentChain === 'forest') title = "Forest Food Chain";
            else if (appState.currentChain === 'aquatic') title = "Aquatic Food Chain";
            else title = "Desert Food Chain";
            
            ctx.fillText(title, width/2, 20);
            
            const chain = foodChains[appState.currentChain];
            
            // Draw chain elements
            const elementWidth = 80;
            const elementHeight = 60;
            const startY = 60;
            const spacing = 100;
            
            chain.forEach((organism, index) => {
                const x = width/2 - elementWidth/2;
                const y = startY + (index * spacing);
                
                // Draw organism box
                ctx.fillStyle = organism.color;
                ctx.fillRect(x, y, elementWidth, elementHeight);
                ctx.strokeStyle = '#FFFFFF';
                ctx.strokeRect(x, y, elementWidth, elementHeight);
                
                // Draw organism name
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(organism.name, x + elementWidth/2, y + 25);
                
                // Draw organism type
                ctx.font = '10px Arial';
                ctx.fillText(organism.type, x + elementWidth/2, y + 40);
                
                // Draw trophic level
                ctx.fillStyle = '#FFC107';
                ctx.font = 'bold 14px Arial';
                ctx.fillText(`T${organism.trophic}`, x + elementWidth/2, y + 55);
                
                // Store organism position for click detection
                organism.x = x;
                organism.y = y;
                organism.width = elementWidth;
                organism.height = elementHeight;
                
                // Draw arrow to next level (except for last organism)
                if (index < chain.length - 1) {
                    ctx.strokeStyle = '#4CAF50';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(x + elementWidth/2, y + elementHeight);
                    ctx.lineTo(x + elementWidth/2, y + spacing - 10);
                    ctx.stroke();
                    
                    // Draw arrowhead
                    ctx.fillStyle = '#4CAF50';
                    ctx.beginPath();
                    ctx.moveTo(x + elementWidth/2 - 5, y + spacing - 15);
                    ctx.lineTo(x + elementWidth/2, y + spacing - 5);
                    ctx.lineTo(x + elementWidth/2 + 5, y + spacing - 15);
                    ctx.closePath();
                    ctx.fill();
                }
            });
            
            // Add click event listener to canvas
            canvas.onclick = function(event) {
                const rect = canvas.getBoundingClientRect();
                const clickX = event.clientX - rect.left;
                const clickY = event.clientY - rect.top;
                
                // Check if clicked on an organism
                const clickedOrganism = chain.find(organism => 
                    clickX >= organism.x && clickX <= organism.x + organism.width &&
                    clickY >= organism.y && clickY <= organism.y + organism.height
                );
                
                if (clickedOrganism) {
                    showOrganismInfo(clickedOrganism);
                }
            };
        }

        // Show organism info
        function showOrganismInfo(organism) {
            organismName.textContent = organism.name;
            organismType.textContent = organism.type;
            trophicLevel.textContent = `Trophic Level ${organism.trophic}`;
            
            // Create description
            let description = "";
            if (organism.type === "Producer") {
                description = "Produces its own food through photosynthesis. Forms the base of the food chain.";
            } else if (organism.type === "Primary Consumer") {
                description = "Herbivore that eats producers. First level of consumers.";
            } else if (organism.type === "Secondary Consumer") {
                description = "Carnivore that eats primary consumers. Second level of consumers.";
            } else {
                description = "Top carnivore that eats secondary consumers. Apex predator.";
            }
            
            description += `\nEnergy received: ${Math.pow(0.1, organism.trophic-1) * 100}% of original sunlight energy`;
            
            organismDescription.textContent = description;
            organismInfo.classList.add('show');
        }

        // Show energy flow
        window.showEnergyFlow = function() {
            alert("Energy Flow in Food Chains:\n\n" +
                  "1. Sun provides energy (100%)\n" +
                  "2. Producers capture ~1% of sunlight\n" +
                  "3. Primary consumers get ~10% of producer energy\n" +
                  "4. Secondary consumers get ~10% of primary consumer energy\n" +
                  "5. Tertiary consumers get ~10% of secondary consumer energy\n\n" +
                  "90% of energy is lost at each transfer as heat, waste, and life processes.");
        };

        // Show trophic levels
        window.showTrophicLevels = function() {
            alert("Trophic Levels:\n\n" +
                  "T1: Producers (plants, algae)\n" +
                  "T2: Primary Consumers (herbivores)\n" +
                  "T3: Secondary Consumers (carnivores)\n" +
                  "T4: Tertiary Consumers (top carnivores)\n" +
                  "T5+: Quaternary Consumers (rare)\n\n" +
                  "Decomposers operate at all levels, breaking down dead organisms.");
        };

        // Animate chain
        window.animateChain = function() {
            // In a full implementation, this would animate energy flow
            alert("Animating Energy Flow!\n\n" +
                  "Energy flows from:\n" +
                  "Sun ‚Üí Producers ‚Üí Primary Consumers ‚Üí Secondary Consumers ‚Üí Tertiary Consumers\n\n" +
                  "Notice how energy decreases at each step!");
        };

        // Reset chain
        window.resetChain = function() {
            drawFoodChain();
        };

        // Show food web
        window.showWeb = function(web) {
            appState.currentWeb = web;
            
            // Update active button
            const webBtns = document.querySelectorAll('.web-btn');
            webBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawFoodWeb();
        };

        // Draw food web
        function drawFoodWeb() {
            const ctx = appState.webCtx;
            const canvas = appState.webCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentWeb === 'grassland') title = "Grassland Food Web";
            else if (appState.currentWeb === 'forest') title = "Forest Food Web";
            else if (appState.currentWeb === 'pond') title = "Pond Food Web";
            else title = "Ocean Food Web";
            
            ctx.fillText(title, width/2, 20);
            
            // Get web data
            const web = foodWebs[appState.currentWeb] || foodWebs.grassland;
            
            // Scale positions to fit canvas
            const scaleX = width / 200;
            const scaleY = height / 300;
            
            // Draw connections first (so they're behind organisms)
            ctx.strokeStyle = 'rgba(76, 175, 80, 0.5)';
            ctx.lineWidth = 1;
            
            web.connections.forEach(connection => {
                const org1 = web.organisms.find(o => o.name === connection[0]);
                const org2 = web.organisms.find(o => o.name === connection[1]);
                
                if (org1 && org2) {
                    ctx.beginPath();
                    ctx.moveTo(org1.x * scaleX, org1.y * scaleY);
                    ctx.lineTo(org2.x * scaleX, org2.y * scaleY);
                    ctx.stroke();
                }
            });
            
            // Draw organisms
            web.organisms.forEach(organism => {
                const x = organism.x * scaleX;
                const y = organism.y * scaleY;
                
                // Set color based on type
                if (organism.type === 'producer') ctx.fillStyle = '#4CAF50';
                else if (organism.type === 'primary') ctx.fillStyle = '#2196F3';
                else if (organism.type === 'secondary') ctx.fillStyle = '#FF9800';
                else ctx.fillStyle = '#795548';
                
                // Draw organism circle
                ctx.beginPath();
                ctx.arc(x, y, 20, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#FFFFFF';
                ctx.stroke();
                
                // Draw organism name
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '10px Arial';
                ctx.textAlign = 'center';
                
                // Split long names
                if (organism.name.length > 8) {
                    const parts = organism.name.split(' ');
                    if (parts.length > 1) {
                        ctx.fillText(parts[0], x, y - 5);
                        ctx.fillText(parts[1], x, y + 5);
                    } else {
                        ctx.fillText(organism.name.substring(0, 8), x, y);
                    }
                } else {
                    ctx.fillText(organism.name, x, y + 3);
                }
                
                // Store organism position
                organism.displayX = x;
                organism.displayY = y;
                organism.radius = 20;
            });
            
            // Draw legend
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '10px Arial';
            ctx.textAlign = 'left';
            
            const legendItems = [
                { color: '#4CAF50', label: 'Producers' },
                { color: '#2196F3', label: 'Primary Consumers' },
                { color: '#FF9800', label: 'Secondary Consumers' },
                { color: '#795548', label: 'Tertiary Consumers' }
            ];
            
            legendItems.forEach((item, index) => {
                ctx.fillStyle = item.color;
                ctx.fillRect(width - 100, 40 + index * 20, 10, 10);
                ctx.fillStyle = '#FFFFFF';
                ctx.fillText(item.label, width - 85, 48 + index * 20);
            });
        }

        // Show interconnections
        window.showInterconnections = function() {
            alert("Food Web Interconnections:\n\n" +
                  "‚Ä¢ Multiple feeding relationships\n" +
                  "‚Ä¢ Organisms can occupy different trophic levels\n" +
                  "‚Ä¢ Provides stability - if one species declines, others can fill its role\n" +
                  "‚Ä¢ Shows biodiversity importance\n\n" +
                  "More connections = More stable ecosystem");
        };

        // Remove species
        window.removeSpecies = function() {
            alert("Removing a species from a food web:\n\n" +
                  "‚Ä¢ Can cause population changes in connected species\n" +
                  "‚Ä¢ May lead to overpopulation of prey species\n" +
                  "‚Ä¢ Could cause extinction of dependent species\n" +
                  "‚Ä¢ Shows importance of biodiversity conservation\n\n" +
                  "Keystone species removal can collapse entire ecosystems!");
        };

        // Add species
        window.addSpecies = function() {
            alert("Adding a species (like invasive species):\n\n" +
                  "‚Ä¢ Can disrupt existing food webs\n" +
                  "‚Ä¢ May outcompete native species\n" +
                  "‚Ä¢ Could cause extinctions\n" +
                  "‚Ä¢ Shows importance of ecosystem balance\n\n" +
                  "Example: Introduction of rabbits to Australia disrupted ecosystems.");
        };

        // Show keystone species
        window.showKeystone = function() {
            alert("Keystone Species:\n\n" +
                  "‚Ä¢ Have disproportionately large effects on ecosystems\n" +
                  "‚Ä¢ Their removal causes major changes\n" +
                  "‚Ä¢ Examples: Sea otters, wolves, bees\n" +
                  "‚Ä¢ Help maintain biodiversity\n\n" +
                  "Sea otters eat sea urchins, which eat kelp. No otters = no kelp forests = no habitat for many species.");
        };

        // Animate web
        window.animateWeb = function() {
            alert("Animating Food Web!\n\n" +
                  "Showing energy flow through multiple pathways.\n" +
                  "Demonstrating how ecosystems are interconnected.\n" +
                  "Highlighting predator-prey relationships.\n\n" +
                  "Food webs are more realistic than simple food chains!");
        };

        // Show balance cycle
        window.showBalance = function(balance) {
            appState.currentBalance = balance;
            
            // Update active button
            const balanceBtns = document.querySelectorAll('.balance-btn');
            balanceBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawBalanceCycle();
        };

        // Draw balance cycle
        function drawBalanceCycle() {
            const ctx = appState.balanceCtx;
            const canvas = appState.balanceCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentBalance === 'carbon') title = "Carbon Cycle";
            else if (appState.currentBalance === 'water') title = "Water Cycle";
            else if (appState.currentBalance === 'nitrogen') title = "Nitrogen Cycle";
            else if (appState.currentBalance === 'population') title = "Population Balance";
            else if (appState.currentBalance === 'predatorPrey') title = "Predator-Prey Relationship";
            else title = "Carrying Capacity";
            
            ctx.fillText(title, width/2, 20);
            
            // Draw based on selected cycle
            if (appState.currentBalance === 'carbon') {
                drawCarbonCycle(ctx, width, height);
            } else if (appState.currentBalance === 'water') {
                drawWaterCycle(ctx, width, height);
            } else if (appState.currentBalance === 'population') {
                drawPopulationBalance(ctx, width, height);
            }
            
            // Draw description
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Click "Run Cycle" to see it in action!', width/2, height - 20);
        }

        function drawCarbonCycle(ctx, width, height) {
            const centerX = width/2;
            const centerY = height/2;
            const radius = Math.min(width, height)/3;
            
            // Draw atmosphere
            ctx.fillStyle = 'rgba(33, 150, 243, 0.3)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Atmosphere (CO‚ÇÇ)', centerX, centerY - radius/2);
            
            // Draw plants
            ctx.fillStyle = '#4CAF50';
            ctx.beginPath();
            ctx.arc(centerX - radius/2, centerY + radius/2, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Plants', centerX - radius/2, centerY + radius/2 + 35);
            
            // Draw animals
            ctx.fillStyle = '#FF9800';
            ctx.beginPath();
            ctx.arc(centerX + radius/2, centerY + radius/2, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Animals', centerX + radius/2, centerY + radius/2 + 35);
            
            // Draw arrows
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 2;
            
            // Photosynthesis: CO‚ÇÇ ‚Üí Plants
            drawArrow(ctx, centerX, centerY - radius/3, centerX - radius/2, centerY + radius/2 - 20);
            ctx.fillStyle = '#4CAF50';
            ctx.fillText('Photosynthesis', centerX - 20, centerY + 10);
            
            // Respiration: Plants ‚Üí CO‚ÇÇ
            drawArrow(ctx, centerX - radius/2 + 20, centerY + radius/2, centerX, centerY - radius/3);
            ctx.fillText('Respiration', centerX - 60, centerY + 50);
            
            // Consumption: Plants ‚Üí Animals
            drawArrow(ctx, centerX - radius/2 + 20, centerY + radius/2, centerX + radius/2 - 20, centerY + radius/2);
            ctx.fillText('Consumption', centerX, centerY + radius/2 + 20);
            
            // Respiration: Animals ‚Üí CO‚ÇÇ
            drawArrow(ctx, centerX + radius/2, centerY + radius/2 - 20, centerX, centerY - radius/3);
            ctx.fillText('Respiration', centerX + 30, centerY + 50);
        }

        function drawWaterCycle(ctx, width, height) {
            // Draw ocean
            ctx.fillStyle = '#2196F3';
            ctx.fillRect(50, height - 100, width - 100, 50);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Ocean', width/2, height - 75);
            
            // Draw sun
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(width - 80, 60, 30, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw evaporation
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            drawArrow(ctx, width/2, height - 100, width - 80, 90);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Evaporation', width - 60, height - 120);
            
            // Draw clouds
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.arc(100, 80, 25, 0, Math.PI * 2);
            ctx.arc(130, 70, 30, 0, Math.PI * 2);
            ctx.arc(160, 80, 25, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw precipitation
            ctx.strokeStyle = '#2196F3';
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.moveTo(120 + i*10, 110);
                ctx.lineTo(120 + i*10, 150);
                ctx.stroke();
            }
            ctx.fillText('Precipitation', 120, 170);
            
            // Draw runoff
            ctx.strokeStyle = '#2196F3';
            drawArrow(ctx, 180, 150, 200, height - 100);
            ctx.fillText('Runoff', 190, height/2);
        }

        function drawPopulationBalance(ctx, width, height) {
            // Draw carrying capacity line
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(50, 100);
            ctx.lineTo(width - 50, 100);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#4CAF50';
            ctx.font = '12px Arial';
            ctx.fillText('Carrying Capacity', width - 100, 90);
            
            // Draw population growth curve
            ctx.strokeStyle = '#FF9800';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(50, height - 50);
            
            // S-curve for logistic growth
            for (let x = 50; x < width - 50; x += 5) {
                const t = (x - 50) / (width - 100);
                // Logistic function
                const y = height - 50 - (height - 150) / (1 + Math.exp(-10 * (t - 0.5)));
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            ctx.fillStyle = '#FF9800';
            ctx.fillText('Population Growth', width/2, height - 30);
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '10px Arial';
            ctx.fillText('Time ‚Üí', width/2, height - 10);
            ctx.save();
            ctx.translate(30, height/2);
            ctx.rotate(-Math.PI/2);
            ctx.fillText('Population Size', 0, 0);
            ctx.restore();
            
            // Draw phases
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '10px Arial';
            ctx.fillText('Lag Phase', 80, height - 80);
            ctx.fillText('Exponential Phase', width/2 - 30, height/2);
            ctx.fillText('Stationary Phase', width - 100, 120);
        }

        function drawArrow(ctx, fromX, fromY, toX, toY) {
            ctx.beginPath();
            ctx.moveTo(fromX, fromY);
            ctx.lineTo(toX, toY);
            ctx.stroke();
            
            // Draw arrowhead
            const angle = Math.atan2(toY - fromY, toX - fromX);
            ctx.beginPath();
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - 10 * Math.cos(angle - Math.PI/6), toY - 10 * Math.sin(angle - Math.PI/6));
            ctx.lineTo(toX - 10 * Math.cos(angle + Math.PI/6), toY - 10 * Math.sin(angle + Math.PI/6));
            ctx.closePath();
            ctx.fill();
        }

        // Run cycle
        window.runCycle = function() {
            alert(`Running ${appState.currentBalance} cycle...\n\n` +
                  "Carbon Cycle: Shows how carbon moves between atmosphere, plants, animals.\n" +
                  "Water Cycle: Shows evaporation, condensation, precipitation.\n" +
                  "Nitrogen Cycle: Shows nitrogen fixation, nitrification, denitrification.\n" +
                  "Population Balance: Shows growth until carrying capacity.\n" +
                  "Predator-Prey: Shows population cycles of predators and prey.\n" +
                  "Carrying Capacity: Shows maximum population environment can support.");
        };

        // Pause cycle
        window.pauseCycle = function() {
            alert("Cycle paused. Click 'Reset' to restart.");
        };

        // Reset cycle
        window.resetCycle = function() {
            drawBalanceCycle();
        };

        // Show energy pyramid
        window.showPyramid = function(pyramid) {
            appState.currentPyramid = pyramid;
            
            // Update active button
            const pyramidBtns = document.querySelectorAll('.pyramid-btn');
            pyramidBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawEnergyPyramid();
        };

        // Draw energy pyramid
        function drawEnergyPyramid() {
            const ctx = appState.pyramidCtx;
            const canvas = appState.pyramidCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentPyramid === 'numbers') title = "Numbers Pyramid";
            else if (appState.currentPyramid === 'biomass') title = "Biomass Pyramid";
            else if (appState.currentPyramid === 'energy') title = "Energy Pyramid";
            else if (appState.currentPyramid === 'grassland') title = "Grassland Energy Pyramid";
            else if (appState.currentPyramid === 'forest') title = "Forest Energy Pyramid";
            else title = "Aquatic Energy Pyramid";
            
            ctx.fillText(title, width/2, 20);
            
            // Draw pyramid
            const baseWidth = 200;
            const levelHeight = 60;
            const startY = 80;
            
            // Define levels based on pyramid type
            let levels = [];
            if (appState.currentPyramid === 'numbers') {
                levels = [
                    { label: "Producers: 1000 plants", color: "#4CAF50", width: baseWidth },
                    { label: "Primary Consumers: 100 rabbits", color: "#2196F3", width: baseWidth * 0.6 },
                    { label: "Secondary Consumers: 10 foxes", color: "#FF9800", width: baseWidth * 0.3 },
                    { label: "Tertiary Consumers: 1 eagle", color: "#795548", width: baseWidth * 0.1 }
                ];
            } else if (appState.currentPyramid === 'biomass') {
                levels = [
                    { label: "Producers: 1000 kg", color: "#4CAF50", width: baseWidth },
                    { label: "Primary Consumers: 100 kg", color: "#2196F3", width: baseWidth * 0.5 },
                    { label: "Secondary Consumers: 10 kg", color: "#FF9800", width: baseWidth * 0.2 },
                    { label: "Tertiary Consumers: 1 kg", color: "#795548", width: baseWidth * 0.05 }
                ];
            } else if (appState.currentPyramid === 'energy') {
                levels = [
                    { label: "Producers: 10,000 kJ", color: "#4CAF50", width: baseWidth },
                    { label: "Primary Consumers: 1,000 kJ", color: "#2196F3", width: baseWidth * 0.4 },
                    { label: "Secondary Consumers: 100 kJ", color: "#FF9800", width: baseWidth * 0.15 },
                    { label: "Tertiary Consumers: 10 kJ", color: "#795548", width: baseWidth * 0.05 }
                ];
            } else {
                // Default energy pyramid
                levels = [
                    { label: "Producers", color: "#4CAF50", width: baseWidth },
                    { label: "Primary Consumers", color: "#2196F3", width: baseWidth * 0.4 },
                    { label: "Secondary Consumers", color: "#FF9800", width: baseWidth * 0.15 },
                    { label: "Tertiary Consumers", color: "#795548", width: baseWidth * 0.05 }
                ];
            }
            
            // Draw pyramid levels
            levels.forEach((level, index) => {
                const levelWidth = level.width;
                const x = (width - levelWidth) / 2;
                const y = startY + (index * levelHeight);
                
                // Draw level
                ctx.fillStyle = level.color;
                ctx.fillRect(x, y, levelWidth, levelHeight - 10);
                ctx.strokeStyle = '#FFFFFF';
                ctx.strokeRect(x, y, levelWidth, levelHeight - 10);
                
                // Draw level label
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(level.label, width/2, y + (levelHeight/2));
                
                // Draw trophic level indicator
                ctx.fillStyle = '#FFC107';
                ctx.font = 'bold 14px Arial';
                ctx.fillText(`T${index + 1}`, width/2, y + levelHeight - 15);
            });
            
            // Draw 10% rule illustration
            if (appState.currentPyramid === 'energy') {
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText("Only 10% of energy transfers to next level", width/2, startY + (levels.length * levelHeight) + 20);
                
                // Draw energy loss arrows
                ctx.strokeStyle = '#FF5252';
                ctx.lineWidth = 2;
                for (let i = 0; i < levels.length - 1; i++) {
                    const y = startY + (i * levelHeight) + levelHeight - 5;
                    drawArrow(ctx, width/2, y, width/2, y + 15);
                    ctx.fillStyle = '#FF5252';
                    ctx.fillText("90% lost as heat", width/2 + 60, y + 10);
                }
            }
        }

        // Show energy loss
        window.showEnergyLoss = function() {
            alert("The 10% Rule (Energy Loss):\n\n" +
                  "‚Ä¢ Only about 10% of energy transfers between trophic levels\n" +
                  "‚Ä¢ 90% is lost as:\n" +
                  "  - Heat from metabolism\n" +
                  "  - Waste products\n" +
                  "  - Movement and life processes\n" +
                  "‚Ä¢ This limits food chain length (usually 3-5 levels)\n\n" +
                  "Example: 10,000 kJ sunlight ‚Üí 1,000 kJ plants ‚Üí 100 kJ rabbits ‚Üí 10 kJ foxes");
        };

        // Compare pyramids
        window.comparePyramids = function() {
            alert("Pyramid Types:\n\n" +
                  "1. Numbers Pyramid:\n" +
                  "   ‚Ä¢ Shows number of organisms\n" +
                  "   ‚Ä¢ Can be inverted (few producers, many parasites)\n\n" +
                  "2. Biomass Pyramid:\n" +
                  "   ‚Ä¢ Shows total mass of organisms\n" +
                  "   ‚Ä¢ Usually upright\n\n" +
                  "3. Energy Pyramid:\n" +
                  "   ‚Ä¢ Shows energy at each level\n" +
                  "   ‚Ä¢ Always upright (10% rule)\n   ‚Ä¢ Most accurate representation");
        };

        // Show role
        window.showRole = function(role) {
            const roles = {
                producer: "Producers (Autotrophs):\n‚Ä¢ Make their own food via photosynthesis\n‚Ä¢ Base of all food chains\n‚Ä¢ Examples: Plants, algae, phytoplankton",
                primaryConsumer: "Primary Consumers (Herbivores):\n‚Ä¢ Eat producers (plants)\n‚Ä¢ First level of consumers\n‚Ä¢ Examples: Rabbits, deer, grasshoppers",
                secondaryConsumer: "Secondary Consumers (Carnivores):\n‚Ä¢ Eat primary consumers\n‚Ä¢ Second level of consumers\n‚Ä¢ Examples: Foxes, frogs, small fish",
                tertiaryConsumer: "Tertiary Consumers (Top Carnivores):\n‚Ä¢ Eat secondary consumers\n‚Ä¢ Apex predators\n‚Ä¢ Examples: Hawks, sharks, lions",
                decomposer: "Decomposers:\n‚Ä¢ Break down dead organisms and waste\n‚Ä¢ Return nutrients to soil\n‚Ä¢ Examples: Fungi, bacteria",
                scavenger: "Scavengers:\n‚Ä¢ Eat dead animals they find\n‚Ä¢ Clean up ecosystems\n‚Ä¢ Examples: Vultures, hyenas, crabs",
                autotroph: "Autotrophs:\n‚Ä¢ 'Self-feeders'\n‚Ä¢ Make their own food\n‚Ä¢ Another name for producers",
                heterotroph: "Heterotrophs:\n‚Ä¢ 'Other-feeders'\n‚Ä¢ Cannot make their own food\n‚Ä¢ Includes all consumers"
            };
            
            if (roles[role]) {
                alert(roles[role]);
            }
        };

        // Compare roles
        window.compareRoles = function() {
            alert("Organism Roles Comparison:\n\n" +
                  "Producers vs Consumers:\n" +
                  "‚Ä¢ Producers: Make food (autotrophs)\n" +
                  "‚Ä¢ Consumers: Eat food (heterotrophs)\n\n" +
                  "Types of Consumers:\n" +
                  "‚Ä¢ Herbivores: Eat plants\n" +
                  "‚Ä¢ Carnivores: Eat animals\n" +
                  "‚Ä¢ Omnivores: Eat both\n" +
                  "‚Ä¢ Scavengers: Eat dead animals\n\n" +
                  "Decomposers: Essential for nutrient recycling!");
        };

        // Show adaptations
        window.showAdaptations = function() {
            alert("Ecological Adaptations:\n\n" +
                  "Predator Adaptations:\n" +
                  "‚Ä¢ Sharp teeth/claws\n" +
                  "‚Ä¢ Camouflage\n" +
                  "‚Ä¢ Speed/agility\n\n" +
                  "Prey Adaptations:\n" +
                  "‚Ä¢ Protective shells\n" +
                  "‚Ä¢ Warning colors\n" +
                  "‚Ä¢ Mimicry\n" +
                  "‚Ä¢ Herding behavior\n\n" +
                  "Plant Adaptations:\n" +
                  "‚Ä¢ Thorns/spines\n" +
                  "‚Ä¢ Poisonous chemicals\n" +
                  "‚Ä¢ Deep roots for dry climates");
        };

        // Run simulation
        window.runSimulation = function(simulation) {
            appState.currentSimulation = simulation;
            
            // Update active button
            const ecosystemBtns = document.querySelectorAll('.ecosystem-btn');
            ecosystemBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawEcosystemSimulation();
        };

        // Draw ecosystem simulation
        function drawEcosystemSimulation() {
            const ctx = appState.ecosystemCtx;
            const canvas = appState.ecosystemCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentSimulation === 'predatorPrey') title = "Predator-Prey Population Cycles";
            else if (appState.currentSimulation === 'population') title = "Population Growth Simulation";
            else if (appState.currentSimulation === 'competition') title = "Species Competition";
            else if (appState.currentSimulation === 'invasive') title = "Invasive Species Impact";
            else if (appState.currentSimulation === 'pollution') title = "Pollution Impact on Ecosystems";
            else title = "Conservation Success Story";
            
            ctx.fillText(title, width/2, 20);
            
            // Draw simulation based on type
            if (appState.currentSimulation === 'predatorPrey') {
                drawPredatorPreySimulation(ctx, width, height);
            } else if (appState.currentSimulation === 'population') {
                drawPopulationSimulation(ctx, width, height);
            } else {
                // Generic ecosystem visualization
                ctx.fillStyle = '#4CAF50';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Click "Run Simulation" to see dynamic ecosystem changes!', width/2, height/2);
                
                // Draw simple ecosystem
                // Draw plants
                ctx.fillStyle = '#4CAF50';
                for (let i = 0; i < 5; i++) {
                    const x = 50 + i * 40;
                    const y = 100;
                    ctx.beginPath();
                    ctx.arc(x, y, 15, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Draw herbivores
                ctx.fillStyle = '#2196F3';
                for (let i = 0; i < 3; i++) {
                    const x = 70 + i * 60;
                    const y = 150;
                    ctx.beginPath();
                    ctx.arc(x, y, 12, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Draw carnivores
                ctx.fillStyle = '#FF9800';
                for (let i = 0; i < 2; i++) {
                    const x = 100 + i * 80;
                    const y = 200;
                    ctx.beginPath();
                    ctx.arc(x, y, 15, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // Draw description
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Click different simulations to see ecosystem dynamics!', width/2, height - 30);
        }

        function drawPredatorPreySimulation(ctx, width, height) {
            // Draw population graph
            const graphX = 50;
            const graphY = 60;
            const graphWidth = width - 100;
            const graphHeight = height - 100;
            
            // Draw axes
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(graphX, graphY);
            ctx.lineTo(graphX, graphY + graphHeight);
            ctx.lineTo(graphX + graphWidth, graphY + graphHeight);
            ctx.stroke();
            
            // Draw axis labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Population', graphX - 40, graphY + graphHeight/2);
            ctx.save();
            ctx.translate(graphX + graphWidth/2, graphY + graphHeight + 20);
            ctx.fillText('Time', 0, 0);
            ctx.restore();
            
            // Draw predator-prey cycle curves
            const timeSteps = 100;
            const preyPoints = [];
            const predatorPoints = [];
            
            // Generate predator-prey cycle data (Lotka-Volterra equations)
            for (let i = 0; i < timeSteps; i++) {
                const t = i / 10;
                // Simplified cyclic functions
                const prey = 50 + 40 * Math.sin(t);
                const predator = 30 + 20 * Math.cos(t - 1); // Phase shift
                
                const x = graphX + (i / timeSteps) * graphWidth;
                const preyY = graphY + graphHeight - (prey / 100) * graphHeight;
                const predatorY = graphY + graphHeight - (predator / 100) * graphHeight;
                
                preyPoints.push({x, y: preyY});
                predatorPoints.push({x, y: predatorY});
            }
            
            // Draw prey curve (green)
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(preyPoints[0].x, preyPoints[0].y);
            for (let i = 1; i < preyPoints.length; i++) {
                ctx.lineTo(preyPoints[i].x, preyPoints[i].y);
            }
            ctx.stroke();
            
            // Draw predator curve (orange)
            ctx.strokeStyle = '#FF9800';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(predatorPoints[0].x, predatorPoints[0].y);
            for (let i = 1; i < predatorPoints.length; i++) {
                ctx.lineTo(predatorPoints[i].x, predatorPoints[i].y);
            }
            ctx.stroke();
            
            // Draw legend
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(graphX + graphWidth - 100, graphY, 10, 10);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Prey (e.g., rabbits)', graphX + graphWidth - 85, graphY + 8);
            
            ctx.fillStyle = '#FF9800';
            ctx.fillRect(graphX + graphWidth - 100, graphY + 20, 10, 10);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Predators (e.g., foxes)', graphX + graphWidth - 85, graphY + 28);
            
            // Draw explanation
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Predator populations follow prey populations with a delay', width/2, height - 20);
        }

        function drawPopulationSimulation(ctx, width, height) {
            // Draw exponential vs logistic growth comparison
            const graphX = 50;
            const graphY = 60;
            const graphWidth = width - 100;
            const graphHeight = height - 100;
            
            // Draw axes
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(graphX, graphY);
            ctx.lineTo(graphX, graphY + graphHeight);
            ctx.lineTo(graphX + graphWidth, graphY + graphHeight);
            ctx.stroke();
            
            // Draw carrying capacity line
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(graphX, graphY + 50);
            ctx.lineTo(graphX + graphWidth, graphY + 50);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#4CAF50';
            ctx.font = '12px Arial';
            ctx.fillText('Carrying Capacity', graphX + graphWidth - 80, graphY + 45);
            
            // Draw exponential growth curve (red)
            ctx.strokeStyle = '#F44336';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(graphX, graphY + graphHeight);
            
            for (let i = 0; i < graphWidth; i += 5) {
                const x = graphX + i;
                // Exponential growth
                const y = graphY + graphHeight - Math.min(graphHeight - 50, i * 0.5);
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Draw logistic growth curve (blue)
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(graphX, graphY + graphHeight);
            
            for (let i = 0; i < graphWidth; i += 5) {
                const x = graphX + i;
                // Logistic growth (S-curve)
                const t = i / graphWidth;
                const y = graphY + graphHeight - (graphHeight - 50) / (1 + Math.exp(-10 * (t - 0.5)));
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Draw legend
            ctx.fillStyle = '#F44336';
            ctx.fillRect(graphX + graphWidth - 100, graphY, 10, 10);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Exponential Growth (unlimited)', graphX + graphWidth - 85, graphY + 8);
            
            ctx.fillStyle = '#2196F3';
            ctx.fillRect(graphX + graphWidth - 100, graphY + 20, 10, 10);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Logistic Growth (realistic)', graphX + graphWidth - 85, graphY + 28);
            
            // Draw explanation
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Real populations grow logistically, limited by carrying capacity', width/2, height - 20);
        }

        // Pause simulation
        window.pauseSimulation = function() {
            alert("Simulation paused. Click 'Reset' to restart.");
        };

        // Reset simulation
        window.resetSimulation = function() {
            drawEcosystemSimulation();
        };

        // Show more examples
        window.showMoreExamples = function() {
            alert("More Ecology Examples:\n\n" +
                  "Food Chains:\n" +
                  "‚Ä¢ Algae ‚Üí Small fish ‚Üí Large fish ‚Üí Shark\n" +
                  "‚Ä¢ Leaves ‚Üí Caterpillar ‚Üí Bird ‚Üí Hawk\n\n" +
                  "Food Webs:\n" +
                  "‚Ä¢ Coral reef ecosystems (most complex)\n" +
                  "‚Ä¢ African savanna (many interconnected species)\n\n" +
                  "Keystone Species:\n" +
                  "‚Ä¢ Sea otters (maintain kelp forests)\n" +
                  "‚Ä¢ Wolves (control deer populations)\n" +
                  "‚Ä¢ Bees (pollinate many plants)");
        };

        // Test your knowledge
        window.testYourKnowledge = function() {
            alert("Quick Ecology Test:\n\n" +
                  "1. What trophic level are humans at? (Multiple - omnivores)\n" +
                  "2. Why are food webs more stable than food chains? (Multiple connections)\n" +
                  "3. What happens if all decomposers disappeared? (Nutrients wouldn't recycle)\n" +
                  "4. How does deforestation affect food webs? (Destroys habitats, reduces biodiversity)\n" +
                  "5. What's the difference between a habitat and a niche? (Habitat = where, niche = role)");
        };

        // Show more applications
        window.showMoreApplications = function() {
            alert("Real-World Ecology Applications:\n\n" +
                  "‚Ä¢ Agriculture: Understanding pest-predator relationships\n" +
                  "‚Ä¢ Fisheries: Managing fish populations sustainably\n" +
                  "‚Ä¢ Conservation: Protecting endangered species and habitats\n" +
                  "‚Ä¢ Urban Planning: Creating green spaces and wildlife corridors\n" +
                  "‚Ä¢ Climate Change: Understanding ecosystem responses\n" +
                  "‚Ä¢ Medicine: Discovering new drugs from plants and animals");
        };

        // Show environmental impact
        window.showEnvironmentalImpact = function() {
            alert("Human Environmental Impact:\n\n" +
                  "Negative Impacts:\n" +
                  "‚Ä¢ Deforestation destroys habitats\n" +
                  "‚Ä¢ Pollution harms organisms\n" +
                  "‚Ä¢ Overfishing disrupts aquatic food webs\n" +
                  "‚Ä¢ Climate change alters ecosystems\n\n" +
                  "Positive Actions:\n" +
                  "‚Ä¢ Conservation protects biodiversity\n" +
                  "‚Ä¢ Sustainable practices maintain balance\n" +
                  "‚Ä¢ Restoration ecology repairs damage\n" +
                  "‚Ä¢ Education promotes awareness");
        };

        // Load quiz question
        function loadQuizQuestion() {
            const quiz = quizQuestions[appState.quizIndex];
            quizQuestion.textContent = quiz.question;
            
            quizOptions.innerHTML = '';
            quiz.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.textContent = `${String.fromCharCode(65 + index)}) ${option}`;
                optionElement.onclick = () => checkQuizAnswer(optionElement, String.fromCharCode(65 + index));
                quizOptions.appendChild(optionElement);
            });
        }

        // Check quiz answer
        window.checkQuizAnswer = function(element, selectedAnswer) {
            const quiz = quizQuestions[appState.quizIndex];
            const options = quizOptions.querySelectorAll('.quiz-option');
            
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (opt.textContent.startsWith(quiz.answer + ')')) {
                    opt.classList.add('correct');
                }
            });
            
            if (selectedAnswer === quiz.answer) {
                element.classList.add('correct');
            } else {
                element.classList.add('incorrect');
            }
        };

        // Next quiz question
        window.nextQuizQuestion = function() {
            appState.quizIndex = (appState.quizIndex + 1) % quizQuestions.length;
            loadQuizQuestion();
        };

        // Topic information display
        window.showTopicInfo = function(topic) {
            let info = '';
            if (topic === 'food-chains') {
                info = "üîÑ Food Chains üîÑ\n\n";
                info += "Linear sequences showing who eats whom in an ecosystem.\n\n";
                info += "Key Facts:\n";
                info += "‚Ä¢ Show energy flow from producers to consumers\n";
                info += "‚Ä¢ Usually 3-5 trophic levels (limited by 10% rule)\n";
                info += "‚Ä¢ Always start with producers (plants/algae)\n";
                info += "‚Ä¢ Arrows show direction of energy flow\n";
                info += "‚Ä¢ Simplified models of feeding relationships\n\n";
                info += "Example: Grass ‚Üí Grasshopper ‚Üí Frog ‚Üí Snake ‚Üí Hawk";
            } else if (topic === 'food-webs') {
                info = "üï∏Ô∏è Food Webs üï∏Ô∏è\n\n";
                info += "Complex networks of interconnected food chains.\n\n";
                info += "Key Facts:\n";
                info += "‚Ä¢ More realistic than simple food chains\n";
                info += "‚Ä¢ Show multiple feeding relationships\n";
                info += "‚Ä¢ Provide ecosystem stability\n";
                info += "‚Ä¢ Demonstrate species interdependence\n";
                info += "‚Ä¢ Help understand biodiversity importance\n\n";
                info += "Shows how removal of one species affects many others.";
            } else {
                info = "‚öñÔ∏è Ecosystem Balance ‚öñÔ∏è\n\n";
                info += "Maintaining stability and health in natural systems.\n\n";
                info += "Key Concepts:\n";
                info += "‚Ä¢ Carrying capacity: Maximum population environment can support\n";
                info += "‚Ä¢ Biogeochemical cycles: Water, carbon, nitrogen cycles\n";
                info += "‚Ä¢ Predator-prey relationships: Population balance\n";
                info += "‚Ä¢ Human impacts: Both positive and negative\n";
                info += "‚Ä¢ Conservation: Protecting and restoring ecosystems\n\n";
                info += "Balance ensures long-term ecosystem health and biodiversity.";
            }
            alert(info);
        };

        // Initialize app
        window.addEventListener('DOMContentLoaded', initApp);
        
        // Handle window resize
        window.addEventListener('resize', function() {
            initializeCanvases();
            drawFoodChain();
            drawFoodWeb();
            drawBalanceCycle();
            drawEnergyPyramid();
            drawEcosystemSimulation();
        });
    </script>
</body>
</html>
