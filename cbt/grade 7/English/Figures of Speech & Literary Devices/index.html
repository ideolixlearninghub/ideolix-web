<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 7 English - Figures of Speech & Literary Devices | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Literary Theme */
        :root {
            --primary-blue: #2196F3;
            --secondary-teal: #009688;
            --accent-yellow: #FFEB3B;
            --accent-green: #4CAF50;
            --accent-orange: #FF9800;
            --accent-red: #F44336;
            --accent-purple: #9C27B0;
            --accent-indigo: #3F51B5;
            --accent-cyan: #00BCD4;
            --accent-pink: #E91E63;
            --accent-deeppurple: #673AB7;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --literary-glow: 0 0 20px rgba(156, 39, 176, 0.4);
            --figurative-glow: 0 0 20px rgba(33, 150, 243, 0.4);
            --device-glow: 0 0 20px rgba(255, 235, 59, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Literary Pattern Background */
        .literary-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(156, 39, 176, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(33, 150, 243, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 235, 59, 0.1) 0%, transparent 50%),
                repeating-linear-gradient(45deg, transparent 0px, transparent 5px, rgba(156, 39, 176, 0.05) 6px, transparent 7px),
                repeating-linear-gradient(-45deg, transparent 0px, transparent 5px, rgba(33, 150, 243, 0.05) 6px, transparent 7px);
            opacity: 0.3;
        }

        .floating-element {
            position: absolute;
            font-size: 3rem;
            font-weight: bold;
            animation: floatElement 25s linear infinite;
        }

        @keyframes floatElement {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-150px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-150px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(150px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--literary-glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--accent-purple), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(156, 39, 176, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--accent-purple);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--accent-purple);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
        }

        .btn-primary:hover {
            background: #7B1FA2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(156, 39, 176, 0.5);
        }

        .btn-secondary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        .btn-secondary:hover {
            background: #1976D2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--accent-purple);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--accent-purple), var(--primary-blue));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .literary-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-yellow);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--accent-purple), var(--primary-blue));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(33, 150, 243, 0.1);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--primary-blue);
            color: white;
        }

        .option.correct .option-letter {
            background: var(--accent-green);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 5px solid var(--accent-green);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--accent-green);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--accent-green);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Example Display */
        .example-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 25px;
            margin: 15px 0;
            border: 2px solid var(--accent-yellow);
            font-family: 'Georgia', serif;
            line-height: 1.8;
            max-height: 400px;
            overflow-y: auto;
        }

        .display-title {
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        /* Literary Concepts */
        .concepts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .literary-card {
            background: var(--dark-card);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            min-width: 200px;
            transition: transform 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .literary-card.figurative {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .literary-card.sound {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .literary-card.imagery {
            border-color: var(--accent-yellow);
            background: rgba(255, 235, 59, 0.1);
        }

        .literary-card:hover {
            transform: scale(1.05);
        }

        .literary-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .literary-card.figurative .literary-name {
            color: var(--accent-purple);
        }

        .literary-card.sound .literary-name {
            color: var(--primary-blue);
        }

        .literary-card.imagery .literary-name {
            color: var(--accent-yellow);
        }

        .literary-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        /* Device Visualization */
        .device-visualization {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-green);
        }

        .device-diagram {
            background: var(--dark-surface);
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--dark-border);
            position: relative;
        }

        .device-element {
            display: inline-block;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 6px;
            font-weight: bold;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .simile {
            background: rgba(33, 150, 243, 0.3);
            color: white;
            border: 2px solid var(--primary-blue);
        }

        .metaphor {
            background: rgba(156, 39, 176, 0.3);
            color: white;
            border: 2px solid var(--accent-purple);
        }

        .personification {
            background: rgba(76, 175, 80, 0.3);
            color: white;
            border: 2px solid var(--accent-green);
        }

        .hyperbole {
            background: rgba(255, 152, 0, 0.3);
            color: white;
            border: 2px solid var(--accent-orange);
        }

        .alliteration {
            background: rgba(244, 67, 54, 0.3);
            color: white;
            border: 2px solid var(--accent-red);
        }

        .device-element:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .analysis-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .analysis-button {
            padding: 8px 16px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-green);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .analysis-button:hover {
            background: rgba(76, 175, 80, 0.1);
            transform: translateY(-2px);
        }

        /* Device Types */
        .types-visualization {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-orange);
        }

        .types-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .type-box {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            min-width: 150px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .type-box.figurative {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .type-box.sound {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .type-box.imagery {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .type-box.structural {
            border-color: var(--accent-red);
            background: rgba(244, 67, 54, 0.1);
        }

        .type-box:hover {
            transform: translateY(-3px);
        }

        .type-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .type-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .type-box.figurative .type-name {
            color: var(--accent-purple);
        }

        .type-box.sound .type-name {
            color: var(--primary-blue);
        }

        .type-box.imagery .type-name {
            color: var(--accent-green);
        }

        .type-box.structural .type-name {
            color: var(--accent-red);
        }

        .type-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Literary Examples */
        .examples-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .examples-grid {
                grid-template-columns: 1fr;
            }
        }

        .example-box {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .example-box:hover {
            transform: translateY(-3px);
        }

        .example-box.simile {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .example-box.metaphor {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .example-box.personification {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .example-box.hyperbole {
            border-color: var(--accent-orange);
            background: rgba(255, 152, 0, 0.1);
        }

        .example-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .example-name {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .example-box.simile .example-name {
            color: var(--primary-blue);
        }

        .example-box.metaphor .example-name {
            color: var(--accent-purple);
        }

        .example-box.personification .example-name {
            color: var(--accent-green);
        }

        .example-box.hyperbole .example-name {
            color: var(--accent-orange);
        }

        .example-sentence {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-family: 'Georgia', serif;
            font-style: italic;
            margin-bottom: 10px;
        }

        /* Literary Table */
        .literary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .literary-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-yellow);
            border-bottom: 2px solid var(--accent-yellow);
        }

        .literary-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
            font-family: 'Georgia', serif;
        }

        .literary-table tr:hover {
            background: rgba(255, 235, 59, 0.05);
        }

        /* Interactive Practice */
        .interactive-practice {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-cyan);
        }

        .practice-title {
            color: var(--accent-cyan);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .practice-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .practice-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-cyan);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-button:hover {
            background: rgba(0, 188, 212, 0.1);
            transform: translateY(-2px);
        }

        .practice-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--accent-purple), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--accent-purple), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-purple);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Device Highlighting */
        .highlighted-device {
            background: rgba(255, 235, 59, 0.3);
            padding: 2px 4px;
            border-radius: 3px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .highlighted-device:hover {
            background: rgba(255, 235, 59, 0.5);
        }

        /* Device Categories */
        .device-category {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .category-figurative {
            background: rgba(156, 39, 176, 0.2);
            color: var(--accent-purple);
            border: 1px solid var(--accent-purple);
        }

        .category-sound {
            background: rgba(33, 150, 243, 0.2);
            color: var(--primary-blue);
            border: 1px solid var(--primary-blue);
        }

        .category-imagery {
            background: rgba(255, 235, 59, 0.2);
            color: var(--accent-yellow);
            border: 1px solid var(--accent-yellow);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .types-display {
                flex-direction: column;
            }
            
            .examples-grid {
                grid-template-columns: 1fr;
            }
            
            .device-diagram {
                flex-direction: column;
                padding: 15px;
            }
        }

        /* Literary Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes literaryFlow {
            0% { transform: translateX(-50px); background-color: rgba(156, 39, 176, 0.2); }
            50% { transform: translateX(0); background-color: rgba(156, 39, 176, 0.4); }
            100% { transform: translateX(50px); background-color: rgba(156, 39, 176, 0.2); }
        }
        
        .literary-flow {
            animation: literaryFlow 3s linear infinite;
        }
        
        @keyframes figurativeFlow {
            0% { transform: translateY(-50px); background-color: rgba(33, 150, 243, 0.2); }
            50% { transform: translateY(0); background-color: rgba(33, 150, 243, 0.4); }
            100% { transform: translateY(50px); background-color: rgba(33, 150, 243, 0.2); }
        }
        
        .figurative-flow {
            animation: figurativeFlow 3s linear infinite;
        }
        
        @keyframes deviceBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .device-bounce {
            animation: deviceBounce 2s ease-in-out infinite;
        }
        
        @keyframes literarySpin {
            0% { transform: rotate(0deg) translateY(0); }
            25% { transform: rotate(90deg) translateY(-10px); }
            50% { transform: rotate(180deg) translateY(0); }
            75% { transform: rotate(270deg) translateY(10px); }
            100% { transform: rotate(360deg) translateY(0); }
        }
        
        .literary-spin {
            animation: literarySpin 3s linear infinite;
        }
        
        @keyframes highlightPulse {
            0%, 100% { background-color: rgba(255, 235, 59, 0.3); }
            50% { background-color: rgba(255, 235, 59, 0.6); }
        }
        
        .highlight-pulse {
            animation: highlightPulse 1.5s ease infinite;
        }
        
        @keyframes textReveal {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .text-reveal {
            animation: textReveal 0.5s ease forwards;
        }
        
        @keyframes metaphorGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(156, 39, 176, 0.5); }
            50% { box-shadow: 0 0 20px rgba(156, 39, 176, 0.8); }
        }
        
        .metaphor-glow {
            animation: metaphorGlow 2s ease infinite;
        }
        
        @keyframes simileGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(33, 150, 243, 0.5); }
            50% { box-shadow: 0 0 20px rgba(33, 150, 243, 0.8); }
        }
        
        .simile-glow {
            animation: simileGlow 2s ease infinite;
        }
    </style>
</head>
<body>
    <!-- Literary Pattern Background -->
    <div class="literary-bg" id="literaryBg">
        <!-- Elements will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 7 English</h1>
            <p class="welcome-subtitle">Discover the magic of language! Learn to identify and understand figures of speech and literary devices. Master similes, metaphors, personification, alliteration, and more to analyze literature and improve your own creative writing!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üé≠‚ú®üìö</span>
                <span class="topic-name">Figures of Speech & Literary Devices</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Literary Journey</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 120</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0.8%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Literary fact display -->
                <div id="literaryFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <!-- Example Display Area -->
                        <div class="example-display" id="exampleDisplay"></div>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Literary Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const literaryBg = document.getElementById('literaryBg');
            
            // Create floating literary symbols
            const elements = ['üé≠', '‚ú®', 'üìö', 'üñãÔ∏è', 'üìñ', 'üí≠', 'üî§', 'üí°', 'üéØ', 'üìä', 'üåà', 'üåü', '‚ö°', 'üî•', 'üíß', 'üå™Ô∏è', 'üåä', 'üåô', '‚òÄÔ∏è', '‚≠ê'];
            
            for (let i = 0; i < 25; i++) {
                const element = document.createElement('div');
                element.className = 'floating-element';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = `${Math.random() * 100}%`;
                element.style.top = `${Math.random() * 100}%`;
                element.style.animationDelay = `${Math.random() * 20}s`;
                element.style.fontSize = `${2 + Math.random() * 3}rem`;
                
                // Color different types
                if (['üé≠', '‚ú®', 'üåü'].includes(element.textContent)) {
                    element.style.color = 'rgba(156, 39, 176, 0.1)'; // Purple for figurative
                } else if (['üñãÔ∏è', 'üìñ', 'üìö'].includes(element.textContent)) {
                    element.style.color = 'rgba(33, 150, 243, 0.1)'; // Blue for writing
                } else if (['üí°', 'üéØ', 'üî§'].includes(element.textContent)) {
                    element.style.color = 'rgba(255, 235, 59, 0.1)'; // Yellow for ideas
                } else {
                    element.style.color = 'rgba(156, 39, 176, 0.1)'; // Default purple
                }
                
                literaryBg.appendChild(element);
            }
        }

        // Literary examples for practice
        const literaryExamples = [
            {
                type: "simile",
                example: "Her smile was as bright as the sun.",
                explanation: "Compares smile to sun using 'as' - simile",
                category: "figurative",
                difficulty: "easy"
            },
            {
                type: "metaphor",
                example: "Time is a thief stealing our moments.",
                explanation: "Directly compares time to thief without 'like' or 'as' - metaphor",
                category: "figurative",
                difficulty: "medium"
            },
            {
                type: "personification",
                example: "The wind whispered secrets through the trees.",
                explanation: "Gives human quality (whispering) to wind - personification",
                category: "figurative",
                difficulty: "easy"
            },
            {
                type: "hyperbole",
                example: "I've told you a million times to clean your room!",
                explanation: "Exaggeration for effect - hyperbole",
                category: "figurative",
                difficulty: "easy"
            },
            {
                type: "alliteration",
                example: "Peter Piper picked a peck of pickled peppers.",
                explanation: "Repetition of initial 'p' sound - alliteration",
                category: "sound",
                difficulty: "easy"
            },
            {
                type: "onomatopoeia",
                example: "The bees buzzed angrily around the hive.",
                explanation: "Word imitates sound - onomatopoeia",
                category: "sound",
                difficulty: "medium"
            },
            {
                type: "oxymoron",
                example: "The silence was deafening in the empty hall.",
                explanation: "Contradictory terms together - oxymoron",
                category: "figurative",
                difficulty: "hard"
            },
            {
                type: "idiom",
                example: "It's raining cats and dogs outside!",
                explanation: "Figurative expression not meant literally - idiom",
                category: "figurative",
                difficulty: "medium"
            }
        ];

        // Questions array - 120+ Grade 7 Literary Devices questions
        const questions = [
            // Simile Basics (1-20)
            {
                type: "simile_basics",
                exampleId: 0,
                question: "What literary device is used in: 'Her smile was as bright as the sun'?",
                options: ["Simile", "Metaphor", "Personification", "Hyperbole"],
                answer: "A",
                explanation: "This is a simile because it compares two things using 'as'."
            },
            {
                type: "simile_basics",
                exampleId: 0,
                question: "What two things are being compared in this simile?",
                options: ["Smile and sun", "Bright and sun", "Her and smile", "Was and bright"],
                answer: "A",
                explanation: "The simile compares 'her smile' to 'the sun' using 'as bright as'."
            },
            {
                type: "simile_basics",
                exampleId: 0,
                question: "What word indicates this is a simile?",
                options: ["as", "bright", "was", "the"],
                answer: "A",
                explanation: "The word 'as' is used to make the comparison, indicating a simile."
            },
            // Metaphor Basics (21-40)
            {
                type: "metaphor_basics",
                exampleId: 1,
                question: "What literary device is used in: 'Time is a thief stealing our moments'?",
                options: ["Metaphor", "Simile", "Personification", "Alliteration"],
                answer: "A",
                explanation: "This is a metaphor because it directly compares time to a thief without using 'like' or 'as'."
            },
            {
                type: "metaphor_basics",
                exampleId: 1,
                question: "What is being compared to a thief in this metaphor?",
                options: ["Time", "Moments", "Stealing", "Our"],
                answer: "A",
                explanation: "Time is directly compared to a thief: 'Time is a thief'."
            },
            {
                type: "metaphor_basics",
                exampleId: 1,
                question: "How does this metaphor differ from a simile?",
                options: ["Doesn't use 'like' or 'as'", "Is shorter", "Uses exaggeration", "Is about people"],
                answer: "A",
                explanation: "Metaphors make direct comparisons without 'like' or 'as', while similes use these words."
            },
            // Personification Basics (41-60)
            {
                type: "personification_basics",
                exampleId: 2,
                question: "What literary device is used in: 'The wind whispered secrets through the trees'?",
                options: ["Personification", "Metaphor", "Simile", "Hyperbole"],
                answer: "A",
                explanation: "This is personification because it gives human quality (whispering) to the wind."
            },
            {
                type: "personification_basics",
                exampleId: 2,
                question: "What human quality is given to the wind?",
                options: ["Whispering", "Having secrets", "Moving through trees", "Being loud"],
                answer: "A",
                explanation: "The wind is described as 'whispered', which is a human action."
            },
            // Hyperbole Basics (61-80)
            {
                type: "hyperbole_basics",
                exampleId: 3,
                question: "What literary device is used in: 'I've told you a million times to clean your room'?",
                options: ["Hyperbole", "Metaphor", "Simile", "Personification"],
                answer: "A",
                explanation: "This is hyperbole because 'a million times' is an exaggeration for effect."
            },
            {
                type: "hyperbole_basics",
                exampleId: 3,
                question: "What makes this statement hyperbolic?",
                options: ["Exaggerated number", "Room cleaning", "Telling someone", "Use of 'I've'"],
                answer: "A",
                explanation: "'A million times' is an exaggerated number not meant to be taken literally."
            },
            // Alliteration Basics (81-100)
            {
                type: "alliteration_basics",
                exampleId: 4,
                question: "What literary device is used in: 'Peter Piper picked a peck of pickled peppers'?",
                options: ["Alliteration", "Onomatopoeia", "Simile", "Metaphor"],
                answer: "A",
                explanation: "This is alliteration because it repeats the initial 'p' sound."
            },
            {
                type: "alliteration_basics",
                exampleId: 4,
                question: "What sound is repeated in this example?",
                options: ["P sound", "E sound", "I sound", "R sound"],
                answer: "A",
                explanation: "Words begin with 'p': Peter, Piper, picked, peck, pickled, peppers."
            },
            // Onomatopoeia Basics (101-120)
            {
                type: "onomatopoeia_basics",
                exampleId: 5,
                question: "What literary device is used in: 'The bees buzzed angrily around the hive'?",
                options: ["Onomatopoeia", "Alliteration", "Personification", "Simile"],
                answer: "A",
                explanation: "This is onomatopoeia because 'buzzed' imitates the sound bees make."
            },
            {
                type: "onomatopoeia_basics",
                exampleId: 5,
                question: "What word imitates a sound in this example?",
                options: ["buzzed", "angrily", "around", "hive"],
                answer: "A",
                explanation: "'Buzzed' imitates the sound that bees make."
            },
            // Oxymoron Basics (121-140)
            {
                type: "oxymoron_basics",
                exampleId: 6,
                question: "What literary device is used in: 'The silence was deafening in the empty hall'?",
                options: ["Oxymoron", "Metaphor", "Hyperbole", "Simile"],
                answer: "A",
                explanation: "This is an oxymoron because 'deafening silence' combines contradictory ideas."
            },
            {
                type: "oxymoron_basics",
                exampleId: 6,
                question: "What contradictory terms are combined in this oxymoron?",
                options: ["Deafening and silence", "Empty and hall", "Was and in", "The and hall"],
                answer: "A",
                explanation: "'Deafening' (very loud) and 'silence' (absence of sound) are contradictory."
            },
            // Idiom Basics (141-160)
            {
                type: "idiom_basics",
                exampleId: 7,
                question: "What literary device is used in: 'It's raining cats and dogs outside'?",
                options: ["Idiom", "Metaphor", "Hyperbole", "Personification"],
                answer: "A",
                explanation: "This is an idiom - a figurative expression not meant literally."
            },
            {
                type: "idiom_basics",
                exampleId: 7,
                question: "What does this idiom actually mean?",
                options: ["It's raining heavily", "Animals are falling", "Pets are outside", "It's stormy with animals"],
                answer: "A",
                explanation: "The idiom 'raining cats and dogs' means it's raining very heavily."
            },
            // Mixed Identification (161-180)
            {
                type: "mixed_identification",
                exampleId: 0,
                question: "Which of these is an example of personification?",
                options: ["The moon smiled down on the sleeping town", "Her eyes were like stars", "He was a lion in battle", "I'm so hungry I could eat a horse"],
                answer: "A",
                explanation: "'The moon smiled' gives human action to the moon - personification."
            },
            {
                type: "mixed_identification",
                exampleId: 1,
                question: "Which of these is an example of a metaphor?",
                options: ["Life is a journey with many paths", "She sings like an angel", "The thunder roared angrily", "I've been waiting forever"],
                answer: "A",
                explanation: "'Life is a journey' directly compares without 'like' or 'as' - metaphor."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent literary analysis!",
            "Perfect device identification!",
            "Great figurative language understanding!",
            "You're a literary expert!",
            "Perfect metaphor recognition!",
            "You're a simile superstar!",
            "Outstanding literary device knowledge!",
            "Brilliant personification identification!",
            "You think like a poet!",
            "Literary mastery achieved!"
        ];

        // Literary facts
        const literaryFacts = [
            "Shakespeare invented over 1,700 words still used in English today!",
            "The word 'metaphor' comes from Greek meaning 'to transfer'!",
            "The longest simile in literature is 14 lines in James Joyce's 'Ulysses'!",
            "'Alliteration' is itself an example of alliteration!",
            "The first recorded use of personification dates back to ancient Greek literature!",
            "'Oxymoron' comes from Greek words meaning 'sharp-dull'!",
            "The most common simile in English is 'as cold as ice'!",
            "Hyperbole has been used in literature for over 2,000 years!"
        ];

        // Literary device categories
        const deviceCategories = [
            {
                category: "Figurative Language",
                description: "Uses words in non-literal ways to create effects",
                examples: ["Simile", "Metaphor", "Personification", "Hyperbole", "Idiom", "Oxymoron"]
            },
            {
                category: "Sound Devices",
                description: "Uses sound patterns for musical or rhythmic effects",
                examples: ["Alliteration", "Assonance", "Consonance", "Onomatopoeia", "Rhyme"]
            },
            {
                category: "Imagery Devices",
                description: "Creates vivid mental pictures through descriptive language",
                examples: ["Visual imagery", "Auditory imagery", "Tactile imagery", "Olfactory imagery", "Gustatory imagery"]
            },
            {
                category: "Structural Devices",
                description: "Organizes language in specific patterns or forms",
                examples: ["Repetition", "Parallelism", "Juxtaposition", "Irony", "Symbolism"]
            }
        ];

        // Detailed device explanations
        const deviceExplanations = [
            {
                device: "Simile",
                definition: "Comparison between two different things using 'like' or 'as'",
                purpose: "Creates vivid imagery and helps readers visualize comparisons",
                examples: ["Brave as a lion", "Light as a feather", "Fits like a glove"],
                keywords: ["like", "as", "than", "similar to"]
            },
            {
                device: "Metaphor",
                definition: "Direct comparison between two unlike things without 'like' or 'as'",
                purpose: "Creates powerful imagery and conveys abstract ideas concretely",
                examples: ["Time is money", "The world is a stage", "Her voice was music"],
                keywords: ["is", "was", "are", "were", "becomes"]
            },
            {
                device: "Personification",
                definition: "Giving human qualities to non-human things",
                purpose: "Makes descriptions more vivid and relatable",
                examples: ["The sun smiled down", "The wind whispered", "Opportunity knocked"],
                keywords: ["smiled", "whispered", "danced", "cried", "laughed"]
            },
            {
                device: "Hyperbole",
                definition: "Exaggeration for emphasis or effect",
                purpose: "Creates humor, emphasis, or dramatic effect",
                examples: ["I'm so hungry I could eat a horse", "I've told you a million times", "This bag weighs a ton"],
                keywords: ["million", "forever", "tons", "always", "never", "endless"]
            },
            {
                device: "Alliteration",
                definition: "Repetition of initial consonant sounds in nearby words",
                purpose: "Creates rhythm, musicality, and emphasis",
                examples: ["Peter Piper picked", "She sells seashells", "Big brown bear"],
                keywords: "Look for repeated initial sounds"
            },
            {
                device: "Onomatopoeia",
                definition: "Words that imitate the sounds they describe",
                purpose: "Creates vivid sensory experiences and sound effects",
                examples: ["Buzz", "Hiss", "Crash", "Boom", "Sizzle"],
                keywords: "Sound-imitating words"
            },
            {
                device: "Oxymoron",
                definition: "Combination of contradictory terms",
                purpose: "Creates dramatic effect and highlights contrasts",
                examples: ["Deafening silence", "Bittersweet", "Living dead", "Original copy"],
                keywords: "Contradictory pairs"
            },
            {
                device: "Idiom",
                definition: "Figurative expression with meaning different from literal words",
                purpose: "Adds cultural flavor and concise expression",
                examples: ["Break a leg", "Piece of cake", "Spill the beans", "Cost an arm and a leg"],
                keywords: "Common expressions not meant literally"
            }
        ];

        // Famous literary examples
        const famousExamples = [
            {
                device: "Simile",
                example: "My love is like a red, red rose",
                author: "Robert Burns",
                work: "A Red, Red Rose",
                analysis: "Compares love to a rose for beauty and freshness"
            },
            {
                device: "Metaphor",
                example: "All the world's a stage",
                author: "William Shakespeare",
                work: "As You Like It",
                analysis: "Compares world to stage, people to actors"
            },
            {
                device: "Personification",
                example: "Because I could not stop for Death, He kindly stopped for me",
                author: "Emily Dickinson",
                work: "Because I could not stop for Death",
                analysis: "Treats Death as a gentleman caller"
            },
            {
                device: "Hyperbole",
                example: "I had to wait in the station for ten days‚Äîan eternity",
                author: "Joseph Conrad",
                work: "Heart of Darkness",
                analysis: "Exaggerates waiting time for dramatic effect"
            },
            {
                device: "Alliteration",
                example: "From forth the fatal loins of these two foes",
                author: "William Shakespeare",
                work: "Romeo and Juliet",
                analysis: "Repeats 'f' sound for rhythmic emphasis"
            },
            {
                device: "Onomatopoeia",
                example: "The moan of doves in immemorial elms, And murmuring of innumerable bees",
                author: "Alfred Lord Tennyson",
                work: "Come Down, O Maid",
                analysis: "Uses sound words to create auditory imagery"
            }
        ];

        // Common mistakes and confusions
        const commonConfusions = [
            {
                pair: "Simile vs Metaphor",
                difference: "Simile uses 'like' or 'as', metaphor makes direct comparison",
                examples: {
                    simile: "Her eyes were like stars (uses 'like')",
                    metaphor: "Her eyes were stars (direct comparison)"
                }
            },
            {
                pair: "Hyperbole vs Metaphor",
                difference: "Hyperbole exaggerates, metaphor compares",
                examples: {
                    hyperbole: "This suitcase weighs a ton (exaggeration)",
                    metaphor: "This suitcase is an anchor (comparison)"
                }
            },
            {
                pair: "Personification vs Metaphor",
                difference: "Personification gives human traits, metaphor makes any comparison",
                examples: {
                    personification: "The flowers danced in the wind (human action)",
                    metaphor: "The flowers were dancers in the wind (comparison)"
                }
            },
            {
                pair: "Alliteration vs Assonance",
                difference: "Alliteration repeats consonants, assonance repeats vowels",
                examples: {
                    alliteration: "Peter Piper picked (repeats 'p')",
                    assonance: "The rain in Spain (repeats 'ai' sound)"
                }
            }
        ];

        // Real-world usage examples
        const realWorldExamples = [
            {
                context: "Advertising",
                example: "Melts in your mouth, not in your hands",
                device: "Juxtaposition/Contrast",
                analysis: "Creates memorable contrast to highlight product benefit"
            },
            {
                context: "Music Lyrics",
                example: "Her eyes were fireflies",
                device: "Metaphor",
                analysis: "Creates vivid, poetic imagery in song"
            },
            {
                context: "News Headlines",
                example: "Economy crashes as markets tumble",
                device: "Metaphor",
                analysis: "Uses dramatic language to emphasize severity"
            },
            {
                context: "Everyday Speech",
                example: "I'm so tired I could sleep for a week",
                device: "Hyperbole",
                analysis: "Exaggerates to express extreme fatigue"
            },
            {
                context: "Social Media",
                example: "This coffee is life!",
                device: "Metaphor",
                analysis: "Uses figurative language for emphasis and humor"
            }
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const exampleDisplay = document.getElementById('exampleDisplay');
        const literaryFact = document.getElementById('literaryFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Literary analysis state
        let literaryState = {
            currentExample: null,
            highlightedDevices: [],
            deviceAnalysis: null
        };

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade7Literary');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade7Literary', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade7Literary_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade7Literary_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a literary devices expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent figurative language skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing literary devices!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review similes, metaphors, and personification!";
            } else {
                scoreMessage.textContent = "Keep exploring! Literary devices make language creative and expressive!";
            }
        }

        // Create literary fact display
        function createLiteraryFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'literary-fact';
            
            factDiv.innerHTML = `<strong>Amazing Literary Fact:</strong> ${literaryFacts[Math.floor(Math.random() * literaryFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "simile_basics": "üîç",
                "metaphor_basics": "‚ú®",
                "personification_basics": "üë§",
                "hyperbole_basics": "üí•",
                "alliteration_basics": "üî§",
                "onomatopoeia_basics": "üîä",
                "oxymoron_basics": "üîÑ",
                "idiom_basics": "üí≠",
                "mixed_identification": "üéØ"
            };
            
            let conceptName = "Simile Basics";
            let conceptIcon = "üîç";
            
            if (question.type.includes("simile_basics")) {
                conceptName = "Simile";
                conceptIcon = conceptIcons.simile_basics;
            } else if (question.type.includes("metaphor_basics")) {
                conceptName = "Metaphor";
                conceptIcon = conceptIcons.metaphor_basics;
            } else if (question.type.includes("personification_basics")) {
                conceptName = "Personification";
                conceptIcon = conceptIcons.personification_basics;
            } else if (question.type.includes("hyperbole_basics")) {
                conceptName = "Hyperbole";
                conceptIcon = conceptIcons.hyperbole_basics;
            } else if (question.type.includes("alliteration_basics")) {
                conceptName = "Alliteration";
                conceptIcon = conceptIcons.alliteration_basics;
            } else if (question.type.includes("onomatopoeia_basics")) {
                conceptName = "Onomatopoeia";
                conceptIcon = conceptIcons.onomatopoeia_basics;
            } else if (question.type.includes("oxymoron_basics")) {
                conceptName = "Oxymoron";
                conceptIcon = conceptIcons.oxymoron_basics;
            } else if (question.type.includes("idiom_basics")) {
                conceptName = "Idiom";
                conceptIcon = conceptIcons.idiom_basics;
            } else if (question.type.includes("mixed_identification")) {
                conceptName = "Mixed Identification";
                conceptIcon = conceptIcons.mixed_identification;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("simile_basics")) {
                label.textContent = "Comparison using 'like' or 'as'";
            } else if (question.type.includes("metaphor_basics")) {
                label.textContent = "Direct comparison without 'like' or 'as'";
            } else if (question.type.includes("personification_basics")) {
                label.textContent = "Giving human qualities to non-human things";
            } else if (question.type.includes("hyperbole_basics")) {
                label.textContent = "Exaggeration for emphasis or effect";
            } else if (question.type.includes("alliteration_basics")) {
                label.textContent = "Repetition of initial consonant sounds";
            } else if (question.type.includes("onomatopoeia_basics")) {
                label.textContent = "Words that imitate sounds";
            } else if (question.type.includes("oxymoron_basics")) {
                label.textContent = "Combination of contradictory terms";
            } else if (question.type.includes("idiom_basics")) {
                label.textContent = "Figurative expressions not meant literally";
            } else if (question.type.includes("mixed_identification")) {
                label.textContent = "Identifying different literary devices";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create literary concepts visualization
        function createLiteraryConcepts() {
            const conceptsDiv = document.createElement('div');
            
            conceptsDiv.innerHTML = `
                <div class="concepts-container">
                    <div class="literary-card figurative literary-flow" onclick="showLiteraryDetails('Figurative Language')">
                        <div class="literary-icon">‚ú®</div>
                        <div class="literary-name">Figurative</div>
                        <div class="literary-description" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Beyond Literal Meaning
                        </div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">
                            Simile, Metaphor, Personification
                        </div>
                    </div>
                    <div class="literary-card sound figurative-flow" onclick="showLiteraryDetails('Sound Devices')">
                        <div class="literary-icon">üîä</div>
                        <div class="literary-name">Sound</div>
                        <div class="literary-description" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Musical Language Effects
                        </div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">
                            Alliteration, Onomatopoeia
                        </div>
                    </div>
                    <div class="literary-card imagery literary-spin" onclick="showLiteraryDetails('Imagery Devices')">
                        <div class="literary-icon">üé®</div>
                        <div class="literary-name">Imagery</div>
                        <div class="literary-description" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Creating Mental Pictures
                        </div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">
                            Sensory Descriptions
                        </div>
                    </div>
                </div>
            `;
            
            return conceptsDiv;
        }

        // Create example display with highlighted devices
        function createExampleDisplay(exampleId) {
            const example = literaryExamples[exampleId];
            const exampleDiv = document.createElement('div');
            exampleDiv.className = 'example-display';
            
            // Add device category badge
            const categoryBadge = document.createElement('div');
            categoryBadge.className = `device-category category-${example.category}`;
            categoryBadge.textContent = example.category === "figurative" ? "‚ú® Figurative Language" : 
                                       example.category === "sound" ? "üîä Sound Device" : "üé® Imagery Device";
            
            // Add title
            const title = document.createElement('div');
            title.style.cssText = 'font-size: 1.3rem; font-weight: bold; margin: 10px 0; color: var(--accent-yellow);';
            title.textContent = `${getDeviceEmoji(example.type)} ${example.type.toUpperCase()}`;
            
            // Create content element
            const contentDiv = document.createElement('div');
            contentDiv.style.cssText = 'margin-top: 15px; line-height: 1.8; font-size: 1.3rem; font-family: "Georgia", serif; font-style: italic; text-align: center;';
            contentDiv.textContent = `"${example.example}"`;
            
            // Add analysis
            const analysisDiv = document.createElement('div');
            analysisDiv.style.cssText = 'margin-top: 20px; padding: 15px; background: rgba(156, 39, 176, 0.1); border-radius: 8px; border-left: 3px solid var(--accent-purple);';
            analysisDiv.innerHTML = `
                <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px;">How to Identify:</div>
                <div style="color: var(--text-secondary);">
                    ‚Ä¢ Look for: ${getIdentificationTips(example.type)}<br>
                    ‚Ä¢ Purpose: ${getDevicePurpose(example.type)}<br>
                    ‚Ä¢ Effect: ${getDeviceEffect(example.type)}
                </div>
            `;
            
            // Assemble example display
            exampleDiv.appendChild(categoryBadge);
            exampleDiv.appendChild(title);
            exampleDiv.appendChild(contentDiv);
            exampleDiv.appendChild(analysisDiv);
            
            // Store current example for later use
            literaryState.currentExample = example;
            
            return exampleDiv;
        }

        // Helper function to get device emoji
        function getDeviceEmoji(deviceType) {
            const emojis = {
                "simile": "üîç",
                "metaphor": "‚ú®",
                "personification": "üë§",
                "hyperbole": "üí•",
                "alliteration": "üî§",
                "onomatopoeia": "üîä",
                "oxymoron": "üîÑ",
                "idiom": "üí≠"
            };
            return emojis[deviceType] || "üìù";
        }

        // Helper function to get identification tips
        function getIdentificationTips(deviceType) {
            const tips = {
                "simile": "'like' or 'as' comparisons",
                "metaphor": "direct comparisons without 'like' or 'as'",
                "personification": "human actions given to non-human things",
                "hyperbole": "extreme exaggeration",
                "alliteration": "repeated initial consonant sounds",
                "onomatopoeia": "words that imitate sounds",
                "oxymoron": "contradictory terms combined",
                "idiom": "common expressions not meant literally"
            };
            return tips[deviceType] || "characteristic patterns or words";
        }

        // Helper function to get device purpose
        function getDevicePurpose(deviceType) {
            const purposes = {
                "simile": "Create vivid comparisons and imagery",
                "metaphor": "Make powerful, direct comparisons",
                "personification": "Make descriptions relatable and vivid",
                "hyperbole": "Emphasize through exaggeration",
                "alliteration": "Create rhythm and musicality",
                "onomatopoeia": "Imitate real sounds",
                "oxymoron": "Highlight contrasts and create dramatic effect",
                "idiom": "Use concise, culturally-rich expressions"
            };
            return purposes[deviceType] || "Enhance language and meaning";
        }

        // Helper function to get device effect
        function getDeviceEffect(deviceType) {
            const effects = {
                "simile": "Helps readers visualize comparisons",
                "metaphor": "Creates strong, memorable imagery",
                "personification": "Makes abstract concepts concrete",
                "hyperbole": "Adds humor or dramatic emphasis",
                "alliteration": "Makes language musical and memorable",
                "onomatopoeia": "Creates sensory sound experiences",
                "oxymoron": "Grabs attention through contradiction",
                "idiom": "Adds color and cultural context"
            };
            return effects[deviceType] || "Enhances reader engagement";
        }

        // Create device visualization
        function createDeviceVisualization() {
            const deviceDiv = document.createElement('div');
            deviceDiv.className = 'device-visualization';
            
            const currentQuestion = appState.currentQuestions[appState.currentQuestionIndex];
            const example = literaryExamples[currentQuestion.exampleId];
            
            deviceDiv.innerHTML = `
                <div class="display-title">${example.type.toUpperCase()} Analysis</div>
                <div style="text-align: center; color: var(--text-secondary); margin-bottom: 15px;">
                    Understanding how this literary device works
                </div>
                
                <div class="device-diagram">
                    ${createDeviceDiagram(example.type)}
                </div>
                
                <div class="analysis-controls">
                    <div class="analysis-button" onclick="analyzeDeviceStructure()">Analyze Structure</div>
                    <div class="analysis-button" onclick="compareSimilarDevices()">Compare Devices</div>
                    <div class="analysis-button" onclick="createYourOwn()">Create Your Own</div>
                    <div class="analysis-button" onclick="showRealWorldExamples()">Real Examples</div>
                </div>
                
                <div id="deviceResult" style="margin-top: 20px; padding: 15px; background: var(--dark-surface); border-radius: 8px; display: none;"></div>
                
                <table class="literary-table">
                    <thead>
                        <tr>
                            <th>Device Feature</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${getDeviceFeatures(example.type).map(feature => `
                            <tr>
                                <td style="font-weight: bold; color: var(--primary-blue);">${feature.name}</td>
                                <td>${feature.description}</td>
                                <td style="font-family: 'Georgia', serif;">${feature.example}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            return deviceDiv;
        }

        // Helper function to create device diagram
        function createDeviceDiagram(deviceType) {
            switch(deviceType) {
                case "simile":
                    return `
                        <span class="device-element simile" onclick="showDeviceInfo('Simile')">Thing 1</span>
                        <span style="margin: 0 10px; color: var(--text-secondary);">is compared to</span>
                        <span class="device-element simile" onclick="showDeviceInfo('Simile')">Thing 2</span>
                        <div style="position: absolute; bottom: 10px; color: var(--text-muted); font-size: 0.9rem;">
                            Using "like" or "as"
                        </div>
                    `;
                case "metaphor":
                    return `
                        <span class="device-element metaphor" onclick="showDeviceInfo('Metaphor')">Thing 1</span>
                        <span style="margin: 0 10px; color: var(--text-secondary);">IS</span>
                        <span class="device-element metaphor" onclick="showDeviceInfo('Metaphor')">Thing 2</span>
                        <div style="position: absolute; bottom: 10px; color: var(--text-muted); font-size: 0.9rem;">
                            Direct comparison without "like" or "as"
                        </div>
                    `;
                case "personification":
                    return `
                        <span class="device-element personification" onclick="showDeviceInfo('Personification')">Non-human thing</span>
                        <span style="margin: 0 10px; color: var(--text-secondary);">+</span>
                        <span class="device-element personification" onclick="showDeviceInfo('Personification')">Human action/quality</span>
                        <div style="position: absolute; bottom: 10px; color: var(--text-muted); font-size: 0.9rem;">
                            Giving human traits to non-human things
                        </div>
                    `;
                case "hyperbole":
                    return `
                        <span class="device-element hyperbole" onclick="showDeviceInfo('Hyperbole')">Reality</span>
                        <span style="margin: 0 10px; color: var(--text-secondary);">‚Üí</span>
                        <span class="device-element hyperbole" onclick="showDeviceInfo('Hyperbole')">Extreme exaggeration</span>
                        <div style="position: absolute; bottom: 10px; color: var(--text-muted); font-size: 0.9rem;">
                            Not meant to be taken literally
                        </div>
                    `;
                case "alliteration":
                    return `
                        <span class="device-element alliteration" onclick="showDeviceInfo('Alliteration')">Same sound</span>
                        <span style="margin: 0 10px; color: var(--text-secondary);">repeated at beginning of</span>
                        <span class="device-element alliteration" onclick="showDeviceInfo('Alliteration')">nearby words</span>
                        <div style="position: absolute; bottom: 10px; color: var(--text-muted); font-size: 0.9rem;">
                            Creates rhythm and musicality
                        </div>
                    `;
                default:
                    return `
                        <span class="device-element simile" onclick="showDeviceInfo('Literary Device')">Literary Device</span>
                        <span style="margin: 0 10px; color: var(--text-secondary);">enhances</span>
                        <span class="device-element metaphor" onclick="showDeviceInfo('Language')">Language</span>
                    `;
            }
        }

        // Helper function to get device features
        function getDeviceFeatures(deviceType) {
            const features = {
                "simile": [
                    {name: "Comparison Words", description: "Uses 'like', 'as', or 'than'", example: "as brave as a lion"},
                    {name: "Two Elements", description: "Compares two different things", example: "Her smile (thing 1) like sunshine (thing 2)"},
                    {name: "Purpose", description: "Creates vivid imagery", example: "Helps readers visualize"}
                ],
                "metaphor": [
                    {name: "Direct Comparison", description: "No 'like' or 'as'", example: "Time is money"},
                    {name: "Implied Meaning", description: "Suggests qualities are shared", example: "Suggests time is valuable"},
                    {name: "Purpose", description: "Creates strong imagery", example: "Makes abstract concepts concrete"}
                ],
                "personification": [
                    {name: "Human Action", description: "Gives human actions to non-human", example: "The wind whispered"},
                    {name: "Human Quality", description: "Attributes human traits", example: "The angry storm"},
                    {name: "Purpose", description: "Makes relatable", example: "Helps readers connect emotionally"}
                ],
                "hyperbole": [
                    {name: "Exaggeration", description: "Overstatement for effect", example: "I'm so hungry I could eat a horse"},
                    {name: "Not Literal", description: "Not meant to be taken literally", example: "Obviously can't eat a horse"},
                    {name: "Purpose", description: "Creates emphasis or humor", example: "Makes point dramatically"}
                ],
                "alliteration": [
                    {name: "Sound Repetition", description: "Repeats initial consonant sounds", example: "Peter Piper picked"},
                    {name: "Position", description: "Usually at word beginnings", example: "She sells seashells"},
                    {name: "Purpose", description: "Creates rhythm", example: "Makes language musical"}
                ],
                "onomatopoeia": [
                    {name: "Sound Imitation", description: "Word imitates actual sound", example: "Buzz, crash, hiss"},
                    {name: "Sensory", description: "Creates auditory imagery", example: "Helps readers 'hear'"},
                    {name: "Purpose", description: "Adds realism", example: "Makes descriptions vivid"}
                ]
            };
            
            return features[deviceType] || [
                {name: "Definition", description: "Literary technique", example: "Enhances language"},
                {name: "Function", description: "Adds depth and meaning", example: "Improves expression"},
                {name: "Effect", description: "Engages readers", example: "Makes writing memorable"}
            ];
        }

        // Create types visualization
        function createTypesVisualization() {
            const typesDiv = document.createElement('div');
            typesDiv.className = 'types-visualization';
            
            typesDiv.innerHTML = `
                <div class="display-title">Literary Device Categories</div>
                <div style="text-align: center; color: var(--text-secondary); margin-bottom: 15px;">
                    Different ways writers enhance language
                </div>
                
                <div class="types-display">
                    ${deviceCategories.map((category, idx) => `
                        <div class="type-box ${category.category.toLowerCase().replace(' ', '-')} device-bounce" onclick="showCategoryDetails('${category.category}')">
                            <div class="type-icon">${getCategoryIcon(category.category)}</div>
                            <div class="type-name">${category.category}</div>
                            <div class="type-description">${category.description}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(156, 39, 176, 0.1); border-radius: 8px; border: 1px solid var(--accent-purple);">
                    <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px;">Why Writers Use Literary Devices:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Figurative Language:</strong> Creates vivid imagery and deeper meaning<br>
                        <strong>Sound Devices:</strong> Adds musicality and rhythm<br>
                        <strong>Imagery Devices:</strong> Appeals to the senses<br>
                        <strong>Structural Devices:</strong> Organizes ideas effectively
                    </div>
                </div>
            `;
            
            return typesDiv;
        }

        // Helper function to get category icon
        function getCategoryIcon(category) {
            const icons = {
                "Figurative Language": "‚ú®",
                "Sound Devices": "üîä",
                "Imagery Devices": "üé®",
                "Structural Devices": "üèóÔ∏è"
            };
            return icons[category] || "üìù";
        }

        // Create literary examples visualization
        function createLiteraryExamples() {
            const examplesDiv = document.createElement('div');
            examplesDiv.className = 'examples-container';
            
            examplesDiv.innerHTML = `
                <div class="display-title">Literary Device Examples</div>
                <div style="text-align: center; color: var(--text-secondary); margin-bottom: 15px;">
                    Click on examples to learn about each device
                </div>
                
                <div class="examples-grid">
                    <div class="example-box simile" onclick="showDeviceExample('Simile')">
                        <div class="example-icon">üîç</div>
                        <div class="example-name">Simile</div>
                        <div class="example-sentence">"As busy as a bee"</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">
                            Uses "like" or "as"
                        </div>
                    </div>
                    <div class="example-box metaphor" onclick="showDeviceExample('Metaphor')">
                        <div class="example-icon">‚ú®</div>
                        <div class="example-name">Metaphor</div>
                        <div class="example-sentence">"The world is a stage"</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">
                            Direct comparison
                        </div>
                    </div>
                    <div class="example-box personification" onclick="showDeviceExample('Personification')">
                        <div class="example-icon">üë§</div>
                        <div class="example-name">Personification</div>
                        <div class="example-sentence">"The flowers danced"</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">
                            Human traits to objects
                        </div>
                    </div>
                    <div class="example-box hyperbole" onclick="showDeviceExample('Hyperbole')">
                        <div class="example-icon">üí•</div>
                        <div class="example-name">Hyperbole</div>
                        <div class="example-sentence">"I've told you a million times"</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">
                            Exaggeration for effect
                        </div>
                    </div>
                </div>
                
                <table class="literary-table">
                    <thead>
                        <tr>
                            <th>Device</th>
                            <th>Definition</th>
                            <th>Key Identifier</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="font-weight: bold; color: var(--primary-blue);">Simile</td>
                            <td>Comparison using "like" or "as"</td>
                            <td>Look for "like", "as", "than"</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-purple);">Metaphor</td>
                            <td>Direct comparison without "like" or "as"</td>
                            <td>Uses "is", "was", "are" for comparison</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-green);">Personification</td>
                            <td>Giving human qualities to non-human things</td>
                            <td>Human actions attributed to objects/animals</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-orange);">Hyperbole</td>
                            <td>Exaggeration for emphasis</td>
                            <td>Extreme statements not meant literally</td>
                        </tr>
                    </tbody>
                </table>
            `;
            
            return examplesDiv;
        }

        // Create literary visualization
        function createLiteraryVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const currentQuestion = appState.currentQuestions[appState.currentQuestionIndex];
            const example = literaryExamples[currentQuestion.exampleId];
            const currentDevice = deviceExplanations.find(d => d.device.toLowerCase() === example.type.toLowerCase());
            const famousExample = famousExamples.find(f => f.device.toLowerCase() === example.type.toLowerCase()) || famousExamples[0];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-yellow);">Literary Devices Explorer</h3>
                
                ${createLiteraryConcepts().outerHTML}
                
                <div class="example-display" style="border-color: var(--accent-purple);">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; text-align: center;">
                        Focus: <span style="color: var(--accent-purple); font-weight: bold;">${example.type.toUpperCase()}</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.2rem; color: var(--accent-purple); margin-bottom: 10px;">Definition</div>
                            <div style="font-size: 1.1rem; color: var(--text-secondary); padding: 10px; background: rgba(156, 39, 176, 0.1); border-radius: 8px;">
                                ${currentDevice ? currentDevice.definition : "Literary technique that enhances language"}
                            </div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">
                                Purpose: ${currentDevice ? currentDevice.purpose : "To enhance expression"}
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.2rem; color: var(--primary-blue); margin-bottom: 10px;">Keywords</div>
                            <div style="font-size: 1.1rem; color: var(--text-secondary); padding: 10px; background: rgba(33, 150, 243, 0.1); border-radius: 8px;">
                                ${currentDevice ? (Array.isArray(currentDevice.keywords) ? currentDevice.keywords.join(", ") : currentDevice.keywords) : "Characteristic patterns"}
                            </div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">
                                Look for these when identifying
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(255, 235, 59, 0.1); border-radius: 6px; border-left: 3px solid var(--accent-yellow);">
                        <div style="font-size: 0.9rem; color: var(--accent-yellow);">
                            <strong>Quick Tip:</strong> ${getQuickTip(example.type)}
                        </div>
                    </div>
                </div>
                
                ${createDeviceVisualization().outerHTML}
                ${createTypesVisualization().outerHTML}
                ${createLiteraryExamples().outerHTML}
                
                <div class="famous-example" style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid var(--accent-orange); font-style: italic;">
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Famous Literary Example - ${famousExample.device}:</div>
                    <div style="color: var(--text-secondary); margin-bottom: 10px; font-family: 'Georgia', serif;">
                        "${famousExample.example}"
                    </div>
                    <div style="font-size: 0.9rem;">
                        <strong>Author:</strong> ${famousExample.author} | <strong>Work:</strong> ${famousExample.work}<br>
                        <strong>Analysis:</strong> ${famousExample.analysis}
                    </div>
                </div>
                
                <div class="interactive-practice">
                    <div class="practice-title">Interactive Literary Practice</div>
                    <div class="practice-controls">
                        <div class="practice-button" onclick="practiceDeviceIdentification()">Identify Devices</div>
                        <div class="practice-button" onclick="practiceCreatingDevices()">Create Devices</div>
                        <div class="practice-button" onclick="practiceMixedReview()">Mixed Review</div>
                        <div class="practice-button" onclick="practiceRealWorld()">Real-World Examples</div>
                    </div>
                    <div class="practice-display" id="practiceDisplay">
                        Click buttons above to practice literary devices
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-red);">
                    <div style="color: var(--accent-red); font-weight: bold; margin-bottom: 10px;">Quick Practice:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. Identify: "Her voice was music to my ears" (simile or metaphor?)<br>
                        2. Identify: "The stars winked at me from the night sky"<br>
                        3. Create: Write a simile about happiness<br>
                        4. Create: Write personification for a river<br>
                        5. Identify: "Sally sells seashells by the seashore"
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--accent-purple);">
                    <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px; text-align: center;">Literary Device Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Simile:</strong> Look for "like" or "as"<br>
                        <strong>Metaphor:</strong> Direct comparison without "like" or "as"<br>
                        <strong>Personification:</strong> Human actions for non-human things<br>
                        <strong>Hyperbole:</strong> Extreme exaggeration<br>
                        <strong>Alliteration:</strong> Repeated initial sounds
                    </div>
                </div>
            `;
            
            return vizDiv;
        }

        // Helper function to get quick tip
        function getQuickTip(deviceType) {
            const tips = {
                "simile": "Ask: Does it use 'like' or 'as' to compare? If yes, it's a simile!",
                "metaphor": "Ask: Does it directly compare things without 'like' or 'as'? If yes, it's a metaphor!",
                "personification": "Ask: Is something non-human doing something human? If yes, it's personification!",
                "hyperbole": "Ask: Is this an obvious exaggeration? If yes, it's hyperbole!",
                "alliteration": "Ask: Do nearby words start with the same sound? If yes, it's alliteration!",
                "onomatopoeia": "Ask: Does the word imitate a sound? If yes, it's onomatopoeia!",
                "oxymoron": "Ask: Are contradictory terms combined? If yes, it's an oxymoron!",
                "idiom": "Ask: Does it mean something different from the literal words? If yes, it's an idiom!"
            };
            return tips[deviceType] || "Look for patterns that make language more expressive!";
        }

        // Global functions for interactive practice
        window.showLiteraryDetails = function(category) {
            const categoryInfo = deviceCategories.find(c => c.category === category);
            if (!categoryInfo) return;
            
            alert(`${category}\n\n${categoryInfo.description}\n\nExamples:\n${categoryInfo.examples.map(ex => `‚Ä¢ ${ex}`).join('\n')}\n\nWhy writers use ${category.toLowerCase()}:\n‚Ä¢ To make writing more engaging\n‚Ä¢ To create specific effects\n‚Ä¢ To enhance meaning and beauty\n‚Ä¢ To connect with readers emotionally`);
        };

        window.showDeviceInfo = function(device) {
            const deviceInfo = deviceExplanations.find(d => d.device === device);
            if (!deviceInfo) {
                alert(`${device}\n\nLiterary devices enhance language by going beyond literal meanings. They create imagery, rhythm, and emotional impact in writing.\n\nTry to identify devices in your favorite songs, poems, or stories!`);
                return;
            }
            
            alert(`${deviceInfo.device}\n\nDefinition: ${deviceInfo.definition}\n\nPurpose: ${deviceInfo.purpose}\n\nExamples:\n${deviceInfo.examples.map(ex => `‚Ä¢ "${ex}"`).join('\n')}\n\nKeywords to look for:\n${Array.isArray(deviceInfo.keywords) ? deviceInfo.keywords.join(', ') : deviceInfo.keywords}`);
        };

        window.showCategoryDetails = function(category) {
            const categoryInfo = deviceCategories.find(c => c.category === category);
            if (!categoryInfo) return;
            
            let examplesText = "";
            switch(category) {
                case "Figurative Language":
                    examplesText = "‚Ä¢ Simile: 'as brave as a lion'\n‚Ä¢ Metaphor: 'time is money'\n‚Ä¢ Personification: 'the wind whispered'\n‚Ä¢ Hyperbole: 'I've told you a million times'";
                    break;
                case "Sound Devices":
                    examplesText = "‚Ä¢ Alliteration: 'Peter Piper picked'\n‚Ä¢ Assonance: 'the rain in Spain'\n‚Ä¢ Onomatopoeia: 'buzz, crash, boom'\n‚Ä¢ Rhyme: 'cat, hat, sat'";
                    break;
                case "Imagery Devices":
                    examplesText = "‚Ä¢ Visual: 'the crimson sunset'\n‚Ä¢ Auditory: 'the thunder roared'\n‚Ä¢ Tactile: 'the rough sandpaper'\n‚Ä¢ Olfactory: 'the sweet fragrance'";
                    break;
                case "Structural Devices":
                    examplesText = "‚Ä¢ Repetition: 'Never, never, never give up'\n‚Ä¢ Parallelism: 'Easy come, easy go'\n‚Ä¢ Juxtaposition: 'best of times, worst of times'\n‚Ä¢ Irony: 'fire station burns down'";
                    break;
            }
            
            alert(`${category}\n\n${categoryInfo.description}\n\nCommon Devices:\n${categoryInfo.examples.map(ex => `‚Ä¢ ${ex}`).join('\n')}\n\nExamples:\n${examplesText}\n\nEffect: ${getCategoryEffect(category)}`);
        };

        function getCategoryEffect(category) {
            switch(category) {
                case "Figurative Language": return "Creates vivid imagery and deeper meanings";
                case "Sound Devices": return "Adds musicality and rhythm to language";
                case "Imagery Devices": return "Appeals to senses and creates mental pictures";
                case "Structural Devices": return "Organizes ideas and creates patterns";
                default: return "Enhances language expression";
            }
        }

        window.showDeviceExample = function(device) {
            const deviceInfo = deviceExplanations.find(d => d.device === device);
            if (!deviceInfo) return;
            
            alert(`${device}\n\nHow to identify:\n${getIdentificationStrategy(device)}\n\nExamples:\n${deviceInfo.examples.map(ex => `‚Ä¢ "${ex}"`).join('\n')}\n\nPractice: Try creating your own ${device.toLowerCase()}!`);
        };

        function getIdentificationStrategy(device) {
            switch(device) {
                case "Simile": return "Look for 'like', 'as', or 'than' making comparisons";
                case "Metaphor": return "Look for direct comparisons without 'like' or 'as'";
                case "Personification": return "Look for human actions/qualities given to non-human things";
                case "Hyperbole": return "Look for obvious exaggerations not meant literally";
                case "Alliteration": return "Listen for repeated initial consonant sounds";
                case "Onomatopoeia": return "Look for words that imitate actual sounds";
                case "Oxymoron": return "Look for contradictory terms combined";
                case "Idiom": return "Look for common expressions with non-literal meanings";
                default: return "Look for patterns that enhance language";
            }
        }

        // Analysis functions
        window.analyzeDeviceStructure = function() {
            const resultDiv = document.getElementById('deviceResult');
            if (!resultDiv || !literaryState.currentExample) return;
            
            const example = literaryState.currentExample;
            const deviceInfo = deviceExplanations.find(d => d.device.toLowerCase() === example.type.toLowerCase());
            
            resultDiv.innerHTML = `
                <div style="color: var(--primary-blue); font-weight: bold; margin-bottom: 10px;">Device Structure Analysis: ${example.type.toUpperCase()}</div>
                <div style="color: var(--text-secondary); margin-bottom: 10px;">
                    <strong>Example:</strong> "${example.example}"<br><br>
                    <strong>Structure Breakdown:</strong><br>
                    ${getStructureBreakdown(example.type, example.example)}<br><br>
                    <strong>How It Works:</strong> ${deviceInfo ? deviceInfo.definition : "Enhances language through specific patterns"}
                </div>
                <div style="color: var(--accent-yellow); font-size: 0.9rem; margin-top: 10px;">
                    <strong>Writing Tip:</strong> ${getWritingTip(example.type)}
                </div>
            `;
            resultDiv.style.display = 'block';
        };

        function getStructureBreakdown(deviceType, example) {
            switch(deviceType) {
                case "simile":
                    return `1. Thing being described: ${example.split(" as ")[0] || example.split(" like ")[0]}<br>
                    2. Comparative word: ${example.includes(" as ") ? "as" : "like"}<br>
                    3. Thing compared to: ${example.split(" as ")[1] || example.split(" like ")[1]}`;
                case "metaphor":
                    return `1. Thing being described: ${example.split(" is ")[0] || example.split(" was ")[0] || example.split(" are ")[0] || example.split(" were ")[0]}<br>
                    2. Connecting word: ${example.includes(" is ") ? "is" : example.includes(" was ") ? "was" : example.includes(" are ") ? "are" : "were"}<br>
                    3. Thing compared to: ${example.split(" is ")[1] || example.split(" was ")[1] || example.split(" are ")[1] || example.split(" were ")[1]}`;
                case "personification":
                    return `1. Non-human subject: ${example.split(" ")[0]} ${example.split(" ")[1]}<br>
                    2. Human action/quality: ${example.split(" ").slice(2).join(" ")}<br>
                    3. Effect: Makes the subject seem alive and relatable`;
                case "hyperbole":
                    return `1. Statement: ${example}<br>
                    2. Exaggerated element: ${getExaggeratedElement(example)}<br>
                    3. Effect: Creates emphasis through obvious exaggeration`;
                case "alliteration":
                    const words = example.split(" ");
                    const repeatedSound = words[0][0].toLowerCase();
                    return `1. Repeated sound: "${repeatedSound}"<br>
                    2. Words with sound: ${words.filter(w => w.toLowerCase().startsWith(repeatedSound)).join(", ")}<br>
                    3. Effect: Creates rhythmic, musical quality`;
                default:
                    return "This device uses specific patterns to enhance language meaning and effect.";
            }
        }

        function getExaggeratedElement(example) {
            if (example.includes("million")) return "'million times' (extreme number)";
            if (example.includes("forever")) return "'forever' (extreme duration)";
            if (example.includes("tons")) return "'tons' (extreme weight)";
            if (example.includes("horse")) return "'eat a horse' (extreme amount)";
            return "obvious exaggeration";
        }

        function getWritingTip(deviceType) {
            const tips = {
                "simile": "Choose vivid, unexpected comparisons to create fresh imagery.",
                "metaphor": "Make sure the comparison reveals something interesting about the subject.",
                "personification": "Choose human actions that fit the thing's natural behavior.",
                "hyperbole": "Make the exaggeration obvious enough that readers know it's not literal.",
                "alliteration": "Use sparingly to avoid sounding silly or forced.",
                "onomatopoeia": "Choose sound words that actually resemble the real sound.",
                "oxymoron": "Make sure the contradiction highlights an interesting truth.",
                "idiom": "Use familiar idioms that your audience will understand."
            };
            return tips[deviceType] || "Use literary devices to make your writing more engaging and expressive.";
        }

        window.compareSimilarDevices = function() {
            const resultDiv = document.getElementById('deviceResult');
            if (!resultDiv || !literaryState.currentExample) return;
            
            const example = literaryState.currentExample;
            const confusions = commonConfusions.filter(c => 
                c.pair.includes(example.type.charAt(0).toUpperCase() + example.type.slice(1))
            );
            
            if (confusions.length === 0) {
                resultDiv.innerHTML = `
                    <div style="color: var(--primary-blue); font-weight: bold; margin-bottom: 10px;">Device Comparison</div>
                    <div style="color: var(--text-secondary);">
                        ${example.type.toUpperCase()} is usually confused with similar devices. Remember its key features!
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div style="color: var(--primary-blue); font-weight: bold; margin-bottom: 10px;">Device Comparison: ${confusions[0].pair}</div>
                    <div style="color: var(--text-secondary); margin-bottom: 10px;">
                        <strong>Key Difference:</strong> ${confusions[0].difference}<br><br>
                        <strong>${confusions[0].pair.split(" vs ")[0]}:</strong><br>
                        ${confusions[0].examples[confusions[0].pair.split(" vs ")[0].toLowerCase().split(" ")[0]]}<br><br>
                        <strong>${confusions[0].pair.split(" vs ")[1]}:</strong><br>
                        ${confusions[0].examples[confusions[0].pair.split(" vs ")[1].toLowerCase().split(" ")[0]]}
                    </div>
                    <div style="color: var(--accent-yellow); font-size: 0.9rem; margin-top: 10px;">
                        <strong>Tip:</strong> ${getComparisonTip(confusions[0].pair)}
                    </div>
                `;
            }
            resultDiv.style.display = 'block';
        };

        function getComparisonTip(pair) {
            switch(pair) {
                case "Simile vs Metaphor":
                    return "Ask: Does it use 'like' or 'as'? If yes ‚Üí simile. If no ‚Üí metaphor.";
                case "Hyperbole vs Metaphor":
                    return "Ask: Is it an obvious exaggeration? If yes ‚Üí hyperbole. Is it a comparison? If yes ‚Üí metaphor.";
                case "Personification vs Metaphor":
                    return "Ask: Is it giving human traits? If yes ‚Üí personification. Is it making any comparison? If yes ‚Üí metaphor.";
                case "Alliteration vs Assonance":
                    return "Ask: Are consonant sounds repeated? If yes ‚Üí alliteration. Are vowel sounds repeated? If yes ‚Üí assonance.";
                default:
                    return "Look for the specific characteristics of each device.";
            }
        }

        window.createYourOwn = function() {
            const resultDiv = document.getElementById('deviceResult');
            if (!resultDiv || !literaryState.currentExample) return;
            
            const example = literaryState.currentExample;
            
            resultDiv.innerHTML = `
                <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px;">Create Your Own ${example.type.toUpperCase()}</div>
                <div style="color: var(--text-secondary); margin-bottom: 10px;">
                    <strong>Example Pattern:</strong> ${getCreationPattern(example.type)}<br><br>
                    <strong>Try creating:</strong><br>
                    <input type="text" id="userCreation" placeholder="Your ${example.type} here" style="width: 100%; padding: 10px; margin: 10px 0; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary);">
                    <button class="btn btn-small btn-secondary" onclick="checkUserCreation()" style="margin-top: 10px;">Check Creation</button>
                </div>
                <div id="creationFeedback" style="margin-top: 10px; color: var(--text-secondary);"></div>
                <div style="color: var(--accent-yellow); font-size: 0.9rem; margin-top: 10px;">
                    <strong>Tips:</strong> ${getCreationTips(example.type)}
                </div>
            `;
            resultDiv.style.display = 'block';
        };

        function getCreationPattern(deviceType) {
            switch(deviceType) {
                case "simile": return "[Thing 1] + [like/as] + [Thing 2]";
                case "metaphor": return "[Thing 1] + [is/was] + [Thing 2]";
                case "personification": return "[Non-human thing] + [human action]";
                case "hyperbole": return "[Statement] + [extreme exaggeration]";
                case "alliteration": return "[Words starting with same sound]";
                case "onomatopoeia": return "[Word that imitates sound]";
                case "oxymoron": return "[Contradictory term 1] + [contradictory term 2]";
                case "idiom": return "[Common figurative expression]";
                default: return "[Device pattern]";
            }
        }

        function getCreationTips(deviceType) {
            switch(deviceType) {
                case "simile": return "Choose two different things that share an interesting quality.";
                case "metaphor": return "Make the comparison reveal something new about the subject.";
                case "personification": return "Choose human actions that fit the thing's natural behavior.";
                case "hyperbole": return "Make the exaggeration obvious but creative.";
                case "alliteration": return "Don't overdo it - 2-3 words with the same sound is usually enough.";
                case "onomatopoeia": return "Choose words that really sound like what they describe.";
                case "oxymoron": return "The contradiction should highlight an interesting truth.";
                case "idiom": return "Idioms are usually fixed expressions, but you can create new ones!";
                default: return "Be creative and have fun with language!";
            }
        }

        window.checkUserCreation = function() {
            const userInput = document.getElementById('userCreation');
            const feedbackDiv = document.getElementById('creationFeedback');
            if (!userInput || !feedbackDiv) return;
            
            const creation = userInput.value.trim();
            if (!creation) {
                feedbackDiv.textContent = "Please enter your creation first!";
                feedbackDiv.style.color = 'var(--accent-red)';
                return;
            }
            
            // Simple validation based on device type
            const example = literaryState.currentExample;
            let isValid = false;
            let feedback = "";
            
            switch(example.type) {
                case "simile":
                    isValid = creation.includes(" like ") || creation.includes(" as ");
                    feedback = isValid ? 
                        "Great! You used 'like' or 'as' for a simile!" : 
                        "Remember to use 'like' or 'as' for a simile.";
                    break;
                case "metaphor":
                    isValid = (creation.includes(" is ") || creation.includes(" was ") || 
                              creation.includes(" are ") || creation.includes(" were ")) && 
                              !creation.includes(" like ") && !creation.includes(" as ");
                    feedback = isValid ? 
                        "Excellent direct comparison - that's a metaphor!" : 
                        "Metaphors directly compare without 'like' or 'as'.";
                    break;
                case "personification":
                    // Simple check for common personification verbs
                    const personificationVerbs = ["whispered", "danced", "smiled", "cried", "laughed", "sang", "whispered", "shouted", "ran", "jumped"];
                    isValid = personificationVerbs.some(verb => creation.includes(verb));
                    feedback = isValid ? 
                        "Nice personification! You gave human qualities to something non-human." : 
                        "Personification gives human actions to non-human things.";
                    break;
                case "hyperbole":
                    // Check for obvious exaggeration words
                    const hyperboleWords = ["million", "billion", "forever", "never", "always", "tons", "endless", "infinite"];
                    isValid = hyperboleWords.some(word => creation.toLowerCase().includes(word));
                    feedback = isValid ? 
                        "Perfect hyperbole! That's a great exaggeration." : 
                        "Hyperbole uses obvious exaggeration for effect.";
                    break;
                default:
                    isValid = true;
                    feedback = "Creative! Literary devices make language more expressive.";
            }
            
            feedbackDiv.innerHTML = `<strong>${isValid ? "‚úì Well done!" : "‚úì Good attempt!"}</strong> ${feedback}`;
            feedbackDiv.style.color = isValid ? 'var(--accent-green)' : 'var(--accent-orange)';
        };

        window.showRealWorldExamples = function() {
            const resultDiv = document.getElementById('deviceResult');
            if (!resultDiv) return;
            
            const randomExamples = [...realWorldExamples].sort(() => 0.5 - Math.random()).slice(0, 3);
            
            resultDiv.innerHTML = `
                <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Real-World Literary Devices</div>
                <div style="color: var(--text-secondary); margin-bottom: 10px;">
                    Literary devices aren't just for literature! They're everywhere:<br><br>
                    ${randomExamples.map(ex => `
                        <div style="margin-bottom: 15px; padding: 10px; background: rgba(255, 152, 0, 0.1); border-radius: 6px;">
                            <strong>${ex.context}:</strong> "${ex.example}"<br>
                            <em>Device:</em> ${ex.device}<br>
                            <em>Effect:</em> ${ex.analysis}
                        </div>
                    `).join('')}
                </div>
                <div style="color: var(--accent-yellow); font-size: 0.9rem; margin-top: 10px;">
                    <strong>Challenge:</strong> Look for literary devices in ads, songs, and everyday conversations today!
                </div>
            `;
            resultDiv.style.display = 'block';
        };

        // Interactive practice functions
        window.practiceDeviceIdentification = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const identificationExercises = [
                {
                    sentence: "The stars were diamonds in the night sky.",
                    device: "Metaphor",
                    explanation: "Directly compares stars to diamonds without 'like' or 'as'"
                },
                {
                    sentence: "He ran like the wind to catch the bus.",
                    device: "Simile",
                    explanation: "Compares running to wind using 'like'"
                },
                {
                    sentence: "The ancient trees whispered stories of the past.",
                    device: "Personification",
                    explanation: "Gives human action (whispering) to trees"
                },
                {
                    sentence: "I'm so tired I could sleep for a year.",
                    device: "Hyperbole",
                    explanation: "Exaggerates sleep duration for effect"
                }
            ];
            
            const currentExercise = identificationExercises[Math.floor(Math.random() * identificationExercises.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-purple);">Device Identification Practice</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-family: 'Georgia', serif; color: var(--text-primary); font-style: italic;">
                        "${currentExercise.sentence}"
                    </div>
                    <div style="font-size: 1.1rem; margin-bottom: 20px; color: var(--accent-yellow);">
                        What literary device is used in this sentence?
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr; gap: 10px; margin: 20px 0;">
                        ${["Simile", "Metaphor", "Personification", "Hyperbole", "Alliteration", "Onomatopoeia"].map((device, idx) => `
                            <div class="option" onclick="checkDeviceIdentification(this, '${device}', '${currentExercise.device}')">
                                <div class="option-letter">${String.fromCharCode(65 + idx)}</div>
                                <div class="option-text">${device}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div id="identificationResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Remember:</strong> Look for comparison words, human actions given to objects, or obvious exaggerations.
                    </div>
                </div>
            `;
            
            window.currentDeviceExplanation = currentExercise.explanation;
        };

        window.checkDeviceIdentification = function(element, selectedDevice, correctDevice) {
            const resultDiv = document.getElementById('identificationResult');
            if (!resultDiv) return;
            
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            if (selectedDevice === correctDevice) {
                element.classList.add('correct');
                resultDiv.textContent = "Correct! Great device identification!";
                resultDiv.style.color = 'var(--accent-green)';
            } else {
                element.classList.add('incorrect');
                // Find and highlight correct option
                options.forEach(opt => {
                    if (opt.querySelector('.option-text').textContent === correctDevice) {
                        opt.classList.add('correct');
                    }
                });
                resultDiv.innerHTML = `Incorrect. This is ${correctDevice.toLowerCase()}.<br>${window.currentDeviceExplanation}`;
                resultDiv.style.color = 'var(--accent-orange)';
            }
            
            resultDiv.classList.add('pulse');
            setTimeout(() => resultDiv.classList.remove('pulse'), 500);
        };

        window.practiceCreatingDevices = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const creationPrompts = [
                {
                    device: "Simile",
                    prompt: "Create a simile about happiness",
                    example: "Happiness is like sunshine after rain."
                },
                {
                    device: "Metaphor",
                    prompt: "Create a metaphor for friendship",
                    example: "Friendship is a shelter in life's storms."
                },
                {
                    device: "Personification",
                    prompt: "Create personification for a river",
                    example: "The river danced over the stones."
                },
                {
                    device: "Hyperbole",
                    prompt: "Create hyperbole about waiting",
                    example: "I waited for so long, I grew a beard!"
                }
            ];
            
            const currentPrompt = creationPrompts[Math.floor(Math.random() * creationPrompts.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary-blue);">Creative Device Practice</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; color: var(--text-primary);">
                        ${currentPrompt.prompt}
                    </div>
                    <div style="font-size: 1.1rem; margin-bottom: 20px; color: var(--accent-yellow);">
                        Device: <strong>${currentPrompt.device}</strong>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <textarea id="userDeviceCreation" placeholder="Write your ${currentPrompt.device.toLowerCase()} here..." style="width: 100%; padding: 15px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary); font-size: 1rem; min-height: 100px; resize: vertical;"></textarea>
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="shareDeviceCreation()">Share Creation</button>
                        <button class="btn btn-small btn-outline" onclick="showDeviceExampleSolution()">See Example</button>
                    </div>
                    
                    <div id="creationResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Tip:</strong> ${getDeviceCreationTip(currentPrompt.device)}
                    </div>
                </div>
            `;
            
            window.currentDevicePrompt = currentPrompt;
        };

        function getDeviceCreationTip(device) {
            switch(device) {
                case "Simile": return "Use 'like' or 'as' to compare two different things.";
                case "Metaphor": return "Directly compare without 'like' or 'as' (X is Y).";
                case "Personification": return "Give human actions or feelings to something non-human.";
                case "Hyperbole": return "Exaggerate greatly for humorous or dramatic effect.";
                default: return "Be creative and have fun with language!";
            }
        }

        window.shareDeviceCreation = function() {
            const textarea = document.getElementById('userDeviceCreation');
            const resultDiv = document.getElementById('creationResult');
            
            if (!textarea || !resultDiv) return;
            
            const creation = textarea.value.trim();
            if (!creation) {
                resultDiv.textContent = "Please write your creation first!";
                resultDiv.style.color = 'var(--accent-red)';
                return;
            }
            
            resultDiv.innerHTML = `
                <div style="color: var(--accent-green); margin-bottom: 5px;">
                    <strong>‚úì Great creation!</strong>
                </div>
                <div style="color: var(--text-secondary); font-size: 0.9rem;">
                    "${creation}"<br>
                    <em>That's a creative ${window.currentDevicePrompt.device.toLowerCase()}!</em>
                </div>
            `;
            
            // Add to local storage for fun
            const userCreations = JSON.parse(localStorage.getItem('userLiteraryCreations') || '[]');
            userCreations.push({
                device: window.currentDevicePrompt.device,
                creation: creation,
                date: new Date().toLocaleDateString()
            });
            localStorage.setItem('userLiteraryCreations', JSON.stringify(userCreations));
        };

        window.showDeviceExampleSolution = function() {
            const resultDiv = document.getElementById('creationResult');
            if (resultDiv && window.currentDevicePrompt) {
                resultDiv.innerHTML = `
                    <div style="color: var(--secondary-teal); margin-bottom: 5px;">
                        <strong>Example ${window.currentDevicePrompt.device}:</strong>
                    </div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; font-style: italic;">
                        "${window.currentDevicePrompt.example}"
                    </div>
                `;
            }
        };

        window.practiceMixedReview = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const mixedExercises = [
                {
                    sentence: "The alarm clock screamed at me to wake up.",
                    device: "Personification",
                    options: ["Simile", "Metaphor", "Personification", "Hyperbole"]
                },
                {
                    sentence: "Her laughter was a melody that filled the room.",
                    device: "Metaphor",
                    options: ["Simile", "Metaphor", "Alliteration", "Onomatopoeia"]
                },
                {
                    sentence: "He was as strong as an ox.",
                    device: "Simile",
                    options: ["Simile", "Metaphor", "Personification", "Hyperbole"]
                },
                {
                    sentence: "The popcorn popped loudly in the microwave.",
                    device: "Onomatopoeia",
                    options: ["Alliteration", "Onomatopoeia", "Personification", "Hyperbole"]
                }
            ];
            
            const currentExercise = mixedExercises[Math.floor(Math.random() * mixedExercises.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-orange);">Mixed Review Challenge</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-family: 'Georgia', serif; color: var(--text-primary); font-style: italic;">
                        "${currentExercise.sentence}"
                    </div>
                    <div style="font-size: 1.1rem; margin-bottom: 20px; color: var(--accent-yellow);">
                        Identify the literary device:
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0;">
                        ${currentExercise.options.map((option, idx) => `
                            <div class="option" onclick="checkMixedReview(this, '${option}', '${currentExercise.device}')">
                                <div class="option-letter">${String.fromCharCode(65 + idx)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div id="mixedReviewResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Quick Check:</strong> Simile = like/as, Metaphor = direct comparison, Personification = human traits, Hyperbole = exaggeration
                    </div>
                </div>
            `;
            
            window.currentMixedExplanation = getMixedExplanation(currentExercise.device, currentExercise.sentence);
        };

        function getMixedExplanation(device, sentence) {
            switch(device) {
                case "Simile": return `Uses comparison word in: "${sentence}"`;
                case "Metaphor": return `Directly compares without 'like' or 'as' in: "${sentence}"`;
                case "Personification": return `Gives human action to non-human thing in: "${sentence}"`;
                case "Hyperbole": return `Uses obvious exaggeration in: "${sentence}"`;
                case "Alliteration": return `Repeats initial sounds in: "${sentence}"`;
                case "Onomatopoeia": return `Uses sound-imitating word in: "${sentence}"`;
                default: return `Uses ${device.toLowerCase()} in: "${sentence}"`;
            }
        }

        window.checkMixedReview = function(element, selectedDevice, correctDevice) {
            const resultDiv = document.getElementById('mixedReviewResult');
            if (!resultDiv) return;
            
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            if (selectedDevice === correctDevice) {
                element.classList.add('correct');
                resultDiv.textContent = "Correct! Excellent mixed review!";
                resultDiv.style.color = 'var(--accent-green)';
            } else {
                element.classList.add('incorrect');
                // Find and highlight correct option
                options.forEach(opt => {
                    if (opt.querySelector('.option-text').textContent === correctDevice) {
                        opt.classList.add('correct');
                    }
                });
                resultDiv.innerHTML = `Incorrect. This is ${correctDevice.toLowerCase()}.<br>${window.currentMixedExplanation}`;
                resultDiv.style.color = 'var(--accent-orange)';
            }
            
            resultDiv.classList.add('pulse');
            setTimeout(() => resultDiv.classList.remove('pulse'), 500);
        };

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const example = literaryExamples[question.exampleId];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            // Clear containers
            literaryFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            exampleDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            // Add content
            literaryFact.appendChild(createLiteraryFact());
            conceptDisplay.appendChild(createConceptDisplay());
            exampleDisplay.appendChild(createExampleDisplay(question.exampleId));
            visualizationContainer.appendChild(createLiteraryVisualization());
            
            // Reset literary state
            literaryState.currentExample = example;
            literaryState.deviceAnalysis = null;
            
            // Add options
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
