<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 7 Science - Respiratory & Circulatory Systems | Ideolix Learning Hub</title>
    <style>
        :root {
            --primary-red: #F44336;
            --secondary-blue: #2196F3;
            --accent-green: #4CAF50;
            --accent-yellow: #FFEB3B;
            --accent-orange: #FF9800;
            --accent-purple: #9C27B0;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Cards */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .welcome-page {
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-red), var(--secondary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(244, 67, 54, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-red);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin: 0 auto 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-red);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: var(--primary-red);
            color: white;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
        }

        .btn-primary:hover {
            background: #D32F2F;
            transform: translateY(-3px);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Practice Page */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-red), var(--secondary-blue));
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .example-display {
            background: var(--dark-surface);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid var(--accent-yellow);
            font-family: 'Georgia', serif;
            font-size: 1.2rem;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-red);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-blue);
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 5px solid var(--accent-green);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid var(--accent-red);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
            background: var(--accent-green);
        }

        .feedback-incorrect .feedback-icon {
            background: var(--accent-red);
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--accent-green);
        }

        .feedback-incorrect .feedback-title {
            color: var(--accent-red);
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            border-color: var(--primary-red);
        }

        /* System Cards */
        .system-card {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid;
            transition: transform 0.3s ease;
        }

        .system-card:hover {
            transform: translateY(-3px);
        }

        .respiratory { border-color: var(--primary-red); background: rgba(244, 67, 54, 0.1); }
        .circulatory { border-color: var(--secondary-blue); background: rgba(33, 150, 243, 0.1); }

        /* Diagram */
        .diagram-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
            text-align: center;
        }

        .organ-label {
            display: inline-block;
            padding: 8px 16px;
            margin: 8px;
            border-radius: 6px;
            background: var(--dark-card);
            border: 2px solid;
            font-weight: bold;
        }

        .label-lungs { border-color: var(--primary-red); color: var(--primary-red); }
        .label-heart { border-color: var(--accent-red); color: var(--accent-red); }
        .label-artery { border-color: #E91E63; color: #E91E63; }
        .label-vein { border-color: #9C27B0; color: #9C27B0; }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-red), var(--secondary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-red), var(--secondary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-red);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .welcome-title { font-size: 2rem; }
            .score-value { font-size: 3rem; }
            .stats-container { grid-template-columns: 1fr; }
            .navigation-buttons { flex-direction: column; gap: 10px; }
            .navigation-buttons .btn { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card" id="welcomePage">
            <h1 class="welcome-title">Grade 7 Science</h1>
            <p class="welcome-subtitle">Explore the amazing systems that keep you alive! Learn about the respiratory system for breathing and the circulatory system for blood flow through 100 interactive questions.</p>
            
            <div class="topic-badge">
                <span class="topic-icon">ü´Å‚ù§Ô∏èü©∏</span>
                <span class="topic-name">Respiratory & Circulatory Systems</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">Start Learning</button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1%"></div>
                </div>
            </div>

            <div class="question-container">
                <h2 class="question-text" id="questionText"></h2>
                
                <div class="example-display" id="exampleDisplay"></div>
                
                <div id="diagramContainer"></div>
                
                <div class="options-container" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-explanation"></div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card" id="resultsPage">
            <h2 class="results-title">Systems Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="accuracyRate">0%</div>
                        <div class="stat-label">Accuracy Rate</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="systemMastery">0%</div>
                        <div class="stat-label">System Mastery</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-outline" id="backToHome">Home</button>
            </div>
        </div>
    </div>

    <script>
        // 100 Questions - Respiratory & Circulatory Systems
        const questions = [
            // ========== RESPIRATORY SYSTEM (Questions 1-50) ==========
            // Basics & Functions (1-10)
            {
                type: "respiratory",
                category: "basics",
                question: "What is the main function of the respiratory system?",
                example: "",
                options: [
                    "To exchange oxygen and carbon dioxide",
                    "To pump blood throughout the body",
                    "To digest food and absorb nutrients",
                    "To control body movements"
                ],
                answer: "A",
                explanation: "The respiratory system's primary function is gas exchange: taking in oxygen and removing carbon dioxide."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "Which gas do we breathe in?",
                example: "",
                options: ["Oxygen", "Carbon dioxide", "Nitrogen", "Helium"],
                answer: "A",
                explanation: "We inhale oxygen (O‚ÇÇ) which our cells need for cellular respiration."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "Which gas do we breathe out as waste?",
                example: "",
                options: ["Carbon dioxide", "Oxygen", "Nitrogen", "Hydrogen"],
                answer: "A",
                explanation: "We exhale carbon dioxide (CO‚ÇÇ) which is a waste product of cellular respiration."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "Where does gas exchange occur in the respiratory system?",
                example: "",
                options: ["Alveoli", "Trachea", "Bronchi", "Pharynx"],
                answer: "A",
                explanation: "Gas exchange occurs in tiny air sacs called alveoli in the lungs."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "What is the process of breathing in called?",
                example: "",
                options: ["Inhalation", "Exhalation", "Respiration", "Ventilation"],
                answer: "A",
                explanation: "Inhalation is breathing in, exhalation is breathing out."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "What is the process of breathing out called?",
                example: "",
                options: ["Exhalation", "Inhalation", "Respiration", "Inspiration"],
                answer: "A",
                explanation: "Exhalation is breathing out, inhalation is breathing in."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "What muscle controls breathing?",
                example: "",
                options: ["Diaphragm", "Heart", "Lungs", "Ribs"],
                answer: "A",
                explanation: "The diaphragm is the main muscle that controls breathing movements."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "What happens to the diaphragm during inhalation?",
                example: "",
                options: ["It contracts and moves down", "It relaxes and moves up", "It stays still", "It expands sideways"],
                answer: "A",
                explanation: "During inhalation, the diaphragm contracts and moves downward, creating space for lungs to expand."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "What happens to the diaphragm during exhalation?",
                example: "",
                options: ["It relaxes and moves up", "It contracts and moves down", "It stays still", "It expands sideways"],
                answer: "A",
                explanation: "During exhalation, the diaphragm relaxes and moves upward, pushing air out."
            },
            {
                type: "respiratory",
                category: "basics",
                question: "How many lungs do humans have?",
                example: "",
                options: ["Two", "One", "Three", "Four"],
                answer: "A",
                explanation: "Humans have two lungs: left and right."
            },

            // Respiratory Organs (11-20)
            {
                type: "respiratory",
                category: "organs",
                question: "What is the windpipe called?",
                example: "",
                options: ["Trachea", "Bronchus", "Alveolus", "Pharynx"],
                answer: "A",
                explanation: "The trachea, also called windpipe, carries air to the lungs."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "What are the two main branches of the trachea called?",
                example: "",
                options: ["Bronchi", "Alveoli", "Bronchioles", "Larynx"],
                answer: "A",
                explanation: "The trachea divides into two bronchi (singular: bronchus), one leading to each lung."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "What are the tiny branches inside the lungs called?",
                example: "",
                options: ["Bronchioles", "Alveoli", "Capillaries", "Arteries"],
                answer: "A",
                explanation: "Bronchioles are small branches of the bronchi inside the lungs."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "What are the tiny air sacs where gas exchange occurs?",
                example: "",
                options: ["Alveoli", "Bronchi", "Bronchioles", "Trachea"],
                answer: "A",
                explanation: "Alveoli are tiny air sacs surrounded by capillaries where oxygen and carbon dioxide are exchanged."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "What is the voice box called?",
                example: "",
                options: ["Larynx", "Pharynx", "Trachea", "Epiglottis"],
                answer: "A",
                explanation: "The larynx, or voice box, contains vocal cords for speech."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "What prevents food from entering the trachea?",
                example: "",
                options: ["Epiglottis", "Larynx", "Pharynx", "Bronchi"],
                answer: "A",
                explanation: "The epiglottis is a flap that covers the trachea when swallowing to prevent food from entering."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "Which lung is slightly smaller to make room for the heart?",
                example: "",
                options: ["Left lung", "Right lung", "Both are equal", "Neither"],
                answer: "A",
                explanation: "The left lung is slightly smaller with two lobes, while the right lung has three lobes."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "What are the hairs in the nose that filter air called?",
                example: "",
                options: ["Cilia", "Mucus", "Hairs", "Filters"],
                answer: "A",
                explanation: "Cilia are tiny hairs that filter dust and particles from inhaled air."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "What moistens and warms incoming air?",
                example: "",
                options: ["Nasal passages", "Trachea", "Bronchi", "Larynx"],
                answer: "A",
                explanation: "Nasal passages moisten and warm incoming air before it reaches the lungs."
            },
            {
                type: "respiratory",
                category: "organs",
                question: "Where does air enter the respiratory system?",
                example: "",
                options: ["Nose and mouth", "Trachea", "Lungs", "Bronchi"],
                answer: "A",
                explanation: "Air enters through the nose or mouth, then travels through the respiratory tract."

            },
            // Gas Exchange & Processes (21-30)
            {
                type: "respiratory",
                category: "process",
                question: "How does oxygen move from alveoli to blood?",
                example: "",
                options: ["Diffusion", "Pumping", "Absorption", "Filtration"],
                answer: "A",
                explanation: "Oxygen moves by diffusion from high concentration in alveoli to low concentration in blood capillaries."
            },
            {
                type: "respiratory",
                category: "process",
                question: "How does carbon dioxide move from blood to alveoli?",
                example: "",
                options: ["Diffusion", "Pumping", "Absorption", "Filtration"],
                answer: "A",
                explanation: "Carbon dioxide moves by diffusion from high concentration in blood to low concentration in alveoli."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What is the waste product of cellular respiration?",
                example: "",
                options: ["Carbon dioxide", "Oxygen", "Water", "Glucose"],
                answer: "A",
                explanation: "Cells produce carbon dioxide as waste during cellular respiration."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What do cells need oxygen for?",
                example: "",
                options: ["Cellular respiration", "Photosynthesis", "Digestion", "Circulation"],
                answer: "A",
                explanation: "Cells use oxygen in cellular respiration to release energy from glucose."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What is the normal breathing rate for adults at rest?",
                example: "",
                options: ["12-20 breaths per minute", "5-10 breaths per minute", "30-40 breaths per minute", "50-60 breaths per minute"],
                answer: "A",
                explanation: "Normal resting breathing rate is 12-20 breaths per minute."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What happens to breathing rate during exercise?",
                example: "",
                options: ["Increases", "Decreases", "Stays same", "Stops"],
                answer: "A",
                explanation: "Breathing rate increases during exercise to supply more oxygen to working muscles."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What controls the breathing rate?",
                example: "",
                options: ["Brain", "Heart", "Lungs", "Blood"],
                answer: "A",
                explanation: "The brain's medulla oblongata controls breathing rate based on carbon dioxide levels in blood."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What is the maximum amount of air lungs can hold?",
                example: "",
                options: ["Total lung capacity", "Tidal volume", "Vital capacity", "Residual volume"],
                answer: "A",
                explanation: "Total lung capacity is about 4-6 liters in adults."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What protects the lungs?",
                example: "",
                options: ["Rib cage", "Skin", "Muscles", "Fat"],
                answer: "A",
                explanation: "The rib cage (thoracic cavity) protects the lungs and heart."
            },
            {
                type: "respiratory",
                category: "process",
                question: "What lines the chest cavity and lungs?",
                example: "",
                options: ["Pleura", "Pericardium", "Peritoneum", "Membrane"],
                answer: "A",
                explanation: "The pleura is a double membrane that lines the chest cavity and covers the lungs."
            },

            // Respiratory Health & Disorders (31-40)
            {
                type: "respiratory",
                category: "health",
                question: "What is asthma?",
                example: "",
                options: ["Inflammation of airways", "Infection of lungs", "Heart condition", "Blood disorder"],
                answer: "A",
                explanation: "Asthma causes inflammation and narrowing of airways, making breathing difficult."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What is pneumonia?",
                example: "",
                options: ["Lung infection", "Heart disease", "Blood infection", "Muscle disorder"],
                answer: "A",
                explanation: "Pneumonia is an infection that inflames air sacs in one or both lungs."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What is bronchitis?",
                example: "",
                options: ["Inflammation of bronchi", "Lung collapse", "Heart inflammation", "Blood clot"],
                answer: "A",
                explanation: "Bronchitis is inflammation of the bronchial tubes carrying air to the lungs."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What is emphysema?",
                example: "",
                options: ["Damage to alveoli", "Heart failure", "Blood disease", "Muscle weakness"],
                answer: "A",
                explanation: "Emphysema damages alveoli walls, reducing surface area for gas exchange."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What is lung cancer?",
                example: "",
                options: ["Uncontrolled cell growth in lungs", "Heart attack", "Blood cancer", "Muscle tumor"],
                answer: "A",
                explanation: "Lung cancer is uncontrolled growth of abnormal cells in lung tissue."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What smoking-related disease causes breathing difficulty?",
                example: "",
                options: ["COPD", "Heart disease", "Diabetes", "Arthritis"],
                answer: "A",
                explanation: "COPD (Chronic Obstructive Pulmonary Disease) is often caused by smoking."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What gas in cigarette smoke binds to hemoglobin?",
                example: "",
                options: ["Carbon monoxide", "Oxygen", "Carbon dioxide", "Nitrogen"],
                answer: "A",
                explanation: "Carbon monoxide binds to hemoglobin 200 times more strongly than oxygen."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What helps keep respiratory tract clean?",
                example: "",
                options: ["Mucus and cilia", "Blood cells", "Muscles", "Bones"],
                answer: "A",
                explanation: "Mucus traps particles, and cilia move them out of respiratory tract."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What is the best way to maintain respiratory health?",
                example: "",
                options: ["Avoid smoking and pollution", "Eat more sugar", "Avoid exercise", "Breathe quickly"],
                answer: "A",
                explanation: "Avoiding smoking and air pollution helps maintain healthy lungs."
            },
            {
                type: "respiratory",
                category: "health",
                question: "What exercise improves lung capacity?",
                example: "",
                options: ["Aerobic exercise", "Weight lifting", "Stretching", "Sleeping"],
                answer: "A",
                explanation: "Aerobic exercises like running, swimming improve lung capacity and efficiency."
            },

            // Respiratory Connection to Circulation (41-50)
            {
                type: "respiratory",
                category: "connection",
                question: "What carries oxygen from lungs to body cells?",
                example: "",
                options: ["Red blood cells", "White blood cells", "Platelets", "Plasma"],
                answer: "A",
                explanation: "Red blood cells contain hemoglobin that carries oxygen."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "What protein in red blood cells carries oxygen?",
                example: "",
                options: ["Hemoglobin", "Insulin", "Collagen", "Keratin"],
                answer: "A",
                explanation: "Hemoglobin binds with oxygen in lungs and releases it to tissues."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "Where does oxygen-rich blood go from lungs?",
                example: "",
                options: ["To the heart", "To the brain", "To the liver", "To the stomach"],
                answer: "A",
                explanation: "Oxygenated blood travels from lungs to heart, then gets pumped to body."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "Where does carbon dioxide-rich blood come from?",
                example: "",
                options: ["From body tissues", "From the heart", "From the brain", "From the stomach"],
                answer: "A",
                explanation: "Blood picks up carbon dioxide from body tissues and brings it to lungs."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "What color is oxygen-rich blood?",
                example: "",
                options: ["Bright red", "Dark red", "Blue", "Purple"],
                answer: "A",
                explanation: "Oxygenated blood is bright red, deoxygenated blood is darker red."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "What part of blood carries carbon dioxide?",
                example: "",
                options: ["Plasma", "Red blood cells", "White blood cells", "Platelets"],
                answer: "A",
                explanation: "Most carbon dioxide dissolves in plasma as bicarbonate."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "What system works with respiratory system for gas transport?",
                example: "",
                options: ["Circulatory system", "Digestive system", "Nervous system", "Skeletal system"],
                answer: "A",
                explanation: "Circulatory system transports gases between lungs and body cells."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "What happens if respiratory system fails?",
                example: "",
                options: ["Cells can't get oxygen", "Food can't be digested", "Bones weaken", "Muscles grow"],
                answer: "A",
                explanation: "Without oxygen from respiratory system, cells can't perform cellular respiration."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "How are alveoli and capillaries related?",
                example: "",
                options: ["They are in close contact for gas exchange", "They are far apart", "They don't connect", "They compete"],
                answer: "A",
                explanation: "Alveoli are surrounded by capillaries for efficient gas exchange."
            },
            {
                type: "respiratory",
                category: "connection",
                question: "What is the purpose of thin walls in alveoli?",
                example: "",
                options: ["Quick gas diffusion", "Protection", "Strength", "Storage"],
                answer: "A",
                explanation: "Thin walls allow rapid diffusion of oxygen and carbon dioxide."

            },

            // ========== CIRCULATORY SYSTEM (Questions 51-100) ==========
            // Basics & Functions (51-60)
            {
                type: "circulatory",
                category: "basics",
                question: "What is the main function of the circulatory system?",
                example: "",
                options: [
                    "Transport oxygen, nutrients, and waste",
                    "Help with breathing",
                    "Digest food",
                    "Control body temperature only"
                ],
                answer: "A",
                explanation: "The circulatory system transports oxygen, nutrients, hormones, and removes waste products."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "What is the pump of the circulatory system?",
                example: "",
                options: ["Heart", "Lungs", "Brain", "Liver"],
                answer: "A",
                explanation: "The heart pumps blood throughout the body."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "What are the tubes that carry blood?",
                example: "",
                options: ["Blood vessels", "Bronchi", "Nerves", "Muscles"],
                answer: "A",
                explanation: "Blood vessels (arteries, veins, capillaries) carry blood throughout body."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "What is the fluid that circulates?",
                example: "",
                options: ["Blood", "Water", "Air", "Mucus"],
                answer: "A",
                explanation: "Blood is the fluid that circulates, carrying substances to and from cells."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "How many chambers does the human heart have?",
                example: "",
                options: ["Four", "Two", "Three", "Five"],
                answer: "A",
                explanation: "The human heart has four chambers: two atria (upper) and two ventricles (lower)."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "What are the upper chambers of the heart called?",
                example: "",
                options: ["Atria", "Ventricles", "Valves", "Aortas"],
                answer: "A",
                explanation: "Atria (singular: atrium) are upper chambers that receive blood."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "What are the lower chambers of the heart called?",
                example: "",
                options: ["Ventricles", "Atria", "Valves", "Arteries"],
                answer: "A",
                explanation: "Ventricles are lower chambers that pump blood out of heart."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "Which side of heart pumps blood to lungs?",
                example: "",
                options: ["Right side", "Left side", "Both sides", "Neither"],
                answer: "A",
                explanation: "Right side pumps deoxygenated blood to lungs for oxygenation."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "Which side of heart pumps blood to body?",
                example: "",
                options: ["Left side", "Right side", "Both sides", "Neither"],
                answer: "A",
                explanation: "Left side pumps oxygenated blood to rest of body."
            },
            {
                type: "circulatory",
                category: "basics",
                question: "What is circulation to and from lungs called?",
                example: "",
                options: ["Pulmonary circulation", "Systemic circulation", "Cardiac circulation", "Renal circulation"],
                answer: "A",
                explanation: "Pulmonary circulation: heart ‚Üí lungs ‚Üí heart."
            },

            // Heart Structure (61-70)
            {
                type: "circulatory",
                category: "heart",
                question: "What is the largest artery?",
                example: "",
                options: ["Aorta", "Pulmonary artery", "Coronary artery", "Carotid artery"],
                answer: "A",
                explanation: "Aorta is largest artery carrying oxygenated blood from heart to body."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What artery carries blood to lungs?",
                example: "",
                options: ["Pulmonary artery", "Aorta", "Coronary artery", "Renal artery"],
                answer: "A",
                explanation: "Pulmonary artery carries deoxygenated blood from heart to lungs."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What veins bring blood from lungs to heart?",
                example: "",
                options: ["Pulmonary veins", "Superior vena cava", "Inferior vena cava", "Coronary veins"],
                answer: "A",
                explanation: "Pulmonary veins carry oxygenated blood from lungs to heart."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What vein brings blood from upper body to heart?",
                example: "",
                options: ["Superior vena cava", "Inferior vena cava", "Pulmonary vein", "Aorta"],
                answer: "A",
                explanation: "Superior vena cava returns blood from upper body to right atrium."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What vein brings blood from lower body to heart?",
                example: "",
                options: ["Inferior vena cava", "Superior vena cava", "Pulmonary vein", "Aorta"],
                answer: "A",
                explanation: "Inferior vena cava returns blood from lower body to right atrium."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What prevents backflow of blood in heart?",
                example: "",
                options: ["Valves", "Arteries", "Veins", "Capillaries"],
                answer: "A",
                explanation: "Heart valves ensure blood flows in one direction only."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What are heart sounds caused by?",
                example: "",
                options: ["Closing of valves", "Opening of valves", "Muscle contraction", "Blood flow"],
                answer: "A",
                explanation: "'Lub-dub' sounds are caused by closing of heart valves."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What supplies blood to heart muscle itself?",
                example: "",
                options: ["Coronary arteries", "Pulmonary arteries", "Carotid arteries", "Renal arteries"],
                answer: "A",
                explanation: "Coronary arteries supply oxygenated blood to heart muscle."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What is the average resting heart rate for adults?",
                example: "",
                options: ["60-100 beats per minute", "30-50 beats per minute", "100-150 beats per minute", "150-200 beats per minute"],
                answer: "A",
                explanation: "Normal resting heart rate is 60-100 beats per minute."
            },
            {
                type: "circulatory",
                category: "heart",
                question: "What controls heart rate?",
                example: "",
                options: ["Sinoatrial node (pacemaker)", "Brain only", "Lungs", "Liver"],
                answer: "A",
                explanation: "Sinoatrial node in right atrium acts as natural pacemaker."

            },
            // Blood Vessels (71-80)
            {
                type: "circulatory",
                category: "vessels",
                question: "Which blood vessels carry blood AWAY from heart?",
                example: "",
                options: ["Arteries", "Veins", "Capillaries", "All of them"],
                answer: "A",
                explanation: "Arteries carry blood away from heart (usually oxygenated, except pulmonary artery)."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "Which blood vessels carry blood TOWARD heart?",
                example: "",
                options: ["Veins", "Arteries", "Capillaries", "All of them"],
                answer: "A",
                explanation: "Veins carry blood toward heart (usually deoxygenated, except pulmonary veins)."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "Which blood vessels connect arteries and veins?",
                example: "",
                options: ["Capillaries", "Arterioles", "Venules", "Aorta"],
                answer: "A",
                explanation: "Capillaries are tiny vessels connecting arteries to veins for exchange with tissues."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "Which vessels have thick muscular walls?",
                example: "",
                options: ["Arteries", "Veins", "Capillaries", "All have thick walls"],
                answer: "A",
                explanation: "Arteries have thick, muscular walls to withstand high pressure."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "Which vessels have valves?",
                example: "",
                options: ["Veins", "Arteries", "Capillaries", "All have valves"],
                answer: "A",
                explanation: "Veins have valves to prevent backflow of blood."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "Which vessels have thinnest walls?",
                example: "",
                options: ["Capillaries", "Arteries", "Veins", "All are equal"],
                answer: "A",
                explanation: "Capillary walls are one cell thick for easy diffusion."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "What is blood pressure?",
                example: "",
                options: ["Force of blood against artery walls", "Amount of blood in body", "Speed of blood flow", "Heart rate"],
                answer: "A",
                explanation: "Blood pressure is the force blood exerts against artery walls."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "What is normal blood pressure for adults?",
                example: "",
                options: ["120/80 mmHg", "100/60 mmHg", "140/90 mmHg", "90/50 mmHg"],
                answer: "A",
                explanation: "120/80 mmHg is considered normal blood pressure."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "What carries oxygenated blood to brain?",
                example: "",
                options: ["Carotid arteries", "Jugular veins", "Coronary arteries", "Renal arteries"],
                answer: "A",
                explanation: "Carotid arteries supply oxygenated blood to brain."
            },
            {
                type: "circulatory",
                category: "vessels",
                question: "What carries deoxygenated blood from brain?",
                example: "",
                options: ["Jugular veins", "Carotid arteries", "Coronary veins", "Renal veins"],
                answer: "A",
                explanation: "Jugular veins return deoxygenated blood from brain to heart."
            },

            // Blood Components (81-90)
            {
                type: "circulatory",
                category: "blood",
                question: "What is the liquid part of blood?",
                example: "",
                options: ["Plasma", "Red blood cells", "White blood cells", "Platelets"],
                answer: "A",
                explanation: "Plasma is 55% of blood volume, carrying nutrients, hormones, waste."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "What carries oxygen in blood?",
                example: "",
                options: ["Red blood cells", "White blood cells", "Platelets", "Plasma"],
                answer: "A",
                explanation: "Red blood cells contain hemoglobin that binds with oxygen."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "What fights infections?",
                example: "",
                options: ["White blood cells", "Red blood cells", "Platelets", "Plasma"],
                answer: "A",
                explanation: "White blood cells are part of immune system, fighting infections."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "What helps blood clotting?",
                example: "",
                options: ["Platelets", "Red blood cells", "White blood cells", "Plasma"],
                answer: "A",
                explanation: "Platelets form clots to stop bleeding at injury sites."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "How long do red blood cells live?",
                example: "",
                options: ["120 days", "7 days", "1 year", "Forever"],
                answer: "A",
                explanation: "Red blood cells live about 120 days before being replaced."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "Where are blood cells made?",
                example: "",
                options: ["Bone marrow", "Heart", "Liver", "Lungs"],
                answer: "A",
                explanation: "Bone marrow produces red blood cells, white blood cells, and platelets."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "What percentage of blood is red blood cells?",
                example: "",
                options: ["45%", "55%", "1%", "10%"],
                answer: "A",
                explanation: "Red blood cells make up about 45% of blood volume (hematocrit)."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "What is anemia?",
                example: "",
                options: ["Low red blood cells or hemoglobin", "High blood pressure", "High cholesterol", "Heart attack"],
                answer: "A",
                explanation: "Anemia is deficiency of red blood cells or hemoglobin, reducing oxygen transport."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "What is leukemia?",
                example: "",
                options: ["Cancer of white blood cells", "Heart disease", "Lung infection", "Blood clotting disorder"],
                answer: "A",
                explanation: "Leukemia is cancer of white blood cells."
            },
            {
                type: "circulatory",
                category: "blood",
                question: "What is hemophilia?",
                example: "",
                options: ["Poor blood clotting", "High blood pressure", "Low oxygen", "Fast heart rate"],
                answer: "A",
                explanation: "Hemophilia is genetic disorder causing poor blood clotting."
            },

            // Circulatory Health & Disorders (91-100)
            {
                type: "circulatory",
                category: "health",
                question: "What is a heart attack?",
                example: "",
                options: ["Blocked blood flow to heart muscle", "Fast heartbeat", "Slow heartbeat", "Heart enlargement"],
                answer: "A",
                explanation: "Heart attack occurs when coronary arteries are blocked, depriving heart muscle of oxygen."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What is hypertension?",
                example: "",
                options: ["High blood pressure", "Low blood pressure", "Fast heart rate", "Slow heart rate"],
                answer: "A",
                explanation: "Hypertension is chronically high blood pressure (>140/90 mmHg)."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What is atherosclerosis?",
                example: "",
                options: ["Hardening of arteries", "Softening of veins", "Heart enlargement", "Blood thinning"],
                answer: "A",
                explanation: "Atherosclerosis is buildup of plaque in artery walls."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What is stroke?",
                example: "",
                options: ["Brain damage from blocked blood flow", "Heart stoppage", "Lung collapse", "Liver failure"],
                answer: "A",
                explanation: "Stroke occurs when blood flow to brain is interrupted."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What helps prevent heart disease?",
                example: "",
                options: ["Exercise and healthy diet", "Smoking", "High salt diet", "No exercise"],
                answer: "A",
                explanation: "Regular exercise and balanced diet help prevent cardiovascular diseases."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What does CPR stand for?",
                example: "",
                options: ["Cardiopulmonary resuscitation", "Cardiac pressure relief", "Circulatory pulmonary response", "Cardiac pulse restoration"],
                answer: "A",
                explanation: "CPR helps maintain blood flow and breathing in emergency situations."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What is the purpose of defibrillator?",
                example: "",
                options: ["Restart normal heart rhythm", "Increase blood pressure", "Decrease heart rate", "Clean arteries"],
                answer: "A",
                explanation: "Defibrillator gives electric shock to restore normal heart rhythm."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What is blood donation?",
                example: "",
                options: ["Giving blood to help others", "Taking blood for tests", "Blood transfusion to self", "Blood cleaning"],
                answer: "A",
                explanation: "Blood donation provides blood for patients needing transfusions."
            },
            {
                type: "circulatory",
                category: "health",
                question: "What are blood types?",
                example: "",
                options: ["A, B, AB, O", "1, 2, 3, 4", "X, Y, Z", "Red, white, blue"],
                answer: "A",
                explanation: "Main blood groups are A, B, AB, and O, with positive or negative Rh factor."
            },
            {
                type: "circulatory",
                category: "health",
                question: "Why is universal donor O negative important?",
                example: "",
                options: ["Can donate to all blood types", "Can receive from all", "Most common type", "Rarest type"],
                answer: "A",
                explanation: "O negative blood lacks A, B, and Rh antigens, so it's safe for most recipients in emergencies."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const exampleDisplay = document.getElementById('exampleDisplay');
        const diagramContainer = document.getElementById('diagramContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const accuracyRate = document.getElementById('accuracyRate');
        const systemMastery = document.getElementById('systemMastery');

        // Initialize the app
        function initApp() {
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', showWelcomePage);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') startPractice();
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'block';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            const accuracy = appState.answered > 0 ? Math.round((appState.score / appState.answered) * 100) : 0;
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            accuracyRate.textContent = `${accuracy}%`;
            systemMastery.textContent = `${percentage}%`;
        }

        // Create system display
        function createSystemDisplay() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const systemType = question.type;
            
            const display = document.createElement('div');
            display.className = `system-card ${systemType}`;
            
            if (systemType === "respiratory") {
                display.innerHTML = `
                    <h3 style="color: var(--primary-red); margin-bottom: 10px;">ü´Å Respiratory System</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 10px;">
                        Responsible for breathing and gas exchange between body and environment.
                    </p>
                    <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 6px;">
                        <strong>Key Organs:</strong> Lungs, trachea, bronchi, alveoli, diaphragm<br>
                        <strong>Function:</strong> Oxygen in, carbon dioxide out
                    </div>
                `;
            } else {
                display.innerHTML = `
                    <h3 style="color: var(--secondary-blue); margin-bottom: 10px;">‚ù§Ô∏è Circulatory System</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 10px;">
                        Responsible for transporting blood, nutrients, gases, and waste throughout body.
                    </p>
                    <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 6px;">
                        <strong>Key Organs:</strong> Heart, blood vessels (arteries, veins, capillaries)<br>
                        <strong>Function:</strong> Transport and circulation
                    </div>
                `;
            }
            
            return display;
        }

        // Create diagram based on question
        function createDiagram() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const category = question.category;
            
            const diagramDiv = document.createElement('div');
            diagramDiv.className = 'diagram-container';
            
            if (question.type === "respiratory") {
                if (category === "organs") {
                    diagramDiv.innerHTML = `
                        <h4 style="color: var(--primary-red); margin-bottom: 15px;">Respiratory System Diagram</h4>
                        <div style="display: flex; justify-content: center; flex-wrap: wrap; gap: 10px;">
                            <div class="organ-label label-lungs">Lungs</div>
                            <div class="organ-label" style="border-color: #FF9800; color: #FF9800;">Trachea</div>
                            <div class="organ-label" style="border-color: #4CAF50; color: #4CAF50;">Bronchi</div>
                            <div class="organ-label" style="border-color: #9C27B0; color: #9C27B0;">Alveoli</div>
                            <div class="organ-label" style="border-color: #00BCD4; color: #00BCD4;">Diaphragm</div>
                        </div>
                        <p style="color: var(--text-secondary); margin-top: 15px;">
                            Air flow: Nose/Mouth ‚Üí Trachea ‚Üí Bronchi ‚Üí Bronchioles ‚Üí Alveoli
                        </p>
                    `;
                } else if (category === "process") {
                    diagramDiv.innerHTML = `
                        <h4 style="color: var(--primary-red); margin-bottom: 15px;">Gas Exchange Process</h4>
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px; margin: 15px 0;">
                            <div style="text-align: center;">
                                <div style="background: rgba(244, 67, 54, 0.2); padding: 15px; border-radius: 8px; border: 2px solid var(--primary-red);">
                                    <strong>Alveolus</strong><br>
                                    O‚ÇÇ High ‚Üí Low
                                </div>
                                <div style="margin-top: 10px; font-size: 0.9rem;">Oxygen enters blood</div>
                            </div>
                            <div style="font-size: 2rem;">‚áÑ</div>
                            <div style="text-align: center;">
                                <div style="background: rgba(33, 150, 243, 0.2); padding: 15px; border-radius: 8px; border: 2px solid var(--secondary-blue);">
                                    <strong>Capillary</strong><br>
                                    CO‚ÇÇ High ‚Üí Low
                                </div>
                                <div style="margin-top: 10px; font-size: 0.9rem;">Carbon dioxide leaves blood</div>
                            </div>
                        </div>
                    `;
                }
            } else if (question.type === "circulatory") {
                if (category === "heart" || category === "basics") {
                    diagramDiv.innerHTML = `
                        <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Heart Chambers & Blood Flow</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                            <div style="background: rgba(244, 67, 54, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                                <strong>Right Side</strong><br>
                                Deoxygenated blood<br>
                                Body ‚Üí Heart ‚Üí Lungs
                            </div>
                            <div style="background: rgba(33, 150, 243, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                                <strong>Left Side</strong><br>
                                Oxygenated blood<br>
                                Lungs ‚Üí Heart ‚Üí Body
                            </div>
                        </div>
                        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 15px;">
                            <div class="organ-label label-heart">Right Atrium</div>
                            <div class="organ-label label-heart">Right Ventricle</div>
                            <div class="organ-label label-heart">Left Atrium</div>
                            <div class="organ-label label-heart">Left Ventricle</div>
                        </div>
                    `;
                } else if (category === "vessels") {
                    diagramDiv.innerHTML = `
                        <h4 style="color: var(--secondary-blue); margin-bottom: 15px;">Blood Vessels Comparison</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 15px 0;">
                            <div style="background: rgba(233, 30, 99, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                                <strong>Arteries</strong><br>
                                Away from heart<br>
                                Thick walls<br>
                                High pressure
                            </div>
                            <div style="background: rgba(156, 39, 176, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                                <strong>Veins</strong><br>
                                Toward heart<br>
                                Valves<br>
                                Low pressure
                            </div>
                            <div style="background: rgba(76, 175, 80, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                                <strong>Capillaries</strong><br>
                                Exchange sites<br>
                                Thin walls<br>
                                Connect arteries/veins
                            </div>
                        </div>
                    `;
                }
            }
            
            return diagramDiv;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            // Clear containers
            exampleDisplay.innerHTML = '';
            diagramContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            // Add system display
            const systemDisplay = createSystemDisplay();
            exampleDisplay.appendChild(systemDisplay);
            exampleDisplay.style.display = 'block';
            
            // Add diagram if appropriate
            if (Math.random() > 0.3) { // 70% chance to show diagram
                const diagram = createDiagram();
                if (diagram.innerHTML.trim() !== '') {
                    diagramContainer.appendChild(diagram);
                }
            }
            
            // Add options
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackExplanation.textContent = `Correct answer: ${correctOption} (${correctText})\n\n${explanation}`;
                }
            }
            
            if (isCorrect) {
                feedbackExplanation.textContent = explanation;
            }
            
            feedbackContainer.style.display = 'block';
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            saveStateToStorage();
            showPracticePage();
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Load/save state
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixBodySystems');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            } else {
                initializeQuestions();
            }
        }

        function saveStateToStorage() {
            localStorage.setItem('ideolixBodySystems', JSON.stringify(appState));
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
