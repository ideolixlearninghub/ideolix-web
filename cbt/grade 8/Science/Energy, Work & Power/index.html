<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 8 Science - Energy, Work & Power | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Energy/Physics Theme */
        :root {
            --primary-blue: #2196F3;
            --primary-green: #4CAF50;
            --primary-orange: #FF9800;
            --primary-yellow: #FFC107;
            --primary-red: #F44336;
            --primary-purple: #9C27B0;
            --accent-teal: #009688;
            --accent-amber: #FFA000;
            --accent-pink: #E91E63;
            --accent-indigo: #3F51B5;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --kinetic-yellow: rgba(255, 193, 7, 0.3);
            --potential-green: rgba(76, 175, 80, 0.3);
            --thermal-red: rgba(244, 67, 54, 0.3);
            --electrical-blue: rgba(33, 150, 243, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(33, 150, 243, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 193, 7, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(76, 175, 80, 0.05) 0%, transparent 70%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            border-radius: 10px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info h1 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 30px 20px;
        }

        .welcome-title {
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-blue), var(--primary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 25px;
            max-width: 800px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 193, 7, 0.15);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 20px;
            border: 2px solid var(--primary-yellow);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-yellow);
        }

        .input-group {
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            font-size: 1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }

        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(33, 150, 243, 0.4);
        }

        .btn-secondary {
            background: var(--primary-yellow);
            color: #333;
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
        }

        .btn-secondary:hover {
            background: #e6ac00;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 193, 7, 0.4);
        }

        .btn-green {
            background: var(--primary-green);
            color: white;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .btn-green:hover {
            background: #388E3C;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
        }

        .btn-orange {
            background: var(--primary-orange);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }

        .btn-orange:hover {
            background: #F57C00;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 152, 0, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Topics Grid */
        .topics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .topics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 576px) {
            .topics-grid {
                grid-template-columns: 1fr;
            }
        }

        .topic-card {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .topic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .topic-card.energy {
            border-color: var(--primary-yellow);
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), transparent);
        }

        .topic-card.transformations {
            border-color: var(--primary-blue);
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), transparent);
        }

        .topic-card.work-power {
            border-color: var(--primary-green);
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), transparent);
        }

        .topic-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .topic-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .topic-card.energy .topic-title {
            color: var(--primary-yellow);
        }

        .topic-card.transformations .topic-title {
            color: var(--primary-blue);
        }

        .topic-card.work-power .topic-title {
            color: var(--primary-green);
        }

        .topic-features {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--dark-border);
        }

        .topic-features h4 {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .feature-list {
            list-style-type: none;
        }

        .feature-list li {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-bottom: 4px;
            padding-left: 15px;
            position: relative;
        }

        .feature-list li:before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: var(--accent-teal);
        }

        /* Practice Page */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 20px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 8px;
            background: var(--dark-surface);
            border-radius: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-yellow), var(--primary-blue), var(--primary-green));
            border-radius: 8px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        .question-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .physics-tip {
            background: rgba(255, 152, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid var(--primary-orange);
            font-style: italic;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Options */
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .option {
            padding: 15px;
            background: var(--dark-card);
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--primary-red);
            color: var(--primary-red);
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 25px;
            height: 25px;
            background: var(--primary-blue);
            border-radius: 50%;
            margin-right: 12px;
            font-weight: bold;
            color: white;
        }

        .option.correct .option-letter {
            background: var(--primary-green);
        }

        .option.incorrect .option-letter {
            background: var(--primary-red);
        }

        /* Feedback */
        .feedback-container {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid var(--primary-green);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 4px solid var(--primary-red);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-green);
        }

        .feedback-incorrect .feedback-icon {
            background: var(--primary-red);
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-green);
        }

        .feedback-incorrect .feedback-title {
            color: var(--primary-red);
        }

        .feedback-explanation {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Navigation */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        /* Visualization Area */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--dark-border);
            overflow: auto;
        }

        /* Energy Forms Visualizer */
        .energy-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-yellow);
        }

        .visualizer-title {
            color: var(--primary-yellow);
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .energy-canvas-container {
            width: 100%;
            height: 250px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .energy-canvas {
            width: 100%;
            height: 100%;
        }

        .energy-info {
            background: var(--dark-surface);
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            display: none;
        }

        .energy-info.show {
            display: block;
        }

        .process-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .process-controls {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .process-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .process-btn:hover {
            background: rgba(255, 193, 7, 0.1);
            border-color: var(--primary-yellow);
        }

        .process-btn.active {
            background: var(--primary-yellow);
            color: #333;
        }

        /* Energy Transformations Visualizer */
        .transformation-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-blue);
        }

        .transformation-canvas-container {
            width: 100%;
            height: 250px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .transformation-canvas {
            width: 100%;
            height: 100%;
        }

        .transformation-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .transformation-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .transformation-btn:hover {
            background: rgba(33, 150, 243, 0.1);
            border-color: var(--primary-blue);
        }

        .transformation-btn.active {
            background: var(--primary-blue);
            color: white;
        }

        /* Work & Power Visualizer */
        .work-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-green);
        }

        .work-canvas-container {
            width: 100%;
            height: 250px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .work-canvas {
            width: 100%;
            height: 100%;
        }

        .work-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .work-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .work-btn:hover {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--primary-green);
        }

        .work-btn.active {
            background: var(--primary-green);
            color: white;
        }

        /* Laws of Energy Visualizer */
        .laws-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-purple);
        }

        .laws-canvas-container {
            width: 100%;
            height: 200px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .laws-canvas {
            width: 100%;
            height: 100%;
        }

        .laws-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .laws-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .laws-btn:hover {
            background: rgba(156, 39, 176, 0.1);
            border-color: var(--primary-purple);
        }

        .laws-btn.active {
            background: var(--primary-purple);
            color: white;
        }

        /* Comparison Table */
        .comparison-table {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-teal);
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        th {
            background: var(--dark-surface);
            padding: 10px;
            text-align: left;
            color: var(--text-primary);
            border-bottom: 2px solid var(--dark-border);
        }

        td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-secondary);
        }

        tr:hover td {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Properties Display */
        .properties-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-amber);
        }

        .properties-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .properties-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .property-card {
            background: var(--dark-surface);
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .property-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .property-card.kinetic {
            border-left-color: var(--primary-yellow);
        }

        .property-card.potential {
            border-left-color: var(--primary-green);
        }

        .property-card.electrical {
            border-left-color: var(--primary-blue);
        }

        .property-card.thermal {
            border-left-color: var(--primary-red);
        }

        .property-title {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .property-value {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Experiment Simulator */
        .experiment-simulator {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-pink);
        }

        .experiment-container {
            width: 100%;
            height: 200px;
            position: relative;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--dark-border);
        }

        .experiment-canvas {
            width: 100%;
            height: 100%;
        }

        .experiment-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .experiment-btn {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .experiment-btn:hover {
            background: rgba(233, 30, 99, 0.1);
            border-color: var(--accent-pink);
        }

        .experiment-btn.active {
            background: var(--accent-pink);
            color: white;
        }

        /* Interactive Quiz */
        .interactive-quiz {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--accent-indigo);
        }

        .quiz-question {
            margin: 10px 0;
            color: var(--text-primary);
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 5px;
            margin: 10px 0;
        }

        .quiz-option {
            padding: 8px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quiz-option:hover {
            background: rgba(63, 81, 181, 0.1);
            border-color: var(--accent-indigo);
        }

        .quiz-option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        .quiz-option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--primary-red);
            color: var(--primary-red);
        }

        /* Calculator */
        .calculator {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--primary-orange);
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .calculator-btn {
            padding: 10px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
        }

        .calculator-btn:hover {
            background: rgba(255, 152, 0, 0.1);
            border-color: var(--primary-orange);
        }

        .calculator-btn.operator {
            background: rgba(255, 152, 0, 0.2);
        }

        .calculator-display {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 1.2rem;
            text-align: right;
            min-height: 40px;
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 30px 20px;
        }

        .results-title {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-blue), var(--primary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            margin: 0 auto 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        @keyframes energyFlow {
            0% { transform: translateX(-100px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        .energy-animate {
            animation: energyFlow 0.5s ease forwards;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 1.8rem;
            }
            
            .topics-grid {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .process-controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .experiment-controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .properties-grid {
                grid-template-columns: 1fr;
            }
            
            .calculator-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <h1 class="welcome-title">Grade 8 Science: Energy, Work & Power</h1>
            <p class="welcome-subtitle">Discover the science of energy! Explore different energy forms, understand how energy transforms from one type to another, and learn about work and power through interactive simulations and real-world applications.</p>
            
            <div class="topic-badge">
                <span class="topic-icon">âš¡ðŸ”‹</span>
                <span class="topic-name">Physics & Energy Concepts</span>
            </div>
            
            <div class="topics-grid">
                <div class="topic-card energy" onclick="showTopicInfo('energy')">
                    <div class="topic-icon">âš¡</div>
                    <h3 class="topic-title">Energy Forms</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">Different types of energy in our universe</p>
                    <div class="topic-features">
                        <h4>Key Concepts:</h4>
                        <ul class="feature-list">
                            <li>Kinetic & Potential Energy</li>
                            <li>Thermal, Electrical, Chemical</li>
                            <li>Nuclear & Sound Energy</li>
                            <li>Renewable vs Non-renewable</li>
                        </ul>
                    </div>
                </div>
                
                <div class="topic-card transformations" onclick="showTopicInfo('transformations')">
                    <div class="topic-icon">ðŸ”„</div>
                    <h3 class="topic-title">Energy Transformations</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">How energy changes from one form to another</p>
                    <div class="topic-features">
                        <h4>Key Concepts:</h4>
                        <ul class="feature-list">
                            <li>Law of Conservation of Energy</li>
                            <li>Energy transfer efficiency</li>
                            <li>Everyday transformations</li>
                            <li>Energy chains & diagrams</li>
                        </ul>
                    </div>
                </div>
                
                <div class="topic-card work-power" onclick="showTopicInfo('work')">
                    <div class="topic-icon">ðŸ’ª</div>
                    <h3 class="topic-title">Work & Power</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">The science of doing work and using energy</p>
                    <div class="topic-features">
                        <h4>Key Concepts:</h4>
                        <ul class="feature-list">
                            <li>Work = Force Ã— Distance</li>
                            <li>Power = Work / Time</li>
                            <li>Simple machines</li>
                            <li>Efficiency calculations</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your name:</label>
                <input type="text" id="studentName" placeholder="Your name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>âš¡ Begin Energy Study</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 25</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 4%"></div>
                </div>
            </div>

            <div class="question-container">
                <div id="physicsTip"></div>
                
                <h2 class="question-text" id="questionText"></h2>
                
                <div class="options-container" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-explanation" id="feedbackExplanation"></div>
                </div>
            </div>
            
            <!-- Visualization Area -->
            <div class="content-wrapper">
                <div class="visualization-container">
                    <!-- Energy Forms Visualizer -->
                    <div class="energy-visualizer">
                        <div class="visualizer-title">Forms of Energy</div>
                        <div class="energy-canvas-container">
                            <canvas class="energy-canvas" id="energyCanvas"></canvas>
                        </div>
                        <div class="energy-info" id="energyInfo">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <div style="font-weight: bold; color: var(--primary-yellow);" id="energyType"></div>
                                    <div style="font-size: 0.9rem;" id="energyExample"></div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Unit</div>
                                    <div style="font-weight: bold;" id="energyUnit"></div>
                                </div>
                            </div>
                            <div style="margin-top: 10px; font-size: 0.85rem; color: var(--text-secondary);" id="energyDescription"></div>
                        </div>
                        <div class="process-controls">
                            <div class="process-btn active" onclick="showEnergyType('kinetic')">Kinetic</div>
                            <div class="process-btn" onclick="showEnergyType('potential')">Potential</div>
                            <div class="process-btn" onclick="showEnergyType('thermal')">Thermal</div>
                            <div class="process-btn" onclick="showEnergyType('electrical')">Electrical</div>
                            <div class="process-btn" onclick="showEnergyType('chemical')">Chemical</div>
                            <div class="process-btn" onclick="showEnergyType('nuclear')">Nuclear</div>
                            <div class="process-btn" onclick="showEnergyType('sound')">Sound</div>
                            <div class="process-btn" onclick="showEnergyType('light')">Light</div>
                            <div class="process-btn" onclick="showEnergyType('mechanical')">Mechanical</div>
                        </div>
                    </div>
                    
                    <!-- Energy Calculator -->
                    <div class="calculator">
                        <div class="visualizer-title">Energy Calculator</div>
                        <div class="calculator-display" id="calcDisplay">0</div>
                        <div class="calculator-grid">
                            <div class="calculator-btn" onclick="appendToDisplay('7')">7</div>
                            <div class="calculator-btn" onclick="appendToDisplay('8')">8</div>
                            <div class="calculator-btn" onclick="appendToDisplay('9')">9</div>
                            <div class="calculator-btn operator" onclick="appendToDisplay('+')">+</div>
                            <div class="calculator-btn" onclick="appendToDisplay('4')">4</div>
                            <div class="calculator-btn" onclick="appendToDisplay('5')">5</div>
                            <div class="calculator-btn" onclick="appendToDisplay('6')">6</div>
                            <div class="calculator-btn operator" onclick="appendToDisplay('-')">-</div>
                            <div class="calculator-btn" onclick="appendToDisplay('1')">1</div>
                            <div class="calculator-btn" onclick="appendToDisplay('2')">2</div>
                            <div class="calculator-btn" onclick="appendToDisplay('3')">3</div>
                            <div class="calculator-btn operator" onclick="appendToDisplay('*')">Ã—</div>
                            <div class="calculator-btn" onclick="appendToDisplay('0')">0</div>
                            <div class="calculator-btn" onclick="appendToDisplay('.')">.</div>
                            <div class="calculator-btn operator" onclick="calculateResult()">=</div>
                            <div class="calculator-btn operator" onclick="clearDisplay()">C</div>
                        </div>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="calculateKineticEnergy()">KE = Â½mvÂ²</button>
                            <button class="btn btn-small btn-green" onclick="calculatePotentialEnergy()">PE = mgh</button>
                            <button class="btn btn-small btn-orange" onclick="calculateWork()">Work = F Ã— d</button>
                            <button class="btn btn-small btn-primary" onclick="calculatePower()">Power = W/t</button>
                        </div>
                    </div>
                    
                    <!-- Comparison Table -->
                    <div class="comparison-table">
                        <div class="visualizer-title">Kinetic vs Potential Energy</div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Aspect</th>
                                        <th>Kinetic Energy</th>
                                        <th>Potential Energy</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Definition</td>
                                        <td>Energy of motion</td>
                                        <td>Stored energy due to position</td>
                                    </tr>
                                    <tr>
                                        <td>Formula</td>
                                        <td>KE = Â½ Ã— m Ã— vÂ²</td>
                                        <td>PE = m Ã— g Ã— h</td>
                                    </tr>
                                    <tr>
                                        <td>Units</td>
                                        <td>Joules (J)</td>
                                        <td>Joules (J)</td>
                                    </tr>
                                    <tr>
                                        <td>Examples</td>
                                        <td>Moving car, flowing water</td>
                                        <td>Book on shelf, stretched spring</td>
                                    </tr>
                                    <tr>
                                        <td>Factors</td>
                                        <td>Mass & velocity</td>
                                        <td>Mass, height & gravity</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="showEnergyConversions()">Conversions</button>
                            <button class="btn btn-small btn-orange" onclick="testYourKnowledge()">Quick Quiz</button>
                        </div>
                    </div>
                    
                    <!-- Interactive Quiz -->
                    <div class="interactive-quiz">
                        <div class="visualizer-title">Quick Knowledge Check</div>
                        <div class="quiz-question" id="quizQuestion">What is the unit of energy?</div>
                        <div class="quiz-options" id="quizOptions">
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'A')">A) Joule</div>
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'B')">B) Watt</div>
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'C')">C) Newton</div>
                            <div class="quiz-option" onclick="checkQuizAnswer(this, 'D')">D) Pascal</div>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="nextQuizQuestion()">Next Question</button>
                        </div>
                    </div>
                </div>
                
                <div class="visualization-container">
                    <!-- Energy Transformations Visualizer -->
                    <div class="transformation-visualizer">
                        <div class="visualizer-title">Energy Transformations</div>
                        <div class="transformation-canvas-container">
                            <canvas class="transformation-canvas" id="transformationCanvas"></canvas>
                        </div>
                        <div class="transformation-controls">
                            <div class="transformation-btn active" onclick="showTransformation('battery')">Battery-powered</div>
                            <div class="transformation-btn" onclick="showTransformation('solar')">Solar Panel</div>
                            <div class="transformation-btn" onclick="showTransformation('hydro')">Hydroelectric Dam</div>
                            <div class="transformation-btn" onclick="showTransformation('human')">Human Body</div>
                            <div class="transformation-btn" onclick="showTransformation('car')">Car Engine</div>
                            <div class="transformation-btn" onclick="showTransformation('bulb')">Light Bulb</div>
                            <div class="transformation-btn" onclick="toggleAnimation()">Animation: On</div>
                            <div class="transformation-btn" onclick="showEfficiency()">Efficiency</div>
                            <div class="transformation-btn" onclick="resetTransformation()">Reset</div>
                        </div>
                    </div>
                    
                    <!-- Work & Power Visualizer -->
                    <div class="work-visualizer">
                        <div class="visualizer-title">Work & Power Concepts</div>
                        <div class="work-canvas-container">
                            <canvas class="work-canvas" id="workCanvas"></canvas>
                        </div>
                        <div class="work-controls">
                            <div class="work-btn active" onclick="showWorkExample('lifting')">Lifting Object</div>
                            <div class="work-btn" onclick="showWorkExample('pushing')">Pushing Box</div>
                            <div class="work-btn" onclick="showWorkExample('climbing')">Climbing Stairs</div>
                            <div class="work-btn" onclick="showWorkExample('machine')">Simple Machines</div>
                            <div class="work-btn" onclick="showWorkExample('noWork')">No Work Done</div>
                            <div class="work-btn" onclick="showWorkExample('power')">Power Comparison</div>
                            <div class="work-btn" onclick="varyForce()">Vary Force</div>
                            <div class="work-btn" onclick="varyDistance()">Vary Distance</div>
                            <div class="work-btn" onclick="varyTime()">Vary Time</div>
                        </div>
                    </div>
                    
                    <!-- Properties Display -->
                    <div class="properties-display">
                        <div class="visualizer-title">Energy Properties & Units</div>
                        <div class="properties-grid">
                            <div class="property-card kinetic" onclick="showProperty('joule')">
                                <div class="property-title">âš¡ Joule (J)</div>
                                <div class="property-value">SI unit of energy & work</div>
                            </div>
                            <div class="property-card potential" onclick="showProperty('watt')">
                                <div class="property-title">ðŸ’¡ Watt (W)</div>
                                <div class="property-value">SI unit of power (J/s)</div>
                            </div>
                            <div class="property-card electrical" onclick="showProperty('kilowatt')">
                                <div class="property-title">ðŸ”Œ Kilowatt-hour</div>
                                <div class="property-value">Energy unit for electricity</div>
                            </div>
                            <div class="property-card thermal" onclick="showProperty('calorie')">
                                <div class="property-title">ðŸ”¥ Calorie (cal)</div>
                                <div class="property-value">Heat energy unit</div>
                            </div>
                            <div class="property-card kinetic" onclick="showProperty('efficiency')">
                                <div class="property-title">ðŸ“ˆ Efficiency</div>
                                <div class="property-value">Useful output / total input</div>
                            </div>
                            <div class="property-card potential" onclick="showProperty('conservation')">
                                <div class="property-title">â™»ï¸ Conservation</div>
                                <div class="property-value">Energy cannot be created/destroyed</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="showUnitConversions()">Unit Conversions</button>
                            <button class="btn btn-small btn-purple" onclick="showRealWorldValues()">Real World Values</button>
                        </div>
                    </div>
                    
                    <!-- Laws of Energy Visualizer -->
                    <div class="laws-visualizer">
                        <div class="visualizer-title">Laws of Energy</div>
                        <div class="laws-canvas-container">
                            <canvas class="laws-canvas" id="lawsCanvas"></canvas>
                        </div>
                        <div class="laws-controls">
                            <div class="laws-btn active" onclick="showLaw('conservation')">Conservation</div>
                            <div class="laws-btn" onclick="showLaw('thermodynamics')">Thermodynamics</div>
                            <div class="laws-btn" onclick="showLaw('entropy')">Entropy</div>
                            <div class="laws-btn" onclick="showLaw('efficiency')">Energy Efficiency</div>
                            <div class="laws-btn" onclick="showLaw('sankey')">Sankey Diagram</div>
                            <div class="laws-btn" onclick="showLaw('waste')">Energy Waste</div>
                        </div>
                    </div>
                    
                    <!-- Experiment Simulator -->
                    <div class="experiment-simulator">
                        <div class="visualizer-title">Energy Experiments</div>
                        <div class="experiment-container">
                            <canvas class="experiment-canvas" id="experimentCanvas"></canvas>
                        </div>
                        <div class="experiment-controls">
                            <div class="experiment-btn active" onclick="runExperiment('pendulum')">Pendulum</div>
                            <div class="experiment-btn" onclick="runExperiment('rollercoaster')">Roller Coaster</div>
                            <div class="experiment-btn" onclick="runExperiment('bouncyBall')">Bouncy Ball</div>
                            <div class="experiment-btn" onclick="runExperiment('ramp')">Ball on Ramp</div>
                            <div class="experiment-btn" onclick="runExperiment('spring')">Spring Energy</div>
                            <div class="experiment-btn" onclick="runExperiment('circuit')">Electrical Circuit</div>
                            <div class="experiment-btn" onclick="pauseExperiment()">Pause</div>
                            <div class="experiment-btn" onclick="resetExperiment()">Reset</div>
                        </div>
                    </div>
                    
                    <!-- Real-World Applications -->
                    <div class="comparison-table" style="border-color: var(--accent-teal);">
                        <div class="visualizer-title">Real-World Applications</div>
                        <div style="margin: 10px 0; padding: 10px; background: var(--dark-surface); border-radius: 6px;">
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">ðŸ­ Power Plants</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Convert various energies to electrical</div>
                                </div>
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">ðŸš— Transportation</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Chemical â†’ kinetic energy</div>
                                </div>
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">ðŸ  Home Appliances</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Electrical â†’ other forms</div>
                                </div>
                                <div style="padding: 8px; background: rgba(0, 150, 136, 0.1); border-radius: 4px;">
                                    <div style="font-weight: bold; color: var(--accent-teal);">ðŸŒž Renewable Energy</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">Solar, wind, hydro power</div>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="showEnergySources()">Energy Sources</button>
                            <button class="btn btn-small btn-blue" onclick="showSustainability()">Sustainability</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn btn-orange" id="skipQuestion">Skip Question</button>
                <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Energy Study Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="timeSpent">0min</div>
                        <div class="stat-label">Time Spent</div>
                    </div>
                </div>
                
                <div class="btn-group" style="margin-top: 20px;">
                    <button class="btn btn-primary" id="retryTopic">Try Again</button>
                    <button class="btn btn-secondary" id="viewTopics">Other Topics</button>
                    <button class="btn btn-green" id="printCertificate">Print Certificate</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Questions array - 25 focused questions on Energy, Work & Power
        const questions = [
            {
                question: "What is the SI unit of energy?",
                options: ["Joule", "Watt", "Newton", "Pascal"],
                answer: "A",
                explanation: "The joule (J) is the SI unit of energy. One joule is the energy transferred when a force of one newton moves an object one meter."
            },
            {
                question: "Which type of energy is stored in a stretched spring?",
                options: ["Elastic potential energy", "Kinetic energy", "Thermal energy", "Chemical energy"],
                answer: "A",
                explanation: "A stretched spring has elastic potential energy - energy stored in objects that are stretched or compressed."
            },
            {
                question: "What is the formula for kinetic energy?",
                options: ["KE = Â½ Ã— m Ã— vÂ²", "KE = m Ã— g Ã— h", "KE = F Ã— d", "KE = P Ã— t"],
                answer: "A",
                explanation: "Kinetic energy = Â½ Ã— mass Ã— velocityÂ². It depends on both mass and speed of the object."
            },
            {
                question: "According to the law of conservation of energy, energy cannot be:",
                options: ["Created or destroyed", "Transformed", "Transferred", "Measured"],
                answer: "A",
                explanation: "Energy can be transformed from one form to another and transferred between objects, but the total amount of energy remains constant."
            },
            {
                question: "What type of energy transformation occurs in a battery-powered flashlight?",
                options: ["Chemical â†’ Electrical â†’ Light", "Electrical â†’ Chemical â†’ Light", "Light â†’ Electrical â†’ Chemical", "Thermal â†’ Electrical â†’ Light"],
                answer: "A",
                explanation: "Batteries convert chemical energy to electrical energy, which powers the bulb to produce light energy."
            },
            {
                question: "How much work is done when a force of 10 N moves an object 5 m?",
                options: ["50 J", "2 J", "15 J", "500 J"],
                answer: "A",
                explanation: "Work = Force Ã— Distance = 10 N Ã— 5 m = 50 J (joules)"
            },
            {
                question: "Which device converts electrical energy to mechanical energy?",
                options: ["Electric motor", "Generator", "Battery", "Solar panel"],
                answer: "A",
                explanation: "Electric motors convert electrical energy to mechanical energy (motion). Generators do the opposite."
            },
            {
                question: "What is the SI unit of power?",
                options: ["Watt", "Joule", "Newton", "Volt"],
                answer: "A",
                explanation: "The watt (W) is the SI unit of power. One watt = one joule per second."
            },
            {
                question: "Which has more kinetic energy: a car moving at 60 km/h or the same car moving at 30 km/h?",
                options: ["Car at 60 km/h", "Car at 30 km/h", "Both have the same", "Cannot determine"],
                answer: "A",
                explanation: "Kinetic energy depends on velocity squared. Doubling the speed quadruples the kinetic energy (if mass is constant)."
            },
            {
                question: "What type of energy is associated with the motion of particles?",
                options: ["Thermal energy", "Chemical energy", "Nuclear energy", "Sound energy"],
                answer: "A",
                explanation: "Thermal energy is the total kinetic energy of all particles in a substance due to their random motion."
            },
            {
                question: "Which energy source is renewable?",
                options: ["Solar energy", "Coal", "Natural gas", "Petroleum"],
                answer: "A",
                explanation: "Solar energy is renewable - it won't run out. Fossil fuels (coal, oil, gas) are non-renewable."
            },
            {
                question: "What is potential energy that depends on height called?",
                options: ["Gravitational potential energy", "Elastic potential energy", "Chemical potential energy", "Magnetic potential energy"],
                answer: "A",
                explanation: "Gravitational potential energy = mass Ã— gravity Ã— height. It increases as height increases."
            },
            {
                question: "How is power related to work and time?",
                options: ["Power = Work Ã· Time", "Power = Work Ã— Time", "Power = Force Ã· Time", "Power = Energy Ã— Time"],
                answer: "A",
                explanation: "Power measures how quickly work is done. More power means the same work is done in less time."
            },
            {
                question: "Which energy transformation occurs in a hydroelectric power plant?",
                options: ["Gravitational potential â†’ Kinetic â†’ Electrical", "Chemical â†’ Thermal â†’ Electrical", "Nuclear â†’ Thermal â†’ Electrical", "Solar â†’ Electrical â†’ Thermal"],
                answer: "A",
                explanation: "Water at height has gravitational potential energy, which converts to kinetic energy as it falls, then to electrical energy via turbines."
            },
            {
                question: "What happens to kinetic energy if velocity is doubled?",
                options: ["It quadruples", "It doubles", "It halves", "It stays the same"],
                answer: "A",
                explanation: "KE = Â½mvÂ². If velocity doubles, vÂ² becomes 4 times larger, so KE becomes 4 times larger (quadruples)."
            },
            {
                question: "Which simple machine reduces the force needed to lift an object?",
                options: ["Lever", "Wheel and axle", "Pulley", "All of the above"],
                answer: "D",
                explanation: "All simple machines (lever, pulley, inclined plane, wheel and axle, screw, wedge) can reduce the force needed to do work."
            },
            {
                question: "What type of energy is in food?",
                options: ["Chemical energy", "Thermal energy", "Electrical energy", "Nuclear energy"],
                answer: "A",
                explanation: "Food contains chemical energy stored in the bonds between atoms. Our bodies convert this to other forms of energy."
            },
            {
                question: "If 1000 J of work is done in 10 seconds, what is the power?",
                options: ["100 W", "10 W", "1000 W", "10,000 W"],
                answer: "A",
                explanation: "Power = Work Ã· Time = 1000 J Ã· 10 s = 100 W (watts)"
            },
            {
                question: "Which energy transformation is least efficient?",
                options: ["Incandescent light bulb", "LED light bulb", "Electric heater", "Electric motor"],
                answer: "A",
                explanation: "Incandescent bulbs are only about 5% efficient (95% of electrical energy becomes heat, not light). LEDs are much more efficient."
            },
            {
                question: "What is the formula for gravitational potential energy?",
                options: ["PE = m Ã— g Ã— h", "PE = Â½ Ã— m Ã— vÂ²", "PE = F Ã— d", "PE = P Ã— t"],
                answer: "A",
                explanation: "Gravitational potential energy = mass Ã— gravitational acceleration Ã— height."
            },
            {
                question: "Which device converts light energy to electrical energy?",
                options: ["Solar panel", "Light bulb", "Battery", "Generator"],
                answer: "A",
                explanation: "Solar panels (photovoltaic cells) convert sunlight (light energy) directly into electrical energy."
            },
            {
                question: "What happens to energy in every transformation?",
                options: ["Some is wasted as heat", "It all becomes useful", "It disappears", "It doubles"],
                answer: "A",
                explanation: "In every energy transformation, some energy is always wasted (usually as heat) due to inefficiencies."
            },
            {
                question: "Which has more gravitational potential energy: a book on a high shelf or the same book on a low shelf?",
                options: ["Book on high shelf", "Book on low shelf", "Both have the same", "Cannot determine"],
                answer: "A",
                explanation: "Gravitational PE = mgh. At greater height (h), there's more potential energy."
            },
            {
                question: "What type of energy is in a vibrating guitar string?",
                options: ["Sound energy", "Chemical energy", "Nuclear energy", "Electrical energy"],
                answer: "A",
                explanation: "Vibrating objects produce sound energy, which travels as waves through air (or other media)."
            },
            {
                question: "Which is NOT a form of energy?",
                options: ["Temperature", "Light", "Heat", "Electricity"],
                answer: "A",
                explanation: "Temperature is a measure of average kinetic energy of particles, not a form of energy itself. Light, heat, and electricity are energy forms."
            }
        ];

        // Physics tips and facts
        const physicsTips = [
            "The average lightning bolt contains about 1 billion joules of energy - enough to power a 100-watt bulb for 3 months!",
            "A human body at rest produces about 100 watts of power - similar to a bright light bulb.",
            "The energy in one gram of matter (via E=mcÂ²) is about 90 trillion joules - enough to power NYC for 2 days!",
            "Photosynthesis is only about 1-2% efficient at converting sunlight to chemical energy.",
            "A roller coaster's highest point gives maximum potential energy, which converts to maximum kinetic energy at the lowest point.",
            "The Sun produces more energy in one second than humanity has used in all of history.",
            "Nuclear power plants are about 33% efficient - 67% of the energy becomes waste heat.",
            "Walking upstairs requires about 10 times more power than walking on level ground.",
            "A typical car engine is only about 20-30% efficient - most energy is lost as heat.",
            "The law of conservation of energy is considered one of the most fundamental laws in physics."
        ];

        // Quiz questions
        const quizQuestions = [
            {
                question: "What is the unit of energy?",
                options: ["Joule", "Watt", "Newton", "Pascal"],
                answer: "A"
            },
            {
                question: "What type of energy is stored in food?",
                options: ["Chemical", "Thermal", "Electrical", "Nuclear"],
                answer: "A"
            },
            {
                question: "What is the formula for kinetic energy?",
                options: ["Â½mvÂ²", "mgh", "Fd", "Pt"],
                answer: "A"
            },
            {
                question: "Which device converts electrical to mechanical energy?",
                options: ["Motor", "Generator", "Battery", "Bulb"],
                answer: "A"
            },
            {
                question: "What is the unit of power?",
                options: ["Watt", "Joule", "Newton", "Volt"],
                answer: "A"
            }
        ];

        // Energy forms data
        const energyForms = {
            kinetic: {
                name: "Kinetic Energy",
                example: "Moving car, flowing water, wind",
                unit: "Joule (J)",
                formula: "KE = Â½ Ã— m Ã— vÂ²",
                description: "Energy of motion. Depends on mass and velocity squared. The faster or heavier an object, the more kinetic energy it has."
            },
            potential: {
                name: "Potential Energy",
                example: "Book on shelf, stretched spring, water behind dam",
                unit: "Joule (J)",
                formula: "PE = m Ã— g Ã— h (gravitational)",
                description: "Stored energy due to position or condition. Gravitational PE depends on height; elastic PE depends on stretch/compression."
            },
            thermal: {
                name: "Thermal Energy",
                example: "Hot coffee, warm room, geothermal heat",
                unit: "Joule (J) or Calorie (cal)",
                formula: "Q = m Ã— c Ã— Î”T",
                description: "Total kinetic energy of all particles in a substance. Related to temperature but not the same - temperature measures average kinetic energy."
            },
            electrical: {
                name: "Electrical Energy",
                example: "Lightning, batteries, power lines",
                unit: "Joule (J) or Kilowatt-hour (kWh)",
                formula: "E = P Ã— t = V Ã— I Ã— t",
                description: "Energy from moving electric charges. Very useful because it can be easily transported and converted to other forms."
            },
            chemical: {
                name: "Chemical Energy",
                example: "Food, batteries, gasoline, wood",
                unit: "Joule (J) or Calorie (cal)",
                formula: "From chemical reactions",
                description: "Energy stored in chemical bonds. Released during chemical reactions like burning, digestion, or battery discharge."
            },
            nuclear: {
                name: "Nuclear Energy",
                example: "Sun, nuclear power plants, atomic bombs",
                unit: "Joule (J)",
                formula: "E = m Ã— cÂ²",
                description: "Energy stored in the nucleus of atoms. Released in nuclear reactions (fission or fusion). Extremely powerful."
            },
            sound: {
                name: "Sound Energy",
                example: "Music, voices, thunder",
                unit: "Joule (J) or Decibel (dB)",
                formula: "Travels as waves",
                description: "Energy carried by sound waves. Requires a medium (air, water, solid) to travel. Caused by vibrating objects."
            },
            light: {
                name: "Light Energy",
                example: "Sunlight, lamps, lasers",
                unit: "Joule (J)",
                formula: "E = h Ã— f (photons)",
                description: "Energy carried by light waves (electromagnetic radiation). Can travel through vacuum (space)."
            },
            mechanical: {
                name: "Mechanical Energy",
                example: "Machines, moving parts, simple machines",
                unit: "Joule (J)",
                formula: "ME = KE + PE",
                description: "Sum of kinetic and potential energy in a mechanical system. Often involves motion and position."
            }
        };

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            studentName: "",
            startTime: null,
            currentEnergyType: 'kinetic',
            currentTransformation: 'battery',
            currentWorkExample: 'lifting',
            currentLaw: 'conservation',
            currentExperiment: 'pendulum',
            showAnimation: true,
            animationSpeed: 1,
            quizIndex: 0,
            energyCanvas: null,
            energyCtx: null,
            transformationCanvas: null,
            transformationCtx: null,
            workCanvas: null,
            workCtx: null,
            lawsCanvas: null,
            lawsCtx: null,
            experimentCanvas: null,
            experimentCtx: null,
            animationFrame: null,
            calculatorValue: "0",
            calculatorMemory: null
        };

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const backToHomeBtn = document.getElementById('backToHome');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const physicsTip = document.getElementById('physicsTip');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const feedbackExplanation = document.getElementById('feedbackExplanation');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const printCertificateBtn = document.getElementById('printCertificate');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const timeSpent = document.getElementById('timeSpent');
        const energyInfo = document.getElementById('energyInfo');
        const energyType = document.getElementById('energyType');
        const energyExample = document.getElementById('energyExample');
        const energyUnit = document.getElementById('energyUnit');
        const energyDescription = document.getElementById('energyDescription');
        const quizQuestion = document.getElementById('quizQuestion');
        const quizOptions = document.getElementById('quizOptions');
        const calcDisplay = document.getElementById('calcDisplay');

        // Initialize
        function initApp() {
            setupEventListeners();
            showWelcomePage();
            initializeCanvases();
            loadQuizQuestion();
            drawEnergyForm();
            drawTransformation();
            drawWorkExample();
            drawLaw();
            drawExperiment();
            updateCalculatorDisplay();
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', showWelcomePage);
            printCertificateBtn.addEventListener('click', printCertificate);
            viewTopicsBtn.addEventListener('click', () => alert("Other science topics would be available here."));
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') startPractice();
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            appState.startTime = new Date();
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const percentage = Math.round((appState.score / questions.length) * 100);
            const timeDiff = new Date() - appState.startTime;
            const minutes = Math.floor(timeDiff / 60000);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            timeSpent.textContent = `${minutes}min`;
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Excellent! You're an energy physics expert!";
            } else if (percentage >= 75) {
                scoreMessage.textContent = "Great job! You understand energy concepts well!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Good work! You're getting the hang of energy physics!";
            } else {
                scoreMessage.textContent = "Keep learning! Energy concepts are fundamental - review and try again!";
            }
        }

        // Create physics tip display
        function createPhysicsTip() {
            const tipDiv = document.createElement('div');
            tipDiv.className = 'physics-tip';
            tipDiv.innerHTML = `<strong>Physics Tip:</strong> ${physicsTips[Math.floor(Math.random() * physicsTips.length)]}`;
            return tipDiv;
        }

        // Load question
        function loadQuestion() {
            const question = questions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${questions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / questions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            physicsTip.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            physicsTip.appendChild(createPhysicsTip());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = questions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation);
            }
            
            nextQuestionBtn.disabled = false;
        }

        // Show feedback
        function showFeedback(isCorrect, explanation) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = 'âœ“';
                feedbackTitle.textContent = 'Correct!';
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = 'âœ—';
                feedbackTitle.textContent = 'Incorrect';
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Skip question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Retry topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            showPracticePage();
        }

        // Print certificate
        function printCertificate() {
            const percentage = Math.round((appState.score / questions.length) * 100);
            const certificateWindow = window.open('', '_blank');
            certificateWindow.document.write(`
                <html>
                <head>
                    <title>Certificate of Achievement</title>
                    <style>
                        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
                        .certificate { border: 20px solid #2196F3; padding: 50px; max-width: 800px; margin: 0 auto; }
                        h1 { color: #2196F3; }
                        .name { font-size: 2em; margin: 20px 0; }
                        .grade { font-size: 1.5em; margin: 20px 0; }
                        .score { font-size: 1.2em; margin: 20px 0; }
                        .date { margin-top: 50px; }
                    </style>
                </head>
                <body>
                    <div class="certificate">
                        <h1>Certificate of Achievement</h1>
                        <p>This certifies that</p>
                        <div class="name">${appState.studentName}</div>
                        <p>has successfully completed the Grade 8 Physics module</p>
                        <div class="grade">Grade 8 Science - Energy, Work & Power</div>
                        <div class="score">Score: ${appState.score}/${questions.length} (${percentage}%)</div>
                        <div class="date">Date: ${new Date().toLocaleDateString()}</div>
                        <p>Ideolix Learning Hub</p>
                    </div>
                </body>
                </html>
            `);
            certificateWindow.document.close();
            certificateWindow.print();
        }

        // Start practice
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin studying energy physics!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            showPracticePage();
        }

        // Initialize canvases
        function initializeCanvases() {
            // Energy canvas
            const energyCanvas = document.getElementById('energyCanvas');
            const energyContainer = document.querySelector('.energy-canvas-container');
            energyCanvas.width = energyContainer.clientWidth;
            energyCanvas.height = energyContainer.clientHeight;
            appState.energyCanvas = energyCanvas;
            appState.energyCtx = energyCanvas.getContext('2d');
            
            // Transformation canvas
            const transformationCanvas = document.getElementById('transformationCanvas');
            const transformationContainer = document.querySelector('.transformation-canvas-container');
            transformationCanvas.width = transformationContainer.clientWidth;
            transformationCanvas.height = transformationContainer.clientHeight;
            appState.transformationCanvas = transformationCanvas;
            appState.transformationCtx = transformationCanvas.getContext('2d');
            
            // Work canvas
            const workCanvas = document.getElementById('workCanvas');
            const workContainer = document.querySelector('.work-canvas-container');
            workCanvas.width = workContainer.clientWidth;
            workCanvas.height = workContainer.clientHeight;
            appState.workCanvas = workCanvas;
            appState.workCtx = workCanvas.getContext('2d');
            
            // Laws canvas
            const lawsCanvas = document.getElementById('lawsCanvas');
            const lawsContainer = document.querySelector('.laws-canvas-container');
            lawsCanvas.width = lawsContainer.clientWidth;
            lawsCanvas.height = lawsContainer.clientHeight;
            appState.lawsCanvas = lawsCanvas;
            appState.lawsCtx = lawsCanvas.getContext('2d');
            
            // Experiment canvas
            const experimentCanvas = document.getElementById('experimentCanvas');
            const experimentContainer = document.querySelector('.experiment-container');
            experimentCanvas.width = experimentContainer.clientWidth;
            experimentCanvas.height = experimentContainer.clientHeight;
            appState.experimentCanvas = experimentCanvas;
            appState.experimentCtx = experimentCanvas.getContext('2d');
        }

        // Show energy type
        window.showEnergyType = function(type) {
            appState.currentEnergyType = type;
            
            // Update active button
            const processBtns = document.querySelectorAll('.process-btn');
            processBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawEnergyForm();
        };

        // Draw energy form
        function drawEnergyForm() {
            const ctx = appState.energyCtx;
            const canvas = appState.energyCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Get energy form data
            const energy = energyForms[appState.currentEnergyType];
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(energy.name, width/2, 20);
            
            // Draw different visualizations based on energy type
            if (appState.currentEnergyType === 'kinetic') {
                drawKineticEnergy(ctx, width, height);
            } else if (appState.currentEnergyType === 'potential') {
                drawPotentialEnergy(ctx, width, height);
            } else if (appState.currentEnergyType === 'thermal') {
                drawThermalEnergy(ctx, width, height);
            } else if (appState.currentEnergyType === 'electrical') {
                drawElectricalEnergy(ctx, width, height);
            } else if (appState.currentEnergyType === 'chemical') {
                drawChemicalEnergy(ctx, width, height);
            } else if (appState.currentEnergyType === 'nuclear') {
                drawNuclearEnergy(ctx, width, height);
            } else if (appState.currentEnergyType === 'sound') {
                drawSoundEnergy(ctx, width, height);
            } else if (appState.currentEnergyType === 'light') {
                drawLightEnergy(ctx, width, height);
            } else {
                drawMechanicalEnergy(ctx, width, height);
            }
            
            // Update info panel
            energyType.textContent = energy.name;
            energyExample.textContent = `Example: ${energy.example}`;
            energyUnit.textContent = energy.unit;
            energyDescription.textContent = energy.description;
            energyInfo.classList.add('show');
        }

        // Draw kinetic energy visualization
        function drawKineticEnergy(ctx, width, height) {
            const centerX = width/2;
            const centerY = height/2;
            
            // Draw moving ball
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                const ballX = centerX + Math.sin(time * 2) * 100;
                const ballY = centerY;
                
                // Draw ball
                ctx.fillStyle = '#FFC107';
                ctx.beginPath();
                ctx.arc(ballX, ballY, 30, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw motion trail
                for (let i = 1; i <= 5; i++) {
                    const trailX = ballX - Math.sin(time * 2) * i * 5;
                    ctx.globalAlpha = 0.2 * (6 - i) / 5;
                    ctx.beginPath();
                    ctx.arc(trailX, ballY, 30 * (6 - i) / 5, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.globalAlpha = 1;
                
                // Draw velocity vector
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(ballX + 30, ballY);
                ctx.lineTo(ballX + 80, ballY);
                ctx.stroke();
                
                // Arrowhead
                ctx.fillStyle = '#FFFFFF';
                ctx.beginPath();
                ctx.moveTo(ballX + 80, ballY);
                ctx.lineTo(ballX + 70, ballY - 5);
                ctx.lineTo(ballX + 70, ballY + 5);
                ctx.closePath();
                ctx.fill();
                
                // Label
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '12px Arial';
                ctx.fillText('Velocity (v)', ballX + 85, ballY - 10);
                ctx.fillText('Mass (m)', ballX - 10, ballY - 40);
                
                // Draw formula
                ctx.fillStyle = '#FFC107';
                ctx.font = '16px Arial';
                ctx.fillText('KE = Â½ Ã— m Ã— vÂ²', width/2, height - 20);
                
                // Schedule next frame if animation is running
                appState.animationFrame = requestAnimationFrame(() => drawEnergyForm());
            }
        }

        // Draw potential energy visualization
        function drawPotentialEnergy(ctx, width, height) {
            const centerX = width/2;
            
            // Draw ground
            ctx.fillStyle = '#795548';
            ctx.fillRect(0, height - 50, width, 50);
            
            // Draw shelves at different heights
            const shelves = [
                { y: height - 150, label: 'Low PE', color: '#8BC34A' },
                { y: height - 250, label: 'Medium PE', color: '#FFC107' },
                { y: height - 350, label: 'High PE', color: '#F44336' }
            ];
            
            shelves.forEach(shelf => {
                // Draw shelf
                ctx.fillStyle = '#795548';
                ctx.fillRect(centerX - 100, shelf.y, 200, 10);
                
                // Draw book on shelf
                ctx.fillStyle = shelf.color;
                ctx.fillRect(centerX - 40, shelf.y - 40, 80, 40);
                
                // Draw height indicator
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(centerX + 60, shelf.y);
                ctx.lineTo(centerX + 60, height - 50);
                ctx.stroke();
                
                // Draw height label
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '12px Arial';
                const heightValue = ((height - 50) - shelf.y) / 10;
                ctx.fillText(`h = ${heightValue} m`, centerX + 70, (shelf.y + height - 50) / 2);
                
                // Draw shelf label
                ctx.fillText(shelf.label, centerX - 100, shelf.y - 10);
            });
            
            // Draw formula
            ctx.fillStyle = '#4CAF50';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('PE = m Ã— g Ã— h', width/2, 60);
            ctx.font = '12px Arial';
            ctx.fillText('(gravitational potential energy)', width/2, 80);
        }

        // Draw thermal energy visualization
        function drawThermalEnergy(ctx, width, height) {
            // Draw three containers with different temperatures
            const containers = [
                { x: 50, temp: 'Low', color: '#2196F3', particleSpeed: 1 },
                { x: width/2 - 50, temp: 'Medium', color: '#FF9800', particleSpeed: 3 },
                { x: width - 150, temp: 'High', color: '#F44336', particleSpeed: 6 }
            ];
            
            containers.forEach(container => {
                // Draw container
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 2;
                ctx.strokeRect(container.x, 50, 100, 150);
                
                // Draw particles (representing molecular motion)
                if (appState.showAnimation) {
                    const time = Date.now() / 1000;
                    
                    for (let i = 0; i < 15; i++) {
                        const particleX = container.x + 20 + (i % 5) * 15;
                        const particleY = 70 + Math.floor(i / 5) * 30;
                        
                        // Animate particle motion
                        const offsetX = Math.sin(time * container.particleSpeed + i) * 10;
                        const offsetY = Math.cos(time * container.particleSpeed + i) * 10;
                        
                        ctx.fillStyle = container.color;
                        ctx.beginPath();
                        ctx.arc(particleX + offsetX, particleY + offsetY, 4, 0, Math.PI * 2);
                        ctx.fill();
                    }
                } else {
                    // Static particles
                    for (let i = 0; i < 15; i++) {
                        const particleX = container.x + 20 + (i % 5) * 15;
                        const particleY = 70 + Math.floor(i / 5) * 30;
                        
                        ctx.fillStyle = container.color;
                        ctx.beginPath();
                        ctx.arc(particleX, particleY, 4, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                // Draw temperature label
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`${container.temp} Temperature`, container.x + 50, 220);
                ctx.fillText(`Particle speed: ${container.particleSpeed}`, container.x + 50, 240);
            });
            
            // Draw explanation
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Thermal Energy = Total kinetic energy of all particles', width/2, 30);
            
            if (appState.showAnimation) {
                appState.animationFrame = requestAnimationFrame(() => drawEnergyForm());
            }
        }

        // Draw electrical energy visualization
        function drawElectricalEnergy(ctx, width, height) {
            const centerX = width/2;
            const centerY = height/2;
            
            // Draw battery
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(centerX - 40, centerY - 60, 80, 120);
            ctx.strokeStyle = '#FFFFFF';
            ctx.strokeRect(centerX - 40, centerY - 60, 80, 120);
            
            // Draw battery terminals
            ctx.fillStyle = '#FFC107';
            ctx.fillRect(centerX - 10, centerY - 70, 20, 10); // Positive terminal
            ctx.fillRect(centerX - 10, centerY + 60, 20, 10); // Negative terminal
            
            // Draw circuit wires
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY + 70); // From negative terminal
            ctx.lineTo(centerX - 100, centerY + 70);
            ctx.lineTo(centerX - 100, centerY - 30);
            ctx.lineTo(centerX - 150, centerY - 30);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(centerX, centerY - 70); // From positive terminal
            ctx.lineTo(centerX + 100, centerY - 70);
            ctx.lineTo(centerX + 100, centerY - 30);
            ctx.lineTo(centerX + 150, centerY - 30);
            ctx.stroke();
            
            // Draw light bulb
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(centerX, centerY - 30, 30, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw electrons moving (animation)
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                
                // Draw electrons moving in circuit
                ctx.fillStyle = '#FFFFFF';
                
                // Electron positions along negative wire
                const electron1X = centerX - 100 + (time * 50) % 200;
                const electron1Y = centerY + 70;
                
                // Electron positions along positive wire
                const electron2X = centerX + 100 - (time * 50) % 200;
                const electron2Y = centerY - 70;
                
                ctx.beginPath();
                ctx.arc(electron1X, electron1Y, 5, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(electron2X, electron2Y, 5, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw light rays from bulb
                ctx.strokeStyle = '#FFC107';
                ctx.lineWidth = 2;
                for (let i = 0; i < 8; i++) {
                    const angle = (i * 45) * Math.PI / 180;
                    const length = 30 + Math.sin(time * 3 + i) * 10;
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY - 30);
                    ctx.lineTo(
                        centerX + Math.cos(angle) * length,
                        centerY - 30 + Math.sin(angle) * length
                    );
                    ctx.stroke();
                }
                
                appState.animationFrame = requestAnimationFrame(() => drawEnergyForm());
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Battery (Chemical â†’ Electrical)', centerX, centerY - 100);
            ctx.fillText('Light Bulb (Electrical â†’ Light + Heat)', centerX, centerY + 100);
            ctx.fillText('Electron flow', centerX, centerY + 130);
        }

        // Draw chemical energy
        function drawChemicalEnergy(ctx, width, height) {
            // Draw food and battery examples
            ctx.fillStyle = '#FF9800';
            ctx.beginPath();
            ctx.ellipse(100, 100, 40, 30, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Apple', 95, 105);
            
            ctx.fillStyle = '#8BC34A';
            ctx.fillRect(200, 70, 80, 60);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Bread', 230, 100);
            
            ctx.fillStyle = '#795548';
            ctx.fillRect(320, 80, 40, 80);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Battery', 315, 175);
            
            // Draw chemical bonds breaking (energy release)
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            
            // Before: bonds intact
            ctx.beginPath();
            ctx.moveTo(100, 150);
            ctx.lineTo(100, 200);
            ctx.stroke();
            
            // After: bonds broken, energy released
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                const offset = Math.sin(time * 3) * 20;
                
                ctx.beginPath();
                ctx.moveTo(150, 150);
                ctx.lineTo(150 + offset, 200);
                ctx.stroke();
                
                // Draw energy release
                ctx.fillStyle = '#FFC107';
                for (let i = 0; i < 5; i++) {
                    const angle = (time * 2 + i) * 1.5;
                    const radius = 20 + i * 5;
                    const x = 150 + Math.cos(angle) * radius;
                    const y = 175 + Math.sin(angle) * radius;
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                appState.animationFrame = requestAnimationFrame(() => drawEnergyForm());
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Chemical bonds store energy', width/2, 230);
            ctx.fillText('Breaking bonds releases energy', width/2, 250);
        }

        // Draw nuclear energy
        function drawNuclearEnergy(ctx, width, height) {
            const centerX = width/2;
            const centerY = height/2;
            
            // Draw atomic nucleus
            ctx.fillStyle = '#F44336';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 40, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw protons and neutrons in nucleus
            ctx.fillStyle = '#FFFFFF';
            for (let i = 0; i < 8; i++) {
                const angle = (i * 45) * Math.PI / 180;
                const x = centerX + Math.cos(angle) * 20;
                const y = centerY + Math.sin(angle) * 20;
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Draw electron orbits
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 1;
            for (let r = 60; r <= 100; r += 20) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
                ctx.stroke();
            }
            
            // Draw electrons orbiting
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                
                ctx.fillStyle = '#FFC107';
                for (let i = 0; i < 3; i++) {
                    const orbitRadius = 60 + i * 20;
                    const angle = time * (i + 1);
                    const x = centerX + Math.cos(angle) * orbitRadius;
                    const y = centerY + Math.sin(angle) * orbitRadius;
                    ctx.beginPath();
                    ctx.arc(x, y, 6, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Draw nuclear fission/release
                ctx.strokeStyle = '#FFC107';
                for (let i = 0; i < 8; i++) {
                    const angle = (i * 45) * Math.PI / 180;
                    const length = 80 + Math.sin(time * 2 + i) * 20;
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.lineTo(
                        centerX + Math.cos(angle) * length,
                        centerY + Math.sin(angle) * length
                    );
                    ctx.stroke();
                }
                
                appState.animationFrame = requestAnimationFrame(() => drawEnergyForm());
            }
            
            // Draw formula
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('E = m Ã— cÂ²', width/2, height - 30);
            ctx.font = '12px Arial';
            ctx.fillText('Nuclear energy: Mass converted to energy', width/2, height - 10);
        }

        // Draw sound energy
        function drawSoundEnergy(ctx, width, height) {
            const centerX = width/2;
            const centerY = height/2;
            
            // Draw sound source (speaker)
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(centerX - 40, centerY - 80, 80, 160);
            
            // Draw speaker cone
            ctx.fillStyle = '#795548';
            ctx.beginPath();
            ctx.ellipse(centerX, centerY, 30, 60, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw sound waves propagating
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                
                ctx.strokeStyle = '#2196F3';
                ctx.lineWidth = 2;
                
                for (let i = 0; i < 5; i++) {
                    const waveRadius = 50 + (time * 40 + i * 30) % 200;
                    const alpha = 1 - (waveRadius - 50) / 200;
                    
                    ctx.globalAlpha = alpha;
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, waveRadius, 0, Math.PI * 2);
                    ctx.stroke();
                }
                ctx.globalAlpha = 1;
                
                appState.animationFrame = requestAnimationFrame(() => drawEnergyForm());
            }
            
            // Draw wave diagram
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let x = 50; x < width - 50; x += 2) {
                const y = height - 50 + Math.sin(x * 0.1) * 20;
                if (x === 50) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Sound waves: Compression and rarefaction', width/2, 30);
            ctx.fillText('Vibrating object creates pressure waves in air', width/2, height - 20);
        }

        // Draw light energy
        function drawLightEnergy(ctx, width, height) {
            // Draw light source (sun/bulb)
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(width/2, 80, 40, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw light rays
            ctx.strokeStyle = '#FFC107';
            ctx.lineWidth = 2;
            
            for (let i = 0; i < 12; i++) {
                const angle = (i * 30) * Math.PI / 180;
                const length = 150;
                ctx.beginPath();
                ctx.moveTo(width/2, 80);
                ctx.lineTo(
                    width/2 + Math.cos(angle) * length,
                    80 + Math.sin(angle) * length
                );
                ctx.stroke();
            }
            
            // Draw prism splitting white light
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.moveTo(width/2 - 100, 200);
            ctx.lineTo(width/2 + 100, 200);
            ctx.lineTo(width/2, 300);
            ctx.closePath();
            ctx.fill();
            ctx.strokeStyle = '#000000';
            ctx.stroke();
            
            // Draw rainbow spectrum
            const colors = ['#F44336', '#FF9800', '#FFC107', '#4CAF50', '#2196F3', '#9C27B0'];
            
            for (let i = 0; i < colors.length; i++) {
                ctx.strokeStyle = colors[i];
                ctx.lineWidth = 8;
                ctx.beginPath();
                ctx.moveTo(width/2, 250);
                ctx.lineTo(width/2 + 100 + i * 20, 150 - i * 10);
                ctx.stroke();
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Light: Electromagnetic waves', width/2, 350);
            ctx.fillText('White light contains all colors', width/2, 370);
        }

        // Draw mechanical energy
        function drawMechanicalEnergy(ctx, width, height) {
            const centerX = width/2;
            const centerY = height/2;
            
            // Draw simple machine (lever)
            // Draw fulcrum
            ctx.fillStyle = '#795548';
            ctx.fillRect(centerX - 10, centerY + 50, 20, 50);
            
            // Draw lever arm
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(centerX - 150, centerY, 300, 10);
            
            // Draw load on one side
            ctx.fillStyle = '#F44336';
            ctx.fillRect(centerX - 140, centerY - 40, 40, 40);
            
            // Draw force on other side
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX + 100, centerY + 10);
            ctx.lineTo(centerX + 100, centerY - 50);
            ctx.stroke();
            
            // Draw downward arrow for force
            ctx.fillStyle = '#4CAF50';
            ctx.beginPath();
            ctx.moveTo(centerX + 100, centerY - 50);
            ctx.lineTo(centerX + 95, centerY - 40);
            ctx.lineTo(centerX + 105, centerY - 40);
            ctx.closePath();
            ctx.fill();
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Load', centerX - 130, centerY - 45);
            ctx.fillText('Force', centerX + 110, centerY - 55);
            ctx.fillText('Fulcrum', centerX - 15, centerY + 110);
            
            // Draw mechanical energy formula
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ME = KE + PE', width/2, 150);
            ctx.font = '12px Arial';
            ctx.fillText('Mechanical Energy = Kinetic + Potential', width/2, 170);
            
            // Draw energy conversion in lever
            ctx.fillStyle = '#FFC107';
            ctx.font = '12px Arial';
            ctx.fillText('Force Ã— Distance (input) = Load Ã— Height (output)', width/2, 200);
        }

        // Show transformation
        window.showTransformation = function(transformation) {
            appState.currentTransformation = transformation;
            
            // Update active button
            const transformationBtns = document.querySelectorAll('.transformation-btn');
            transformationBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawTransformation();
        };

        // Draw transformation
        function drawTransformation() {
            const ctx = appState.transformationCtx;
            const canvas = appState.transformationCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentTransformation === 'battery') title = "Battery-Powered Device";
            else if (appState.currentTransformation === 'solar') title = "Solar Panel System";
            else if (appState.currentTransformation === 'hydro') title = "Hydroelectric Power";
            else if (appState.currentTransformation === 'human') title = "Human Body Energy";
            else if (appState.currentTransformation === 'car') title = "Car Engine";
            else title = "Incandescent Light Bulb";
            
            ctx.fillText(title, width/2, 20);
            
            // Draw transformation based on type
            if (appState.currentTransformation === 'battery') {
                drawBatteryTransformation(ctx, width, height);
            } else if (appState.currentTransformation === 'solar') {
                drawSolarTransformation(ctx, width, height);
            } else if (appState.currentTransformation === 'hydro') {
                drawHydroTransformation(ctx, width, height);
            } else if (appState.currentTransformation === 'human') {
                drawHumanTransformation(ctx, width, height);
            } else if (appState.currentTransformation === 'car') {
                drawCarTransformation(ctx, width, height);
            } else {
                drawBulbTransformation(ctx, width, height);
            }
        }

        // Draw battery transformation
        function drawBatteryTransformation(ctx, width, height) {
            const centerX = width/2;
            
            // Draw battery
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(centerX - 30, 50, 60, 100);
            ctx.strokeStyle = '#FFFFFF';
            ctx.strokeRect(centerX - 30, 50, 60, 100);
            
            // Draw battery terminals
            ctx.fillStyle = '#FFC107';
            ctx.fillRect(centerX - 10, 45, 20, 5); // Positive
            ctx.fillRect(centerX - 10, 155, 20, 5); // Negative
            
            // Draw wires to device
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 45); // Positive wire
            ctx.lineTo(centerX, 30);
            ctx.lineTo(centerX - 100, 30);
            ctx.lineTo(centerX - 100, 120);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(centerX, 155); // Negative wire
            ctx.lineTo(centerX, 170);
            ctx.lineTo(centerX + 100, 170);
            ctx.lineTo(centerX + 100, 120);
            ctx.stroke();
            
            // Draw device (e.g., flashlight)
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(centerX - 120, 90, 40, 60);
            
            // Draw light beam
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.moveTo(centerX - 120, 120);
            ctx.lineTo(centerX - 200, 100);
            ctx.lineTo(centerX - 200, 140);
            ctx.closePath();
            ctx.fill();
            
            // Draw energy flow animation
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                
                // Draw chemical energy particles in battery
                ctx.fillStyle = '#FFFFFF';
                for (let i = 0; i < 8; i++) {
                    const x = centerX - 20 + (i % 4) * 10;
                    const y = 60 + Math.floor(i / 4) * 30;
                    const offset = Math.sin(time * 2 + i) * 3;
                    ctx.beginPath();
                    ctx.arc(x, y + offset, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Draw electrical energy flow
                ctx.fillStyle = '#2196F3';
                const electronX = centerX - 100 + (time * 40) % 200;
                ctx.beginPath();
                ctx.arc(electronX, 30, 4, 0, Math.PI * 2);
                ctx.fill();
                
                appState.animationFrame = requestAnimationFrame(() => drawTransformation());
            }
            
            // Draw energy transformation labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Chemical â†’ Electrical â†’ Light', width/2, height - 40);
            ctx.fillText('+ Heat (waste energy)', width/2, height - 20);
        }

        // Draw solar transformation
        function drawSolarTransformation(ctx, width, height) {
            const centerX = width/2;
            
            // Draw sun
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(centerX - 150, 80, 40, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw sun rays
            ctx.strokeStyle = '#FFC107';
            for (let i = 0; i < 8; i++) {
                const angle = (i * 45) * Math.PI / 180;
                ctx.beginPath();
                ctx.moveTo(centerX - 150 + Math.cos(angle) * 40, 80 + Math.sin(angle) * 40);
                ctx.lineTo(centerX - 150 + Math.cos(angle) * 70, 80 + Math.sin(angle) * 70);
                ctx.stroke();
            }
            
            // Draw solar panel
            ctx.fillStyle = '#3F51B5';
            ctx.fillRect(centerX - 50, 100, 100, 80);
            
            // Draw solar cells
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 1;
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 3; j++) {
                    ctx.strokeRect(centerX - 45 + i * 18, 105 + j * 25, 15, 20);
                }
            }
            
            // Draw wires from solar panel
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 180);
            ctx.lineTo(centerX, 220);
            ctx.lineTo(centerX + 100, 220);
            ctx.lineTo(centerX + 100, 170);
            ctx.stroke();
            
            // Draw battery being charged
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(centerX + 80, 140, 40, 60);
            
            // Draw light bulb powered by battery
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(centerX + 150, 170, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw photons from sun to panel
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                
                ctx.fillStyle = '#FFC107';
                for (let i = 0; i < 5; i++) {
                    const photonY = 60 + (time * 40 + i * 15) % 80;
                    const photonX = centerX - 150 + (photonY - 60) * 1.2;
                    ctx.beginPath();
                    ctx.arc(photonX, photonY, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Draw electrons in wires
                ctx.fillStyle = '#2196F3';
                const electronX = centerX + 100 - (time * 30) % 120;
                ctx.beginPath();
                ctx.arc(electronX, 220, 4, 0, Math.PI * 2);
                ctx.fill();
                
                appState.animationFrame = requestAnimationFrame(() => drawTransformation());
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Light â†’ Electrical â†’ Chemical â†’ Electrical â†’ Light', width/2, height - 20);
        }

        // Draw hydroelectric transformation
        function drawHydroTransformation(ctx, width, height) {
            // Draw dam and reservoir
            ctx.fillStyle = '#795548';
            ctx.fillRect(50, 80, 40, 120); // Dam wall
            
            // Draw water reservoir
            ctx.fillStyle = '#2196F3';
            ctx.fillRect(0, 80, 50, 120);
            
            // Draw water flowing through turbine
            ctx.fillStyle = '#2196F3';
            ctx.beginPath();
            ctx.moveTo(90, 200);
            ctx.lineTo(150, 200);
            ctx.lineTo(150, 180);
            ctx.lineTo(90, 180);
            ctx.closePath();
            ctx.fill();
            
            // Draw turbine
            ctx.fillStyle = '#9E9E9E';
            ctx.beginPath();
            ctx.arc(120, 190, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw turbine blades
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 3;
            for (let i = 0; i < 6; i++) {
                const angle = (i * 60) * Math.PI / 180;
                ctx.beginPath();
                ctx.moveTo(120, 190);
                ctx.lineTo(120 + Math.cos(angle) * 30, 190 + Math.sin(angle) * 30);
                ctx.stroke();
            }
            
            // Draw generator
            ctx.fillStyle = '#FF9800';
            ctx.fillRect(150, 170, 40, 40);
            
            // Draw power lines
            ctx.strokeStyle = '#FFC107';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(190, 190);
            ctx.lineTo(250, 190);
            ctx.lineTo(250, 120);
            ctx.lineTo(300, 120);
            ctx.stroke();
            
            // Draw house receiving electricity
            ctx.fillStyle = '#8BC34A';
            ctx.fillRect(280, 80, 60, 40);
            ctx.fillRect(290, 40, 40, 40); // Roof
            
            // Draw light in house
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(310, 100, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw water flow animation
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                
                // Draw water particles flowing
                ctx.fillStyle = '#2196F3';
                for (let i = 0; i < 5; i++) {
                    const waterY = 85 + (time * 30 + i * 10) % 115;
                    const waterX = 45;
                    ctx.beginPath();
                    ctx.arc(waterX, waterY, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Draw turbine rotation
                ctx.save();
                ctx.translate(120, 190);
                ctx.rotate(time);
                ctx.strokeStyle = '#000000';
                for (let i = 0; i < 6; i++) {
                    const angle = (i * 60) * Math.PI / 180;
                    ctx.beginPath();
                    ctx.moveTo(0, 0);
                    ctx.lineTo(Math.cos(angle) * 30, Math.sin(angle) * 30);
                    ctx.stroke();
                }
                ctx.restore();
                
                appState.animationFrame = requestAnimationFrame(() => drawTransformation());
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Gravitational PE â†’ Kinetic â†’ Electrical â†’ Light/Heat', width/2, height - 20);
        }

        // Draw human body energy transformation
        function drawHumanTransformation(ctx, width, height) {
            const centerX = width/2;
            
            // Draw simple human figure
            // Head
            ctx.fillStyle = '#FFCCBC';
            ctx.beginPath();
            ctx.arc(centerX, 80, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Body
            ctx.fillRect(centerX - 15, 100, 30, 60);
            
            // Arms
            ctx.fillRect(centerX - 40, 100, 25, 10);
            ctx.fillRect(centerX + 15, 100, 25, 10);
            
            // Legs
            ctx.fillRect(centerX - 10, 160, 10, 40);
            ctx.fillRect(centerX, 160, 10, 40);
            
            // Draw food entering body
            ctx.fillStyle = '#8BC34A';
            ctx.beginPath();
            ctx.ellipse(centerX - 60, 70, 15, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Food', centerX - 65, 75);
            
            // Draw arrow from food to mouth
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX - 45, 70);
            ctx.lineTo(centerX - 20, 80);
            ctx.stroke();
            
            // Draw oxygen entering body
            ctx.fillStyle = '#2196F3';
            ctx.beginPath();
            ctx.arc(centerX + 60, 70, 10, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Oâ‚‚', centerX + 55, 75);
            
            // Draw arrow from oxygen to mouth
            ctx.beginPath();
            ctx.moveTo(centerX + 50, 70);
            ctx.lineTo(centerX + 20, 80);
            ctx.stroke();
            
            // Draw energy output (movement, heat)
            // Draw running motion lines
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                const offset = Math.sin(time * 3) * 5;
                
                ctx.strokeStyle = '#FFC107';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(centerX + 40, 120);
                ctx.lineTo(centerX + 80 + offset, 120);
                ctx.stroke();
                
                // Draw heat waves
                ctx.strokeStyle = '#F44336';
                for (let i = 0; i < 3; i++) {
                    const radius = 30 + i * 10 + Math.sin(time * 2 + i) * 5;
                    ctx.beginPath();
                    ctx.arc(centerX, 130, radius, 0, Math.PI * 2);
                    ctx.stroke();
                }
                
                appState.animationFrame = requestAnimationFrame(() => drawTransformation());
            }
            
            // Draw waste products
            ctx.fillStyle = '#795548';
            ctx.beginPath();
            ctx.ellipse(centerX, 210, 20, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('COâ‚‚ + Hâ‚‚O + Heat', centerX - 40, 215);
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Chemical (food) + Chemical (Oâ‚‚) â†’ Kinetic + Thermal', width/2, height - 20);
        }

        // Draw car engine transformation
        function drawCarTransformation(ctx, width, height) {
            // Draw simple car
            ctx.fillStyle = '#F44336';
            ctx.fillRect(100, 120, 120, 50); // Car body
            ctx.fillRect(130, 100, 60, 20); // Car top
            
            // Draw wheels
            ctx.fillStyle = '#000000';
            ctx.beginPath();
            ctx.arc(120, 170, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(200, 170, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw engine compartment
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(110, 110, 40, 30);
            
            // Draw fuel tank
            ctx.fillStyle = '#FF9800';
            ctx.fillRect(180, 110, 30, 30);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Fuel', 185, 128);
            
            // Draw exhaust pipe
            ctx.fillStyle = '#795548';
            ctx.fillRect(220, 140, 20, 10);
            
            // Draw motion lines
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                const carX = 100 + (time * 30) % (width - 220);
                
                // Redraw car at new position
                ctx.clearRect(0, 0, width, height);
                
                // Redraw title
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Car Engine', width/2, 20);
                
                // Redraw car at animated position
                ctx.fillStyle = '#F44336';
                ctx.fillRect(carX, 120, 120, 50);
                ctx.fillRect(carX + 30, 100, 60, 20);
                
                ctx.fillStyle = '#000000';
                ctx.beginPath();
                ctx.arc(carX + 20, 170, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(carX + 100, 170, 15, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw engine and fuel
                ctx.fillStyle = '#9E9E9E';
                ctx.fillRect(carX + 10, 110, 40, 30);
                
                ctx.fillStyle = '#FF9800';
                ctx.fillRect(carX + 80, 110, 30, 30);
                ctx.fillStyle = '#FFFFFF';
                ctx.fillText('Fuel', carX + 85, 128);
                
                // Draw exhaust
                ctx.fillStyle = '#795548';
                ctx.fillRect(carX + 120, 140, 20, 10);
                
                // Draw exhaust gases
                ctx.fillStyle = '#9E9E9E';
                for (let i = 0; i < 3; i++) {
                    const smokeX = carX + 130 + Math.sin(time * 2 + i) * 10;
                    const smokeY = 135 - i * 10;
                    const smokeSize = 5 + i * 2;
                    ctx.beginPath();
                    ctx.arc(smokeX, smokeY, smokeSize, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Draw heat waves from engine
                ctx.strokeStyle = '#F44336';
                for (let i = 0; i < 2; i++) {
                    const radius = 20 + i * 15 + Math.sin(time * 3 + i) * 5;
                    ctx.beginPath();
                    ctx.arc(carX + 30, 125, radius, 0, Math.PI * 2);
                    ctx.stroke();
                }
                
                appState.animationFrame = requestAnimationFrame(() => drawTransformation());
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Chemical â†’ Thermal â†’ Kinetic + Waste Heat', width/2, height - 40);
            ctx.fillText('Efficiency: ~20-30%', width/2, height - 20);
        }

        // Draw light bulb transformation
        function drawBulbTransformation(ctx, width, height) {
            const centerX = width/2;
            
            // Draw light bulb
            // Glass bulb
            ctx.fillStyle = '#E0E0E0';
            ctx.beginPath();
            ctx.arc(centerX, 100, 40, 0, Math.PI * 2);
            ctx.fill();
            
            // Base
            ctx.fillStyle = '#FF9800';
            ctx.fillRect(centerX - 15, 140, 30, 30);
            
            // Filament
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX - 20, 90);
            ctx.lineTo(centerX + 20, 110);
            ctx.moveTo(centerX - 20, 110);
            ctx.lineTo(centerX + 20, 90);
            ctx.stroke();
            
            // Draw power source
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 170);
            ctx.lineTo(centerX, 200);
            ctx.lineTo(centerX - 80, 200);
            ctx.lineTo(centerX - 80, 230);
            ctx.stroke();
            
            // Draw electrical outlet
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(centerX - 100, 220, 40, 30);
            ctx.fillStyle = '#000000';
            ctx.fillRect(centerX - 95, 225, 10, 20); // Left slot
            ctx.fillRect(centerX - 75, 225, 10, 20); // Right slot
            ctx.fillRect(centerX - 85, 235, 10, 5); // Ground
            
            // Draw energy transformations
            // Electrical energy flow
            if (appState.showAnimation) {
                const time = Date.now() / 1000;
                
                // Draw electrons flowing
                ctx.fillStyle = '#2196F3';
                const electronX = centerX - 80 - (time * 30) % 160;
                ctx.beginPath();
                ctx.arc(electronX, 200, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw light from bulb
                ctx.strokeStyle = '#FFC107';
                ctx.lineWidth = 2;
                for (let i = 0; i < 12; i++) {
                    const angle = (i * 30) * Math.PI / 180;
                    const length = 50 + Math.sin(time * 2 + i) * 20;
                    ctx.beginPath();
                    ctx.moveTo(centerX, 100);
                    ctx.lineTo(
                        centerX + Math.cos(angle) * length,
                        100 + Math.sin(angle) * length
                    );
                    ctx.stroke();
                }
                
                // Draw heat from bulb
                ctx.strokeStyle = '#F44336';
                for (let i = 0; i < 3; i++) {
                    const radius = 60 + i * 15 + Math.sin(time * 3 + i) * 10;
                    ctx.beginPath();
                    ctx.arc(centerX, 100, radius, 0, Math.PI * 2);
                    ctx.stroke();
                }
                
                appState.animationFrame = requestAnimationFrame(() => drawTransformation());
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Electrical â†’ Light + Heat', width/2, height - 40);
            ctx.fillText('Incandescent: 5% light, 95% heat (waste)', width/2, height - 20);
        }

        // Toggle animation
        window.toggleAnimation = function() {
            appState.showAnimation = !appState.showAnimation;
            event.target.textContent = `Animation: ${appState.showAnimation ? 'On' : 'Off'}`;
            
            if (appState.showAnimation) {
                drawTransformation();
            } else {
                if (appState.animationFrame) {
                    cancelAnimationFrame(appState.animationFrame);
                }
            }
        };

        // Show efficiency
        window.showEfficiency = function() {
            alert("Energy Transformation Efficiency:\n\n" +
                  "â€¢ Incandescent bulb: 5% (95% waste heat)\n" +
                  "â€¢ LED bulb: 20-30% (much better!)\n" +
                  "â€¢ Car engine: 20-30%\n" +
                  "â€¢ Electric motor: 85-95%\n" +
                  "â€¢ Human body: 20-25%\n" +
                  "â€¢ Power plants: 30-60%\n\n" +
                  "No transformation is 100% efficient - some energy always becomes waste heat!");
        };

        // Reset transformation
        window.resetTransformation = function() {
            drawTransformation();
        };

        // Show work example
        window.showWorkExample = function(example) {
            appState.currentWorkExample = example;
            
            // Update active button
            const workBtns = document.querySelectorAll('.work-btn');
            workBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawWorkExample();
        };

        // Draw work example
        function drawWorkExample() {
            const ctx = appState.workCtx;
            const canvas = appState.workCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentWorkExample === 'lifting') title = "Work: Lifting an Object";
            else if (appState.currentWorkExample === 'pushing') title = "Work: Pushing a Box";
            else if (appState.currentWorkExample === 'climbing') title = "Work: Climbing Stairs";
            else if (appState.currentWorkExample === 'machine') title = "Simple Machines";
            else if (appState.currentWorkExample === 'noWork') title = "When is NO Work Done?";
            else title = "Power: Rate of Doing Work";
            
            ctx.fillText(title, width/2, 20);
            
            // Draw work example based on type
            if (appState.currentWorkExample === 'lifting') {
                drawLiftingWork(ctx, width, height);
            } else if (appState.currentWorkExample === 'pushing') {
                drawPushingWork(ctx, width, height);
            } else if (appState.currentWorkExample === 'climbing') {
                drawClimbingWork(ctx, width, height);
            } else if (appState.currentWorkExample === 'machine') {
                drawSimpleMachines(ctx, width, height);
            } else if (appState.currentWorkExample === 'noWork') {
                drawNoWorkExamples(ctx, width, height);
            } else {
                drawPowerComparison(ctx, width, height);
            }
        }

        // Draw lifting work example
        function drawLiftingWork(ctx, width, height) {
            const centerX = width/2;
            
            // Draw ground
            ctx.fillStyle = '#795548';
            ctx.fillRect(0, height - 50, width, 50);
            
            // Draw object being lifted
            ctx.fillStyle = '#F44336';
            const boxY = height - 100;
            ctx.fillRect(centerX - 30, boxY, 60, 50);
            
            // Draw force arrow (upward)
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX, boxY);
            ctx.lineTo(centerX, boxY - 80);
            ctx.stroke();
            
            // Draw arrowhead
            ctx.fillStyle = '#4CAF50';
            ctx.beginPath();
            ctx.moveTo(centerX, boxY - 80);
            ctx.lineTo(centerX - 5, boxY - 70);
            ctx.lineTo(centerX + 5, boxY - 70);
            ctx.closePath();
            ctx.fill();
            
            // Draw distance arrow
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX + 50, boxY + 25);
            ctx.lineTo(centerX + 50, boxY - 55);
            ctx.stroke();
            
            // Draw distance labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Distance (d)', centerX + 60, (boxY + boxY - 80) / 2);
            ctx.fillText('Force (F)', centerX + 10, boxY - 90);
            
            // Draw weight/mass label
            ctx.fillText('Mass = 10 kg', centerX - 25, boxY + 70);
            
            // Draw formula and calculation
            ctx.fillStyle = '#4CAF50';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Work = Force Ã— Distance', width/2, 60);
            ctx.font = '14px Arial';
            ctx.fillText('W = F Ã— d = m Ã— g Ã— h', width/2, 85);
            ctx.fillText('= 10 kg Ã— 9.8 m/sÂ² Ã— 1.5 m = 147 J', width/2, 110);
        }

        // Draw pushing work example
        function drawPushingWork(ctx, width, height) {
            // Draw floor
            ctx.fillStyle = '#795548';
            ctx.fillRect(0, height - 50, width, 50);
            
            // Draw box
            ctx.fillStyle = '#FF9800';
            const boxX = 100;
            const boxY = height - 100;
            ctx.fillRect(boxX, boxY, 80, 50);
            
            // Draw force arrow (horizontal)
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(boxX, boxY + 25);
            ctx.lineTo(boxX - 60, boxY + 25);
            ctx.stroke();
            
            // Draw arrowhead
            ctx.fillStyle = '#4CAF50';
            ctx.beginPath();
            ctx.moveTo(boxX - 60, boxY + 25);
            ctx.lineTo(boxX - 50, boxY + 20);
            ctx.lineTo(boxX - 50, boxY + 30);
            ctx.closePath();
            ctx.fill();
            
            // Draw distance arrow
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(boxX + 90, boxY + 60);
            ctx.lineTo(boxX + 90 + 150, boxY + 60);
            ctx.stroke();
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Force (F) = 50 N', boxX - 100, boxY + 20);
            ctx.fillText('Distance (d) = 3 m', boxX + 170, boxY + 70);
            
            // Draw person pushing
            ctx.fillStyle = '#FFCCBC';
            // Body
            ctx.fillRect(boxX - 70, boxY, 20, 40);
            // Arm
            ctx.fillRect(boxX - 50, boxY + 10, 30, 10);
            
            // Draw calculation
            ctx.fillStyle = '#4CAF50';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Work = Force Ã— Distance', width/2, 60);
            ctx.font = '14px Arial';
            ctx.fillText('W = F Ã— d = 50 N Ã— 3 m = 150 J', width/2, 90);
            
            // Draw note about angle
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Work is maximum when force is parallel to motion', width/2, 120);
            ctx.fillText('If pushing at an angle, only the parallel component does work', width/2, 140);
        }

        // Draw climbing work example
        function drawClimbingWork(ctx, width, height) {
            // Draw stairs
            ctx.fillStyle = '#9E9E9E';
            for (let i = 0; i < 5; i++) {
                const x = 100 + i * 40;
                const y = height - 100 - i * 30;
                ctx.fillRect(x, y, 40, 30);
            }
            
            // Draw person climbing
            const personX = 140;
            const personY = height - 120;
            
            // Body
            ctx.fillStyle = '#FFCCBC';
            ctx.fillRect(personX, personY, 20, 40);
            // Legs
            ctx.fillRect(personX, personY + 40, 8, 30);
            ctx.fillRect(personX + 12, personY + 40, 8, 30);
            
            // Draw height gained
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(200, height - 100);
            ctx.lineTo(200, height - 250);
            ctx.stroke();
            
            // Draw height label
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Height (h) = 4.5 m', 210, (height - 100 + height - 250) / 2);
            
            // Draw force against gravity (weight)
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(personX + 10, personY);
            ctx.lineTo(personX + 10, personY - 80);
            ctx.stroke();
            
            // Draw calculation
            ctx.fillStyle = '#4CAF50';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Work against gravity = Weight Ã— Height', width/2, 60);
            ctx.font = '14px Arial';
            ctx.fillText('W = m Ã— g Ã— h = 60 kg Ã— 9.8 m/sÂ² Ã— 4.5 m', width/2, 90);
            ctx.fillText('= 2646 J', width/2, 110);
            
            // Draw time and power calculation
            ctx.fillStyle = '#FFC107';
            ctx.font = '14px Arial';
            ctx.fillText('If climbed in 10 seconds:', width/2, 140);
            ctx.fillText('Power = Work Ã· Time = 2646 J Ã· 10 s = 264.6 W', width/2, 160);
        }

        // Draw simple machines
        function drawSimpleMachines(ctx, width, height) {
            const centerX = width/2;
            
            // Draw three simple machines
            
            // 1. Lever
            // Fulcrum
            ctx.fillStyle = '#795548';
            ctx.fillRect(centerX - 200, 150, 10, 50);
            // Lever arm
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(centerX - 250, 140, 100, 10);
            // Load
            ctx.fillStyle = '#F44336';
            ctx.fillRect(centerX - 260, 100, 30, 40);
            // Force
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX - 150, 145);
            ctx.lineTo(centerX - 150, 100);
            ctx.stroke();
            ctx.fillText('Lever', centerX - 200, 220);
            
            // 2. Inclined plane
            // Ramp
            ctx.fillStyle = '#9E9E9E';
            ctx.beginPath();
            ctx.moveTo(centerX - 50, 200);
            ctx.lineTo(centerX + 50, 200);
            ctx.lineTo(centerX + 50, 150);
            ctx.closePath();
            ctx.fill();
            // Object on ramp
            ctx.fillStyle = '#F44336';
            ctx.fillRect(centerX, 140, 30, 30);
            ctx.fillText('Inclined Plane', centerX, 220);
            
            // 3. Pulley
            // Support
            ctx.fillStyle = '#795548';
            ctx.fillRect(centerX + 150, 100, 10, 50);
            // Pulley wheel
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX + 155, 120, 15, 0, Math.PI * 2);
            ctx.stroke();
            // Rope
            ctx.strokeStyle = '#795548';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX + 140, 120);
            ctx.lineTo(centerX + 140, 180);
            ctx.lineTo(centerX + 200, 180);
            ctx.stroke();
            // Load
            ctx.fillStyle = '#F44336';
            ctx.fillRect(centerX + 130, 180, 20, 30);
            // Force
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX + 200, 180);
            ctx.lineTo(centerX + 240, 180);
            ctx.stroke();
            ctx.fillText('Pulley', centerX + 155, 220);
            
            // Draw principle
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Simple Machines: Reduce force needed, but increase distance', width/2, 250);
            ctx.fillText('Work input = Work output (ignoring friction)', width/2, 270);
        }

        // Draw no work examples
        function drawNoWorkExamples(ctx, width, height) {
            // Example 1: Holding object stationary
            // Draw person holding box
            ctx.fillStyle = '#FFCCBC';
            // Body
            ctx.fillRect(100, 100, 30, 60);
            // Arms
            ctx.fillRect(80, 110, 20, 10);
            ctx.fillRect(130, 110, 20, 10);
            
            // Draw box being held
            ctx.fillStyle = '#F44336';
            ctx.fillRect(90, 80, 50, 30);
            
            // Draw label
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Holding box stationary:', 100, 180);
            ctx.fillText('Force applied, but no movement', 100, 200);
            ctx.fillText('Work = 0 J', 100, 220);
            
            // Example 2: Carrying horizontally
            // Draw person walking with box
            ctx.fillStyle = '#FFCCBC';
            // Body at new position
            ctx.fillRect(300, 100, 30, 60);
            // Arms
            ctx.fillRect(280, 110, 20, 10);
            ctx.fillRect(330, 110, 20, 10);
            
            // Draw box being carried
            ctx.fillStyle = '#F44336';
            ctx.fillRect(290, 80, 50, 30);
            
            // Draw motion lines
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(250, 150);
            ctx.lineTo(350, 150);
            ctx.stroke();
            
            // Draw force and motion vectors
            // Force (upward)
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(315, 80);
            ctx.lineTo(315, 40);
            ctx.stroke();
            
            // Motion (horizontal)
            ctx.strokeStyle = '#2196F3';
            ctx.beginPath();
            ctx.moveTo(340, 95);
            ctx.lineTo(380, 95);
            ctx.stroke();
            
            // Draw label
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Carrying box horizontally:', 300, 180);
            ctx.fillText('Force is vertical, motion is horizontal', 300, 200);
            ctx.fillText('No work against gravity (force âŠ¥ motion)', 300, 220);
            
            // Draw explanation
            ctx.fillStyle = '#4CAF50';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Work = Force Ã— Distance Ã— cos(Î¸)', width/2, 250);
            ctx.font = '14px Arial';
            ctx.fillText('Î¸ = angle between force and motion directions', width/2, 270);
            ctx.fillText('When force is perpendicular to motion (Î¸ = 90Â°), cos(90Â°) = 0 â†’ Work = 0', width/2, 290);
        }

        // Draw power comparison
        function drawPowerComparison(ctx, width, height) {
            // Compare different power outputs
            
            // Light bulb (60W)
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(100, 100, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('60W Light Bulb', 85, 150);
            ctx.fillText('60 J/s', 90, 170);
            
            // Human climbing stairs
            ctx.fillStyle = '#FFCCBC';
            // Body
            ctx.fillRect(250, 80, 30, 50);
            // Legs in climbing position
            ctx.fillRect(250, 130, 10, 30);
            ctx.fillRect(270, 130, 10, 20);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Human climbing', 240, 150);
            ctx.fillText('~200-300 W', 240, 170);
            
            // Car engine
            ctx.fillStyle = '#F44336';
            ctx.fillRect(400, 90, 60, 40);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Car Engine', 405, 150);
            ctx.fillText('100,000 W (134 hp)', 395, 170);
            
            // Draw power comparison scale
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(50, 200);
            ctx.lineTo(550, 200);
            ctx.stroke();
            
            // Mark power levels on scale
            const powers = [
                { label: '60W', x: 100, color: '#FFC107' },
                { label: '300W', x: 250, color: '#4CAF50' },
                { label: '100kW', x: 430, color: '#F44336' }
            ];
            
            powers.forEach(power => {
                ctx.strokeStyle = power.color;
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(power.x, 190);
                ctx.lineTo(power.x, 210);
                ctx.stroke();
                
                ctx.fillStyle = power.color;
                ctx.font = '12px Arial';
                ctx.fillText(power.label, power.x - 15, 230);
            });
            
            // Draw logarithmic note
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Note: Scale is logarithmic (not linear)', width/2, 260);
            
            // Draw power definition
            ctx.fillStyle = '#4CAF50';
            ctx.font = '16px Arial';
            ctx.fillText('Power = Work Ã· Time = Rate of doing work', width/2, 290);
            ctx.font = '14px Arial';
            ctx.fillText('1 Watt = 1 Joule per second', width/2, 310);
        }

        // Vary force in work calculation
        window.varyForce = function() {
            alert("Varying Force in Work Calculation:\n\n" +
                  "Work = Force Ã— Distance\n\n" +
                  "Example: Pushing a box 5 meters:\n" +
                  "â€¢ With 10 N force: Work = 10 N Ã— 5 m = 50 J\n" +
                  "â€¢ With 20 N force: Work = 20 N Ã— 5 m = 100 J\n" +
                  "â€¢ With 50 N force: Work = 50 N Ã— 5 m = 250 J\n\n" +
                  "More force = more work done (if distance is same).");
        };

        // Vary distance in work calculation
        window.varyDistance = function() {
            alert("Varying Distance in Work Calculation:\n\n" +
                  "Work = Force Ã— Distance\n\n" +
                  "Example: Pushing with 20 N force:\n" +
                  "â€¢ For 2 meters: Work = 20 N Ã— 2 m = 40 J\n" +
                  "â€¢ For 5 meters: Work = 20 N Ã— 5 m = 100 J\n" +
                  "â€¢ For 10 meters: Work = 20 N Ã— 10 m = 200 J\n\n" +
                  "More distance = more work done (if force is same).");
        };

        // Vary time in power calculation
        window.varyTime = function() {
            alert("Varying Time in Power Calculation:\n\n" +
                  "Power = Work Ã· Time\n\n" +
                  "Example: Doing 1000 J of work:\n" +
                  "â€¢ In 10 seconds: Power = 1000 J Ã· 10 s = 100 W\n" +
                  "â€¢ In 5 seconds: Power = 1000 J Ã· 5 s = 200 W\n" +
                  "â€¢ In 2 seconds: Power = 1000 J Ã· 2 s = 500 W\n\n" +
                  "Same work in less time = more power needed.");
        };

        // Show law
        window.showLaw = function(law) {
            appState.currentLaw = law;
            
            // Update active button
            const lawsBtns = document.querySelectorAll('.laws-btn');
            lawsBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawLaw();
        };

        // Draw law visualization
        function drawLaw() {
            const ctx = appState.lawsCtx;
            const canvas = appState.lawsCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentLaw === 'conservation') title = "Law of Conservation of Energy";
            else if (appState.currentLaw === 'thermodynamics') title = "Laws of Thermodynamics";
            else if (appState.currentLaw === 'entropy') title = "Entropy & Energy Quality";
            else if (appState.currentLaw === 'efficiency') title = "Energy Efficiency";
            else if (appState.currentLaw === 'sankey') title = "Sankey Diagram";
            else title = "Energy Waste & Loss";
            
            ctx.fillText(title, width/2, 20);
            
            // Draw law visualization
            if (appState.currentLaw === 'conservation') {
                drawConservationLaw(ctx, width, height);
            } else if (appState.currentLaw === 'thermodynamics') {
                drawThermodynamics(ctx, width, height);
            } else if (appState.currentLaw === 'entropy') {
                drawEntropy(ctx, width, height);
            } else if (appState.currentLaw === 'efficiency') {
                drawEfficiency(ctx, width, height);
            } else if (appState.currentLaw === 'sankey') {
                drawSankeyDiagram(ctx, width, height);
            } else {
                drawEnergyWaste(ctx, width, height);
            }
        }

        // Draw conservation of energy law
        function drawConservationLaw(ctx, width, height) {
            const centerX = width/2;
            
            // Draw pendulum to show energy transformation
            const time = Date.now() / 1000;
            const angle = Math.sin(time) * Math.PI/4; // Â±45 degrees
            
            // Draw support
            ctx.fillStyle = '#795548';
            ctx.fillRect(centerX - 5, 30, 10, 20);
            
            // Draw string
            const pendulumLength = 100;
            const ballX = centerX + Math.sin(angle) * pendulumLength;
            const ballY = 50 + Math.cos(angle) * pendulumLength;
            
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 50);
            ctx.lineTo(ballX, ballY);
            ctx.stroke();
            
            // Draw pendulum bob
            ctx.fillStyle = '#F44336';
            ctx.beginPath();
            ctx.arc(ballX, ballY, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw energy labels at different positions
            
            // At highest point (left)
            ctx.fillStyle = '#4CAF50';
            ctx.font = '12px Arial';
            ctx.fillText('Max Potential Energy', centerX - 120, 80);
            ctx.fillText('Min Kinetic Energy', centerX - 120, 100);
            
            // At lowest point (center)
            ctx.fillText('Min Potential Energy', centerX - 40, 180);
            ctx.fillText('Max Kinetic Energy', centerX - 40, 200);
            
            // At highest point (right)
            ctx.fillText('Max Potential Energy', centerX + 40, 80);
            ctx.fillText('Min Kinetic Energy', centerX + 40, 100);
            
            // Draw energy flow arrows
            ctx.strokeStyle = '#FFC107';
            ctx.lineWidth = 2;
            
            // Left to center
            ctx.beginPath();
            ctx.moveTo(centerX - 100, 110);
            ctx.lineTo(centerX - 20, 160);
            ctx.stroke();
            
            // Center to right
            ctx.beginPath();
            ctx.moveTo(centerX + 20, 160);
            ctx.lineTo(centerX + 100, 110);
            ctx.stroke();
            
            // Draw total energy (constant)
            ctx.fillStyle = '#2196F3';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Total Energy = Constant', width/2, height - 40);
            ctx.fillText('PE + KE = Constant (ignoring friction)', width/2, height - 20);
            
            // Animate if needed
            appState.animationFrame = requestAnimationFrame(() => drawLaw());
        }

        // Draw thermodynamics laws
        function drawThermodynamics(ctx, width, height) {
            // Draw three laws
            
            // First law: Conservation
            ctx.fillStyle = '#4CAF50';
            ctx.font = '14px Arial';
            ctx.fillText('1st Law: Conservation of Energy', width/2, 50);
            ctx.font = '12px Arial';
            ctx.fillText('Energy cannot be created or destroyed', width/2, 70);
            ctx.fillText('Only converted from one form to another', width/2, 90);
            
            // Draw energy transformation diagram
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(100, 120);
            ctx.lineTo(200, 120);
            ctx.lineTo(150, 170);
            ctx.closePath();
            ctx.stroke();
            
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Input Energy', 150, 110);
            ctx.fillText('Output Energy', 90, 135);
            ctx.fillText('(same total)', 90, 150);
            
            // Second law: Entropy
            ctx.fillStyle = '#FF9800';
            ctx.font = '14px Arial';
            ctx.fillText('2nd Law: Entropy Increases', width/2, 200);
            ctx.font = '12px Arial';
            ctx.fillText('Energy transformations are never 100% efficient', width/2, 220);
            ctx.fillText('Some energy always becomes waste heat', width/2, 240);
            
            // Draw efficiency diagram
            ctx.fillStyle = '#F44336';
            ctx.fillRect(100, 250, 200, 30);
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(100, 250, 40, 30); // 20% useful
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Useful Energy (20%)', 110, 270);
            ctx.fillText('Waste Heat (80%)', 200, 270);
            
            // Third law: Absolute zero
            ctx.fillStyle = '#2196F3';
            ctx.font = '14px Arial';
            ctx.fillText('3rd Law: Absolute Zero', width/2, 320);
            ctx.font = '12px Arial';
            ctx.fillText('Absolute zero (-273.15Â°C) cannot be reached', width/2, 340);
            ctx.fillText('All molecular motion stops at absolute zero', width/2, 360);
        }

        // Draw entropy concept
        function drawEntropy(ctx, width, height) {
            // Draw ordered vs disordered states
            
            // Ordered state (low entropy)
            ctx.fillStyle = '#4CAF50';
            ctx.font = '14px Arial';
            ctx.fillText('Low Entropy (Ordered)', 150, 50);
            
            // Draw organized particles
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 5; j++) {
                    const x = 100 + i * 20;
                    const y = 70 + j * 20;
                    ctx.fillStyle = '#2196F3';
                    ctx.beginPath();
                    ctx.arc(x, y, 6, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // Arrow to disordered state
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(200, 170);
            ctx.lineTo(200, 200);
            ctx.stroke();
            
            // Disordered state (high entropy)
            ctx.fillStyle = '#F44336';
            ctx.font = '14px Arial';
            ctx.fillText('High Entropy (Disordered)', 150, 240);
            
            // Draw random particles
            for (let i = 0; i < 25; i++) {
                const x = 50 + Math.random() * 200;
                const y = 260 + Math.random() * 80;
                ctx.fillStyle = '#2196F3';
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Draw energy quality concept
            ctx.fillStyle = '#FFC107';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Energy Quality Degrades', width/2, 380);
            ctx.font = '12px Arial';
            ctx.fillText('High-quality energy (electricity, gasoline)', width/2, 400);
            ctx.fillText('â†’ Low-quality energy (waste heat)', width/2, 420);
            
            // Draw example
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Example: Car engine efficiency ~30%', width/2, 450);
            ctx.fillText('70% of gasoline energy becomes waste heat', width/2, 470);
        }

        // Draw efficiency visualization
        function drawEfficiency(ctx, width, height) {
            // Draw efficiency formula and examples
            
            ctx.fillStyle = '#4CAF50';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Efficiency = (Useful Output Energy Ã· Total Input Energy) Ã— 100%', width/2, 50);
            
            // Draw efficiency bars for different devices
            
            const devices = [
                { name: 'Incandescent Bulb', efficiency: 5, color: '#F44336' },
                { name: 'LED Bulb', efficiency: 30, color: '#4CAF50' },
                { name: 'Car Engine', efficiency: 25, color: '#FF9800' },
                { name: 'Electric Motor', efficiency: 90, color: '#2196F3' },
                { name: 'Solar Panel', efficiency: 20, color: '#FFC107' }
            ];
            
            devices.forEach((device, index) => {
                const y = 80 + index * 50;
                
                // Draw device name
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '12px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(device.name, 50, y + 15);
                
                // Draw efficiency percentage
                ctx.textAlign = 'right';
                ctx.fillText(`${device.efficiency}%`, 130, y + 15);
                
                // Draw efficiency bar background (100%)
                ctx.fillStyle = '#333333';
                ctx.fillRect(150, y, 200, 20);
                
                // Draw actual efficiency
                ctx.fillStyle = device.color;
                ctx.fillRect(150, y, 200 * device.efficiency / 100, 20);
                
                // Draw bar value
                ctx.fillStyle = '#FFFFFF';
                ctx.textAlign = 'left';
                ctx.fillText(`${device.efficiency}% efficient`, 360, y + 15);
            });
            
            // Draw waste heat note
            ctx.fillStyle = '#FF9800';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('The rest becomes waste heat!', width/2, height - 40);
            ctx.fillText('No device is 100% efficient due to 2nd Law of Thermodynamics', width/2, height - 20);
        }

        // Draw Sankey diagram
        function drawSankeyDiagram(ctx, width, height) {
            // Draw Sankey diagram for energy flow
            
            // Input energy (100%)
            ctx.fillStyle = '#F44336';
            ctx.fillRect(50, 100, 40, 100);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Input Energy', 45, 95);
            ctx.fillText('100%', 55, 155);
            
            // Arrows to outputs
            // Useful output (30%)
            ctx.fillStyle = '#4CAF50';
            ctx.beginPath();
            ctx.moveTo(90, 120);
            ctx.lineTo(250, 80);
            ctx.lineTo(250, 100);
            ctx.lineTo(90, 140);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = '#000000';
            ctx.fillText('Useful Output', 260, 90);
            ctx.fillText('30%', 260, 105);
            
            // Waste heat (70%)
            ctx.fillStyle = '#FF9800';
            ctx.beginPath();
            ctx.moveTo(90, 160);
            ctx.lineTo(250, 140);
            ctx.lineTo(250, 180);
            ctx.lineTo(90, 180);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = '#000000';
            ctx.fillText('Waste Heat', 260, 160);
            ctx.fillText('70%', 260, 175);
            
            // Draw example device
            ctx.fillStyle = '#2196F3';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Example: Car Engine', width/2, 220);
            
            // Draw detailed breakdown
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Gasoline energy (100%) â†’', 50, 250);
            ctx.fillStyle = '#4CAF50';
            ctx.fillText('Useful kinetic energy (25%)', 200, 250);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('â†’', 50, 270);
            ctx.fillStyle = '#FF9800';
            ctx.fillText('Exhaust heat (40%)', 200, 270);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('â†’', 50, 290);
            ctx.fillStyle = '#FF9800';
            ctx.fillText('Cooling system heat (30%)', 200, 290);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('â†’', 50, 310);
            ctx.fillStyle = '#FF9800';
            ctx.fillText('Friction & other losses (5%)', 200, 310);
        }

        // Draw energy waste
        function drawEnergyWaste(ctx, width, height) {
            // Draw where energy is wasted
            
            // Draw power plant example
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(50, 50, 100, 80);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Power Plant', 75, 95);
            
            // Draw transmission lines
            ctx.strokeStyle = '#FFC107';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(150, 90);
            ctx.lineTo(250, 90);
            ctx.stroke();
            
            // Draw house
            ctx.fillStyle = '#8BC34A';
            ctx.fillRect(250, 60, 80, 60);
            ctx.fillRect(270, 30, 40, 30);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Home', 275, 95);
            
            // Draw energy losses
            // Power plant losses
            ctx.fillStyle = '#FF9800';
            ctx.beginPath();
            ctx.arc(100, 140, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000000';
            ctx.fillText('60% waste heat', 75, 145);
            
            // Transmission losses
            ctx.fillStyle = '#FF9800';
            ctx.beginPath();
            ctx.arc(200, 140, 20, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000000';
            ctx.fillText('5% loss', 190, 145);
            
            // Device losses (e.g., light bulb)
            ctx.fillStyle = '#FFC107';
            ctx.beginPath();
            ctx.arc(290, 140, 25, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000000';
            ctx.fillText('95% heat', 280, 145);
            
            // Draw overall efficiency
            ctx.fillStyle = '#4CAF50';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Overall Efficiency:', width/2, 200);
            ctx.font = '16px Arial';
            ctx.fillText('100% â†’ 40% â†’ 38% â†’ 2%', width/2, 230);
            ctx.font = '14px Arial';
            ctx.fillText('(Power plant) (Transmission) (Light bulb)', width/2, 250);
            
            // Draw conclusion
            ctx.fillStyle = '#F44336';
            ctx.font = '14px Arial';
            ctx.fillText('Only 2% of original energy becomes light!', width/2, 290);
            ctx.fillText('98% is wasted as heat at various stages', width/2, 310);
        }

        // Run experiment
        window.runExperiment = function(experiment) {
            appState.currentExperiment = experiment;
            
            // Update active button
            const experimentBtns = document.querySelectorAll('.experiment-btn');
            experimentBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawExperiment();
        };

        // Draw experiment
        function drawExperiment() {
            const ctx = appState.experimentCtx;
            const canvas = appState.experimentCanvas;
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Draw title
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            let title = "";
            if (appState.currentExperiment === 'pendulum') title = "Pendulum Energy Experiment";
            else if (appState.currentExperiment === 'rollercoaster') title = "Roller Coaster Energy";
            else if (appState.currentExperiment === 'bouncyBall') title = "Bouncing Ball Energy";
            else if (appState.currentExperiment === 'ramp') title = "Ball on Ramp";
            else if (appState.currentExperiment === 'spring') title = "Spring Energy";
            else title = "Electrical Circuit";
            
            ctx.fillText(title, width/2, 20);
            
            // Draw experiment based on type
            if (appState.currentExperiment === 'pendulum') {
                drawPendulumExperiment(ctx, width, height);
            } else if (appState.currentExperiment === 'rollercoaster') {
                drawRollerCoasterExperiment(ctx, width, height);
            } else if (appState.currentExperiment === 'bouncyBall') {
                drawBouncyBallExperiment(ctx, width, height);
            } else if (appState.currentExperiment === 'ramp') {
                drawRampExperiment(ctx, width, height);
            } else if (appState.currentExperiment === 'spring') {
                drawSpringExperiment(ctx, width, height);
            } else {
                drawCircuitExperiment(ctx, width, height);
            }
        }

        // Draw pendulum experiment
        function drawPendulumExperiment(ctx, width, height) {
            const centerX = width/2;
            const time = Date.now() / 1000;
            
            // Draw support
            ctx.fillStyle = '#795548';
            ctx.fillRect(centerX - 10, 40, 20, 20);
            
            // Calculate pendulum position
            const length = 80;
            const amplitude = Math.PI/3; // 60 degrees
            const frequency = 1;
            const angle = amplitude * Math.sin(time * frequency * 2 * Math.PI);
            
            const ballX = centerX + Math.sin(angle) * length;
            const ballY = 60 + Math.cos(angle) * length;
            
            // Draw string
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 60);
            ctx.lineTo(ballX, ballY);
            ctx.stroke();
            
            // Draw pendulum bob
            ctx.fillStyle = '#F44336';
            ctx.beginPath();
            ctx.arc(ballX, ballY, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw energy indicators
            const maxHeight = 60 + length; // Lowest point
            const currentHeight = ballY;
            const heightDifference = Math.abs(currentHeight - maxHeight);
            
            // Calculate energy proportions (simplified)
            const pePercent = Math.min(100, (heightDifference / length) * 100);
            const kePercent = 100 - pePercent;
            
            // Draw energy bars
            // Potential energy bar
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(50, 150, pePercent * 2, 20);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText(`PE: ${pePercent.toFixed(0)}%`, 50, 145);
            
            // Kinetic energy bar
            ctx.fillStyle = '#FFC107';
            ctx.fillRect(50, 180, kePercent * 2, 20);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText(`KE: ${kePercent.toFixed(0)}%`, 50, 175);
            
            // Draw total energy bar (constant)
            ctx.fillStyle = '#2196F3';
            ctx.fillRect(50, 210, 200, 20);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Total Energy: Constant (ignoring friction)', 50, 205);
            
            // Draw positions
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            
            // Left highest point
            const leftHighX = centerX + Math.sin(-amplitude) * length;
            const leftHighY = 60 + Math.cos(-amplitude) * length;
            ctx.fillText('Max PE, Min KE', leftHighX, leftHighY - 25);
            
            // Right highest point
            const rightHighX = centerX + Math.sin(amplitude) * length;
            const rightHighY = 60 + Math.cos(amplitude) * length;
            ctx.fillText('Max PE, Min KE', rightHighX, rightHighY - 25);
            
            // Bottom point
            ctx.fillText('Min PE, Max KE', centerX, 60 + length + 25);
            
            // Animate
            appState.animationFrame = requestAnimationFrame(() => drawExperiment());
        }

        // Draw roller coaster experiment
        function drawRollerCoasterExperiment(ctx, width, height) {
            // Draw roller coaster track
            ctx.strokeStyle = '#795548';
            ctx.lineWidth = 4;
            ctx.beginPath();
            
            // Start with a hill
            ctx.moveTo(50, 150);
            // First hill
            ctx.quadraticCurveTo(100, 50, 150, 150);
            // Valley
            ctx.quadraticCurveTo(200, 200, 250, 150);
            // Second hill (smaller)
            ctx.quadraticCurveTo(300, 100, 350, 150);
            // End
            ctx.lineTo(400, 150);
            
            ctx.stroke();
            
            // Draw roller coaster car
            const time = Date.now() / 1000;
            const carSpeed = 0.5; // units per second
            const carX = 50 + (time * 50) % 350;
            
            // Calculate car Y position based on track
            let carY = 150; // Default
            
            if (carX < 150) {
                // On first hill
                const t = (carX - 50) / 100;
                carY = 150 - (1 - Math.pow(2*t - 1, 2)) * 100;
            } else if (carX < 250) {
                // In valley
                const t = (carX - 150) / 100;
                carY = 150 + (1 - Math.pow(2*t - 1, 2)) * 50;
            } else if (carX < 350) {
                // On second hill
                const t = (carX - 250) / 100;
                carY = 150 - (1 - Math.pow(2*t - 1, 2)) * 50;
            }
            
            // Draw car
            ctx.fillStyle = '#F44336';
            ctx.fillRect(carX - 15, carY - 10, 30, 20);
            ctx.fillStyle = '#FFC107';
            // Draw wheels
            ctx.beginPath();
            ctx.arc(carX - 8, carY + 10, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(carX + 8, carY + 10, 5, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw energy indicators
            // Calculate energy based on height
            const maxHeight = 50;
            const pePercent = ((carY - 150) / (maxHeight - 150) + 1) * 50;
            const kePercent = 100 - pePercent;
            
            // Draw energy bars
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(50, 180, pePercent * 1.5, 15);
            ctx.fillStyle = '#FFC107';
            ctx.fillRect(50, 200, kePercent * 1.5, 15);
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText(`Height: ${(200 - carY).toFixed(0)} units`, 50, 175);
            ctx.fillText(`PE: ${pePercent.toFixed(0)}%`, 200, 188);
            ctx.fillText(`KE: ${kePercent.toFixed(0)}%`, 200, 208);
            
            // Draw energy conservation note
            ctx.fillStyle = '#2196F3';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('PE + KE = Constant (ignoring friction)', width/2, 230);
            
            // Animate
            appState.animationFrame = requestAnimationFrame(() => drawExperiment());
        }

        // Draw bouncy ball experiment
        function drawBouncyBallExperiment(ctx, width, height) {
            const time = Date.now() / 1000;
            
            // Draw ground
            ctx.fillStyle = '#795548';
            ctx.fillRect(0, height - 50, width, 50);
            
            // Calculate ball position (bouncing)
            const gravity = 9.8 * 10; // Scaled for animation
            const initialHeight = 100;
            const bounceFactor = 0.7; // Energy lost per bounce
            
            // Simple bouncing physics
            const cycleTime = time % 3; // 3 second cycle
            let ballY;
            
            if (cycleTime < 1.5) {
                // Falling or bouncing up
                const fallTime = cycleTime % 1.5;
                ballY = height - 50 - 15 - (initialHeight - 0.5 * gravity * Math.pow(fallTime, 2));
            } else {
                // On ground or starting new bounce
                ballY = height - 50 - 15;
            }
            
            // Ensure ball doesn't go below ground
            ballY = Math.max(height - 50 - 15, ballY);
            
            // Draw ball
            const ballX = width/2;
            ctx.fillStyle = '#F44336';
            ctx.beginPath();
            ctx.arc(ballX, ballY, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw height indicator
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(ballX + 30, height - 50);
            ctx.lineTo(ballX + 30, ballY);
            ctx.stroke();
            
            // Draw height label
            const heightValue = (height - 50 - ballY) / 10;
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText(`Height: ${heightValue.toFixed(1)} m`, ballX + 40, (height - 50 + ballY) / 2);
            
            // Draw energy graph over time
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            // Draw PE graph
            for (let x = 50; x < 250; x += 2) {
                const graphTime = (time + (x - 50) / 100) % 3;
                let graphHeight;
                
                if (graphTime < 1.5) {
                    const fallTime = graphTime % 1.5;
                    graphHeight = initialHeight - 0.5 * gravity * Math.pow(fallTime, 2);
                } else {
                    graphHeight = 0;
                }
                
                const y = 250 - (graphHeight / initialHeight) * 50;
                
                if (x === 50) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // Draw KE graph
            ctx.strokeStyle = '#FFC107';
            ctx.beginPath();
            
            for (let x = 50; x < 250; x += 2) {
                const graphTime = (time + (x - 50) / 100) % 3;
                let graphKE;
                
                if (graphTime < 1.5) {
                    const fallTime = graphTime % 1.5;
                    const velocity = gravity * fallTime;
                    graphKE = 0.5 * Math.pow(velocity, 2);
                } else {
                    graphKE = 0;
                }
                
                const y = 250 - (graphKE / 500) * 50; // Scaled
                
                if (x === 50) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // Draw labels
            ctx.fillStyle = '#4CAF50';
            ctx.fillText('PE', 260, 220);
            ctx.fillStyle = '#FFC107';
            ctx.fillText('KE', 260, 240);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Bounces get lower due to energy loss (heat, sound)', width/2, height - 20);
            
            // Animate
            appState.animationFrame = requestAnimationFrame(() => drawExperiment());
        }

        // Draw ramp experiment
        function drawRampExperiment(ctx, width, height) {
            // Draw ramp
            ctx.fillStyle = '#9E9E9E';
            ctx.beginPath();
            ctx.moveTo(50, height - 50);
            ctx.lineTo(200, 100);
            ctx.lineTo(350, height - 50);
            ctx.closePath();
            ctx.fill();
            
            // Draw ball on ramp
            const time = Date.now() / 1000;
            const ballSpeed = 50; // pixels per second
            const ballX = 100 + (time * ballSpeed) % 250;
            
            // Calculate ball Y position on ramp
            const rampHeight = height - 50 - 100;
            const rampLength = 250;
            const ballDistance = ballX - 50;
            const ballY = height - 50 - (ballDistance / rampLength) * rampHeight;
            
            // Draw ball
            ctx.fillStyle = '#F44336';
            ctx.beginPath();
            ctx.arc(ballX, ballY, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw height indicator at start
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(30, height - 50);
            ctx.lineTo(30, 100);
            ctx.stroke();
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText('Initial height', 10, (height - 50 + 100) / 2);
            
            // Draw velocity vector
            const velocityX = ballSpeed;
            const velocityY = -(rampHeight / rampLength) * ballSpeed;
            
            ctx.strokeStyle = '#FFC107';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(ballX, ballY);
            ctx.lineTo(ballX + velocityX / 2, ballY + velocityY / 2);
            ctx.stroke();
            
            // Draw energy calculations
            ctx.fillStyle = '#4CAF50';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Energy Transformation:', width/2, 50);
            ctx.font = '12px Arial';
            ctx.fillText('Gravitational PE â†’ Kinetic Energy', width/2, 70);
            
            // Draw formulas
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('At top: PE = mgh, KE = 0', width/2, 100);
            ctx.fillText('At bottom: PE = 0, KE = Â½mvÂ²', width/2, 120);
            ctx.fillText('mgh = Â½mvÂ² (ignoring friction)', width/2, 140);
            
            // Draw speed calculation
            const currentHeight = height - 50 - ballY;
            const initialHeight = rampHeight;
            const speed = Math.sqrt(2 * 9.8 * (initialHeight - currentHeight)) * 10; // Scaled
            
            ctx.fillStyle = '#FFC107';
            ctx.fillText(`Current speed: ${speed.toFixed(1)} m/s`, width/2, 170);
            
            // Animate
            appState.animationFrame = requestAnimationFrame(() => drawExperiment());
        }

        // Draw spring experiment
        function drawSpringExperiment(ctx, width, height) {
            const centerX = width/2;
            const time = Date.now() / 1000;
            
            // Draw spring
            const amplitude = 30;
            const frequency = 2;
            const compression = amplitude * Math.sin(time * frequency * 2 * Math.PI);
            
            // Draw spring base
            ctx.fillStyle = '#795548';
            ctx.fillRect(centerX - 20, 50, 40, 20);
            
            // Draw spring coils
            ctx.strokeStyle = '#9E9E9E';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX, 70);
            
            const coils = 10;
            const coilHeight = 80;
            const compressedHeight = coilHeight + compression;
            
            for (let i = 0; i <= coils; i++) {
                const y = 70 + (i / coils) * compressedHeight;
                const x = centerX + (i % 2 === 0 ? -10 : 10);
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Draw mass on spring
            const massY = 70 + compressedHeight;
            ctx.fillStyle = '#F44336';
            ctx.fillRect(centerX - 25, massY, 50, 30);
            
            // Draw equilibrium position
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(centerX - 50, 70 + coilHeight);
            ctx.lineTo(centerX + 50, 70 + coilHeight);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#4CAF50';
            ctx.font = '12px Arial';
            ctx.fillText('Equilibrium', centerX + 60, 70 + coilHeight);
            
            // Draw energy indicators
            // Elastic PE is maximum at max compression/extension
            const pePercent = Math.abs(compression / amplitude) * 100;
            const kePercent = 100 - pePercent;
            
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(50, 150, pePercent * 1.5, 15);
            ctx.fillStyle = '#FFC107';
            ctx.fillRect(50, 170, kePercent * 1.5, 15);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.fillText(`Elastic PE: ${pePercent.toFixed(0)}%`, 200, 158);
            ctx.fillText(`KE: ${kePercent.toFixed(0)}%`, 200, 178);
            
            // Draw positions
            ctx.fillStyle = '#FFFFFF';
            ctx.textAlign = 'center';
            
            // Top (max compression)
            ctx.fillText('Max Elastic PE, Min KE', centerX, 40);
            
            // Bottom (max extension)
            ctx.fillText('Max Elastic PE, Min KE', centerX, massY + 50);
            
            // Middle (equilibrium)
            ctx.fillText('Min Elastic PE, Max KE', centerX, 70 + coilHeight + 20);
            
            // Draw formula
            ctx.fillStyle = '#2196F3';
            ctx.font = '14px Arial';
            ctx.fillText('Elastic PE = Â½kxÂ²', width/2, 220);
            ctx.font = '12px Arial';
            ctx.fillText('(k = spring constant, x = displacement from equilibrium)', width/2, 240);
            
            // Animate
            appState.animationFrame = requestAnimationFrame(() => drawExperiment());
        }

        // Draw circuit experiment
        function drawCircuitExperiment(ctx, width, height) {
            const centerX = width/2;
            
            // Draw battery
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(50, 100, 40, 80);
            ctx.strokeStyle = '#FFFFFF';
            ctx.strokeRect(50, 100, 40, 80);
            
            // Draw battery terminals
            ctx.fillStyle = '#FFC107';
            ctx.fillRect(60, 95, 20, 5); // Positive
            ctx.fillRect(60, 180, 20, 5); // Negative
            
            // Draw wires
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 3;
            
            // From positive terminal
            ctx.beginPath();
            ctx.moveTo(70, 95);
            ctx.lineTo(70, 50);
            ctx.lineTo(centerX - 30, 50);
            ctx.lineTo(centerX - 30, 100);
            ctx.stroke();
            
            // To light bulb
            ctx.beginPath();
            ctx.moveTo(centerX - 30, 100);
            ctx.lineTo(centerX, 100);
            ctx.stroke();
            
            // From light bulb back to battery
            ctx.beginPath();
            ctx.moveTo(centerX, 100);
            ctx.lineTo(centerX + 30, 100);
            ctx.lineTo(centerX + 30, 180);
            ctx.lineTo(70, 180);
            ctx.stroke();
            
            // Draw light bulb
            // Glass bulb
            ctx.fillStyle = '#E0E0E0';
            ctx.beginPath();
            ctx.arc(centerX, 100, 30, 0, Math.PI * 2);
            ctx.fill();
            
            // Filament
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX - 15, 95);
            ctx.lineTo(centerX + 15, 105);
            ctx.moveTo(centerX - 15, 105);
            ctx.lineTo(centerX + 15, 95);
            ctx.stroke();
            
            // Draw switch
            ctx.fillStyle = '#9E9E9E';
            ctx.fillRect(centerX - 40, 150, 20, 40);
            
            // Draw switch lever
            const time = Date.now() / 1000;
            const switchOn = Math.sin(time) > 0;
            
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 4;
            if (switchOn) {
                // Switch closed (circuit complete)
                ctx.beginPath();
                ctx.moveTo(centerX - 30, 150);
                ctx.lineTo(centerX - 30, 170);
                ctx.stroke();
            } else {
                // Switch open (circuit broken)
                ctx.beginPath();
                ctx.moveTo(centerX - 30, 150);
                ctx.lineTo(centerX - 20, 160);
                ctx.stroke();
            }
            
            // Draw current flow if switch is closed
            if (switchOn && appState.showAnimation) {
                const electronX = 70 + (time * 40) % (centerX - 40);
                const electronY = electronX < centerX - 30 ? 50 : 180;
                
                ctx.fillStyle = '#2196F3';
                ctx.beginPath();
                ctx.arc(electronX, electronY, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw light from bulb
                ctx.strokeStyle = '#FFC107';
                ctx.lineWidth = 2;
                for (let i = 0; i < 8; i++) {
                    const angle = (i * 45) * Math.PI / 180;
                    const length = 30 + Math.sin(time * 3 + i) * 10;
                    ctx.beginPath();
                    ctx.moveTo(centerX, 100);
                    ctx.lineTo(
                        centerX + Math.cos(angle) * length,
                        100 + Math.sin(angle) * length
                    );
                    ctx.stroke();
                }
                
                // Draw heat from bulb
                ctx.strokeStyle = '#F44336';
                for (let i = 0; i < 2; i++) {
                    const radius = 40 + i * 20 + Math.sin(time * 2 + i) * 5;
                    ctx.beginPath();
                    ctx.arc(centerX, 100, radius, 0, Math.PI * 2);
                    ctx.stroke();
                }
            }
            
            // Draw labels
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Battery', 70, 190);
            ctx.fillText('Switch', centerX - 30, 200);
            ctx.fillText('Light Bulb', centerX, 140);
            
            // Draw energy transformations
            ctx.fillText('Chemical â†’ Electrical â†’ Light + Heat', width/2, 230);
            
            if (switchOn) {
                ctx.fillStyle = '#4CAF50';
                ctx.fillText('Circuit CLOSED - Current flows', width/2, 250);
            } else {
                ctx.fillStyle = '#F44336';
                ctx.fillText('Circuit OPEN - No current', width/2, 250);
            }
            
            // Animate
            appState.animationFrame = requestAnimationFrame(() => drawExperiment());
        }

        // Pause experiment
        window.pauseExperiment = function() {
            appState.showAnimation = !appState.showAnimation;
            event.target.textContent = appState.showAnimation ? 'Pause' : 'Resume';
            
            if (appState.showAnimation) {
                drawExperiment();
            } else {
                if (appState.animationFrame) {
                    cancelAnimationFrame(appState.animationFrame);
                }
            }
        };

        // Reset experiment
        window.resetExperiment = function() {
            if (appState.animationFrame) {
                cancelAnimationFrame(appState.animationFrame);
            }
            drawExperiment();
        };

        // Calculator functions
        function updateCalculatorDisplay() {
            calcDisplay.textContent = appState.calculatorValue;
        }

        window.appendToDisplay = function(value) {
            if (appState.calculatorValue === "0" || appState.calculatorValue === "Error") {
                appState.calculatorValue = value;
            } else {
                appState.calculatorValue += value;
            }
            updateCalculatorDisplay();
        };

        window.clearDisplay = function() {
            appState.calculatorValue = "0";
            appState.calculatorMemory = null;
            updateCalculatorDisplay();
        };

        window.calculateResult = function() {
            try {
                // Replace Ã— with * for evaluation
                const expression = appState.calculatorValue.replace(/Ã—/g, '*');
                appState.calculatorValue = eval(expression).toString();
            } catch (error) {
                appState.calculatorValue = "Error";
            }
            updateCalculatorDisplay();
        };

        window.calculateKineticEnergy = function() {
            alert("Kinetic Energy Calculator:\n\nKE = Â½ Ã— m Ã— vÂ²\n\nExample:\nMass (m) = 10 kg\nVelocity (v) = 5 m/s\nKE = Â½ Ã— 10 Ã— 5Â² = Â½ Ã— 10 Ã— 25 = 125 J\n\nTry: 0.5 * 10 * 5 * 5 = 125");
        };

        window.calculatePotentialEnergy = function() {
            alert("Potential Energy Calculator:\n\nPE = m Ã— g Ã— h\n\nExample:\nMass (m) = 5 kg\nGravity (g) = 9.8 m/sÂ²\nHeight (h) = 2 m\nPE = 5 Ã— 9.8 Ã— 2 = 98 J\n\nTry: 5 * 9.8 * 2 = 98");
        };

        window.calculateWork = function() {
            alert("Work Calculator:\n\nWork = Force Ã— Distance\n\nExample:\nForce (F) = 20 N\nDistance (d) = 3 m\nWork = 20 Ã— 3 = 60 J\n\nTry: 20 * 3 = 60");
        };

        window.calculatePower = function() {
            alert("Power Calculator:\n\nPower = Work Ã· Time\n\nExample:\nWork = 500 J\nTime = 10 s\nPower = 500 Ã· 10 = 50 W\n\nTry: 500 / 10 = 50");
        };

        // Show property
        window.showProperty = function(property) {
            const properties = {
                joule: "Joule (J): SI unit of energy and work.\n1 J = 1 NÂ·m (force of 1 newton moving 1 meter)\nNamed after James Prescott Joule.",
                watt: "Watt (W): SI unit of power.\n1 W = 1 J/s (1 joule per second)\nNamed after James Watt, steam engine inventor.",
                kilowatt: "Kilowatt-hour (kWh): Common unit for electrical energy.\n1 kWh = 3,600,000 J\nTypical home uses 10-30 kWh per day.",
                calorie: "Calorie (cal): Heat energy unit.\n1 cal = 4.184 J (energy to heat 1g water by 1Â°C)\nFood calories are actually kilocalories (1 Cal = 1000 cal).",
                efficiency: "Efficiency = (Useful output Ã· Total input) Ã— 100%\nNo device is 100% efficient due to waste heat.\nHigher efficiency = less energy wasted.",
                conservation: "Law of Conservation of Energy:\nEnergy cannot be created or destroyed.\nTotal energy in isolated system remains constant."
            };
            
            if (properties[property]) {
                alert(properties[property]);
            }
        };

        // Show unit conversions
        window.showUnitConversions = function() {
            alert("Energy Unit Conversions:\n\n" +
                  "1 joule (J) = 1 newton-meter (NÂ·m)\n" +
                  "1 kilojoule (kJ) = 1000 J\n" +
                  "1 calorie (cal) = 4.184 J\n" +
                  "1 kilocalorie (kcal) = 4184 J\n" +
                  "1 British Thermal Unit (BTU) = 1055 J\n" +
                  "1 kilowatt-hour (kWh) = 3.6 Ã— 10â¶ J\n" +
                  "1 electronvolt (eV) = 1.602 Ã— 10â»Â¹â¹ J\n\n" +
                  "Power Unit Conversions:\n" +
                  "1 watt (W) = 1 J/s\n" +
                  "1 kilowatt (kW) = 1000 W\n" +
                  "1 horsepower (hp) = 746 W");
        };

        // Show real world values
        window.showRealWorldValues = function() {
            alert("Real-World Energy Values:\n\n" +
                  "â€¢ Human heartbeat: 1 J\n" +
                  "â€¢ Apple falling 1m: 1 J\n" +
                  "â€¢ Turning on light bulb for 1 hour: 60,000-100,000 J\n" +
                  "â€¢ 1 gram of TNT explosion: 4184 J\n" +
                  "â€¢ 1 liter of gasoline: 34,000,000 J\n" +
                  "â€¢ Daily food intake: 8,000,000-12,000,000 J\n\n" +
                  "Power Values:\n" +
                  "â€¢ Human at rest: 100 W\n" +
                  "â€¢ Bicycling: 200-300 W\n" +
                  "â€¢ Car engine: 100,000 W (134 hp)\n" +
                  "â€¢ Small wind turbine: 1,000 W\n" +
                  "â€¢ Nuclear power plant: 1,000,000,000 W");
        };

        // Show energy conversions
        window.showEnergyConversions = function() {
            alert("Energy Conversion Examples:\n\n" +
                  "â€¢ Chemical â†’ Electrical: Battery\n" +
                  "â€¢ Chemical â†’ Thermal: Burning fuel\n" +
                  "â€¢ Chemical â†’ Kinetic: Muscles moving\n" +
                  "â€¢ Electrical â†’ Light: Light bulb\n" +
                  "â€¢ Electrical â†’ Sound: Speaker\n" +
                  "â€¢ Electrical â†’ Thermal: Heater\n" +
                  "â€¢ Light â†’ Electrical: Solar panel\n" +
                  "â€¢ Kinetic â†’ Electrical: Generator\n" +
                  "â€¢ Thermal â†’ Kinetic: Steam engine\n" +
                  "â€¢ Nuclear â†’ Thermal: Nuclear reactor");
        };

        // Test your knowledge
        window.testYourKnowledge = function() {
            alert("Quick Test:\n\n" +
                  "1. What's the difference between energy and power? (Energy = capacity to do work; Power = rate of using energy)\n" +
                  "2. When is work done? (When force causes displacement in force's direction)\n" +
                  "3. Why can't we have 100% efficient machines? (2nd law of thermodynamics - some energy always becomes waste heat)\n" +
                  "4. What happens to kinetic energy if speed doubles? (Quadruples - KE âˆ vÂ²)\n" +
                  "5. What's the energy source for most life on Earth? (Sun - via photosynthesis)");
        };

        // Show energy sources
        window.showEnergySources = function() {
            alert("Energy Sources:\n\n" +
                  "Renewable:\n" +
                  "â€¢ Solar (sunlight)\n" +
                  "â€¢ Wind (air movement)\n" +
                  "â€¢ Hydro (falling water)\n" +
                  "â€¢ Geothermal (Earth's heat)\n" +
                  "â€¢ Biomass (plant matter)\n" +
                  "â€¢ Tidal (ocean tides)\n\n" +
                  "Non-renewable:\n" +
                  "â€¢ Fossil fuels (coal, oil, gas)\n" +
                  "â€¢ Nuclear (uranium)\n\n" +
                  "World energy: ~80% fossil fuels, ~20% renewables & nuclear");
        };

        // Show sustainability
        window.showSustainability = function() {
            alert("Energy Sustainability:\n\n" +
                  "Challenges:\n" +
                  "â€¢ Fossil fuels cause climate change\n" +
                  "â€¢ Non-renewable resources depleting\n" +
                  "â€¢ Energy demand increasing\n\n" +
                  "Solutions:\n" +
                  "â€¢ Increase renewable energy use\n" +
                  "â€¢ Improve energy efficiency\n" +
                  "â€¢ Reduce energy waste\n" +
                  "â€¢ Energy conservation\n\n" +
                  "Individual actions matter: Use LED bulbs, turn off unused devices, use public transport!");
        };

        // Load quiz question
        function loadQuizQuestion() {
            const quiz = quizQuestions[appState.quizIndex];
            quizQuestion.textContent = quiz.question;
            
            quizOptions.innerHTML = '';
            quiz.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.textContent = `${String.fromCharCode(65 + index)}) ${option}`;
                optionElement.onclick = () => checkQuizAnswer(optionElement, String.fromCharCode(65 + index));
                quizOptions.appendChild(optionElement);
            });
        }

        // Check quiz answer
        window.checkQuizAnswer = function(element, selectedAnswer) {
            const quiz = quizQuestions[appState.quizIndex];
            const options = quizOptions.querySelectorAll('.quiz-option');
            
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (opt.textContent.startsWith(quiz.answer + ')')) {
                    opt.classList.add('correct');
                }
            });
            
            if (selectedAnswer === quiz.answer) {
                element.classList.add('correct');
            } else {
                element.classList.add('incorrect');
            }
        };

        // Next quiz question
        window.nextQuizQuestion = function() {
            appState.quizIndex = (appState.quizIndex + 1) % quizQuestions.length;
            loadQuizQuestion();
        };

        // Topic information display
        window.showTopicInfo = function(topic) {
            let info = '';
            if (topic === 'energy') {
                info = "âš¡ Energy Forms âš¡\n\n";
                info += "Energy: Ability to do work or cause change.\n\n";
                info += "Main Forms:\n";
                info += "â€¢ Kinetic: Energy of motion (KE = Â½mvÂ²)\n";
                info += "â€¢ Potential: Stored energy (PE = mgh)\n";
                info += "â€¢ Thermal: Heat energy (molecular motion)\n";
                info += "â€¢ Chemical: Energy in chemical bonds\n";
                info += "â€¢ Electrical: Energy of moving charges\n";
                info += "â€¢ Nuclear: Energy in atomic nuclei\n";
                info += "â€¢ Sound: Energy of vibrating particles\n";
                info += "â€¢ Light: Electromagnetic radiation\n\n";
                info += "SI Unit: Joule (J)";
            } else if (topic === 'transformations') {
                info = "ðŸ”„ Energy Transformations ðŸ”„\n\n";
                info += "Energy can change from one form to another.\n\n";
                info += "Key Principles:\n";
                info += "1. Law of Conservation of Energy:\n";
                info += "   Energy cannot be created or destroyed\n";
                info += "   Total energy remains constant\n\n";
                info += "2. Energy Transformation Efficiency:\n";
                info += "   No transformation is 100% efficient\n";
                info += "   Some energy always becomes waste heat\n\n";
                info += "Examples:\n";
                info += "â€¢ Battery: Chemical â†’ Electrical\n";
                info += "â€¢ Light bulb: Electrical â†’ Light + Heat\n";
                info += "â€¢ Photosynthesis: Light â†’ Chemical\n";
                info += "â€¢ Human body: Chemical â†’ Kinetic + Heat";
            } else {
                info = "ðŸ’ª Work & Power ðŸ’ª\n\n";
                info += "Work: Transfer of energy when force causes displacement.\n";
                info += "Formula: Work = Force Ã— Distance (W = F Ã— d)\n";
                info += "Unit: Joule (1 J = 1 NÂ·m)\n\n";
                info += "Power: Rate of doing work or using energy.\n";
                info += "Formula: Power = Work Ã· Time (P = W/t)\n";
                info += "Unit: Watt (1 W = 1 J/s)\n\n";
                info += "Simple Machines:\n";
                info += "â€¢ Make work easier by changing force/distance\n";
                info += "â€¢ Examples: Lever, pulley, inclined plane, screw, wheel & axle\n";
                info += "â€¢ Work input = Work output (ignoring friction)";
            }
            alert(info);
        };

        // Initialize app
        window.addEventListener('DOMContentLoaded', initApp);
        
        // Handle window resize
        window.addEventListener('resize', function() {
            initializeCanvases();
            drawEnergyForm();
            drawTransformation();
            drawWorkExample();
            drawLaw();
            drawExperiment();
        });
    </script>
</body>
</html>
