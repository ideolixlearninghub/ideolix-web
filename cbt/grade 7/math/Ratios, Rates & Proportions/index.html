<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 Math - Ratios, Rates & Proportions | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Math Theme */
        :root {
            --primary-purple: #9C27B0;
            --secondary-cyan: #00BCD4;
            --accent-gold: #FFD700;
            --accent-green: #4CAF50;
            --accent-orange: #FF9800;
            --accent-red: #F44336;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --ratio-glow: 0 0 20px rgba(156, 39, 176, 0.4);
            --rate-glow: 0 0 20px rgba(0, 188, 212, 0.4);
            --proportion-glow: 0 0 20px rgba(255, 215, 0, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Math Pattern Background */
        .math-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(156, 39, 176, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 188, 212, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%);
            opacity: 0.3;
        }

        .floating-element {
            position: absolute;
            font-size: 3rem;
            font-weight: bold;
            animation: floatElement 25s linear infinite;
        }

        @keyframes floatElement {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-150px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-150px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(150px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--ratio-glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(156, 39, 176, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-purple);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-purple);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
        }

        .btn-primary:hover {
            background: #7B1FA2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(156, 39, 176, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-cyan);
            color: #212121;
            box-shadow: 0 4px 15px rgba(0, 188, 212, 0.4);
        }

        .btn-secondary:hover {
            background: #0097A7;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 188, 212, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-purple);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-purple), var(--secondary-cyan));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .math-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-gold);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-cyan));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-purple);
            background: rgba(156, 39, 176, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(156, 39, 176, 0.1);
            border-color: var(--primary-purple);
            color: var(--primary-purple);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-cyan);
            color: #212121;
        }

        .option.correct .option-letter {
            background: var(--primary-purple);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(156, 39, 176, 0.1);
            border-left: 5px solid var(--primary-purple);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-purple);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-purple);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Math Display */
        .math-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid var(--accent-gold);
            text-align: center;
        }

        .display-title {
            color: var(--primary-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        /* Ratios vs Rates vs Proportions */
        .comparison-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .comparison-box {
            background: var(--dark-card);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            min-width: 200px;
            transition: transform 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .comparison-box.ratio {
            border-color: var(--primary-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .comparison-box.rate {
            border-color: var(--secondary-cyan);
            background: rgba(0, 188, 212, 0.1);
        }

        .comparison-box.proportion {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .comparison-box:hover {
            transform: scale(1.05);
        }

        .comparison-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .comparison-box.ratio .comparison-name {
            color: var(--primary-purple);
        }

        .comparison-box.rate .comparison-name {
            color: var(--secondary-cyan);
        }

        .comparison-box.proportion .comparison-name {
            color: var(--accent-gold);
        }

        .comparison-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        /* Ratio Representations */
        .ratio-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-green);
        }

        .ratio-methods {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .ratio-methods {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .ratio-box {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .ratio-box:hover {
            transform: translateY(-3px);
        }

        .ratio-box.verbal {
            border-color: var(--primary-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .ratio-box.colon {
            border-color: var(--secondary-cyan);
            background: rgba(0, 188, 212, 0.1);
        }

        .ratio-box.fraction {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .ratio-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .ratio-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .ratio-box.verbal .ratio-name {
            color: var(--primary-purple);
        }

        .ratio-box.colon .ratio-name {
            color: var(--secondary-cyan);
        }

        .ratio-box.fraction .ratio-name {
            color: var(--accent-gold);
        }

        .ratio-example {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Rate Examples */
        .rate-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-orange);
        }

        .rate-examples {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .rate-examples {
                grid-template-columns: 1fr;
            }
        }

        .rate-box {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .rate-box:hover {
            transform: translateY(-3px);
        }

        .rate-box.speed {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .rate-box.price {
            border-color: var(--accent-orange);
            background: rgba(255, 152, 0, 0.1);
        }

        .rate-box.flow {
            border-color: var(--secondary-cyan);
            background: rgba(0, 188, 212, 0.1);
        }

        .rate-box.density {
            border-color: var(--primary-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .rate-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .rate-name {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .rate-box.speed .rate-name {
            color: var(--accent-green);
        }

        .rate-box.price .rate-name {
            color: var(--accent-orange);
        }

        .rate-box.flow .rate-name {
            color: var(--secondary-cyan);
        }

        .rate-box.density .rate-name {
            color: var(--primary-purple);
        }

        .rate-value {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Proportion Solving */
        .proportion-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-red);
        }

        .proportion-display {
            background: var(--dark-surface);
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 1.5rem;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--dark-border);
            font-family: 'Courier New', monospace;
        }

        .proportion-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .proportion-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-red);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .proportion-button:hover {
            background: rgba(244, 67, 54, 0.1);
            transform: translateY(-2px);
        }

        /* Ratio Table */
        .ratio-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .ratio-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-gold);
            border-bottom: 2px solid var(--accent-gold);
        }

        .ratio-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .ratio-table tr:hover {
            background: rgba(255, 215, 0, 0.05);
        }

        /* Interactive Practice */
        .interactive-practice {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-green);
        }

        .practice-title {
            color: var(--accent-green);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .practice-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .practice-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-green);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-button:hover {
            background: rgba(76, 175, 80, 0.1);
            transform: translateY(-2px);
        }

        .practice-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-purple);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .ratio-methods {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .rate-examples {
                grid-template-columns: 1fr;
            }
        }

        /* Math Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes ratioFlow {
            0% { transform: translateX(-50px); background-color: rgba(156, 39, 176, 0.2); }
            50% { transform: translateX(0); background-color: rgba(156, 39, 176, 0.4); }
            100% { transform: translateX(50px); background-color: rgba(156, 39, 176, 0.2); }
        }
        
        .ratio-flow {
            animation: ratioFlow 3s linear infinite;
        }
        
        @keyframes rateFlow {
            0% { transform: translateY(-50px); background-color: rgba(0, 188, 212, 0.2); }
            50% { transform: translateY(0); background-color: rgba(0, 188, 212, 0.4); }
            100% { transform: translateY(50px); background-color: rgba(0, 188, 212, 0.2); }
        }
        
        .rate-flow {
            animation: rateFlow 3s linear infinite;
        }
        
        @keyframes proportionScale {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .proportion-scale {
            animation: proportionScale 2s ease-in-out infinite;
        }
        
        @keyframes mathSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .math-spin {
            animation: mathSpin 3s linear infinite;
        }
        
        @keyframes equalFlash {
            0%, 100% { color: var(--text-primary); }
            50% { color: var(--accent-gold); }
        }
        
        .equal-flash {
            animation: equalFlash 1s ease-in-out infinite;
        }
        
        @keyframes fractionSlide {
            0% { transform: translateY(-20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        .fraction-slide {
            animation: fractionSlide 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <!-- Math Pattern Background -->
    <div class="math-bg" id="mathBg">
        <!-- Elements will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 6 Mathematics</h1>
            <p class="welcome-subtitle">Discover the relationships between numbers! Explore ratios, rates, and proportions - learn how to compare quantities, calculate rates, and solve proportional relationships. Master these essential math concepts that help us understand relationships in recipes, maps, shopping, and everyday life!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">‚öñÔ∏èüìäüî¢</span>
                <span class="topic-name">Ratios, Rates & Proportions</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Math Journey</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 120</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0.8%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Math fact display -->
                <div id="mathFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Math Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const mathBg = document.getElementById('mathBg');
            
            // Create floating math symbols
            const elements = ['‚öñÔ∏è', 'üìä', 'üî¢', 'üìê', 'üî∫', '‚ûó', '‚úñÔ∏è', '‚ûï', '‚ûñ', 'üìà', 'üìâ', 'üî∑', 'üî∂', 'üéØ', 'üåü', '‚àù', '‚à∂', '√∑', '√ó', '=', '‚âà', '%'];
            
            for (let i = 0; i < 25; i++) {
                const element = document.createElement('div');
                element.className = 'floating-element';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = `${Math.random() * 100}%`;
                element.style.top = `${Math.random() * 100}%`;
                element.style.animationDelay = `${Math.random() * 20}s`;
                element.style.fontSize = `${2 + Math.random() * 3}rem`;
                
                // Color different types
                if (['‚öñÔ∏è', 'üìä', 'üî¢', '‚àù', '‚à∂', '%'].includes(element.textContent)) {
                    element.style.color = 'rgba(156, 39, 176, 0.1)'; // Purple for ratios
                } else if (['üìê', 'üî∫', 'üî∑', 'üî∂'].includes(element.textContent)) {
                    element.style.color = 'rgba(0, 188, 212, 0.1)'; // Cyan for geometry
                } else if (['‚ûó', '‚úñÔ∏è', '‚ûï', '‚ûñ', '√∑', '√ó', '=', '‚âà'].includes(element.textContent)) {
                    element.style.color = 'rgba(255, 215, 0, 0.1)'; // Gold for operations
                } else {
                    element.style.color = 'rgba(156, 39, 176, 0.1)'; // Default purple
                }
                
                mathBg.appendChild(element);
            }
        }

        // Questions array - 120+ Grade 6 Ratios, Rates & Proportions questions
        const questions = [
            // Basic Ratio Concepts (1-20)
            {
                type: "basic_ratios",
                question: "What is a ratio?",
                options: ["A comparison of two quantities", "A type of fraction", "The result of multiplication", "A decimal number"],
                answer: "A",
                explanation: "A ratio compares two quantities. Example: The ratio of apples to oranges is 3:2."
            },
            {
                type: "basic_ratios",
                question: "Which shows a ratio of 3 to 4?",
                options: ["3:4", "4:3", "3/5", "4/7"],
                answer: "A",
                explanation: "3:4 means 3 compared to 4, or 3 for every 4."
            },
            {
                type: "basic_ratios",
                question: "How can you write the ratio of 5 dogs to 3 cats?",
                options: ["5:3", "3:5", "5/8", "3/8"],
                answer: "A",
                explanation: "Dogs to cats = 5:3 (dogs first, then cats)."
            },
            {
                type: "basic_ratios",
                question: "Simplify the ratio 8:12",
                options: ["2:3", "4:6", "8:12", "1:2"],
                answer: "A",
                explanation: "Divide both numbers by 4: 8√∑4=2, 12√∑4=3 ‚Üí 2:3"
            },
            // Ratio Representations (21-40)
            {
                type: "ratio_representations",
                question: "Which is equivalent to the ratio 2:5?",
                options: ["4:10", "5:2", "2/7", "5/7"],
                answer: "A",
                explanation: "Multiply both numbers by 2: 2√ó2=4, 5√ó2=10 ‚Üí 4:10"
            },
            {
                type: "ratio_representations",
                question: "Write 3:8 as a fraction",
                options: ["3/8", "8/3", "3/11", "8/11"],
                answer: "A",
                explanation: "Ratio a:b = a/b as a fraction."
            },
            // Rate Concepts (41-60)
            {
                type: "rate_concepts",
                question: "What is a rate?",
                options: ["A ratio comparing two different units", "Any ratio", "A percentage", "A decimal"],
                answer: "A",
                explanation: "A rate compares quantities with different units. Example: 60 miles per hour."
            },
            {
                type: "rate_concepts",
                question: "Which is a rate?",
                options: ["$5 per hour", "3:4", "2/5", "0.75"],
                answer: "A",
                explanation: "$5 per hour compares dollars to hours (different units)."
            },
            {
                type: "rate_concepts",
                question: "Find the unit rate: 150 miles in 3 hours",
                options: ["50 miles per hour", "150 miles per hour", "3 miles per hour", "450 miles per hour"],
                answer: "A",
                explanation: "150 miles √∑ 3 hours = 50 miles per hour."
            },
            // Proportion Concepts (61-80)
            {
                type: "proportion_concepts",
                question: "What is a proportion?",
                options: ["An equation showing two ratios are equal", "A type of rate", "A simplified ratio", "A percentage"],
                answer: "A",
                explanation: "A proportion states that two ratios are equal. Example: 2/3 = 4/6"
            },
            {
                type: "proportion_concepts",
                question: "Which is a proportion?",
                options: ["3/4 = 6/8", "3:4", "0.75", "3 out of 4"],
                answer: "A",
                explanation: "3/4 = 6/8 shows two equal ratios (both equal 0.75)."
            },
            // Solving Proportions (81-100)
            {
                type: "solving_proportions",
                question: "Solve: 2/3 = x/12",
                options: ["x = 8", "x = 6", "x = 9", "x = 4"],
                answer: "A",
                explanation: "Cross multiply: 2√ó12 = 3√óx ‚Üí 24 = 3x ‚Üí x = 8"
            },
            {
                type: "solving_proportions",
                question: "Solve: 5/7 = 15/x",
                options: ["x = 21", "x = 35", "x = 25", "x = 30"],
                answer: "A",
                explanation: "Cross multiply: 5√óx = 7√ó15 ‚Üí 5x = 105 ‚Üí x = 21"
            },
            // Real-World Applications (101-120)
            {
                type: "real_world",
                question: "If a recipe needs 2 cups flour for 3 cups sugar, what's the flour:sugar ratio?",
                options: ["2:3", "3:2", "2/5", "3/5"],
                answer: "A",
                explanation: "Flour to sugar = 2:3 (always in same order as stated)."
            },
            {
                type: "real_world",
                question: "A car travels 240 miles using 8 gallons. What's the miles per gallon?",
                options: ["30 mpg", "240 mpg", "8 mpg", "32 mpg"],
                answer: "A",
                explanation: "240 miles √∑ 8 gallons = 30 miles per gallon."
            },
            {
                type: "real_world",
                question: "If 3 pencils cost $1.50, what's the unit price per pencil?",
                options: ["$0.50", "$1.50", "$0.75", "$0.25"],
                answer: "A",
                explanation: "$1.50 √∑ 3 pencils = $0.50 per pencil."
            },
            // Scale Drawings (121-140)
            {
                type: "scale_drawings",
                question: "On a map, 1 inch = 10 miles. How many miles is 3 inches?",
                options: ["30 miles", "10 miles", "3 miles", "13 miles"],
                answer: "A",
                explanation: "Scale: 1 inch:10 miles = 3 inches:x miles ‚Üí x = 30 miles"
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent ratio understanding!",
            "Perfect rate calculation!",
            "Great proportion solving!",
            "You're a math expert!",
            "Perfect unit rate finding!",
            "You're a ratio transformation champion!",
            "Outstanding math skills!",
            "Brilliant understanding of proportions!",
            "You think like a mathematician!",
            "Math mastery achieved!"
        ];

        // Math terms and definitions
        const mathTerms = [
            {
                term: "Ratio",
                definition: "Comparison of two quantities",
                example: "3:2, 3 to 2, or 3/2"
            },
            {
                term: "Rate",
                definition: "Ratio comparing different units",
                example: "60 miles per hour"
            },
            {
                term: "Unit Rate",
                definition: "Rate with denominator of 1",
                example: "$0.50 per pencil"
            },
            {
                term: "Proportion",
                definition: "Equation showing two ratios are equal",
                example: "2/3 = 4/6"
            },
            {
                term: "Cross Multiply",
                definition: "Method to solve proportions",
                example: "If a/b = c/d, then a√ód = b√óc"
            }
        ];

        // Ratio examples by category
        const ratioExamples = [
            {
                category: "Food & Recipes",
                ratio: "Flour to sugar",
                example: "2 cups flour : 3 cups sugar",
                simplified: "2:3",
                explanation: "For every 2 cups flour, use 3 cups sugar"
            },
            {
                category: "Sports",
                ratio: "Wins to losses",
                example: "8 wins : 4 losses",
                simplified: "2:1",
                explanation: "For every 2 wins, there's 1 loss"
            },
            {
                category: "Classroom",
                ratio: "Boys to girls",
                example: "12 boys : 18 girls",
                simplified: "2:3",
                explanation: "For every 2 boys, there are 3 girls"
            },
            {
                category: "Nature",
                ratio: "Trees to bushes",
                example: "15 trees : 20 bushes",
                simplified: "3:4",
                explanation: "For every 3 trees, there are 4 bushes"
            }
        ];

        // Rate examples
        const rateExamples = [
            {
                type: "Speed",
                rate: "60 miles per hour",
                unitRate: "60 mph",
                calculation: "Distance √∑ Time",
                icon: "üöó"
            },
            {
                type: "Price",
                rate: "$3 per pound",
                unitRate: "$3/lb",
                calculation: "Cost √∑ Quantity",
                icon: "üí∞"
            },
            {
                type: "Flow",
                rate: "5 liters per minute",
                unitRate: "5 L/min",
                calculation: "Volume √∑ Time",
                icon: "üíß"
            },
            {
                type: "Density",
                rate: "8 students per table",
                unitRate: "8 students/table",
                calculation: "Count √∑ Space",
                icon: "üë•"
            }
        ];

        // Proportion examples
        const proportionExamples = [
            {
                problem: "2/3 = x/12",
                solution: "x = 8",
                steps: ["Cross multiply: 2√ó12 = 3√óx", "Simplify: 24 = 3x", "Divide: x = 8"]
            },
            {
                problem: "5/7 = 15/x",
                solution: "x = 21",
                steps: ["Cross multiply: 5√óx = 7√ó15", "Simplify: 5x = 105", "Divide: x = 21"]
            },
            {
                problem: "4/9 = 12/x",
                solution: "x = 27",
                steps: ["Cross multiply: 4√óx = 9√ó12", "Simplify: 4x = 108", "Divide: x = 27"]
            }
        ];

        // Ratio representations
        const ratioRepresentations = [
            {
                type: "Verbal",
                example: "3 to 4",
                format: "word form",
                icon: "üó£Ô∏è"
            },
            {
                type: "Colon",
                example: "3:4",
                format: "colon notation",
                icon: "‚à∂"
            },
            {
                type: "Fraction",
                example: "3/4",
                format: "fraction form",
                icon: "¬Ω"
            }
        ];

        // Interesting math facts
        const mathFacts = [
            "The Golden Ratio (about 1.618) appears often in nature and art!",
            "Ratios were used by ancient Egyptians in pyramid construction!",
            "The equals sign (=) was invented in 1557 by Robert Recorde!",
            "Scale models use ratios to represent real objects!",
            "Maps use scale ratios like 1:100,000!",
            "Cooking recipes are practical applications of ratios!",
            "Sports statistics often use ratios and rates!",
            "Financial calculations rely heavily on ratios and proportions!"
        ];

        // Real-world applications
        const realWorldApplications = [
            {
                application: "Cooking",
                example: "Recipe scaling",
                ratio: "2:3 (flour:sugar)",
                use: "Adjusting recipes for more or fewer servings"
            },
            {
                application: "Shopping",
                example: "Unit price comparison",
                ratio: "$/item or $/weight",
                use: "Finding better deals at the store"
            },
            {
                application: "Travel",
                example: "Speed calculation",
                ratio: "miles/hour",
                use: "Planning trip times"
            },
            {
                application: "Maps",
                example: "Scale conversion",
                ratio: "1 inch:10 miles",
                use: "Converting map distances to real distances"
            }
        ];

        // Equivalent ratios
        const equivalentRatios = [
            {
                ratio: "1:2",
                equivalents: ["2:4", "3:6", "4:8", "5:10"],
                multiplier: "Multiply both numbers by same factor"
            },
            {
                ratio: "3:4",
                equivalents: ["6:8", "9:12", "12:16", "15:20"],
                multiplier: "Multiply by 2, 3, 4, 5..."
            },
            {
                ratio: "2:5",
                equivalents: ["4:10", "6:15", "8:20", "10:25"],
                multiplier: "Each equivalent maintains the same relationship"
            }
        ];

        // Scale drawing examples
        const scaleExamples = [
            {
                object: "House blueprint",
                scale: "1 inch:4 feet",
                measurement: "3 inches on blueprint",
                reality: "12 feet in real life"
            },
            {
                object: "Map",
                scale: "1 cm:5 km",
                measurement: "4 cm on map",
                reality: "20 km in reality"
            },
            {
                object: "Model car",
                scale: "1:24",
                measurement: "6 inch model",
                reality: "12 foot real car (144 inches)"
            }
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const mathFact = document.getElementById('mathFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade6MathRatios');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade6MathRatios', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade6MathRatios_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade6MathRatios_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a ratios, rates, and proportions expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent mathematical reasoning skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing ratios and proportions!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review ratio representations and proportion solving!";
            } else {
                scoreMessage.textContent = "Keep exploring! Mastering ratios will help you in many real-life situations!";
            }
        }

        // Create math fact display
        function createMathFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'math-fact';
            
            factDiv.innerHTML = `<strong>Amazing Math Fact:</strong> ${mathFacts[Math.floor(Math.random() * mathFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "basic_ratios": "‚öñÔ∏è",
                "ratio_representations": "üìä",
                "rate_concepts": "üöó",
                "proportion_concepts": "üî¢",
                "solving_proportions": "‚úèÔ∏è",
                "real_world": "üåç",
                "scale_drawings": "üó∫Ô∏è"
            };
            
            let conceptName = "Basic Ratios";
            let conceptIcon = "‚öñÔ∏è";
            
            if (question.type.includes("basic_ratios")) {
                conceptName = "Basic Ratios";
                conceptIcon = conceptIcons.basic_ratios;
            } else if (question.type.includes("ratio_representations")) {
                conceptName = "Ratio Representations";
                conceptIcon = conceptIcons.ratio_representations;
            } else if (question.type.includes("rate_concepts")) {
                conceptName = "Rate Concepts";
                conceptIcon = conceptIcons.rate_concepts;
            } else if (question.type.includes("proportion_concepts")) {
                conceptName = "Proportion Concepts";
                conceptIcon = conceptIcons.proportion_concepts;
            } else if (question.type.includes("solving_proportions")) {
                conceptName = "Solving Proportions";
                conceptIcon = conceptIcons.solving_proportions;
            } else if (question.type.includes("real_world")) {
                conceptName = "Real-World Applications";
                conceptIcon = conceptIcons.real_world;
            } else if (question.type.includes("scale_drawings")) {
                conceptName = "Scale Drawings";
                conceptIcon = conceptIcons.scale_drawings;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("basic_ratios")) {
                label.textContent = "Understanding and comparing quantities";
            } else if (question.type.includes("ratio_representations")) {
                label.textContent = "Different ways to write ratios";
            } else if (question.type.includes("rate_concepts")) {
                label.textContent = "Comparing different units of measurement";
            } else if (question.type.includes("proportion_concepts")) {
                label.textContent = "Understanding equal ratios";
            } else if (question.type.includes("solving_proportions")) {
                label.textContent = "Solving for unknown values in proportions";
            } else if (question.type.includes("real_world")) {
                label.textContent = "Applying ratios in everyday situations";
            } else if (question.type.includes("scale_drawings")) {
                label.textContent = "Using ratios in maps and models";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create math visualization
        function createMathVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const ratioExample = ratioExamples[Math.floor(Math.random() * ratioExamples.length)];
            const rateExample = rateExamples[Math.floor(Math.random() * rateExamples.length)];
            const proportionExample = proportionExamples[Math.floor(Math.random() * proportionExamples.length)];
            const realWorldApp = realWorldApplications[Math.floor(Math.random() * realWorldApplications.length)];
            const equivalentRatioSet = equivalentRatios[Math.floor(Math.random() * equivalentRatios.length)];
            const scaleExample = scaleExamples[Math.floor(Math.random() * scaleExamples.length)];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-gold);">Ratios, Rates & Proportions Explorer</h3>
                
                <div class="comparison-container">
                    <div class="comparison-box ratio ratio-flow" onclick="showMathDetails('Ratio')">
                        <div class="comparison-icon">‚öñÔ∏è</div>
                        <div class="comparison-name">Ratio</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Comparing quantities
                        </div>
                    </div>
                    <div class="comparison-box rate rate-flow" onclick="showMathDetails('Rate')">
                        <div class="comparison-icon">üöó</div>
                        <div class="comparison-name">Rate</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Comparing different units
                        </div>
                    </div>
                    <div class="comparison-box proportion proportion-scale" onclick="showMathDetails('Proportion')">
                        <div class="comparison-icon">üî¢</div>
                        <div class="comparison-name">Proportion</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Equal ratios
                        </div>
                    </div>
                </div>
                
                <div class="math-display math-spin">
                    <div style="font-size: 1.5rem; margin-bottom: 15px;">
                        Category: <span style="color: var(--primary-purple); font-weight: bold;">${ratioExample.category}</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.2rem; color: var(--primary-purple); margin-bottom: 10px;">Ratio Example</div>
                            <div style="font-size: 1rem; color: var(--text-secondary); font-style: italic;">${ratioExample.example}</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">Simplified: ${ratioExample.simplified}</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.2rem; color: var(--secondary-cyan); margin-bottom: 10px;">Rate Example</div>
                            <div style="font-size: 1rem; color: var(--text-secondary); font-style: italic;">${rateExample.rate}</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">Unit Rate: ${rateExample.unitRate}</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(255, 215, 0, 0.1); border-radius: 6px; border-left: 3px solid var(--accent-gold);">
                        <div style="font-size: 0.9rem; color: var(--accent-gold);"><strong>Explanation:</strong> ${ratioExample.explanation}</div>
                    </div>
                </div>
                
                <div class="ratio-container fraction-slide">
                    <div class="display-title">Ratio Representations - Three Ways to Show</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        The same ratio can be written in different forms
                    </div>
                    
                    <div class="ratio-methods">
                        ${ratioRepresentations.map((rep, idx) => `
                            <div class="ratio-box ${rep.type.toLowerCase().replace(' ', '-')}" onclick="showRatioRepresentation('${rep.type}')">
                                <div class="ratio-icon">${rep.icon}</div>
                                <div class="ratio-name">${rep.type}</div>
                                <div style="font-size: 1.5rem; margin: 10px 0; font-weight: bold;">${rep.example}</div>
                                <div class="ratio-example">${rep.format}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 8px; border: 1px solid var(--accent-green);">
                        <div style="color: var(--accent-green); font-weight: bold; margin-bottom: 10px;">Remember:</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            All these represent the same relationship: "3 to 4" = 3:4 = 3/4<br>
                            They all mean: For every 3 of the first quantity, there are 4 of the second.
                        </div>
                    </div>
                </div>
                
                <div class="rate-container">
                    <div class="display-title">Rate Examples - Comparing Different Units</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        ${rateExample.type}: ${rateExample.rate}
                    </div>
                    
                    <div class="rate-examples">
                        ${rateExamples.map((rate, idx) => `
                            <div class="rate-box ${rate.type.toLowerCase()}" onclick="showRateExample('${rate.type}')">
                                <div class="rate-icon">${rate.icon}</div>
                                <div class="rate-name">${rate.type} Rate</div>
                                <div class="rate-value">${rate.rate}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 10px;">${rate.calculation}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(255, 152, 0, 0.1); border-radius: 8px; border: 1px solid var(--accent-orange);">
                        <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Unit Rates:</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            A unit rate has a denominator of 1. Examples:<br>
                            ‚Ä¢ 60 miles per 1 hour = 60 mph<br>
                            ‚Ä¢ $3 for 1 pound = $3/lb<br>
                            ‚Ä¢ 5 liters in 1 minute = 5 L/min
                        </div>
                    </div>
                </div>
                
                <div class="proportion-container">
                    <div class="display-title">Proportion Solving - Finding Missing Values</div>
                    
                    <div class="proportion-display" id="proportionDisplay">
                        ${proportionExample.problem}
                    </div>
                    
                    <div style="text-align: center; margin: 15px 0; color: var(--text-secondary);">
                        Can you solve for the missing value? Click "Show Solution" to see the steps.
                    </div>
                    
                    <div class="proportion-controls">
                        <div class="proportion-button" onclick="showProportionSolution()">Show Solution</div>
                        <div class="proportion-button" onclick="explainProportion()">Explain Steps</div>
                        <div class="proportion-button" onclick="newProportion()">New Problem</div>
                    </div>
                    
                    <div id="proportionResult" style="margin-top: 20px; padding: 15px; background: var(--dark-surface); border-radius: 8px; display: none;"></div>
                </div>
                
                <div class="ratio-table">
                    <thead>
                        <tr>
                            <th>Ratio</th>
                            <th>Equivalent Ratios</th>
                            <th>Simplified</th>
                            <th>Fraction Form</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="font-weight: bold; color: var(--primary-purple);">2:4</td>
                            <td>1:2, 3:6, 4:8</td>
                            <td>1:2</td>
                            <td style="font-style: italic;">1/2</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--secondary-cyan);">3:9</td>
                            <td>1:3, 2:6, 4:12</td>
                            <td>1:3</td>
                            <td style="font-style: italic;">1/3</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-gold);">4:6</td>
                            <td>2:3, 8:12, 12:18</td>
                            <td>2:3</td>
                            <td style="font-style: italic;">2/3</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-green);">6:8</td>
                            <td>3:4, 9:12, 12:16</td>
                            <td>3:4</td>
                            <td style="font-style: italic;">3/4</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-orange);">10:15</td>
                            <td>2:3, 20:30, 30:45</td>
                            <td>2:3</td>
                            <td style="font-style: italic;">2/3</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="real-world-example" style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid var(--accent-orange); font-style: italic; color: var(--text-secondary);">
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Real-World Applications:</div>
                    "In cooking: If a recipe calls for 2 cups flour to 3 cups sugar (ratio 2:3), and you want to make half the recipe, you'd use 1 cup flour to 1.5 cups sugar (maintaining the same ratio). In shopping: If 3 apples cost $1.50, the unit rate is $0.50 per apple. If you want 5 apples: 5 √ó $0.50 = $2.50 (using the rate). In travel: If you drive 60 mph (rate), in 2.5 hours you'll travel: 60 √ó 2.5 = 150 miles. On a map: If 1 inch = 10 miles (scale ratio), then 3.5 inches = 35 miles."
                    <div style="margin-top: 10px;">
                        <strong>Key concepts:</strong> Ratios compare, rates measure, proportions solve for unknowns, all maintain relationships.
                    </div>
                </div>
                
                <div class="interactive-practice">
                    <div class="practice-title">Interactive Math Practice</div>
                    <div class="practice-controls">
                        <div class="practice-button" onclick="simplifyRatio()">Simplify Ratio</div>
                        <div class="practice-button" onclick="findUnitRate()">Find Unit Rate</div>
                        <div class="practice-button" onclick="solveProportion()">Solve Proportion</div>
                        <div class="practice-button" onclick="mathChallenge()">Math Challenge</div>
                    </div>
                    <div class="practice-display" id="practiceDisplay">
                        Click buttons above to practice math skills
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-red);">
                    <div style="color: var(--accent-red); font-weight: bold; margin-bottom: 10px;">Quick Practice:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. Simplify: 8:12<br>
                        2. Find unit rate: 150 miles in 3 hours<br>
                        3. Solve: 2/3 = x/12<br>
                        4. Write ratio of 5 dogs to 7 cats three ways<br>
                        5. If 4 pencils cost $2, what's the unit price?
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--primary-purple);">
                    <div style="color: var(--primary-purple); font-weight: bold; margin-bottom: 10px; text-align: center;">Math Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Ratio:</strong> Compare quantities (same or different units)<br>
                        <strong>Rate:</strong> Compare different units (miles/hour)<br>
                        <strong>Proportion:</strong> Two equal ratios (a/b = c/d)<br>
                        <strong>Cross Multiply:</strong> a√ód = b√óc to solve proportions
                    </div>
                </div>
            `;
            
            // Store current examples for interactive functions
            window.currentProportionExample = proportionExample;
            window.currentEquivalentRatioSet = equivalentRatioSet;
            window.currentScaleExample = scaleExample;
            
            return vizDiv;
        }

        // Helper functions
        function getIconForRate(rateType) {
            const iconMap = {
                "Speed": "üöó",
                "Price": "üí∞",
                "Flow": "üíß",
                "Density": "üë•"
            };
            return iconMap[rateType] || "üìä";
        }

        // Global functions for interactive practice
        window.showMathDetails = function(type) {
            if (type === 'Ratio') {
                alert(`‚öñÔ∏è Ratio\n\nA ratio compares two quantities.\n\nWays to write:\n‚Ä¢ Verbal: "3 to 4"\n‚Ä¢ Colon: 3:4\n‚Ä¢ Fraction: 3/4\n\nExamples:\n‚Ä¢ 2 apples : 3 oranges\n‚Ä¢ 5 boys : 7 girls\n‚Ä¢ 1 cup sugar : 2 cups flour\n\nRatios can be simplified like fractions: 4:8 = 1:2`);
            } else if (type === 'Rate') {
                alert(`üöó Rate\n\nA rate compares quantities with different units.\n\nExamples:\n‚Ä¢ 60 miles per hour\n‚Ä¢ $3 per pound\n‚Ä¢ 5 liters per minute\n\nUnit Rate: Rate with denominator of 1\n‚Ä¢ 60 mph = 60 miles per 1 hour\n‚Ä¢ $3/lb = $3 per 1 pound\n\nRates help compare prices, speeds, and other measurements.`);
            } else {
                alert(`üî¢ Proportion\n\nA proportion states that two ratios are equal.\n\nExamples:\n‚Ä¢ 2/3 = 4/6\n‚Ä¢ 1:2 = 3:6\n‚Ä¢ a/b = c/d\n\nTo solve proportions:\n1. Cross multiply: a√ód = b√óc\n2. Solve for the unknown\n\nExample: 2/3 = x/12\nCross multiply: 2√ó12 = 3√óx ‚Üí 24 = 3x ‚Üí x = 8`);
            }
        };

        window.showRatioRepresentation = function(type) {
            const rep = ratioRepresentations.find(r => r.type === type);
            if (!rep) return;
            
            alert(`${rep.type} Form\n\nExample: ${rep.example}\n\nFormat: ${rep.format}\n\n${type === 'Verbal' ? "Use 'to' between numbers: '3 to 4'" : ""}${type === 'Colon' ? "Use colon between numbers: 3:4" : ""}${type === 'Fraction' ? "Write as fraction: 3/4 (means 3 divided by 4)" : ""}\n\nAll forms represent the same relationship!`);
        };

        window.showRateExample = function(rateType) {
            const rate = rateExamples.find(r => r.type === rateType);
            if (!rate) return;
            
            alert(`${rate.type} Rate\n\nExample: ${rate.rate}\n\nUnit Rate: ${rate.unitRate}\n\nCalculation: ${rate.calculation}\n\n${rateType === 'Speed' ? "Used for travel: distance per time" : ""}${rateType === 'Price' ? "Used for shopping: cost per quantity" : ""}${rateType === 'Flow' ? "Used for liquids: volume per time" : ""}${rateType === 'Density' ? "Used for populations: count per area" : ""}`);
        };

        window.showProportionSolution = function() {
            const resultDiv = document.getElementById('proportionResult');
            if (resultDiv && window.currentProportionExample) {
                resultDiv.innerHTML = `
                    <div style="color: var(--secondary-cyan); font-weight: bold; margin-bottom: 10px;">Solution:</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        ${window.currentProportionExample.problem} ‚Üí ${window.currentProportionExample.solution}
                    </div>
                    <div style="color: var(--accent-gold); font-size: 0.9rem;">
                        Steps: ${window.currentProportionExample.steps.join(' ‚Üí ')}
                    </div>
                `;
                resultDiv.style.display = 'block';
            }
        };

        window.explainProportion = function() {
            const resultDiv = document.getElementById('proportionResult');
            if (resultDiv && window.currentProportionExample) {
                resultDiv.innerHTML = `
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Step-by-Step Explanation:</div>
                    <div style="color: var(--text-secondary); margin-bottom: 10px;">
                        ${window.currentProportionExample.steps.map((step, idx) => `
                            <div style="margin-bottom: 5px;">${idx + 1}. ${step}</div>
                        `).join('')}
                    </div>
                    <div style="color: var(--accent-gold); font-size: 0.9rem; margin-top: 10px;">
                        <strong>Cross Multiply Rule:</strong> If a/b = c/d, then a√ód = b√óc
                    </div>
                `;
                resultDiv.style.display = 'block';
            }
        };

        window.newProportion = function() {
            const proportionDisplay = document.getElementById('proportionDisplay');
            const resultDiv = document.getElementById('proportionResult');
            
            if (proportionDisplay && resultDiv) {
                const newExample = proportionExamples[Math.floor(Math.random() * proportionExamples.length)];
                proportionDisplay.textContent = newExample.problem;
                window.currentProportionExample = newExample;
                resultDiv.style.display = 'none';
            }
        };

        window.simplifyRatio = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const simplificationProblems = [
                {
                    ratio: "8:12",
                    simplified: "2:3",
                    steps: ["Find GCF of 8 and 12 = 4", "Divide both by 4: 8√∑4=2, 12√∑4=3", "Simplified ratio = 2:3"]
                },
                {
                    ratio: "15:25",
                    simplified: "3:5",
                    steps: ["Find GCF of 15 and 25 = 5", "Divide both by 5: 15√∑5=3, 25√∑5=5", "Simplified ratio = 3:5"]
                },
                {
                    ratio: "18:24",
                    simplified: "3:4",
                    steps: ["Find GCF of 18 and 24 = 6", "Divide both by 6: 18√∑6=3, 24√∑6=4", "Simplified ratio = 3:4"]
                },
                {
                    ratio: "14:21",
                    simplified: "2:3",
                    steps: ["Find GCF of 14 and 21 = 7", "Divide both by 7: 14√∑7=2, 21√∑7=3", "Simplified ratio = 2:3"]
                }
            ];
            
            const currentProblem = simplificationProblems[Math.floor(Math.random() * simplificationProblems.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary-purple);">Simplify Ratio</div>
                    <div style="font-size: 1.3rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        Simplify: ${currentProblem.ratio}
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 20px 0;">
                        ${["2:3", "3:4", "4:5", "1:2", "3:5"].map((option, idx) => `
                            <div class="option" onclick="checkSimplification(this, '${option}', '${currentProblem.simplified}')">
                                <div class="option-letter">${String.fromCharCode(65 + idx)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div id="simplificationResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Hint:</strong> Find the greatest common factor (GCF) and divide both numbers by it.
                    </div>
                </div>
            `;
            
            window.currentSimplificationSteps = currentProblem.steps;
        };

        window.checkSimplification = function(element, selectedAnswer, correctAnswer) {
            const resultDiv = document.getElementById('simplificationResult');
            if (!resultDiv) return;
            
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            if (selectedAnswer === correctAnswer) {
                element.classList.add('correct');
                resultDiv.textContent = `Correct! ${selectedAnswer} is the simplified form.`;
                resultDiv.style.color = 'var(--primary-purple)';
            } else {
                element.classList.add('incorrect');
                // Find and highlight correct option
                options.forEach(opt => {
                    if (opt.querySelector('.option-text').textContent === correctAnswer) {
                        opt.classList.add('correct');
                    }
                });
                resultDiv.innerHTML = `Incorrect. The simplified form is ${correctAnswer}.<br>Steps: ${window.currentSimplificationSteps.join(' ‚Üí ')}`;
                resultDiv.style.color = 'var(--accent-orange)';
            }
            
            resultDiv.classList.add('pulse');
            setTimeout(() => resultDiv.classList.remove('pulse'), 500);
        };

        window.findUnitRate = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const unitRateProblems = [
                {
                    problem: "150 miles in 3 hours",
                    unitRate: "50 miles per hour",
                    calculation: "150 √∑ 3 = 50 mph"
                },
                {
                    problem: "$12 for 4 pounds",
                    unitRate: "$3 per pound",
                    calculation: "12 √∑ 4 = $3/lb"
                },
                {
                    problem: "240 words in 4 minutes",
                    unitRate: "60 words per minute",
                    calculation: "240 √∑ 4 = 60 wpm"
                },
                {
                    problem: "75 cookies from 5 batches",
                    unitRate: "15 cookies per batch",
                    calculation: "75 √∑ 5 = 15 cookies/batch"
                }
            ];
            
            const currentProblem = unitRateProblems[Math.floor(Math.random() * unitRateProblems.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--secondary-cyan);">Find Unit Rate</div>
                    <div style="font-size: 1.3rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        ${currentProblem.problem}
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0;">
                        ${[currentProblem.unitRate, "45 mph", "$4/lb", "40 wpm", "12 cookies/batch"].map((option, idx) => `
                            <div class="option" onclick="checkUnitRate(this, '${option}', '${currentProblem.unitRate}')">
                                <div class="option-letter">${String.fromCharCode(65 + idx)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div id="unitRateResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Remember:</strong> Unit rate = total √∑ quantity (denominator of 1)
                    </div>
                </div>
            `;
            
            window.currentUnitRateCalculation = currentProblem.calculation;
        };

        window.checkUnitRate = function(element, selectedAnswer, correctAnswer) {
            const resultDiv = document.getElementById('unitRateResult');
            if (!resultDiv) return;
            
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            if (selectedAnswer === correctAnswer) {
                element.classList.add('correct');
                resultDiv.textContent = `Correct! ${selectedAnswer} is the unit rate. ${window.currentUnitRateCalculation}`;
                resultDiv.style.color = 'var(--secondary-cyan)';
            } else {
                element.classList.add('incorrect');
                // Find and highlight correct option
                options.forEach(opt => {
                    if (opt.querySelector('.option-text').textContent === correctAnswer) {
                        opt.classList.add('correct');
                    }
                });
                resultDiv.textContent = `Incorrect. The unit rate is ${correctAnswer}. ${window.currentUnitRateCalculation}`;
                resultDiv.style.color = 'var(--accent-orange)';
            }
            
            resultDiv.classList.add('pulse');
            setTimeout(() => resultDiv.classList.remove('pulse'), 500);
        };

        window.solveProportion = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const proportionProblems = [
                {
                    problem: "2/3 = x/12",
                    answer: "x = 8",
                    steps: ["Cross multiply: 2√ó12 = 3√óx", "24 = 3x", "x = 8"]
                },
                {
                    problem: "5/7 = 15/x",
                    answer: "x = 21",
                    steps: ["Cross multiply: 5√óx = 7√ó15", "5x = 105", "x = 21"]
                },
                {
                    problem: "3/4 = x/20",
                    answer: "x = 15",
                    steps: ["Cross multiply: 3√ó20 = 4√óx", "60 = 4x", "x = 15"]
                }
            ];
            
            const currentProblem = proportionProblems[Math.floor(Math.random() * proportionProblems.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-gold);">Solve Proportion</div>
                    <div style="font-size: 1.3rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        ${currentProblem.problem}
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <input type="text" id="proportionAnswer" placeholder="Enter your answer (e.g., x = 8)" style="width: 100%; padding: 15px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary); font-size: 1rem;">
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="checkProportionSolution()">Check Answer</button>
                        <button class="btn btn-small btn-outline" onclick="showProportionSolutionAnswer()">Show Answer</button>
                    </div>
                    
                    <div id="proportionSolutionResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Remember:</strong> Cross multiply: a/b = c/d ‚Üí a√ód = b√óc
                    </div>
                </div>
            `;
            
            window.currentProportionSolution = currentProblem.answer;
            window.currentProportionSteps = currentProblem.steps;
        };

        window.checkProportionSolution = function() {
            const answerInput = document.getElementById('proportionAnswer');
            const resultDiv = document.getElementById('proportionSolutionResult');
            
            if (!answerInput || !resultDiv) return;
            
            const userAnswer = answerInput.value.trim().toLowerCase();
            const correctAnswer = window.currentProportionSolution.toLowerCase();
            
            // Extract just the number from answers like "x = 8"
            const userNumber = userAnswer.replace(/[^0-9]/g, '');
            const correctNumber = correctAnswer.replace(/[^0-9]/g, '');
            
            if (userNumber === correctNumber) {
                resultDiv.textContent = "Excellent! You solved the proportion correctly!";
                resultDiv.style.color = 'var(--primary-purple)';
            } else if (userAnswer.includes(correctNumber)) {
                resultDiv.textContent = "Close! Check your formatting (should be 'x = number').";
                resultDiv.style.color = 'var(--secondary-cyan)';
            } else {
                resultDiv.textContent = "Try again. Remember to cross multiply and solve for x.";
                resultDiv.style.color = 'var(--accent-orange)';
            }
        };

        window.showProportionSolutionAnswer = function() {
            const resultDiv = document.getElementById('proportionSolutionResult');
            if (resultDiv && window.currentProportionSolution) {
                resultDiv.innerHTML = `
                    <div>
                        <div style="color: var(--secondary-cyan); margin-bottom: 5px;"><strong>Correct answer:</strong> ${window.currentProportionSolution}</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">Steps: ${window.currentProportionSteps.join(' ‚Üí ')}</div>
                    </div>
                `;
            }
        };

        window.mathChallenge = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const challenges = [
                {
                    type: "Real-World Problem",
                    challenge: "If 3 apples cost $1.50, how much would 7 apples cost?",
                    answer: "$3.50",
                    steps: ["Find unit price: $1.50 √∑ 3 = $0.50 per apple", "Multiply: 7 √ó $0.50 = $3.50"]
                },
                {
                    type: "Recipe Scaling",
                    challenge: "A recipe uses 2 cups flour to 3 cups sugar. How much flour for 9 cups sugar?",
                    answer: "6 cups flour",
                    steps: ["Set up proportion: 2/3 = x/9", "Cross multiply: 2√ó9 = 3√óx", "18 = 3x", "x = 6"]
                },
                {
                    type: "Map Scale",
                    challenge: "On a map, 1 inch = 15 miles. How many miles apart are two cities 4.5 inches apart on the map?",
                    answer: "67.5 miles",
                    steps: ["Set up proportion: 1/15 = 4.5/x", "Cross multiply: 1√óx = 15√ó4.5", "x = 67.5"]
                }
            ];
            
            const currentChallenge = challenges[Math.floor(Math.random() * challenges.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-green);">Math Challenge: ${currentChallenge.type}</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-style: italic;">
                        "${currentChallenge.challenge}"
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <textarea id="challengeAnswer" placeholder="Type your answer with explanation..." style="width: 100%; min-height: 100px; padding: 15px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary); font-size: 1rem; resize: vertical;"></textarea>
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="checkMathChallenge()">Check Answer</button>
                        <button class="btn btn-small btn-outline" onclick="showMathChallengeAnswer()">Show Answer</button>
                    </div>
                    
                    <div id="mathChallengeResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                </div>
            `;
            
            window.currentMathChallengeAnswer = currentChallenge.answer;
            window.currentMathChallengeSteps = currentChallenge.steps;
        };

        window.checkMathChallenge = function() {
            const answerInput = document.getElementById('challengeAnswer');
            const resultDiv = document.getElementById('mathChallengeResult');
            
            if (!answerInput || !resultDiv) return;
            
            const userAnswer = answerInput.value.trim().toLowerCase();
            const correctAnswer = window.currentMathChallengeAnswer.toLowerCase();
            
            // Extract numbers
            const userNumbers = userAnswer.match(/\d+(\.\d+)?/g) || [];
            const correctNumbers = correctAnswer.match(/\d+(\.\d+)?/g) || [];
            
            if (userNumbers.length > 0 && correctNumbers.length > 0 && userNumbers.includes(correctNumbers[0])) {
                resultDiv.textContent = "Excellent problem solving! You got the right answer!";
                resultDiv.style.color = 'var(--primary-purple)';
            } else if (userAnswer.includes("proportion") || userAnswer.includes("ratio") || userAnswer.includes("unit rate")) {
                resultDiv.textContent = "Good approach! Check your calculations.";
                resultDiv.style.color = 'var(--secondary-cyan)';
            } else {
                resultDiv.textContent = "Try again! Think about using ratios or unit rates.";
                resultDiv.style.color = 'var(--accent-orange)';
            }
        };

        window.showMathChallengeAnswer = function() {
            const resultDiv = document.getElementById('mathChallengeResult');
            if (resultDiv && window.currentMathChallengeAnswer) {
                resultDiv.innerHTML = `
                    <div>
                        <div style="color: var(--secondary-teal); margin-bottom: 5px;"><strong>Answer:</strong> ${window.currentMathChallengeAnswer}</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            <strong>Steps:</strong><br>${window.currentMathChallengeSteps.map(step => `‚Ä¢ ${step}`).join('<br>')}
                        </div>
                    </div>
                `;
            }
        };

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            mathFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            mathFact.appendChild(createMathFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createMathVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
