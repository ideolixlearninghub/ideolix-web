<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 8 English - Comprehension Mastery | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Comprehension Theme */
        :root {
            --inference-blue: #1565C0;
            --theme-purple: #7B1FA2;
            --tone-teal: #00897B;
            --context-orange: #F57C00;
            --symbolism-indigo: #3949AB;
            --irony-pink: #C2185B;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --inference-glow: 0 0 20px rgba(21, 101, 192, 0.4);
            --theme-glow: 0 0 20px rgba(123, 31, 162, 0.4);
            --tone-glow: 0 0 20px rgba(0, 137, 123, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(21, 101, 192, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(123, 31, 162, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0, 137, 123, 0.05) 0%, transparent 50%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            border-radius: 10px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info h1 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 30px 20px;
        }

        .welcome-title {
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--inference-blue), var(--theme-purple), var(--tone-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 25px;
            max-width: 800px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(21, 101, 192, 0.15);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 20px;
            border: 2px solid var(--inference-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--inference-blue);
        }

        .input-group {
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            font-size: 1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--inference-blue);
            box-shadow: 0 0 0 3px rgba(21, 101, 192, 0.2);
        }

        /* Comprehension Skills Grid */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .skills-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .skills-grid {
                grid-template-columns: 1fr;
            }
        }

        .skill-card {
            background: var(--dark-surface);
            border-radius: 16px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .skill-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
        }

        .skill-card.inference {
            border-color: var(--inference-blue);
            background: linear-gradient(135deg, rgba(21, 101, 192, 0.1), transparent);
        }

        .skill-card.theme {
            border-color: var(--theme-purple);
            background: linear-gradient(135deg, rgba(123, 31, 162, 0.1), transparent);
        }

        .skill-card.tone {
            border-color: var(--tone-teal);
            background: linear-gradient(135deg, rgba(0, 137, 123, 0.1), transparent);
        }

        .skill-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .skill-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .skill-card.inference .skill-title {
            color: var(--inference-blue);
        }

        .skill-card.theme .skill-title {
            color: var(--theme-purple);
        }

        .skill-card.tone .skill-title {
            color: var(--tone-teal);
        }

        .skill-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.6;
            flex-grow: 1;
        }

        .skill-features {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--dark-border);
        }

        .skill-features h4 {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feature-list {
            list-style-type: none;
        }

        .feature-list li {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-bottom: 6px;
            padding-left: 20px;
            position: relative;
        }

        .feature-list li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
        }

        .skill-card.inference .feature-list li:before {
            color: var(--inference-blue);
        }

        .skill-card.theme .feature-list li:before {
            color: var(--theme-purple);
        }

        .skill-card.tone .feature-list li:before {
            color: var(--tone-teal);
        }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--inference-blue);
            color: white;
            box-shadow: 0 4px 12px rgba(21, 101, 192, 0.3);
        }

        .btn-primary:hover {
            background: #0D47A1;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(21, 101, 192, 0.4);
        }

        .btn-secondary {
            background: var(--theme-purple);
            color: white;
            box-shadow: 0 4px 12px rgba(123, 31, 162, 0.3);
        }

        .btn-secondary:hover {
            background: #4A148C;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(123, 31, 162, 0.4);
        }

        .btn-success {
            background: var(--tone-teal);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 137, 123, 0.3);
        }

        .btn-success:hover {
            background: #00695C;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 137, 123, 0.4);
        }

        .btn-warning {
            background: var(--context-orange);
            color: white;
            box-shadow: 0 4px 12px rgba(245, 124, 0, 0.3);
        }

        .btn-warning:hover {
            background: #E65100;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(245, 124, 0, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--inference-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Page */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 20px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 8px;
            background: var(--dark-surface);
            border-radius: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--inference-blue), var(--theme-purple), var(--tone-teal));
            border-radius: 8px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(21, 101, 192, 0.5);
        }

        /* Passage Display */
        .passage-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid var(--inference-blue);
            border-right: 4px solid var(--inference-blue);
        }

        .passage-title {
            font-size: 1.3rem;
            color: var(--inference-blue);
            margin-bottom: 15px;
            font-weight: bold;
        }

        .passage-content {
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-primary);
            margin-bottom: 20px;
            text-align: justify;
        }

        .passage-metadata {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.9rem;
            padding-top: 15px;
            border-top: 1px solid var(--dark-border);
        }

        .comprehension-tip {
            background: rgba(245, 124, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid var(--context-orange);
            font-style: italic;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Question Container */
        .question-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--text-primary);
        }

        .skill-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .indicator-inference {
            background: rgba(21, 101, 192, 0.2);
            color: var(--inference-blue);
            border: 1px solid var(--inference-blue);
        }

        .indicator-theme {
            background: rgba(123, 31, 162, 0.2);
            color: var(--theme-purple);
            border: 1px solid var(--theme-purple);
        }

        .indicator-tone {
            background: rgba(0, 137, 123, 0.2);
            color: var(--tone-teal);
            border: 1px solid var(--tone-teal);
        }

        /* Options */
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin: 20px 0;
        }

        .option {
            padding: 15px;
            background: var(--dark-card);
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--inference-blue);
            background: rgba(21, 101, 192, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(0, 137, 123, 0.1);
            border-color: var(--tone-teal);
            color: var(--tone-teal);
        }

        .option.incorrect {
            background: rgba(198, 40, 40, 0.1);
            border-color: #C62828;
            color: #C62828;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 25px;
            height: 25px;
            background: var(--theme-purple);
            border-radius: 50%;
            margin-right: 12px;
            font-weight: bold;
            color: white;
        }

        .option.correct .option-letter {
            background: var(--tone-teal);
        }

        .option.incorrect .option-letter {
            background: #C62828;
        }

        /* Feedback */
        .feedback-container {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(0, 137, 123, 0.1);
            border-left: 4px solid var(--tone-teal);
        }

        .feedback-incorrect {
            background: rgba(198, 40, 40, 0.1);
            border-left: 4px solid #C62828;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--tone-teal);
        }

        .feedback-incorrect .feedback-icon {
            background: #C62828;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .feedback-correct .feedback-title {
            color: var(--tone-teal);
        }

        .feedback-incorrect .feedback-title {
            color: #C62828;
        }

        .feedback-explanation {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .evidence-highlight {
            background: rgba(21, 101, 192, 0.2);
            padding: 2px 4px;
            border-radius: 3px;
            font-style: italic;
        }

        /* Navigation */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Interactive Analysis Sidebar */
        .analysis-sidebar {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .analysis-sidebar {
                grid-template-columns: 1fr;
            }
        }

        .analysis-panel {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--dark-border);
            overflow: auto;
            max-height: 800px;
        }

        /* Inference Builder */
        .inference-builder {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--inference-blue);
        }

        .analysis-title {
            color: inherit;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.1rem;
        }

        .inference-clues {
            background: var(--dark-surface);
            border-radius: 6px;
            padding: 12px;
            margin: 10px 0;
            border-left: 3px solid var(--inference-blue);
        }

        .clue-item {
            padding: 8px;
            margin: 5px 0;
            background: rgba(21, 101, 192, 0.1);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .clue-item:hover {
            background: rgba(21, 101, 192, 0.2);
            transform: translateX(5px);
        }

        .inference-question {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin: 10px 0;
            padding: 10px;
            background: var(--dark-surface);
            border-radius: 6px;
            border-left: 3px solid var(--context-orange);
        }

        .inference-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin: 10px 0;
        }

        .inference-option {
            padding: 10px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .inference-option:hover {
            border-color: var(--inference-blue);
            background: rgba(21, 101, 192, 0.05);
        }

        .inference-feedback {
            padding: 10px;
            background: var(--dark-surface);
            border-radius: 6px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 10px;
            min-height: 50px;
        }

        /* Theme Analyzer */
        .theme-analyzer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--theme-purple);
        }

        .theme-elements {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .theme-elements {
                grid-template-columns: 1fr;
            }
        }

        .theme-element {
            padding: 10px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .theme-element:hover {
            border-color: var(--theme-purple);
            background: rgba(123, 31, 162, 0.05);
        }

        .theme-element.selected {
            border-color: var(--theme-purple);
            background: rgba(123, 31, 162, 0.1);
        }

        .theme-statement {
            padding: 12px;
            background: var(--dark-surface);
            border-radius: 6px;
            margin: 10px 0;
            border: 2px dashed var(--dark-border);
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        /* Tone Detector */
        .tone-detector {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--tone-teal);
        }

        .tone-slider-container {
            padding: 15px;
            background: var(--dark-surface);
            border-radius: 6px;
            margin: 10px 0;
        }

        .tone-axis {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .tone-slider {
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, #E0E0E0, #616161);
            border-radius: 4px;
            margin: 10px 0;
            position: relative;
        }

        .tone-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--tone-teal);
            border-radius: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: grab;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .tone-marker:active {
            cursor: grabbing;
        }

        .tone-labels {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            margin-top: 15px;
        }

        .tone-label {
            text-align: center;
            padding: 8px;
            background: var(--dark-surface);
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tone-label:hover {
            background: rgba(0, 137, 123, 0.1);
        }

        .tone-label.selected {
            background: rgba(0, 137, 123, 0.2);
            border: 1px solid var(--tone-teal);
        }

        .tone-justification {
            padding: 12px;
            background: var(--dark-surface);
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
            min-height: 60px;
        }

        /* Context Clues Practice */
        .context-practice {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--context-orange);
        }

        .context-sentence {
            padding: 12px;
            background: var(--dark-surface);
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .context-word {
            display: inline-block;
            padding: 2px 6px;
            background: rgba(245, 124, 0, 0.2);
            border-radius: 3px;
            font-weight: bold;
            color: var(--context-orange);
            cursor: pointer;
        }

        .context-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin: 10px 0;
        }

        .context-option {
            padding: 10px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .context-option:hover {
            border-color: var(--context-orange);
            background: rgba(245, 124, 0, 0.05);
        }

        /* Literary Devices */
        .devices-practice {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--symbolism-indigo);
        }

        .device-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .device-grid {
                grid-template-columns: 1fr;
            }
        }

        .device-card {
            padding: 10px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .device-card:hover {
            border-color: var(--symbolism-indigo);
            background: rgba(57, 73, 171, 0.05);
        }

        .device-name {
            font-weight: bold;
            color: var(--symbolism-indigo);
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .device-example {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Irony Detector */
        .irony-detector {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--irony-pink);
        }

        .irony-scenario {
            padding: 12px;
            background: var(--dark-surface);
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .irony-types {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .irony-types {
                grid-template-columns: 1fr;
            }
        }

        .irony-type {
            padding: 10px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            font-size: 0.85rem;
        }

        .irony-type:hover {
            border-color: var(--irony-pink);
            background: rgba(194, 24, 91, 0.05);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 30px 20px;
        }

        .results-title {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--inference-blue), var(--theme-purple), var(--tone-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            margin: 0 auto 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--inference-blue), var(--theme-purple), var(--tone-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--inference-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        @keyframes highlight {
            0% { background-color: transparent; }
            50% { background-color: rgba(21, 101, 192, 0.2); }
            100% { background-color: transparent; }
        }

        .highlight {
            animation: highlight 1s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 1.8rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <h1 class="welcome-title">Grade 8 English: Comprehension Mastery</h1>
            <p class="welcome-subtitle">Develop advanced reading comprehension skills! Learn to infer hidden meanings, identify themes, analyze tone, and understand literary devices in texts.</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üîçüé≠üìöüé®</span>
                <span class="topic-name">Inference, Theme, Tone, Literary Analysis</span>
            </div>
            
            <div class="skills-grid">
                <div class="skill-card inference" onclick="showSkillDetail('inference')">
                    <div class="skill-icon">üîç</div>
                    <h3 class="skill-title">Inference</h3>
                    <p class="skill-description">Reading between the lines to understand implied meanings, make predictions, and draw conclusions based on textual evidence.</p>
                    <div class="skill-features">
                        <h4>Key Skills:</h4>
                        <ul class="feature-list">
                            <li>Identifying implicit meanings</li>
                            <li>Making logical predictions</li>
                            <li>Drawing evidence-based conclusions</li>
                            <li>Understanding character motivations</li>
                            <li>Recognizing cause-effect relationships</li>
                        </ul>
                    </div>
                </div>
                
                <div class="skill-card theme" onclick="showSkillDetail('theme')">
                    <div class="skill-icon">üé≠</div>
                    <h3 class="skill-title">Theme</h3>
                    <p class="skill-description">Identifying central ideas, messages, and universal truths that run throughout a literary work.</p>
                    <div class="skill-features">
                        <h4>Key Skills:</h4>
                        <ul class="feature-list">
                            <li>Identifying central messages</li>
                            <li>Recognizing universal truths</li>
                            <li>Analyzing character development</li>
                            <li>Understanding symbolic meanings</li>
                            <li>Connecting plot to message</li>
                        </ul>
                    </div>
                </div>
                
                <div class="skill-card tone" onclick="showSkillDetail('tone')">
                    <div class="skill-icon">üìö</div>
                    <h3 class="skill-title">Tone & Mood</h3>
                    <p class="skill-description">Analyzing the author's attitude toward the subject and the emotional atmosphere created in the text.</p>
                    <div class="skill-features">
                        <h4>Key Skills:</h4>
                        <ul class="feature-list">
                            <li>Identifying author's attitude</li>
                            <li>Analyzing word choice effects</li>
                            <li>Recognizing emotional atmosphere</li>
                            <li>Understanding tone shifts</li>
                            <li>Connecting tone to purpose</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your name:</label>
                <input type="text" id="studentName" placeholder="Your name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>üìñ Begin Comprehension Practice</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 80</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1.25%"></div>
                </div>
            </div>

            <!-- Current Passage -->
            <div class="passage-container" id="passageContainer">
                <div class="passage-title" id="passageTitle"></div>
                <div class="passage-content" id="passageContent"></div>
                <div class="passage-metadata">
                    <span id="passageAuthor"></span>
                    <span id="passageGenre"></span>
                </div>
            </div>

            <!-- Comprehension Tip -->
            <div id="comprehensionTip"></div>

            <!-- Question Container -->
            <div class="question-container">
                <div class="skill-indicator" id="skillIndicator">
                    <span id="skillIcon">üîç</span>
                    <span id="skillName">Inference</span>
                </div>
                
                <h2 class="question-text" id="questionText"></h2>
                
                <div class="options-container" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-explanation" id="feedbackExplanation"></div>
                </div>
            </div>
            
            <!-- Interactive Analysis Sidebar -->
            <div class="analysis-sidebar">
                <div class="analysis-panel">
                    <!-- Inference Builder -->
                    <div class="inference-builder">
                        <div class="analysis-title">Inference Practice</div>
                        <div class="inference-clues">
                            <div class="clue-item" onclick="showClueDetail('clue1')">Character's actions suggest...</div>
                            <div class="clue-item" onclick="showClueDetail('clue2')">Descriptive details imply...</div>
                            <div class="clue-item" onclick="showClueDetail('clue3')">Dialogue reveals...</div>
                        </div>
                        <div class="inference-question">
                            Based on these clues, what can you infer about the character's feelings?
                        </div>
                        <div class="inference-options">
                            <div class="inference-option" onclick="checkInference('option1')">The character is excited about the upcoming event</div>
                            <div class="inference-option" onclick="checkInference('option2')">The character feels anxious and uncertain</div>
                            <div class="inference-option" onclick="checkInference('option3')">The character is bored and uninterested</div>
                        </div>
                        <div class="inference-feedback" id="inferenceFeedback">
                            Select an option to practice inference skills
                        </div>
                    </div>
                    
                    <!-- Theme Analyzer -->
                    <div class="theme-analyzer">
                        <div class="analysis-title">Theme Identification</div>
                        <div class="theme-elements">
                            <div class="theme-element" onclick="selectThemeElement('conflict')">
                                <strong>Conflict:</strong> Man vs Nature
                            </div>
                            <div class="theme-element" onclick="selectThemeElement('character')">
                                <strong>Character Arc:</strong> Growth through adversity
                            </div>
                            <div class="theme-element" onclick="selectThemeElement('symbol')">
                                <strong>Symbol:</strong> The journey as life
                            </div>
                            <div class="theme-element" onclick="selectThemeElement('message')">
                                <strong>Message:</strong> Persistence leads to growth
                            </div>
                        </div>
                        <div class="theme-statement" id="themeStatement">
                            Combine elements to identify the theme
                        </div>
                        <div class="btn-group" style="margin-top: 10px;">
                            <button class="btn btn-small btn-secondary" onclick="suggestTheme()">Suggest Theme</button>
                            <button class="btn btn-small btn-secondary" onclick="clearTheme()">Clear</button>
                        </div>
                    </div>
                    
                    <!-- Context Clues Practice -->
                    <div class="context-practice">
                        <div class="analysis-title">Context Clues Practice</div>
                        <div class="context-sentence">
                            The speaker's <span class="context-word" onclick="explainContextWord('laconic')">laconic</span> response suggested he wasn't interested in continuing the conversation.
                        </div>
                        <div class="context-options">
                            <div class="context-option" onclick="checkContext('brief')">Brief, using few words</div>
                            <div class="context-option" onclick="checkContext('angry')">Angry and hostile</div>
                            <div class="context-option" onclick="checkContext('detailed')">Detailed and elaborate</div>
                            <div class="context-option" onclick="checkContext('happy')">Happy and enthusiastic</div>
                        </div>
                        <div class="inference-feedback" id="contextFeedback">
                            Use context clues to determine word meaning
                        </div>
                    </div>
                </div>
                
                <div class="analysis-panel">
                    <!-- Tone Detector -->
                    <div class="tone-detector">
                        <div class="analysis-title">Tone Analysis</div>
                        <div class="tone-slider-container">
                            <div class="tone-axis">
                                <span>Negative</span>
                                <span>Neutral</span>
                                <span>Positive</span>
                            </div>
                            <div class="tone-slider" id="toneSlider">
                                <div class="tone-marker" id="toneMarker"></div>
                            </div>
                            <div class="tone-labels">
                                <div class="tone-label" onclick="selectTone('sarcastic')">Sarcastic</div>
                                <div class="tone-label" onclick="selectTone('nostalgic')">Nostalgic</div>
                                <div class="tone-label" onclick="selectTone('objective')">Objective</div>
                                <div class="tone-label" onclick="selectTone('optimistic')">Optimistic</div>
                                <div class="tone-label" onclick="selectTone('pessimistic')">Pessimistic</div>
                            </div>
                        </div>
                        <div class="tone-justification" id="toneJustification">
                            Select a tone and justify your choice based on word choice, sentence structure, and imagery.
                        </div>
                        <div class="btn-group" style="margin-top: 10px;">
                            <button class="btn btn-small btn-success" onclick="checkToneAnalysis()">Analyze</button>
                            <button class="btn btn-small btn-success" onclick="newToneExample()">New Example</button>
                        </div>
                    </div>
                    
                    <!-- Literary Devices Practice -->
                    <div class="devices-practice">
                        <div class="analysis-title">Literary Devices</div>
                        <div class="device-grid">
                            <div class="device-card" onclick="explainDevice('metaphor')">
                                <div class="device-name">Metaphor</div>
                                <div class="device-example">"Time is a thief"</div>
                            </div>
                            <div class="device-card" onclick="explainDevice('simile')">
                                <div class="device-name">Simile</div>
                                <div class="device-example">"Brave as a lion"</div>
                            </div>
                            <div class="device-card" onclick="explainDevice('personification')">
                                <div class="device-name">Personification</div>
                                <div class="device-example">"The wind whispered"</div>
                            </div>
                            <div class="device-card" onclick="explainDevice('hyperbole')">
                                <div class="device-name">Hyperbole</div>
                                <div class="device-example">"I've told you a million times"</div>
                            </div>
                        </div>
                        <div class="inference-feedback" id="deviceFeedback">
                            Click on devices to learn about their effects
                        </div>
                    </div>
                    
                    <!-- Irony Detector -->
                    <div class="irony-detector">
                        <div class="analysis-title">Irony Detection</div>
                        <div class="irony-scenario">
                            A fire station burns down while firefighters are out celebrating Fire Safety Week.
                        </div>
                        <div class="irony-types">
                            <div class="irony-type" onclick="checkIrony('situational')">Situational Irony</div>
                            <div class="irony-type" onclick="checkIrony('verbal')">Verbal Irony</div>
                            <div class="irony-type" onclick="checkIrony('dramatic')">Dramatic Irony</div>
                        </div>
                        <div class="inference-feedback" id="ironyFeedback">
                            What type of irony is this? Click to select.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn btn-secondary" id="skipQuestion">Skip Question</button>
                <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Comprehension Practice Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="timeSpent">0min</div>
                        <div class="stat-label">Time Spent</div>
                    </div>
                </div>
                
                <div class="btn-group" style="margin-top: 20px;">
                    <button class="btn btn-primary" id="retryTopic">Try Again</button>
                    <button class="btn btn-secondary" id="viewTopics">Other Topics</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive Comprehension Questions (80+)
        const passages = [
            {
                id: 1,
                title: "The Old Lighthouse",
                author: "Unknown",
                genre: "Short Story",
                content: "Captain Marlowe stood at the edge of the cliff, watching the storm clouds gather over the churning sea. The old lighthouse, which had guided sailors safely for a century, stood dark and silent. Its light had been extinguished three nights ago, and already two ships had been lost to the treacherous rocks below. Marlowe clenched his fists, remembering his promise to old Captain Briggs to keep the light burning. But the supplies hadn't arrived, and the government had declared the lighthouse obsolete. As lightning flashed, Marlowe made his decision. He would light the beacon himself, even if it meant using every candle in the village.",
                questions: [
                    {
                        id: 1,
                        skill: "inference",
                        question: "What can you infer about Captain Marlowe's relationship with Captain Briggs?",
                        options: [
                            "They had a close, mentor-like relationship",
                            "They were business competitors",
                            "They were strangers who met once",
                            "They were father and son"
                        ],
                        answer: "A",
                        explanation: "Marlowe remembers his 'promise to old Captain Briggs,' suggesting a close relationship where Briggs trusted Marlowe with important responsibilities."
                    },
                    {
                        id: 2,
                        skill: "theme",
                        question: "What theme is emerging in this passage?",
                        options: [
                            "The conflict between tradition and progress",
                            "The beauty of ocean storms",
                            "The dangers of government control",
                            "The importance of friendship"
                        ],
                        answer: "A",
                        explanation: "The lighthouse represents tradition and safety, while the government declaring it 'obsolete' represents progress, creating the central conflict."
                    },
                    {
                        id: 3,
                        skill: "tone",
                        question: "What is the tone of this passage?",
                        options: [
                            "Determined and urgent",
                            "Humorous and lighthearted",
                            "Romantic and dreamy",
                            "Scientific and analytical"
                        ],
                        answer: "A",
                        explanation: "Words like 'clenched his fists,' 'made his decision,' and the urgency of ships being lost create a determined, urgent tone."
                    }
                ]
            },
            {
                id: 2,
                title: "The Garden Party",
                author: "L. Henderson",
                genre: "Excerpt from Novel",
                content: "Miranda watched from her bedroom window as the garden transformed. Servants scurried about, arranging white chairs in perfect rows, while her mother directed them with sharp, precise gestures. The roses, which Miranda had helped plant last spring, bloomed in riotous colors‚Äîcrimson, gold, and the palest pink. She remembered planting them with her grandmother, who had said, 'Roses teach us patience, Miranda. They take time, but the beauty is worth the wait.' Now, her grandmother was gone, and the party was for Miranda's engagement to a man she barely knew. She touched the single white rose on her dresser, its petals already beginning to brown at the edges.",
                questions: [
                    {
                        id: 4,
                        skill: "inference",
                        question: "What can you infer about Miranda's feelings toward her upcoming engagement?",
                        options: [
                            "She feels resigned but unhappy about it",
                            "She is excited and looking forward to it",
                            "She doesn't care one way or another",
                            "She is actively planning to escape it"
                        ],
                        answer: "A",
                        explanation: "The juxtaposition of beautiful memories with her grandmother against the engagement to 'a man she barely knew' suggests resignation rather than happiness."
                    },
                    {
                        id: 5,
                        skill: "theme",
                        question: "What theme is suggested by the roses in this passage?",
                        options: [
                            "The contrast between natural beauty and social expectations",
                            "The importance of gardening skills",
                            "The temporary nature of beauty",
                            "The value of hard work"
                        ],
                        answer: "A",
                        explanation: "The natural beauty of the roses contrasts with the artificial, arranged social event, highlighting the tension between natural desires and social expectations."
                    },
                    {
                        id: 6,
                        skill: "tone",
                        question: "What tone is created by the description of the white rose?",
                        options: [
                            "Melancholy and fading beauty",
                            "Joyful and celebratory",
                            "Angry and resentful",
                            "Hopeful and optimistic"
                        ],
                        answer: "A",
                        explanation: "The white rose 'already beginning to brown at the edges' creates a melancholy tone, symbolizing fading beauty and lost opportunities."
                    }
                ]
            },
            {
                id: 3,
                title: "The Inventor's Workshop",
                author: "J. Sterling",
                genre: "Science Fiction",
                content: "Dr. Aris peered through the magnifying lens at the tiny gears, her hands steady despite the tremor of excitement that ran through her. For seven years, she had worked in secret, ignoring the laughter of her colleagues who called her work 'impossible fantasy.' The automaton bird on her workbench was more than machinery; it was proof that life could be understood, analyzed, and recreated. As she placed the final gear, the bird's ruby eyes flickered to life. It turned its head, gears whirring softly, and let out a perfect birdsong‚Äîa sound not heard in their smog-choked city for a generation. Aris smiled, tears tracing clean paths through the grime on her cheeks.",
                questions: [
                    {
                        id: 7,
                        skill: "inference",
                        question: "What can you infer about Dr. Aris's colleagues?",
                        options: [
                            "They dismissed her work without understanding its value",
                            "They actively supported her research",
                            "They were jealous of her intelligence",
                            "They were equally innovative scientists"
                        ],
                        answer: "A",
                        explanation: "The description of colleagues calling her work 'impossible fantasy' suggests they dismissed it without appreciating its potential value."
                    },
                    {
                        id: 8,
                        skill: "theme",
                        question: "What theme is explored through the automaton bird?",
                        options: [
                            "The human desire to recreate and preserve nature",
                            "The dangers of technological advancement",
                            "The importance of following scientific protocols",
                            "The conflict between art and science"
                        ],
                        answer: "A",
                        explanation: "The bird recreates natural beauty (birdsong) in a polluted city, exploring humanity's desire to preserve and recreate nature through technology."
                    },
                    {
                        id: 9,
                        skill: "tone",
                        question: "What tone is created by the bird's perfect birdsong?",
                        options: [
                            "Triumphant and hopeful",
                            "Sinister and ominous",
                            "Sad and regretful",
                            "Boring and monotonous"
                        ],
                        answer: "A",
                        explanation: "The successful creation after years of work, bringing back a lost natural sound, creates a triumphant and hopeful tone."
                    }
                ]
            },
            {
                id: 4,
                title: "The Market Square",
                author: "Historical Fiction",
                genre: "Historical Fiction",
                content: "The market square buzzed with the energy of a hundred conversations. Merchants called out prices in a dozen languages, their voices weaving through the scents of spices, fresh bread, and the less pleasant smell of too many people in too small a space. Elena moved through the crowd with practiced ease, her basket already heavy with purchases. She paused at the spice merchant's stall, her eyes scanning the vibrant powders. 'Cinnamon from the East,' the merchant said, noticing her interest. 'Brings warmth to even the coldest heart.' Elena smiled politely but didn't buy. She had learned long ago that promises, like spices, could lose their potency when taken from their native soil.",
                questions: [
                    {
                        id: 10,
                        skill: "inference",
                        question: "What can you infer about Elena from her actions?",
                        options: [
                            "She is experienced and cautious in her dealings",
                            "She is new to the market and overwhelmed",
                            "She is wealthy and buys impulsively",
                            "She is suspicious of all merchants"
                        ],
                        answer: "A",
                        explanation: "Her 'practiced ease' and refusal to buy despite the merchant's pitch show experience and caution rather than impulsiveness."
                    },
                    {
                        id: 11,
                        skill: "theme",
                        question: "What theme is suggested by Elena's thoughts about spices?",
                        options: [
                            "Things lose meaning when removed from their original context",
                            "Spices are essential for good cooking",
                            "Merchants cannot be trusted",
                            "Travel broadens the mind"
                        ],
                        answer: "A",
                        explanation: "Her comparison of promises to spices that 'lose their potency when taken from their native soil' suggests this theme."
                    },
                    {
                        id: 12,
                        skill: "tone",
                        question: "What tone is created by the description of the market?",
                        options: [
                            "Vibrant and sensory",
                            "Dull and boring",
                            "Threatening and dangerous",
                            "Peaceful and calm"
                        ],
                        answer: "A",
                        explanation: "The 'buzzed with energy,' 'scents of spices,' and 'vibrant powders' create a vibrant, sensory-rich tone."
                    }
                ]
            }
        ];

        // Additional passages for more questions
        const additionalPassages = [
            {
                id: 5,
                title: "The Last Train",
                author: "M. Chen",
                genre: "Drama",
                content: "The station clock showed 11:47 PM. Leo checked his watch for the third time in as many minutes. The last train to Hartford left at midnight, and with it, his last chance to make things right. He paced the nearly empty platform, each footstep echoing in the cavernous space. The letter in his pocket felt like it weighed a thousand pounds‚Äîthree pages of apologies he should have written years ago. A train whistle sounded in the distance, and Leo's heart leapt. But it was just a freight train passing through. He sat on a cold bench, watching his breath fog in the air. Sometimes, he realized, the hardest journeys aren't measured in miles.",
                questions: [
                    {
                        id: 13,
                        skill: "inference",
                        question: "What can you infer about why Leo needs to go to Hartford?",
                        options: [
                            "He needs to deliver an important apology to someone",
                            "He has a job interview there",
                            "He's running away from problems",
                            "He's visiting family for a holiday"
                        ],
                        answer: "A",
                        explanation: "The 'letter in his pocket' containing 'apologies he should have written years ago' strongly suggests he needs to deliver an apology."
                    },
                    {
                        id: 14,
                        skill: "theme",
                        question: "What theme is suggested by the final sentence?",
                        options: [
                            "Emotional journeys are often harder than physical ones",
                            "Trains represent missed opportunities",
                            "Time heals all wounds",
                            "Winter makes travel difficult"
                        ],
                        answer: "A",
                        explanation: "The contrast between the physical train journey and the 'hardest journeys' being emotional ones clearly establishes this theme."
                    },
                    {
                        id: 15,
                        skill: "tone",
                        question: "What tone is created by the empty station description?",
                        options: [
                            "Lonely and regretful",
                            "Exciting and adventurous",
                            "Angry and frustrated",
                            "Happy and nostalgic"
                        ],
                        answer: "A",
                        explanation: "The 'nearly empty platform,' 'cavernous space,' and cold bench create a lonely tone, while the apology letter adds regret."
                    }
                ]
            },
            {
                id: 6,
                title: "The Library at Midnight",
                author: "A. Patel",
                genre: "Mystery",
                content: "The only sound in the library was the soft whisper of pages turning. Noah moved between the shelves like a shadow, the beam of his flashlight cutting through the darkness. He wasn't supposed to be here after hours, but some mysteries couldn't wait for daylight. The book he sought wasn't in the catalog, wasn't on any shelf, yet he knew it existed. His grandfather had described it perfectly: bound in faded green leather, with silver clasps that clicked like distant thunder. As Noah reached the restricted section, he found the door slightly ajar. Inside, on a lone reading desk, bathed in moonlight from the high window, lay the green book. It was open to a page that showed his own family crest.",
                questions: [
                    {
                        id: 16,
                        skill: "inference",
                        question: "What can you infer about Noah's grandfather?",
                        options: [
                            "He had secret knowledge about the book",
                            "He was a librarian at this library",
                            "He didn't approve of Noah's search",
                            "He wrote the book himself"
                        ],
                        answer: "A",
                        explanation: "The detailed description of the book that isn't in the catalog suggests the grandfather had special knowledge about it."
                    },
                    {
                        id: 17,
                        skill: "theme",
                        question: "What theme is suggested by the discovery of the family crest?",
                        options: [
                            "The past is connected to the present in unexpected ways",
                            "Libraries hold dangerous secrets",
                            "Breaking rules leads to discovery",
                            "Family wealth brings responsibility"
                        ],
                        answer: "A",
                        explanation: "Finding his family crest in a mysterious book suggests unexpected connections between past and present."
                    },
                    {
                        id: 18,
                        skill: "tone",
                        question: "What tone is created by the library description?",
                        options: [
                            "Mysterious and suspenseful",
                            "Peaceful and relaxing",
                            "Academic and boring",
                            "Frightening and terrifying"
                        ],
                        answer: "A",
                        explanation: "The darkness, secrecy, mysterious book, and family crest create a mysterious, suspenseful tone."
                    }
                ]
            }
        ];

        // Combine all passages
        const allPassages = [...passages, ...additionalPassages];

        // Generate comprehensive question list (80+ questions)
        const allQuestions = [];
        allPassages.forEach(passage => {
            passage.questions.forEach(q => {
                allQuestions.push({
                    ...q,
                    passageId: passage.id
                });
            });
        });

        // Add more inference questions (19-30)
        for (let i = 19; i <= 30; i++) {
            allQuestions.push({
                id: i,
                passageId: 0, // General inference questions
                skill: "inference",
                question: getInferenceQuestion(i-18),
                options: getInferenceOptions(i-18),
                answer: "A",
                explanation: getInferenceExplanation(i-18)
            });
        }

        // Add more theme questions (31-45)
        for (let i = 31; i <= 45; i++) {
            allQuestions.push({
                id: i,
                passageId: 0,
                skill: "theme",
                question: getThemeQuestion(i-30),
                options: getThemeOptions(i-30),
                answer: "A",
                explanation: getThemeExplanation(i-30)
            });
        }

        // Add more tone questions (46-60)
        for (let i = 46; i <= 60; i++) {
            allQuestions.push({
                id: i,
                passageId: 0,
                skill: "tone",
                question: getToneQuestion(i-45),
                options: getToneOptions(i-45),
                answer: "A",
                explanation: getToneExplanation(i-45)
            });
        }

        // Add context clues questions (61-70)
        for (let i = 61; i <= 70; i++) {
            allQuestions.push({
                id: i,
                passageId: 0,
                skill: "inference",
                question: getContextQuestion(i-60),
                options: getContextOptions(i-60),
                answer: "A",
                explanation: getContextExplanation(i-60)
            });
        }

        // Add literary devices questions (71-80)
        for (let i = 71; i <= 80; i++) {
            allQuestions.push({
                id: i,
                passageId: 0,
                skill: "inference",
                question: getDeviceQuestion(i-70),
                options: getDeviceOptions(i-70),
                answer: "A",
                explanation: getDeviceExplanation(i-70)
            });
        }

        // Add irony questions (81-83)
        for (let i = 81; i <= 83; i++) {
            allQuestions.push({
                id: i,
                passageId: 0,
                skill: "inference",
                question: getIronyQuestion(i-80),
                options: getIronyOptions(i-80),
                answer: "A",
                explanation: getIronyExplanation(i-80)
            });
        }

        // Comprehension tips
        const comprehensionTips = [
            "Remember: Inference = Reading between the lines. Look for clues in actions, dialogue, and descriptions!",
            "Theme is the central message or insight about life. Ask: What is the author trying to say about human experience?",
            "Tone = Author's attitude. Mood = Emotional atmosphere. Word choice reveals both!",
            "Use context clues: Look at surrounding words and sentences to figure out unfamiliar vocabulary.",
            "Ask yourself: What evidence supports my interpretation? Always go back to the text!",
            "Characters' actions often reveal more than their words. Pay attention to what they DO.",
            "Symbols often represent larger ideas. A journey might represent life; darkness might represent ignorance.",
            "Tone can shift within a passage. Watch for changes in word choice or perspective."
        ];

        // Inference practice data
        const inferenceExamples = [
            {
                clues: [
                    "Sarah checked her watch every two minutes",
                    "She tapped her foot nervously on the floor",
                    "Her eyes kept darting toward the entrance",
                    "She adjusted her outfit three times in five minutes"
                ],
                question: "What can you infer about Sarah's situation?",
                correct: "She is anxiously waiting for someone important",
                incorrect: [
                    "She is bored and has nothing to do",
                    "She is getting ready to leave the building",
                    "She is waiting for a package delivery"
                ]
            },
            {
                clues: [
                    "The teacher's voice grew quieter as she spoke",
                    "She avoided making eye contact with students",
                    "Her hands trembled slightly as she held the papers",
                    "She cleared her throat three times in one minute"
                ],
                question: "What can you infer about the teacher?",
                correct: "She is nervous about delivering difficult news",
                incorrect: [
                    "She is angry with the students",
                    "She is bored with the lesson",
                    "She is about to give a surprise test"
                ]
            }
        ];

        // Context clues examples
        const contextExamples = [
            {
                sentence: "The dilapidated house had broken windows, a sagging roof, and walls covered in peeling paint.",
                word: "dilapidated",
                meaning: "In poor condition from neglect",
                options: [
                    "In poor condition from neglect",
                    "Recently renovated and beautiful",
                    "Small and cozy",
                    "Modern and stylish"
                ]
            },
            {
                sentence: "Her magnanimous gesture of paying for everyone's meal surprised her friends, who knew she was usually careful with money.",
                word: "magnanimous",
                meaning: "Generous and forgiving",
                options: [
                    "Generous and forgiving",
                    "Stingy and selfish",
                    "Confusing and unclear",
                    "Expected and ordinary"
                ]
            }
        ];

        // Tone examples for practice
        const toneExamples = [
            {
                text: "The waves crashed against the shore with relentless fury, tearing at the sand as if trying to reclaim the land that had been stolen from them centuries before.",
                correctTone: "Angry and powerful",
                wordChoices: ["crashed", "relentless fury", "tearing", "stolen"]
            },
            {
                text: "In the quiet morning light, the garden seemed to hold its breath, each dew-kissed petal a perfect jewel waiting to be discovered by the first rays of sun.",
                correctTone: "Peaceful and appreciative",
                wordChoices: ["quiet", "hold its breath", "dew-kissed", "perfect jewel"]
            }
        ];

        // Literary devices examples
        const deviceExamples = [
            {
                device: "metaphor",
                example: "Her smile was a beacon in the dark room.",
                explanation: "Directly compares smile to beacon without 'like' or 'as'"
            },
            {
                device: "simile",
                example: "He ran as fast as a cheetah chasing its prey.",
                explanation: "Comparison using 'as' to show speed"
            },
            {
                device: "personification",
                example: "The wind whispered secrets through the trees.",
                explanation: "Gives human qualities (whispering) to wind"
            },
            {
                device: "hyperbole",
                example: "I've been waiting in this line since the dawn of time!",
                explanation: "Exaggeration for effect"
            }
        ];

        // Irony examples
        const ironyExamples = [
            {
                type: "situational",
                scenario: "A professional marriage counselor files for divorce.",
                explanation: "Situational irony - opposite of what's expected from a marriage counselor"
            },
            {
                type: "verbal",
                scenario: "After walking through a rainstorm: 'What lovely weather we're having!'",
                explanation: "Verbal irony - saying the opposite of what's meant"
            },
            {
                type: "dramatic",
                scenario: "In a movie, the audience knows there's a monster in the closet, but the character doesn't.",
                explanation: "Dramatic irony - audience knows something characters don't"
            }
        ];

        // Helper functions for generating additional questions
        function getInferenceQuestion(num) {
            const questions = [
                "If a character is described as 'constantly looking over their shoulder' and 'speaking in hushed tones,' what can you infer?",
                "When a story begins with 'It was the last time she would see her hometown,' what inference can you make?",
                "If a character declines a promotion with a shaky voice while staring at a family photo, what can you infer?",
                "When an author describes a house as 'too quiet' and 'holding its breath,' what inference can you make?",
                "If a character always wears long sleeves in summer and avoids physical contact, what might you infer?",
                "When a diary entry reads 'Today I made a choice I can never undo,' what inference is most logical?",
                "If a character laughs loudly at a sad moment in a movie, what can you infer about them?",
                "When every description of nature includes words like 'struggling,' 'withering,' or 'fading,' what inference can you make about the story's mood?",
                "If a character repeatedly mentions how 'everything will be different tomorrow,' what can you infer?",
                "When a character's dialogue is always interrupted or unfinished, what inference can you make?",
                "If objects in a room are described as 'precisely arranged' and 'dust-free,' what can you infer about the owner?",
                "When a character memorizes someone else's coffee order perfectly, what inference can you make?"
            ];
            return questions[num-1] || questions[0];
        }

        function getInferenceOptions(num) {
            const optionsSets = [
                ["The character is anxious or paranoid", "The character is confident and relaxed", "The character is preparing for a performance", "The character has hearing problems"],
                ["Something significant is about to change", "She hates her hometown", "She is going on vacation", "She is moving to a better house"],
                ["The character has family priorities over career", "The character is afraid of success", "The character doesn't understand the offer", "The character wants a different job"],
                ["Something suspenseful is about to happen", "The house is well-maintained", "The occupants are sleeping", "It's a new house"],
                ["The character may be hiding something", "The character is always cold", "The character is from a cold climate", "The character is shy"],
                ["The character made a significant, life-altering decision", "The character bought something expensive", "The character ate too much", "The character watched a sad movie"],
                ["The character may be uncomfortable with emotions", "The character found the movie funny", "The character didn't understand the movie", "The character is rude"],
                ["The story has a pessimistic or decaying mood", "The author loves nature", "It's autumn in the story", "The characters are gardeners"],
                ["The character is anticipating a major event", "The character hates today", "The character is forgetful", "The character is complaining"],
                ["The character has trouble expressing themselves", "The author is bad at writing dialogue", "Other characters are rude", "The character is unimportant"],
                ["The owner is meticulous and organized", "The owner is messy", "The owner is rarely home", "The owner has pets"],
                ["The character pays close attention to that person", "The character works in a coffee shop", "Everyone likes the same coffee", "It's a coincidence"]
            ];
            return optionsSets[num-1] || optionsSets[0];
        }

        function getInferenceExplanation(num) {
            const explanations = [
                "Physical actions like looking over one's shoulder and hushed speech typically indicate anxiety or paranoia.",
                "The phrase 'last time' implies impending change, not necessarily negative feelings about the place.",
                "The combination of shaky voice and looking at family photo suggests emotional conflict between career and family.",
                "Personification of a house as 'holding its breath' creates suspense and foreshadows events.",
                "Unusual clothing choices and avoidance of contact often suggest something is being concealed.",
                "'Never undo' implies permanence and significance, not trivial decisions.",
                "Inappropriate emotional responses often indicate discomfort or defense mechanisms.",
                "Consistent negative nature imagery establishes overall mood and tone.",
                "Repeated anticipation suggests a significant upcoming event is central to the plot.",
                "Patterns in speech patterns reveal character traits and communication styles.",
                "Extreme orderliness in environment reflects personality traits of the occupant.",
                "Remembering specific details about someone indicates attention and care."
            ];
            return explanations[num-1] || explanations[0];
        }

        function getThemeQuestion(num) {
            const questions = [
                "What theme is suggested by a story where a rich character finds happiness only after losing everything?",
                "What theme is explored when a character must choose between personal desire and family duty?",
                "What universal theme is present in stories about characters overcoming great obstacles?",
                "What theme is suggested when technology solves problems but creates new ones?",
                "What theme emerges when characters from different backgrounds learn to understand each other?",
                "What theme is explored through a character's journey from ignorance to knowledge?",
                "What theme is suggested when natural disasters force characters to work together?",
                "What universal theme is present in stories about growing up and losing innocence?",
                "What theme emerges when characters must confront their fears to achieve goals?",
                "What theme is suggested when the past constantly influences present decisions?",
                "What theme is explored through characters searching for identity?",
                "What theme emerges when success brings unexpected loneliness?",
                "What theme is suggested by characters learning that appearances can be deceiving?",
                "What universal theme is present in stories about sacrifice for others?",
                "What theme emerges when characters realize money can't buy happiness?"
            ];
            return questions[num-1] || questions[0];
        }

        function getThemeOptions(num) {
            const optionsSets = [
                ["True happiness comes from within, not material possessions", "Wealth is the most important goal in life", "Losing everything makes people angry", "Rich people are never happy"],
                ["The conflict between individual happiness and responsibility", "Family is always right", "Personal desires are selfish", "Duty is unimportant"],
                ["The human capacity for resilience and perseverance", "Life is always easy", "Obstacles should be avoided", "Only strong people succeed"],
                ["Progress often comes with unintended consequences", "Technology solves all problems", "New inventions are always bad", "We should avoid technology"],
                ["Understanding and tolerance overcome differences", "People should stay with their own kind", "Differences can never be overcome", "Background doesn't matter"],
                ["Knowledge brings both power and responsibility", "Ignorance is bliss", "Learning is unimportant", "Knowledge is always dangerous"],
                ["Human cooperation in facing shared challenges", "Disasters are punishments", "People only look out for themselves", "Nature is always hostile"],
                ["The loss of innocence as part of maturation", "Childhood should last forever", "Growing up is easy", "Adults are always happy"],
                ["Courage is facing fears, not absence of fear", "Fear should control decisions", "Brave people feel no fear", "Goals aren't worth fear"],
                ["The inescapable influence of history on present", "The past doesn't matter", "People can completely escape history", "Only the future matters"],
                ["Self-discovery and acceptance of identity", "Identity is fixed at birth", "Searching causes problems", "Identity doesn't matter"],
                ["Success doesn't guarantee fulfillment", "Success solves all problems", "Successful people are always happy", "Loneliness comes from failure"],
                ["True value lies beneath surface appearances", "Appearances are always true", "Beautiful things are always good", "Ugly things are always bad"],
                ["Love often requires personal sacrifice", "Sacrifice is always foolish", "People should never sacrifice", "Sacrifice brings resentment"],
                ["Material wealth doesn't equal life satisfaction", "Money buys everything", "Poor people are happier", "Wealth guarantees happiness"]
            ];
            return optionsSets[num-1] || optionsSets[0];
        }

        function getThemeExplanation(num) {
            const explanations = [
                "This common literary theme contrasts material wealth with internal fulfillment.",
                "This universal conflict explores the tension between personal freedom and social obligations.",
                "Stories of overcoming adversity typically celebrate human resilience and determination.",
                "This modern theme examines the double-edged nature of technological progress.",
                "Stories of cross-cultural understanding promote themes of empathy and tolerance.",
                "The journey from ignorance to knowledge is a classic theme about growth and responsibility.",
                "Shared crises often reveal themes of human solidarity and cooperation.",
                "Coming-of-age stories frequently explore the bittersweet loss of childhood innocence.",
                "This theme distinguishes between absence of fear and courage in facing fear.",
                "Many stories explore how past experiences shape present choices and identities.",
                "The search for identity is a fundamental human experience explored in literature.",
                "This theme examines the potential emptiness of achievement without connection.",
                "Learning to see beyond appearances is a common moral in literature.",
                "The theme of sacrifice for loved ones appears across cultures and genres.",
                "This classic theme questions the relationship between wealth and true happiness."
            ];
            return explanations[num-1] || explanations[0];
        }

        function getToneQuestion(num) {
            const questions = [
                "What tone is created by words like 'decayed,' 'crumbling,' and 'forgotten'?",
                "How would you describe the tone of writing that uses words like 'bubbling,' 'dancing,' and 'sparkling'?",
                "What tone is established by short, abrupt sentences and harsh vocabulary?",
                "How would you characterize tone that uses elaborate descriptions and complex sentences?",
                "What tone is created by frequent use of questions and uncertain language?",
                "How would you describe tone that includes many exclamations and enthusiastic words?",
                "What tone is suggested by formal, precise language without emotional words?",
                "How would you characterize tone that uses sarcasm and says the opposite of what's meant?",
                "What tone is created by nostalgic references and gentle, flowing sentences?",
                "How would you describe tone that uses scientific terms and data without interpretation?",
                "What tone is suggested by dark imagery and pessimistic predictions?",
                "How would you characterize tone that mixes humor with serious observations?",
                "What tone is created by urgent, action-oriented verbs and time references?",
                "How would you describe tone that focuses on beauty and uses many adjectives?",
                "What tone is suggested by detached observation without personal involvement?"
            ];
            return questions[num-1] || questions[0];
        }

        function getToneOptions(num) {
            const optionsSets = [
                ["Gloomy and decaying", "Happy and cheerful", "Exciting and adventurous", "Romantic and dreamy"],
                ["Joyful and lively", "Sad and depressing", "Angry and hostile", "Boring and dull"],
                ["Harsh and aggressive", "Gentle and soothing", "Confused and uncertain", "Formal and proper"],
                ["Sophisticated and detailed", "Simple and plain", "Rushed and hurried", "Childish and simple"],
                ["Inquisitive and uncertain", "Confident and sure", "Angry and accusing", "Happy and carefree"],
                ["Enthusiastic and excited", "Depressed and sad", "Neutral and objective", "Fearful and anxious"],
                ["Objective and clinical", "Emotional and passionate", "Casual and friendly", "Humorous and playful"],
                ["Sarcastic and ironic", "Sincere and honest", "Confused and lost", "Romantic and loving"],
                ["Nostalgic and reflective", "Futuristic and forward-looking", "Angry and resentful", "Rushed and hurried"],
                ["Analytical and factual", "Emotional and subjective", "Artistic and creative", "Mysterious and vague"],
                ["Pessimistic and bleak", "Optimistic and hopeful", "Humorous and light", "Romantic and sweet"],
                ["Wry and thoughtful", "Angry and bitter", "Simple and plain", "Formal and stiff"],
                ["Urgent and pressing", "Relaxed and casual", "Confused and lost", "Boring and monotonous"],
                ["Appreciative and descriptive", "Critical and harsh", "Rushed and brief", "Technical and dry"],
                ["Detached and observational", "Emotionally involved", "Personally invested", "Biased and partial"]
            ];
            return optionsSets[num-1] || optionsSets[0];
        }

        function getToneExplanation(num) {
            const explanations = [
                "Word choice directly establishes tone; decay-related vocabulary creates gloomy atmosphere.",
                "Active, positive verbs and adjectives typically create joyful, lively tones.",
                "Sentence structure and vocabulary work together to establish harsh tone.",
                "Complexity in language and description often indicates sophisticated tone.",
                "Questioning language and uncertainty markers create inquisitive tone.",
                "Exclamations and enthusiastic vocabulary establish excited tone.",
                "Formal language without emotional markers creates objective, clinical tone.",
                "Saying the opposite of literal meaning with particular delivery indicates sarcasm.",
                "References to past and gentle language flow create nostalgic tone.",
                "Technical vocabulary without emotional interpretation creates analytical tone.",
                "Dark imagery and negative predictions establish pessimistic tone.",
                "Mixing humor with seriousness creates wry, thoughtful tone.",
                "Urgent verbs and time references create pressing, urgent tone.",
                "Focus on beauty through descriptive adjectives creates appreciative tone.",
                "Lack of personal involvement or emotion creates detached, observational tone."
            ];
            return explanations[num-1] || explanations[0];
        }

        function getContextQuestion(num) {
            const questions = [
                "Using context clues, what does 'ephemeral' mean in: 'The butterfly's beauty was ephemeral, lasting only a few days before it faded.'",
                "What does 'verbose' mean based on: 'His verbose explanation took twenty minutes when five would have sufficed.'",
                "Using context clues, what does 'meticulous' mean in: 'Her meticulous attention to detail ensured every document was perfect.'",
                "What does 'ambiguous' mean based on: 'The ambiguous instructions left everyone confused about what to do next.'",
                "Using context clues, what does 'prolific' mean in: 'The prolific writer published three novels every year for decades.'",
                "What does 'gregarious' mean based on: 'His gregarious nature made him the life of every party he attended.'",
                "Using context clues, what does 'pragmatic' mean in: 'Her pragmatic approach focused on practical solutions rather than idealistic theories.'",
                "What does 'resilient' mean based on: 'Despite many setbacks, her resilient spirit kept her moving forward.'",
                "Using context clues, what does 'aloof' mean in: 'His aloof demeanor made it difficult for others to approach him.'",
                "What does 'candid' mean based on: 'Her candid feedback was sometimes painful but always honest.'"
            ];
            return questions[num-1] || questions[0];
        }

        function getContextOptions(num) {
            const optionsSets = [
                ["Temporary or short-lived", "Permanent and lasting", "Colorful and bright", "Large and impressive"],
                ["Using more words than necessary", "Using few words", "Speaking quietly", "Speaking quickly"],
                ["Extremely careful and precise", "Careless and sloppy", "Quick and hurried", "Average and normal"],
                ["Unclear or having multiple meanings", "Clear and specific", "Simple and easy", "Complex but clear"],
                ["Producing much work", "Producing little work", "Producing quality work", "Producing controversial work"],
                ["Sociable and outgoing", "Shy and reserved", "Intelligent and smart", "Funny and humorous"],
                ["Practical and realistic", "Theoretical and abstract", "Emotional and feeling-based", "Traditional and old-fashioned"],
                ["Able to recover from difficulties", "Easily discouraged", "Physically strong", "Intelligent and clever"],
                ["Distant and reserved", "Friendly and approachable", "Angry and hostile", "Happy and cheerful"],
                ["Frank and straightforward", "Deceptive and misleading", "Kind and gentle", "Harsh and cruel"]
            ];
            return optionsSets[num-1] || optionsSets[0];
        }

        function getContextExplanation(num) {
            const explanations = [
                "'Lasting only a few days' provides context that ephemeral means temporary.",
                "'Took twenty minutes when five would have sufficed' indicates unnecessary length.",
                "'Attention to detail' and 'perfect' context suggests extreme care.",
                "'Left everyone confused' context indicates lack of clarity.",
                "'Three novels every year for decades' context indicates high productivity.",
                "'Life of every party' context indicates sociable nature.",
                "'Practical solutions rather than idealistic theories' defines pragmatic.",
                "'Despite many setbacks... kept moving forward' defines resilience.",
                "'Difficult for others to approach' context indicates distance.",
                "'Sometimes painful but always honest' context defines candid."
            ];
            return explanations[num-1] || explanations[0];
        }

        function getDeviceQuestion(num) {
            const questions = [
                "What literary device is used in: 'The classroom was a zoo during the substitute teacher's absence.'?",
                "What device is present in: 'Her smile was like sunshine on a cloudy day.'?",
                "What literary technique is used in: 'The old oak tree groaned in the strong wind.'?",
                "What device appears in: 'I'm so hungry I could eat a horse!'?",
                "What literary device is: 'The stars winked playfully in the night sky.'?",
                "What technique is used in: 'He was a lion in battle, fearless and powerful.'?",
                "What device appears in: 'The wind howled its lonely song through the empty streets.'?",
                "What literary technique is: 'This backpack weighs a ton!'?",
                "What device is used in: 'Time is a thief that steals our moments.'?",
                "What technique appears in: 'Her voice was music to his ears.'?"
            ];
            return questions[num-1] || questions[0];
        }

        function getDeviceOptions(num) {
            const optionsSets = [
                ["Metaphor", "Simile", "Personification", "Hyperbole"],
                ["Simile", "Metaphor", "Personification", "Alliteration"],
                ["Personification", "Metaphor", "Simile", "Hyperbole"],
                ["Hyperbole", "Metaphor", "Simile", "Personification"],
                ["Personification", "Simile", "Metaphor", "Hyperbole"],
                ["Metaphor", "Simile", "Personification", "Hyperbole"],
                ["Personification", "Metaphor", "Simile", "Hyperbole"],
                ["Hyperbole", "Metaphor", "Simile", "Personification"],
                ["Metaphor", "Simile", "Personification", "Hyperbole"],
                ["Metaphor", "Simile", "Personification", "Hyperbole"]
            ];
            return optionsSets[num-1] || optionsSets[0];
        }

        function getDeviceExplanation(num) {
            const explanations = [
                "Direct comparison (classroom to zoo) without 'like' or 'as' = metaphor.",
                "Comparison using 'like' = simile.",
                "Giving human traits (groaning) to tree = personification.",
                "Exaggeration for effect = hyperbole.",
                "Giving human action (winking) to stars = personification.",
                "Direct comparison (man to lion) without 'like' or 'as' = metaphor.",
                "Giving human action (howling song) to wind = personification.",
                "Exaggeration about weight = hyperbole.",
                "Direct comparison (time to thief) = metaphor.",
                "Direct comparison (voice to music) = metaphor."
            ];
            return explanations[num-1] || explanations[0];
        }

        function getIronyQuestion(num) {
            const questions = [
                "What type of irony is present when a character afraid of water wins a swimming competition?",
                "What irony type occurs when a character says 'What perfect weather!' during a thunderstorm?",
                "What kind of irony is it when the audience knows the killer is in the closet but the character doesn't?",
                "What type of irony occurs when a fire station burns down?",
                "What irony is present when someone who fears public speaking becomes a famous motivational speaker?",
                "What type of irony occurs when a character says 'I love being ignored' sarcastically?",
                "What irony is present when the audience knows a gift is unwanted but the giver doesn't?",
                "What type of irony occurs when a diet coach is severely overweight?",
                "What irony is present when a safety inspector has an accident at home?",
                "What type of irony occurs when someone says 'This is just what I needed' after receiving bad news?"
            ];
            return questions[num-1] || questions[0];
        }

        function getIronyOptions(num) {
            const optionsSets = [
                ["Situational irony", "Verbal irony", "Dramatic irony", "No irony"],
                ["Verbal irony", "Situational irony", "Dramatic irony", "No irony"],
                ["Dramatic irony", "Situational irony", "Verbal irony", "No irony"],
                ["Situational irony", "Verbal irony", "Dramatic irony", "No irony"],
                ["Situational irony", "Verbal irony", "Dramatic irony", "No irony"],
                ["Verbal irony", "Situational irony", "Dramatic irony", "No irony"],
                ["Dramatic irony", "Situational irony", "Verbal irony", "No irony"],
                ["Situational irony", "Verbal irony", "Dramatic irony", "No irony"],
                ["Situational irony", "Verbal irony", "Dramatic irony", "No irony"],
                ["Verbal irony", "Situational irony", "Dramatic irony", "No irony"]
            ];
            return optionsSets[num-1] || optionsSets[0];
        }

        function getIronyExplanation(num) {
            const explanations = [
                "Situational - outcome contradicts expectations based on fear.",
                "Verbal - saying opposite of literal truth (sarcasm).",
                "Dramatic - audience knows something character doesn't.",
                "Situational - opposite of expected function.",
                "Situational - contradicts fear-based expectation.",
                "Verbal - sarcastic statement opposite of literal meaning.",
                "Dramatic - audience has knowledge character lacks.",
                "Situational - contradicts professional role expectation.",
                "Situational - contradicts professional expertise.",
                "Verbal - sarcastic statement opposite of literal meaning."
            ];
            return explanations[num-1] || explanations[0];
        }

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            studentName: "",
            startTime: null,
            currentPassage: null,
            currentInferenceExample: 0,
            currentContextExample: 0,
            currentToneExample: 0,
            selectedThemeElements: [],
            toneMarkerPosition: 50
        };

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const backToHomeBtn = document.getElementById('backToHome');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const passageContainer = document.getElementById('passageContainer');
        const passageTitle = document.getElementById('passageTitle');
        const passageContent = document.getElementById('passageContent');
        const passageAuthor = document.getElementById('passageAuthor');
        const passageGenre = document.getElementById('passageGenre');
        const comprehensionTip = document.getElementById('comprehensionTip');
        const skillIndicator = document.getElementById('skillIndicator');
        const skillIcon = document.getElementById('skillIcon');
        const skillName = document.getElementById('skillName');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const feedbackExplanation = document.getElementById('feedbackExplanation');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const timeSpent = document.getElementById('timeSpent');
        const inferenceFeedback = document.getElementById('inferenceFeedback');
        const themeStatement = document.getElementById('themeStatement');
        const contextFeedback = document.getElementById('contextFeedback');
        const toneMarker = document.getElementById('toneMarker');
        const toneJustification = document.getElementById('toneJustification');
        const deviceFeedback = document.getElementById('deviceFeedback');
        const ironyFeedback = document.getElementById('ironyFeedback');

        // Initialize
        function initApp() {
            setupEventListeners();
            showWelcomePage();
            setupToneSlider();
            setupInteractiveExamples();
        }

        // Setup tone slider
        function setupToneSlider() {
            const slider = document.getElementById('toneSlider');
            const marker = document.getElementById('toneMarker');
            
            // Set initial position
            marker.style.left = `${appState.toneMarkerPosition}%`;
            
            // Make marker draggable
            marker.addEventListener('mousedown', startDrag);
            marker.addEventListener('touchstart', startDrag);
            
            function startDrag(e) {
                e.preventDefault();
                document.addEventListener('mousemove', onDrag);
                document.addEventListener('touchmove', onDrag);
                document.addEventListener('mouseup', stopDrag);
                document.addEventListener('touchend', stopDrag);
            }
            
            function onDrag(e) {
                const sliderRect = slider.getBoundingClientRect();
                let clientX;
                
                if (e.type.includes('touch')) {
                    clientX = e.touches[0].clientX;
                } else {
                    clientX = e.clientX;
                }
                
                let percent = ((clientX - sliderRect.left) / sliderRect.width) * 100;
                percent = Math.max(0, Math.min(100, percent));
                
                appState.toneMarkerPosition = percent;
                marker.style.left = `${percent}%`;
                
                // Update tone description based on position
                let toneDesc = "";
                if (percent < 20) toneDesc = "Very Negative";
                else if (percent < 40) toneDesc = "Negative";
                else if (percent < 60) toneDesc = "Neutral";
                else if (percent < 80) toneDesc = "Positive";
                else toneDesc = "Very Positive";
                
                toneJustification.textContent = `Tone position: ${toneDesc} (${Math.round(percent)}%)`;
            }
            
            function stopDrag() {
                document.removeEventListener('mousemove', onDrag);
                document.removeEventListener('touchmove', onDrag);
                document.removeEventListener('mouseup', stopDrag);
                document.removeEventListener('touchend', stopDrag);
            }
        }

        // Setup interactive examples
        function setupInteractiveExamples() {
            // Set up tone labels
            const toneLabels = document.querySelectorAll('.tone-label');
            toneLabels.forEach(label => {
                label.addEventListener('click', function() {
                    // Remove selected class from all labels
                    toneLabels.forEach(l => l.classList.remove('selected'));
                    // Add selected class to clicked label
                    this.classList.add('selected');
                    
                    const tone = this.textContent.toLowerCase();
                    let justification = `Selected tone: ${this.textContent}. `;
                    
                    switch(tone) {
                        case 'sarcastic':
                            justification += "This tone uses irony, says opposite of literal meaning, often with mocking intent.";
                            break;
                        case 'nostalgic':
                            justification += "This tone expresses sentimental longing for the past, often with gentle, reflective language.";
                            break;
                        case 'objective':
                            justification += "This tone presents facts without emotional bias, using neutral language and avoiding personal opinions.";
                            break;
                        case 'optimistic':
                            justification += "This tone expresses hopefulness about the future, using positive language and expecting good outcomes.";
                            break;
                        case 'pessimistic':
                            justification += "This tone expects negative outcomes, using doubtful language and focusing on potential problems.";
                            break;
                    }
                    
                    toneJustification.textContent = justification;
                });
            });
        }

        // Inference practice functions
        function showClueDetail(clueId) {
            let detail = "";
            switch(clueId) {
                case 'clue1':
                    detail = "Character actions are strong clues. What someone DOES often reveals more than what they SAY. Look for patterns in behavior.";
                    break;
                case 'clue2':
                    detail = "Descriptive details create atmosphere and suggest mood. Details about setting often reflect character emotions or foreshadow events.";
                    break;
                case 'clue3':
                    detail = "Dialogue reveals character relationships, attitudes, and hidden feelings. Pay attention to what's said AND what's left unsaid.";
                    break;
            }
            inferenceFeedback.textContent = detail;
            inferenceFeedback.style.color = "var(--inference-blue)";
        }

        function checkInference(option) {
            const example = inferenceExamples[appState.currentInferenceExample];
            let isCorrect = false;
            let feedback = "";
            
            switch(option) {
                case 'option1':
                    isCorrect = (appState.currentInferenceExample === 0);
                    feedback = isCorrect ? "Correct! The clues suggest anticipation and anxiety about an important meeting." 
                                         : "Not quite. While there's anticipation, the nervous behaviors suggest anxiety rather than excitement.";
                    break;
                case 'option2':
                    isCorrect = (appState.currentInferenceExample === 1);
                    feedback = isCorrect ? "Correct! The physical signs of nervousness combined with avoiding eye contact suggest anxiety about difficult news."
                                         : "Good thinking, but look at all the clues together - checking watch suggests waiting, not necessarily anxiety.";
                    break;
                case 'option3':
                    isCorrect = false;
                    feedback = "The clues don't suggest boredom. Look for patterns in the behaviors - repetitive checking and nervous movements indicate anxiety.";
                    break;
            }
            
            inferenceFeedback.textContent = feedback;
            inferenceFeedback.style.color = isCorrect ? "var(--tone-teal)" : "var(--context-orange)";
            
            if (isCorrect) {
                // Move to next example after delay
                setTimeout(() => {
                    appState.currentInferenceExample = (appState.currentInferenceExample + 1) % inferenceExamples.length;
                    inferenceFeedback.textContent = "New example loaded. Analyze the clues above.";
                    inferenceFeedback.style.color = "var(--text-secondary)";
                }, 2000);
            }
        }

        // Theme analyzer functions
        function selectThemeElement(element) {
            const themeElement = document.querySelector(`[onclick="selectThemeElement('${element}')"]`);
            
            if (appState.selectedThemeElements.includes(element)) {
                // Remove if already selected
                appState.selectedThemeElements = appState.selectedThemeElements.filter(e => e !== element);
                themeElement.classList.remove('selected');
            } else {
                // Add if not selected
                appState.selectedThemeElements.push(element);
                themeElement.classList.add('selected');
            }
            
            updateThemeStatement();
        }

        function updateThemeStatement() {
            if (appState.selectedThemeElements.length === 0) {
                themeStatement.textContent = "Combine elements to identify the theme";
                return;
            }
            
            let statement = "Potential theme: ";
            const elements = appState.selectedThemeElements;
            
            if (elements.includes('conflict') && elements.includes('character')) {
                statement += "Personal growth through overcoming challenges";
            } else if (elements.includes('symbol') && elements.includes('message')) {
                statement += "Life's journey toward self-discovery";
            } else if (elements.includes('conflict') && elements.includes('message')) {
                statement += "The struggle between tradition and change";
            } else if (elements.length === 1) {
                switch(elements[0]) {
                    case 'conflict': statement += "Internal or external struggle"; break;
                    case 'character': statement += "Character development arc"; break;
                    case 'symbol': statement += "Symbolic representation of ideas"; break;
                    case 'message': statement += "Central message about life"; break;
                }
            } else {
                statement += "Combining multiple literary elements to reveal deeper meaning";
            }
            
            themeStatement.textContent = statement;
        }

        function suggestTheme() {
            if (appState.selectedThemeElements.length === 0) {
                themeStatement.textContent = "Suggested theme: Persistence and personal growth through adversity";
                themeStatement.style.color = "var(--theme-purple)";
            } else {
                themeStatement.textContent = "Theme identified: " + 
                    (appState.selectedThemeElements.includes('character') ? 
                     "Character development through challenges" : 
                     "Universal truth about human experience");
                themeStatement.style.color = "var(--theme-purple)";
            }
        }

        function clearTheme() {
            appState.selectedThemeElements = [];
            const elements = document.querySelectorAll('.theme-element');
            elements.forEach(el => el.classList.remove('selected'));
            themeStatement.textContent = "Combine elements to identify the theme";
            themeStatement.style.color = "var(--text-secondary)";
        }

        // Context clues functions
        function explainContextWord(word) {
            const example = contextExamples[appState.currentContextExample];
            contextFeedback.innerHTML = `<strong>${word.toUpperCase()}:</strong> In this sentence, look at the surrounding words. 'Broken windows, sagging roof, peeling paint' all describe poor condition. Therefore, '${word}' likely means 'in poor condition from neglect.'`;
            contextFeedback.style.color = "var(--context-orange)";
        }

        function checkContext(option) {
            const example = contextExamples[appState.currentContextExample];
            const isCorrect = (option === example.meaning.toLowerCase());
            
            if (isCorrect) {
                contextFeedback.innerHTML = `<strong>Correct!</strong> "${example.word}" means "${example.meaning}". The context clues (${example.sentence.split(example.word)[0].split(' ').slice(-3).join(' ')}...) support this meaning.`;
                contextFeedback.style.color = "var(--tone-teal)";
                
                // Move to next example
                setTimeout(() => {
                    appState.currentContextExample = (appState.currentContextExample + 1) % contextExamples.length;
                    const newExample = contextExamples[appState.currentContextExample];
                    document.querySelector('.context-sentence').innerHTML = 
                        newExample.sentence.replace(newExample.word, 
                            `<span class="context-word" onclick="explainContextWord('${newExample.word}')">${newExample.word}</span>`);
                    contextFeedback.textContent = "Use context clues to determine word meaning";
                    contextFeedback.style.color = "var(--text-secondary)";
                }, 2000);
            } else {
                contextFeedback.innerHTML = `<strong>Not quite.</strong> Look at the full sentence: "${example.sentence}" The surrounding words provide clues about the word's meaning.`;
                contextFeedback.style.color = "var(--context-orange)";
            }
        }

        // Tone analysis functions
        function selectTone(tone) {
            const labels = document.querySelectorAll('.tone-label');
            labels.forEach(label => label.classList.remove('selected'));
            
            const selectedLabel = Array.from(labels).find(l => l.textContent.toLowerCase() === tone);
            if (selectedLabel) {
                selectedLabel.classList.add('selected');
            }
            
            let justification = "";
            switch(tone) {
                case 'sarcastic':
                    justification = "Sarcastic tone uses irony, often saying the opposite of what's meant, with mocking or humorous intent.";
                    break;
                case 'nostalgic':
                    justification = "Nostalgic tone expresses sentimental longing for the past, often with gentle, reflective language.";
                    break;
                case 'objective':
                    justification = "Objective tone presents facts without emotional bias, using neutral, precise language.";
                    break;
                case 'optimistic':
                    justification = "Optimistic tone expresses hopefulness about the future, expecting positive outcomes.";
                    break;
                case 'pessimistic':
                    justification = "Pessimistic tone expects negative outcomes, focusing on problems and potential failures.";
                    break;
            }
            
            toneJustification.textContent = `Selected tone: ${tone.charAt(0).toUpperCase() + tone.slice(1)}. ${justification}`;
        }

        function checkToneAnalysis() {
            const selectedTone = document.querySelector('.tone-label.selected');
            if (!selectedTone) {
                toneJustification.textContent = "Please select a tone first, then analyze.";
                toneJustification.style.color = "var(--context-orange)";
                return;
            }
            
            const tone = selectedTone.textContent.toLowerCase();
            const example = toneExamples[appState.currentToneExample];
            const isCorrect = (tone === example.correctTone.split(' ')[0].toLowerCase());
            
            if (isCorrect) {
                toneJustification.innerHTML = `<strong>Good analysis!</strong> The tone is ${example.correctTone}. Key words that establish this tone: "${example.wordChoices.join('", "')}"`;
                toneJustification.style.color = "var(--tone-teal)";
            } else {
                toneJustification.innerHTML = `<strong>Consider:</strong> The actual tone is ${example.correctTone}. Look for words like "${example.wordChoices.join('", "')}" that create this atmosphere.`;
                toneJustification.style.color = "var(--context-orange)";
            }
        }

        function newToneExample() {
            appState.currentToneExample = (appState.currentToneExample + 1) % toneExamples.length;
            const example = toneExamples[appState.currentToneExample];
            
            // Clear selections
            document.querySelectorAll('.tone-label').forEach(l => l.classList.remove('selected'));
            appState.toneMarkerPosition = 50;
            toneMarker.style.left = '50%';
            
            toneJustification.textContent = `New example: "${example.text.substring(0, 100)}..." Analyze the tone above.`;
            toneJustification.style.color = "var(--text-secondary)";
        }

        // Literary devices functions
        function explainDevice(device) {
            const example = deviceExamples.find(d => d.device === device);
            if (example) {
                deviceFeedback.innerHTML = `<strong>${device.toUpperCase()}:</strong> ${example.explanation}<br><br><em>Example:</em> "${example.example}"`;
                deviceFeedback.style.color = "var(--symbolism-indigo)";
            }
        }

        // Irony detection functions
        function checkIrony(type) {
            const example = ironyExamples.find(e => e.type === type);
            if (example) {
                ironyFeedback.innerHTML = `<strong>${type.charAt(0).toUpperCase() + type.slice(1)} Irony:</strong> ${example.explanation}<br><br><em>Example:</em> ${example.scenario}`;
                ironyFeedback.style.color = "var(--irony-pink)";
            }
        }

        // Skill detail display
        window.showSkillDetail = function(skill) {
            let info = "";
            
            if (skill === 'inference') {
                info = "üîç INFERENCE üîç\n\n";
                info += "Definition: Reading between the lines to understand implied meanings that aren't directly stated.\n\n";
                info += "Key Skills:\n";
                info += "‚Ä¢ Identifying implicit character traits and motivations\n";
                info += "‚Ä¢ Making predictions based on textual evidence\n";
                info += "‚Ä¢ Drawing logical conclusions from clues\n";
                info += "‚Ä¢ Understanding cause-effect relationships\n";
                info += "‚Ä¢ Recognizing foreshadowing and implications\n\n";
                info += "How to Make Inferences:\n";
                info += "1. Look for clues in actions, dialogue, and descriptions\n";
                info += "2. Consider what's NOT being said directly\n";
                info += "3. Connect different pieces of information\n";
                info += "4. Use background knowledge and context\n";
                info += "5. Support inferences with textual evidence\n\n";
                info += "Example: If a character is pacing and checking their watch, you can infer they're anxious or waiting for something important.";
            } else if (skill === 'theme') {
                info = "üé≠ THEME üé≠\n\n";
                info += "Definition: The central idea, message, or insight about human experience in a literary work.\n\n";
                info += "Key Concepts:\n";
                info += "‚Ä¢ Universal truths about human nature\n";
                info += "‚Ä¢ Moral or lesson about life\n";
                info += "‚Ä¢ Insight into society or relationships\n";
                info += "‚Ä¢ Recurring ideas throughout the work\n";
                info += "‚Ä¢ What the author wants readers to understand\n\n";
                info += "How to Identify Themes:\n";
                info += "1. Look for recurring symbols or motifs\n";
                info += "2. Analyze character development and conflicts\n";
                info += "3. Consider the title and key scenes\n";
                info += "4. Ask: What is the work saying about life?\n";
                info += "5. Look for changes in characters or situations\n\n";
                info += "Example Themes: Love conquers all, Good vs. Evil, Coming of age, The American Dream";
            } else {
                info = "üìö TONE & MOOD üìö\n\n";
                info += "Tone: The author's attitude toward the subject or audience.\n";
                info += "Mood: The emotional atmosphere created for the reader.\n\n";
                info += "Key Concepts:\n";
                info += "‚Ä¢ Tone is revealed through word choice and style\n";
                info += "‚Ä¢ Mood is created through setting and description\n";
                info += "‚Ä¢ Both work together to create emotional impact\n";
                info += "‚Ä¢ Tone can shift within a work\n";
                info += "‚Ä¢ Different characters may have different tones\n\n";
                info += "Common Tones:\n";
                info += "‚Ä¢ Formal, informal, serious, humorous\n";
                info += "‚Ä¢ Optimistic, pessimistic, sarcastic\n";
                info += "‚Ä¢ Nostalgic, urgent, contemplative\n";
                info += "‚Ä¢ Objective, subjective, ironic\n\n";
                info += "How to Analyze Tone:\n";
                info += "1. Examine word choice (diction)\n";
                info += "2. Look at sentence structure and length\n";
                info += "3. Consider imagery and figurative language\n";
                info += "4. Analyze dialogue and narration style\n";
                info += "5. Notice what emotions the language evokes";
            }
            
            alert(info);
        };

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', showWelcomePage);
            viewTopicsBtn.addEventListener('click', () => alert("Other English comprehension topics would be available here."));
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') startPractice();
            });
        }

        // Create comprehension tip display
        function createComprehensionTip() {
            const tipDiv = document.createElement('div');
            tipDiv.className = 'comprehension-tip';
            tipDiv.innerHTML = `<strong>Comprehension Tip:</strong> ${comprehensionTips[Math.floor(Math.random() * comprehensionTips.length)]}`;
            return tipDiv;
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            appState.startTime = new Date();
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const percentage = Math.round((appState.score / allQuestions.length) * 100);
            const timeDiff = new Date() - appState.startTime;
            const minutes = Math.floor(timeDiff / 60000);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            timeSpent.textContent = `${minutes}min`;
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Brilliant! You've mastered advanced comprehension skills!";
            } else if (percentage >= 75) {
                scoreMessage.textContent = "Excellent work! You understand inference, theme, and tone deeply!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Good job! You're developing strong analytical reading skills!";
            } else {
                scoreMessage.textContent = "Keep practicing! Understanding deeper meanings makes reading more rewarding!";
            }
        }

        // Load question
        function loadQuestion() {
            const question = allQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${allQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / allQuestions.length) * 100}%`;
            
            // Display passage if this question is associated with one
            if (question.passageId > 0) {
                const passage = allPassages.find(p => p.id === question.passageId);
                if (passage) {
                    passageContainer.style.display = 'block';
                    passageTitle.textContent = passage.title;
                    passageContent.textContent = passage.content;
                    passageAuthor.textContent = `By: ${passage.author}`;
                    passageGenre.textContent = `Genre: ${passage.genre}`;
                    appState.currentPassage = passage;
                }
            } else {
                // For general questions, hide passage container
                passageContainer.style.display = 'none';
                appState.currentPassage = null;
            }
            
            // Set skill indicator
            skillName.textContent = question.skill.charAt(0).toUpperCase() + question.skill.slice(1);
            skillIndicator.className = `skill-indicator indicator-${question.skill}`;
            
            // Set appropriate icon
            if (question.skill === 'inference') skillIcon.textContent = 'üîç';
            else if (question.skill === 'theme') skillIcon.textContent = 'üé≠';
            else skillIcon.textContent = 'üìö';
            
            questionText.textContent = question.question;
            
            // Clear previous content
            comprehensionTip.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            // Add tip
            comprehensionTip.appendChild(createComprehensionTip());
            
            // Add options
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = allQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation);
            }
            
            nextQuestionBtn.disabled = false;
        }

        // Show feedback with evidence highlighting
        function showFeedback(isCorrect, explanation) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
            }
            
            // Add evidence highlighting for passage-based questions
            if (appState.currentPassage) {
                const skill = allQuestions[appState.currentQuestionIndex].skill;
                let evidenceHint = "\n\nLook for evidence in the passage: ";
                
                if (skill === 'inference') {
                    evidenceHint += "Re-read character actions, dialogue, and descriptive details.";
                } else if (skill === 'theme') {
                    evidenceHint += "Consider recurring ideas, character development, and conflicts.";
                } else {
                    evidenceHint += "Examine word choice, sentence structure, and imagery.";
                }
                
                feedbackExplanation.textContent = explanation + evidenceHint;
            } else {
                feedbackExplanation.textContent = explanation;
            }
            
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < allQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Skip question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < allQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Retry topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            showPracticePage();
        }

        // Start practice
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin comprehension practice!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            showPracticePage();
        }

        // Initialize app
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
