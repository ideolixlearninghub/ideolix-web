<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 7 English - Parts of Speech (Deeper Study) | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Language Arts Theme */
        :root {
            --primary-blue: #2962FF;
            --secondary-teal: #00BFA5;
            --accent-amber: #FFAB00;
            --accent-purple: #AA00FF;
            --accent-pink: #FF4081;
            --accent-green: #00C853;
            --accent-orange: #FF6D00;
            --accent-cyan: #00B8D4;
            --dark-bg: #0D1B2A;
            --dark-surface: #1B2B3A;
            --dark-card: #253447;
            --dark-border: #3A4A5A;
            --text-primary: #FFFFFF;
            --text-secondary: #B8D0E0;
            --text-muted: #7A94A8;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            --glow: 0 0 20px rgba(41, 98, 255, 0.3);
            --noun-glow: 0 0 15px rgba(0, 191, 165, 0.4);
            --verb-glow: 0 0 15px rgba(255, 171, 0, 0.4);
            --adjective-glow: 0 0 15px rgba(170, 0, 255, 0.4);
            --adverb-glow: 0 0 15px rgba(255, 64, 129, 0.4);
            --pronoun-glow: 0 0 15px rgba(0, 200, 83, 0.4);
            --preposition-glow: 0 0 15px rgba(255, 109, 0, 0.4);
            --conjunction-glow: 0 0 15px rgba(0, 184, 212, 0.4);
            --interjection-glow: 0 0 15px rgba(41, 98, 255, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Language Arts Pattern Background */
        .language-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(41, 98, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 191, 165, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 171, 0, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0D1B2A, #1B2B3A);
            opacity: 0.8;
        }

        .floating-letters {
            position: absolute;
            color: rgba(255, 255, 255, 0.05);
            font-size: 3rem;
            font-weight: bold;
            animation: floatLetters 20s linear infinite;
            font-family: 'Georgia', serif;
        }

        @keyframes floatLetters {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-100px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-100px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(100px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 27, 42, 0.9);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(41, 98, 255, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-blue);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(41, 98, 255, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(41, 98, 255, 0.4);
        }

        .btn-primary:hover {
            background: #1A56DB;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(41, 98, 255, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-teal);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 191, 165, 0.4);
        }

        .btn-secondary:hover {
            background: #009688;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 191, 165, 0.5);
        }

        .btn-amber {
            background: var(--accent-amber);
            color: #000;
            box-shadow: 0 4px 15px rgba(255, 171, 0, 0.4);
        }

        .btn-amber:hover {
            background: #FF9800;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 171, 0, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(41, 98, 255, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .language-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(41, 98, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: rgba(41, 98, 255, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(0, 200, 83, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .option.incorrect {
            background: rgba(255, 64, 129, 0.1);
            border-color: var(--accent-pink);
            color: var(--accent-pink);
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-teal);
        }

        .option.correct .option-letter {
            background: var(--accent-green);
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--accent-pink);
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(0, 200, 83, 0.1);
            border-left: 5px solid var(--accent-green);
        }

        .feedback-incorrect {
            background: rgba(255, 64, 129, 0.1);
            border-left: 5px solid var(--accent-pink);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--accent-green);
        }

        .feedback-incorrect .feedback-icon {
            background: var(--accent-pink);
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--accent-green);
        }

        .feedback-incorrect .feedback-title {
            color: var(--accent-pink);
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Parts of Speech Display */
        .speech-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .display-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        .speech-container {
            padding: 20px;
            background: var(--dark-surface);
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .speech-scenario {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .speech-highlight {
            background: rgba(170, 0, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            border: 1px solid var(--accent-purple);
        }

        .highlight-text {
            color: var(--accent-purple);
            font-weight: bold;
        }

        /* Interactive Sentence Builder */
        .sentence-canvas {
            width: 100%;
            height: 300px;
            background: var(--dark-surface);
            border-radius: 12px;
            position: relative;
            margin: 20px 0;
            overflow: hidden;
            border: 2px solid var(--secondary-teal);
            padding: 20px;
        }

        #sentenceCanvas {
            width: 100%;
            height: 100%;
            display: block;
            background: var(--dark-surface);
        }

        .word-element {
            position: absolute;
            padding: 8px 12px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
            border: 2px solid transparent;
        }

        .word-element:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        /* Parts of Speech Grid */
        .speech-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .speech-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .speech-grid {
                grid-template-columns: 1fr;
            }
        }

        .speech-card {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid transparent;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .speech-card:hover {
            transform: translateY(-5px);
        }

        .speech-card.noun {
            border-color: var(--secondary-teal);
        }

        .speech-card.verb {
            border-color: var(--accent-amber);
        }

        .speech-card.adjective {
            border-color: var(--accent-purple);
        }

        .speech-card.adverb {
            border-color: var(--accent-pink);
        }

        .speech-card.pronoun {
            border-color: var(--accent-green);
        }

        .speech-card.preposition {
            border-color: var(--accent-orange);
        }

        .speech-card.conjunction {
            border-color: var(--accent-cyan);
        }

        .speech-card.interjection {
            border-color: var(--primary-blue);
        }

        .speech-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .noun .speech-icon {
            color: var(--secondary-teal);
        }

        .verb .speech-icon {
            color: var(--accent-amber);
        }

        .adjective .speech-icon {
            color: var(--accent-purple);
        }

        .adverb .speech-icon {
            color: var(--accent-pink);
        }

        .pronoun .speech-icon {
            color: var(--accent-green);
        }

        .preposition .speech-icon {
            color: var(--accent-orange);
        }

        .conjunction .speech-icon {
            color: var(--accent-cyan);
        }

        .interjection .speech-icon {
            color: var(--primary-blue);
        }

        .speech-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .noun .speech-title {
            color: var(--secondary-teal);
        }

        .verb .speech-title {
            color: var(--accent-amber);
        }

        .adjective .speech-title {
            color: var(--accent-purple);
        }

        .adverb .speech-title {
            color: var(--accent-pink);
        }

        .pronoun .speech-title {
            color: var(--accent-green);
        }

        .preposition .speech-title {
            color: var(--accent-orange);
        }

        .conjunction .speech-title {
            color: var(--accent-cyan);
        }

        .interjection .speech-title {
            color: var(--primary-blue);
        }

        .speech-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .speech-examples {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 10px;
            background: var(--dark-surface);
            padding: 8px;
            border-radius: 4px;
        }

        /* Parts of Speech Table */
        .speech-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .speech-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-purple);
            border-bottom: 2px solid var(--accent-purple);
        }

        .speech-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .speech-table tr:hover {
            background: rgba(170, 0, 255, 0.05);
        }

        /* Detailed Parts Display */
        .noun-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--secondary-teal);
        }

        .noun-title {
            color: var(--secondary-teal);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .noun-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .noun-grid {
                grid-template-columns: 1fr;
            }
        }

        .noun-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .noun-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--secondary-teal);
        }

        .noun-type {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--secondary-teal);
            font-size: 1.2rem;
        }

        .noun-steps {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Verb Display */
        .verb-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-amber);
        }

        .verb-title {
            color: var(--accent-amber);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .verb-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .verb-grid {
                grid-template-columns: 1fr;
            }
        }

        .verb-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .verb-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent-amber);
        }

        .verb-type {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-amber);
            font-size: 1.2rem;
        }

        .verb-steps {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Adjective Display */
        .adjective-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .adjective-title {
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .adjective-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .adjective-grid {
                grid-template-columns: 1fr;
            }
        }

        .adjective-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .adjective-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent-purple);
        }

        .adjective-type {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-purple);
            font-size: 1.2rem;
        }

        .adjective-steps {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Interactive Sentence Builder */
        .builder-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--primary-blue);
        }

        .builder-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .builder-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .builder-select {
            padding: 10px 15px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-blue);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .builder-input {
            padding: 15px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-blue);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            resize: vertical;
            min-height: 60px;
        }

        .builder-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .builder-btn {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-blue);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .builder-btn:hover {
            background: rgba(41, 98, 255, 0.1);
            transform: translateY(-2px);
        }

        .builder-display {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        /* Grammar Study Display */
        .grammar-study-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .grammar-study-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .grammar-study-grid {
                grid-template-columns: 1fr;
            }
        }

        .study-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--accent-green);
        }

        .study-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent-green);
        }

        .study-concept {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent-green);
        }

        .study-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Parts of Speech Visual Elements */
        .speech-step {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 191, 165, 0.05);
            border-radius: 6px;
            border-left: 4px solid var(--secondary-teal);
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--secondary-teal);
            color: white;
            border-radius: 50%;
            font-weight: bold;
        }

        .step-description {
            flex: 1;
        }

        .word-box {
            display: inline-block;
            padding: 5px 10px;
            margin: 0 5px;
            background: rgba(255, 171, 0, 0.1);
            border-radius: 4px;
            border: 1px solid var(--accent-amber);
            font-weight: bold;
        }

        .noun-marker {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--accent-pink);
            border-radius: 50%;
            margin: 0 5px;
        }

        .verb-element {
            display: inline-block;
            height: 2px;
            width: 30px;
            background: var(--primary-blue);
            margin: 0 5px;
            vertical-align: middle;
        }

        .speech-marker {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--accent-amber);
            margin: 0 5px;
            position: relative;
        }

        .speech-marker::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-amber);
            opacity: 0.3;
        }

        /* Canvas Styling */
        canvas {
            cursor: crosshair;
        }

        .canvas-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .canvas-btn {
            padding: 8px 12px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .canvas-btn:hover {
            background: rgba(41, 98, 255, 0.1);
            border-color: var(--primary-blue);
        }

        .canvas-btn.active {
            background: rgba(41, 98, 255, 0.2);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .speech-grid {
                grid-template-columns: 1fr;
            }
            
            .noun-grid {
                grid-template-columns: 1fr;
            }
            
            .verb-grid {
                grid-template-columns: 1fr;
            }
            
            .adjective-grid {
                grid-template-columns: 1fr;
            }
            
            .grammar-study-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 0.7; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes speechReveal {
            0% { transform: translateX(-100px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .speech-reveal {
            animation: speechReveal 0.5s ease forwards;
        }
        
        @keyframes nounGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(0, 191, 165, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(0, 191, 165, 0.2); }
        }
        
        .noun-glow {
            animation: nounGlow 2s ease-in-out infinite;
        }
        
        @keyframes verbGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 171, 0, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(255, 171, 0, 0.2); }
        }
        
        .verb-glow {
            animation: verbGlow 2s ease-in-out infinite;
        }
        
        @keyframes adjectiveGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(170, 0, 255, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(170, 0, 255, 0.2); }
        }
        
        .adjective-glow {
            animation: adjectiveGlow 2s ease-in-out infinite;
        }
        
        @keyframes floatSymbol {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        
        .float-symbol {
            animation: floatSymbol 3s ease-in-out infinite;
        }
        
        @keyframes speechGlow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .speech-glow {
            animation: speechGlow 2s ease-in-out infinite;
        }
        
        @keyframes constructSentence {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .construct-sentence {
            animation: constructSentence 0.5s ease forwards;
        }
        
        @keyframes typeWord {
            0% { opacity: 0; transform: translateX(-20px); }
            100% { opacity: 1; transform: translateX(0); }
        }
        
        .type-word {
            animation: typeWord 0.5s ease forwards;
        }
        
        /* Word Bank Styles */
        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            background: var(--dark-card);
            border-radius: 8px;
        }
        
        .word-token {
            padding: 8px 15px;
            background: var(--dark-surface);
            border-radius: 20px;
            cursor: grab;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .word-token.noun {
            border-color: var(--secondary-teal);
            color: var(--secondary-teal);
        }
        
        .word-token.verb {
            border-color: var(--accent-amber);
            color: var(--accent-amber);
        }
        
        .word-token.adjective {
            border-color: var(--accent-purple);
            color: var(--accent-purple);
        }
        
        .word-token.adverb {
            border-color: var(--accent-pink);
            color: var(--accent-pink);
        }
        
        .word-token.pronoun {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }
        
        .word-token.preposition {
            border-color: var(--accent-orange);
            color: var(--accent-orange);
        }
        
        .word-token.conjunction {
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }
        
        .word-token.interjection {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }
        
        .word-token:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Sentence Builder Area */
        .sentence-builder {
            min-height: 150px;
            padding: 20px;
            background: var(--dark-surface);
            border-radius: 8px;
            border: 2px dashed var(--dark-border);
            margin: 20px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        
        .sentence-builder .word-token {
            cursor: default;
        }
        
        /* Color-coded Sentences */
        .color-coded-sentence {
            padding: 15px;
            margin: 15px 0;
            background: var(--dark-card);
            border-radius: 8px;
            border-left: 4px solid var(--accent-purple);
        }
        
        .color-coded-word {
            padding: 5px 10px;
            margin: 0 2px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .cc-noun {
            background: rgba(0, 191, 165, 0.2);
            color: var(--secondary-teal);
            border: 1px solid var(--secondary-teal);
        }
        
        .cc-verb {
            background: rgba(255, 171, 0, 0.2);
            color: var(--accent-amber);
            border: 1px solid var(--accent-amber);
        }
        
        .cc-adjective {
            background: rgba(170, 0, 255, 0.2);
            color: var(--accent-purple);
            border: 1px solid var(--accent-purple);
        }
        
        .cc-adverb {
            background: rgba(255, 64, 129, 0.2);
            color: var(--accent-pink);
            border: 1px solid var(--accent-pink);
        }
        
        .cc-pronoun {
            background: rgba(0, 200, 83, 0.2);
            color: var(--accent-green);
            border: 1px solid var(--accent-green);
        }
        
        .cc-preposition {
            background: rgba(255, 109, 0, 0.2);
            color: var(--accent-orange);
            border: 1px solid var(--accent-orange);
        }
        
        .cc-conjunction {
            background: rgba(0, 184, 212, 0.2);
            color: var(--accent-cyan);
            border: 1px solid var(--accent-cyan);
        }
        
        .cc-interjection {
            background: rgba(41, 98, 255, 0.2);
            color: var(--primary-blue);
            border: 1px solid var(--primary-blue);
        }
        
        /* Grammar Rules Display */
        .grammar-rule {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid;
        }
        
        .rule-noun { border-left-color: var(--secondary-teal); }
        .rule-verb { border-left-color: var(--accent-amber); }
        .rule-adjective { border-left-color: var(--accent-purple); }
        .rule-adverb { border-left-color: var(--accent-pink); }
        
        .rule-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .rule-noun .rule-title { color: var(--secondary-teal); }
        .rule-verb .rule-title { color: var(--accent-amber); }
        .rule-adjective .rule-title { color: var(--accent-purple); }
        .rule-adverb .rule-title { color: var(--accent-pink); }
    </style>
</head>
<body>
    <!-- Language Arts Pattern Background -->
    <div class="language-bg" id="languageBg">
        <!-- Letters will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 7 English - Parts of Speech (Deeper Study)</h1>
            <p class="welcome-subtitle">Master the building blocks of English grammar! Explore nouns, verbs, adjectives, adverbs, pronouns, prepositions, conjunctions, and interjections in depth. Learn to identify, use, and combine all eight parts of speech to create powerful, effective sentences!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üìö ‚úçÔ∏è üìù üî§ üìñ</span>
                <span class="topic-name">Advanced Grammar & Sentence Structure</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Grammar Journey</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 80</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1.25%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Language fact display -->
                <div id="languageFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Grammar Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Practice Again</button>
                <button class="btn btn-secondary" id="viewTopics">Other English Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const languageBg = document.getElementById('languageBg');
            
            // Create floating letters
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            
            for (let i = 0; i < 30; i++) {
                const letter = document.createElement('div');
                letter.className = 'floating-letters float-symbol';
                letter.textContent = letters[Math.floor(Math.random() * letters.length)];
                letter.style.left = `${Math.random() * 100}%`;
                letter.style.top = `${Math.random() * 100}%`;
                letter.style.animationDelay = `${Math.random() * 5}s`;
                letter.style.fontSize = `${2 + Math.random() * 4}rem`;
                
                // Color based on letter position
                const colors = [
                    'rgba(0, 191, 165, 0.1)',    // Teal
                    'rgba(255, 171, 0, 0.1)',    // Amber
                    'rgba(170, 0, 255, 0.1)',    // Purple
                    'rgba(255, 64, 129, 0.1)',   // Pink
                    'rgba(0, 200, 83, 0.1)',     // Green
                    'rgba(41, 98, 255, 0.1)'     // Blue
                ];
                letter.style.color = colors[Math.floor(Math.random() * colors.length)];
                
                languageBg.appendChild(letter);
            }
        }

        // Questions array - 80+ Grade 7 Parts of Speech Questions
        const questions = [
            // NOUNS (1-20)
            {
                type: "nouns",
                question: "What is a noun?",
                options: ["A person, place, thing, or idea", "An action word", "A describing word", "A word that replaces a noun"],
                answer: "A",
                explanation: "A noun is a word that names a person, place, thing, or idea. Examples: teacher, school, book, freedom."
            },
            {
                type: "nouns",
                question: "What is a proper noun?",
                options: ["Specific name of a person, place, or thing (capitalized)", "General name for things", "Plural form of noun", "Noun showing ownership"],
                answer: "A",
                explanation: "Proper nouns name specific people, places, or things and are always capitalized. Examples: John, Paris, Monday."
            },
            {
                type: "nouns",
                question: "What is a common noun?",
                options: ["General name for people, places, or things (not capitalized)", "Specific name capitalized", "Plural noun", "Noun showing possession"],
                answer: "A",
                explanation: "Common nouns are general names not capitalized. Examples: girl, city, day (vs. Mary, Paris, Monday)."
            },
            {
                type: "nouns",
                question: "What is an abstract noun?",
                options: ["Names an idea, quality, or state", "Names physical objects", "Names specific people", "Names places only"],
                answer: "A",
                explanation: "Abstract nouns name things you can't see or touch: ideas, qualities, states. Examples: love, courage, happiness."
            },
            {
                type: "nouns",
                question: "What is a concrete noun?",
                options: ["Names physical things you can perceive", "Names ideas only", "Names actions", "Names qualities"],
                answer: "A",
                explanation: "Concrete nouns name things you can see, hear, touch, taste, or smell. Examples: table, music, flower, chocolate."
            },
            {
                type: "nouns",
                question: "What is a collective noun?",
                options: ["Names a group of people or things", "Names one person or thing", "Names an idea", "Names a place"],
                answer: "A",
                explanation: "Collective nouns name groups. Examples: team, family, herd, flock, class."
            },
            {
                type: "nouns",
                question: "What is a compound noun?",
                options: ["Made of two or more words", "Single word noun", "Plural noun", "Possessive noun"],
                answer: "A",
                explanation: "Compound nouns combine words: football, notebook, swimming pool, mother-in-law."
            },
            {
                type: "nouns",
                question: "Identify the noun: 'The curious cat explored the mysterious garden.'",
                options: ["cat, garden", "curious, mysterious", "explored, the", "The, the"],
                answer: "A",
                explanation: "Nouns: cat (thing), garden (place). 'Curious' and 'mysterious' are adjectives describing the nouns."
            },
            {
                type: "nouns",
                question: "Which is a proper noun?",
                options: ["Mount Everest", "mountain", "tall", "climbed"],
                answer: "A",
                explanation: "'Mount Everest' is a specific mountain name (proper noun). 'Mountain' is common noun."
            },
            {
                type: "nouns",
                question: "Which is an abstract noun?",
                options: ["Justice", "Judge", "Courtroom", "Gavel"],
                answer: "A",
                explanation: "'Justice' is an abstract noun (idea). Others are concrete nouns (physical things)."
            },
            // VERBS (21-40)
            {
                type: "verbs",
                question: "What is a verb?",
                options: ["Word showing action or state of being", "Person, place, or thing", "Describing word", "Word replacing noun"],
                answer: "A",
                explanation: "Verbs show action (run, think) or state of being (is, seem, become)."
            },
            {
                type: "verbs",
                question: "What is an action verb?",
                options: ["Shows physical or mental action", "Shows state of being", "Helps main verb", "Links subject to complement"],
                answer: "A",
                explanation: "Action verbs show what subject does: physical (run, jump) or mental (think, believe)."
            },
            {
                type: "verbs",
                question: "What is a linking verb?",
                options: ["Connects subject to word describing it", "Shows action", "Helps another verb", "Shows time"],
                answer: "A",
                explanation: "Linking verbs connect subject to adjective/noun: is, seem, become, appear, feel (when not showing action)."
            },
            {
                type: "verbs",
                question: "What is a helping (auxiliary) verb?",
                options: ["Helps main verb show tense/mood", "Shows main action", "Links subject to complement", "Replaces noun"],
                answer: "A",
                explanation: "Helping verbs work with main verbs: is running, have eaten, will go, can see, might come."
            },
            {
                type: "verbs",
                question: "Identify the verb: 'The students quickly completed their challenging assignment.'",
                options: ["completed", "students, assignment", "quickly, challenging", "The, their"],
                answer: "A",
                explanation: "'Completed' is the action verb. 'Quickly' is adverb, 'challenging' is adjective."
            },
            {
                type: "verbs",
                question: "Which is a linking verb?",
                options: ["appears", "runs", "jumps", "writes"],
                answer: "A",
                explanation: "'Appears' can be linking (She appears happy). Others are action verbs."
            },
            {
                type: "verbs",
                question: "What are the helping verbs in: 'She has been studying for hours.'",
                options: ["has, been", "studying", "for, hours", "She, has"],
                answer: "A",
                explanation: "'Has' and 'been' are helping verbs; 'studying' is main verb."
            },
            {
                type: "verbs",
                question: "What is verb tense?",
                options: ["Shows time of action", "Shows who does action", "Shows action completed", "Shows mood"],
                answer: "A",
                explanation: "Verb tense shows when action happens: past (walked), present (walk), future (will walk)."
            },
            {
                type: "verbs",
                question: "What is verb conjugation?",
                options: ["Changing verb form for subject/time", "Making verb plural", "Adding -ing", "Making verb negative"],
                answer: "A",
                explanation: "Conjugation changes verb form: I walk, he walks, we walked, they will walk."
            },
            // ADJECTIVES (41-60)
            {
                type: "adjectives",
                question: "What is an adjective?",
                options: ["Describes or modifies noun/pronoun", "Shows action", "Replaces noun", "Connects words"],
                answer: "A",
                explanation: "Adjectives describe nouns/pronouns: tall building, red apple, three books, happy children."
            },
            {
                type: "adjectives",
                question: "What are the three degrees of adjectives?",
                options: ["Positive, comparative, superlative", "Past, present, future", "Singular, plural, possessive", "Active, passive, linking"],
                answer: "A",
                explanation: "Positive (tall), comparative (taller), superlative (tallest)."
            },
            {
                type: "adjectives",
                question: "Identify adjectives: 'The old wooden house had beautiful intricate carvings.'",
                options: ["old, wooden, beautiful, intricate", "house, carvings", "The, had", "The, had, beautiful"],
                answer: "A",
                explanation: "Adjectives: old (describes house), wooden (describes house), beautiful (describes carvings), intricate (describes carvings)."
            },
            {
                type: "adjectives",
                question: "Which are adjectives: 'five yellow buses'?",
                options: ["five, yellow", "buses", "five yellow", "yellow buses"],
                answer: "A",
                explanation: "'Five' (number adjective), 'yellow' (color adjective) describe 'buses' (noun)."
            },
            {
                type: "adjectives",
                question: "What is a proper adjective?",
                options: ["Derived from proper noun (capitalized)", "Regular describing word", "Comparative form", "Superlative form"],
                answer: "A",
                explanation: "Proper adjectives come from proper nouns: American (from America), Shakespearean (from Shakespeare)."
            },
            {
                type: "adjectives",
                question: "What are coordinate adjectives?",
                options: ["Equal adjectives separated by comma/and", "Adjectives at different positions", "Comparative adjectives", "Superlative adjectives"],
                answer: "A",
                explanation: "Coordinate adjectives equally modify same noun: 'The tall, handsome man' (both describe man equally)."
            },
            // ADVERBS (61-80)
            {
                type: "adverbs",
                question: "What is an adverb?",
                options: ["Modifies verb, adjective, or other adverb", "Describes noun", "Replaces noun", "Shows action"],
                answer: "A",
                explanation: "Adverbs modify verbs (run quickly), adjectives (very tall), or other adverbs (quite slowly)."
            },
            {
                type: "adverbs",
                question: "What do adverbs answer?",
                options: ["How, when, where, to what extent", "Who, what, which", "How many, what kind", "Whose, whom"],
                answer: "A",
                explanation: "Adverbs answer: How? (quickly), When? (yesterday), Where? (here), To what extent? (very)."
            },
            {
                type: "adverbs",
                question: "Identify adverbs: 'She spoke very softly during the meeting yesterday.'",
                options: ["very, softly, yesterday", "spoke, during, meeting", "She, the, the", "during, meeting, yesterday"],
                answer: "A",
                explanation: "'Very' modifies 'softly', 'softly' modifies 'spoke', 'yesterday' tells when."
            },
            {
                type: "adverbs",
                question: "Which is an adverb of manner?",
                options: ["carefully", "here", "now", "very"],
                answer: "A",
                explanation: "'Carefully' tells how something is done (manner). 'Here' is place, 'now' is time, 'very' is degree."
            },
            {
                type: "adverbs",
                question: "What is the adverb form of 'quick'?",
                options: ["quickly", "quicker", "quickest", "quickness"],
                answer: "A",
                explanation: "Most adverbs add -ly to adjectives: quick ‚Üí quickly, happy ‚Üí happily, careful ‚Üí carefully."
            },
            // PRONOUNS (81-100)
            {
                type: "pronouns",
                question: "What is a pronoun?",
                options: ["Word replacing noun/noun phrase", "Describing word", "Action word", "Connecting word"],
                answer: "A",
                explanation: "Pronouns replace nouns: he, she, it, they, we, you, I, me, him, her, them, us."
            },
            {
                type: "pronouns",
                question: "What is a personal pronoun?",
                options: ["Refers to specific person/thing", "Shows ownership", "Asks questions", "Points out"],
                answer: "A",
                explanation: "Personal pronouns: I, you, he, she, it, we, they (subject); me, you, him, her, it, us, them (object)."
            },
            {
                type: "pronouns",
                question: "What is a possessive pronoun?",
                options: ["Shows ownership (mine, yours)", "Replaces subject", "Asks questions", "Refers back"],
                answer: "A",
                explanation: "Possessive pronouns: mine, yours, his, hers, its, ours, theirs."
            },
            {
                type: "pronouns",
                question: "What is a reflexive pronoun?",
                options: ["Refers back to subject (-self)", "Shows ownership", "Asks questions", "Points out"],
                answer: "A",
                explanation: "Reflexive pronouns: myself, yourself, himself, herself, itself, ourselves, yourselves, themselves."
            },
            {
                type: "pronouns",
                question: "Identify pronouns: 'She gave her book to them, but they returned it to me.'",
                options: ["She, her, them, they, it, me", "gave, returned", "book, to", "but, to"],
                answer: "A",
                explanation: "Pronouns: She (subject), her (possessive), them (object), they (subject), it (object), me (object)."
            },
            // PREPOSITIONS (101-120)
            {
                type: "prepositions",
                question: "What is a preposition?",
                options: ["Shows relationship between words", "Replaces noun", "Shows action", "Describes noun"],
                answer: "A",
                explanation: "Prepositions show position/direction/time relationships: in, on, at, by, with, for, to, from, of, about."
            },
            {
                type: "prepositions",
                question: "What is a prepositional phrase?",
                options: ["Preposition + object + modifiers", "Just preposition", "Object only", "Modifiers only"],
                answer: "A",
                explanation: "Prepositional phrase = preposition + its object + any modifiers: in the house, with my friends, after the long meeting."
            },
            {
                type: "prepositions",
                question: "Identify preposition: 'The cat slept under the warm blanket during the storm.'",
                options: ["under, during", "slept, warm", "cat, blanket", "The, the"],
                answer: "A",
                explanation: "'Under' shows position, 'during' shows time relationship."
            },
            // CONJUNCTIONS (121-140)
            {
                type: "conjunctions",
                question: "What is a conjunction?",
                options: ["Connects words/phrases/clauses", "Replaces noun", "Shows action", "Describes noun"],
                answer: "A",
                explanation: "Conjunctions connect: and, but, or, nor, for, yet, so (coordinating); because, although, while (subordinating)."
            },
            {
                type: "conjunctions",
                question: "What are coordinating conjunctions?",
                options: ["FANBOYS: for, and, nor, but, or, yet, so", "because, although, while", "either/or, neither/nor", "both/and, not only/but also"],
                answer: "A",
                explanation: "Coordinating conjunctions (FANBOYS) connect equal elements: words, phrases, independent clauses."
            },
            {
                type: "conjunctions",
                question: "Identify conjunction: 'She wanted to go, but she was too tired.'",
                options: ["but", "wanted, was", "She, she", "to, too"],
                answer: "A",
                explanation: "'But' is coordinating conjunction connecting two independent clauses."
            },
            // INTERJECTIONS (141-160)
            {
                type: "interjections",
                question: "What is an interjection?",
                options: ["Word expressing emotion (often with !)", "Connecting word", "Replacing word", "Describing word"],
                answer: "A",
                explanation: "Interjections express emotion: Wow! Ouch! Hey! Oh! Well! Oops! Hooray!"
            },
            {
                type: "interjections",
                question: "Identify interjection: 'Oops! I dropped my phone.'",
                options: ["Oops", "I, my", "dropped, phone", "my, phone"],
                answer: "A",
                explanation: "'Oops' expresses surprise or mistake, followed by exclamation mark."
            },
            // MIXED/ADVANCED (161-180)
            {
                type: "mixed",
                question: "Identify all parts: 'The quick brown fox jumps over the lazy dog.'",
                options: ["The (article), quick (adj), brown (adj), fox (noun), jumps (verb), over (prep), the (article), lazy (adj), dog (noun)",
                         "All nouns", "All verbs", "All adjectives"],
                answer: "A",
                explanation: "Complete breakdown: Articles (The, the), Adjectives (quick, brown, lazy), Nouns (fox, dog), Verb (jumps), Preposition (over)."
            },
            {
                type: "mixed",
                question: "What part of speech is 'running' in 'Running is good exercise.'?",
                options: ["Gerund (verb form functioning as noun)", "Present participle", "Adjective", "Adverb"],
                answer: "A",
                explanation: "'Running' is a gerund - verb form ending in -ing functioning as noun (subject of sentence)."
            },
            {
                type: "mixed",
                question: "What is a participle?",
                options: ["Verb form functioning as adjective", "Noun form", "Adverb form", "Preposition form"],
                answer: "A",
                explanation: "Participles are verb forms used as adjectives: running water, broken glass, excited children."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent grammatical analysis!",
            "Perfect parts of speech identification!",
            "Great job with sentence structure!",
            "Amazing! You're a grammar champion!",
            "Perfect understanding of language mechanics!",
            "You're a future linguist or writer in the making!",
            "Outstanding language analysis skills!",
            "Brilliant grammatical reasoning!",
            "You think like a grammarian!",
            "Grammar mastery achieved!"
        ];

        // Parts of speech types
        const partsOfSpeech = [
            {
                name: "Nouns",
                description: "Naming words for people, places, things, ideas",
                examples: "teacher, school, book, freedom, team",
                characteristics: "Can be proper/common, concrete/abstract, singular/plural",
                icon: "üìö",
                color: "#00BFA5"
            },
            {
                name: "Verbs",
                description: "Action or state of being words",
                examples: "run, think, is, become, have been studying",
                characteristics: "Show tense, can be action/linking/helping",
                icon: "‚ö°",
                color: "#FFAB00"
            },
            {
                name: "Adjectives",
                description: "Describing words for nouns/pronouns",
                examples: "tall, red, three, beautiful, challenging",
                characteristics: "Can show degrees (comparative/superlative)",
                icon: "üé®",
                color: "#AA00FF"
            },
            {
                name: "Adverbs",
                description: "Modify verbs, adjectives, or other adverbs",
                examples: "quickly, very, here, yesterday, carefully",
                characteristics: "Often end in -ly, answer how/when/where/to what extent",
                icon: "üîç",
                color: "#FF4081"
            },
            {
                name: "Pronouns",
                description: "Words that replace nouns",
                examples: "he, she, they, we, it, me, him, her, them, us",
                characteristics: "Avoid repetition, show person/number/gender/case",
                icon: "üîÑ",
                color: "#00C853"
            },
            {
                name: "Prepositions",
                description: "Show relationships between words",
                examples: "in, on, at, by, with, for, to, from, of, about",
                characteristics: "Begin prepositional phrases, show position/time",
                icon: "üìç",
                color: "#FF6D00"
            },
            {
                name: "Conjunctions",
                description: "Connecting words",
                examples: "and, but, or, because, although, while",
                characteristics: "Connect words/phrases/clauses (coordinating/subordinating)",
                icon: "üîó",
                color: "#00B8D4"
            },
            {
                name: "Interjections",
                description: "Express emotion or surprise",
                examples: "Wow! Ouch! Hey! Oh! Well! Oops!",
                characteristics: "Often followed by exclamation mark, stand alone",
                icon: "üí•",
                color: "#2962FF"
            }
        ];

        // Noun types
        const nounTypes = [
            {
                type: "Proper Noun",
                definition: "Specific name (capitalized)",
                examples: "John, Paris, Monday, Mount Everest",
                usage: "Names particular people, places, things"
            },
            {
                type: "Common Noun",
                definition: "General name (not capitalized)",
                examples: "teacher, city, day, mountain",
                usage: "Names general categories"
            },
            {
                type: "Abstract Noun",
                definition: "Names ideas/qualities/states",
                examples: "love, courage, happiness, justice",
                usage: "Things you can't perceive with senses"
            },
            {
                type: "Concrete Noun",
                definition: "Names physical things",
                examples: "table, music, flower, chocolate",
                usage: "Things you can perceive with senses"
            },
            {
                type: "Collective Noun",
                definition: "Names a group",
                examples: "team, family, herd, flock, class",
                usage: "Refers to multiple entities as one unit"
            },
            {
                type: "Compound Noun",
                definition: "Made of multiple words",
                examples: "football, notebook, swimming pool, mother-in-law",
                usage: "Combined words functioning as single noun"
            }
        ];

        // Verb types
        const verbTypes = [
            {
                type: "Action Verb",
                definition: "Shows physical/mental action",
                examples: "run, jump, think, believe, create",
                usage: "Tells what subject does"
            },
            {
                type: "Linking Verb",
                definition: "Connects subject to description",
                examples: "is, seem, become, appear, feel",
                usage: "Shows state of being, not action"
            },
            {
                type: "Helping Verb",
                definition: "Helps main verb show tense/mood",
                examples: "am, is, are, was, were, have, has, had, will, can, could",
                usage: "Works with main verb in verb phrases"
            },
            {
                type: "Regular Verb",
                definition: "Forms past with -ed",
                examples: "walk ‚Üí walked, play ‚Üí played, talk ‚Üí talked",
                usage: "Follows standard conjugation pattern"
            },
            {
                type: "Irregular Verb",
                definition: "Doesn't follow -ed pattern",
                examples: "go ‚Üí went, see ‚Üí saw, eat ‚Üí ate, be ‚Üí was/were",
                usage: "Has unique past forms"
            }
        ];

        // Adjective types
        const adjectiveTypes = [
            {
                type: "Descriptive Adjective",
                definition: "Describes quality/characteristic",
                examples: "tall, beautiful, intelligent, fast",
                usage: "Most common type of adjective"
            },
            {
                type: "Proper Adjective",
                definition: "From proper noun (capitalized)",
                examples: "American, Shakespearean, Victorian, Buddhist",
                usage: "Derived from specific names"
            },
            {
                type: "Quantitative Adjective",
                definition: "Shows quantity/number",
                examples: "three, many, few, several, some",
                usage: "Tells how much/many"
            },
            {
                type: "Demonstrative Adjective",
                definition: "Points out specific nouns",
                examples: "this, that, these, those",
                usage: "Indicates which one(s)"
            },
            {
                type: "Possessive Adjective",
                definition: "Shows ownership/possession",
                examples: "my, your, his, her, its, our, their",
                usage: "Modifies noun to show who owns it"
            }
        ];

        // Language facts
        const languageFacts = [
            "There are approximately 170,000 words in current use in English!",
            "The word 'set' has the most definitions in English (over 430)!",
            "English borrows words from over 350 languages!",
            "The shortest complete sentence in English is 'I am.'!",
            "The word 'noun' comes from Latin 'nomen' meaning 'name'!",
            "Shakespeare invented over 1,700 words still used today!",
            "The most common English noun is 'time'!",
            "The word 'goodbye' comes from 'God be with you'!"
        ];

        // Grammar study concepts
        const grammarStudyConcepts = [
            {
                concept: "Sentence Patterns",
                description: "Understanding basic sentence structures",
                examples: "Subject + Verb, Subject + Verb + Object, Subject + Verb + Complement"
            },
            {
                concept: "Word Functions",
                description: "How words work in sentences",
                examples: "Subjects, predicates, objects, complements, modifiers"
            },
            {
                concept: "Agreement Rules",
                description: "Making words work together correctly",
                examples: "Subject-verb agreement, pronoun-antecedent agreement"
            },
            {
                concept: "Modifier Placement",
                description: "Proper positioning of descriptive words",
                examples: "Avoiding misplaced/dangling modifiers"
            }
        ];

        // Color-coded example sentences
        const colorCodedSentences = [
            {
                sentence: "The <span class='cc-adjective'>quick</span> <span class='cc-adjective'>brown</span> <span class='cc-noun'>fox</span> <span class='cc-verb'>jumps</span> <span class='cc-preposition'>over</span> the <span class='cc-adjective'>lazy</span> <span class='cc-noun'>dog</span>.",
                analysis: "Articles: The, the | Adjectives: quick, brown, lazy | Nouns: fox, dog | Verb: jumps | Preposition: over"
            },
            {
                sentence: "<span class='cc-pronoun'>She</span> <span class='cc-adverb'>quickly</span> <span class='cc-verb'>finished</span> <span class='cc-pronoun'>her</span> <span class='cc-adjective'>difficult</span> <span class='cc-noun'>homework</span> <span class='cc-preposition'>before</span> <span class='cc-noun'>dinner</span>.",
                analysis: "Pronoun: She, her | Adverb: quickly | Verb: finished | Adjective: difficult | Nouns: homework, dinner | Preposition: before"
            },
            {
                sentence: "<span class='cc-interjection'>Wow</span>! <span class='cc-pronoun'>You</span> <span class='cc-verb'>have</span> <span class='cc-adverb'>truly</span> <span class='cc-verb'>mastered</span> <span class='cc-adjective'>these</span> <span class='cc-adjective'>complex</span> <span class='cc-noun'>concepts</span>!",
                analysis: "Interjection: Wow | Pronoun: You | Verbs: have, mastered | Adverb: truly | Adjectives: these, complex | Noun: concepts"
            }
        ];

        // Grammar rules
        const grammarRules = [
            {
                rule: "Subject-Verb Agreement",
                description: "Verb must agree with subject in number",
                example: "Singular: The dog runs. Plural: The dogs run.",
                tip: "Ignore words between subject and verb"
            },
            {
                rule: "Pronoun-Antecedent Agreement",
                description: "Pronoun must agree with its antecedent",
                example: "Each student must bring his or her book.",
                tip: "Singular antecedents need singular pronouns"
            },
            {
                rule: "Adjective Order",
                description: "Multiple adjectives follow specific order",
                example: "Opinion-size-age-shape-color-origin-material-purpose",
                tip: "A lovely little old rectangular green French silver whittling knife"
            },
            {
                rule: "Comma with Coordinate Adjectives",
                description: "Use commas between equal adjectives",
                example: "The tall, handsome man (comma) vs. The old wooden house (no comma)",
                tip: "If you can say 'and' between them, use comma"
            }
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const languageFact = document.getElementById('languageFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade7PartsOfSpeech');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade7PartsOfSpeech', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade7PartsOfSpeech_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a grammar expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent grammar skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing your grammar analysis!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review parts of speech and try again!";
            } else {
                scoreMessage.textContent = "Keep learning! Grammar builds communication skills for life!";
            }
        }

        // Create language fact display
        function createLanguageFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'language-fact';
            
            factDiv.innerHTML = `<strong>Interesting Language Fact:</strong> ${languageFacts[Math.floor(Math.random() * languageFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "nouns": "üìö",
                "verbs": "‚ö°",
                "adjectives": "üé®",
                "adverbs": "üîç",
                "pronouns": "üîÑ",
                "prepositions": "üìç",
                "conjunctions": "üîó",
                "interjections": "üí•",
                "mixed": "üß©"
            };
            
            let conceptName = "Nouns";
            let conceptIcon = "üìö";
            
            if (question.type.includes("nouns")) {
                conceptName = "Nouns";
                conceptIcon = conceptIcons.nouns;
            } else if (question.type.includes("verbs")) {
                conceptName = "Verbs";
                conceptIcon = conceptIcons.verbs;
            } else if (question.type.includes("adjectives")) {
                conceptName = "Adjectives";
                conceptIcon = conceptIcons.adjectives;
            } else if (question.type.includes("adverbs")) {
                conceptName = "Adverbs";
                conceptIcon = conceptIcons.adverbs;
            } else if (question.type.includes("pronouns")) {
                conceptName = "Pronouns";
                conceptIcon = conceptIcons.pronouns;
            } else if (question.type.includes("prepositions")) {
                conceptName = "Prepositions";
                conceptIcon = conceptIcons.prepositions;
            } else if (question.type.includes("conjunctions")) {
                conceptName = "Conjunctions";
                conceptIcon = conceptIcons.conjunctions;
            } else if (question.type.includes("interjections")) {
                conceptName = "Interjections";
                conceptIcon = conceptIcons.interjections;
            } else if (question.type.includes("mixed")) {
                conceptName = "Mixed Analysis";
                conceptIcon = conceptIcons.mixed;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("nouns")) {
                label.textContent = "Naming words: people, places, things, ideas - proper, common, abstract, concrete";
            } else if (question.type.includes("verbs")) {
                label.textContent = "Action/state words: action, linking, helping verbs - tense, conjugation";
            } else if (question.type.includes("adjectives")) {
                label.textContent = "Describing words: modify nouns/pronouns - comparative, superlative degrees";
            } else if (question.type.includes("adverbs")) {
                label.textContent = "Modifying words: modify verbs/adjectives/adverbs - how/when/where/to what extent";
            } else if (question.type.includes("pronouns")) {
                label.textContent = "Replacing words: stand in for nouns - personal, possessive, reflexive types";
            } else if (question.type.includes("prepositions")) {
                label.textContent = "Relationship words: show position/time - begin prepositional phrases";
            } else if (question.type.includes("conjunctions")) {
                label.textContent = "Connecting words: join words/phrases/clauses - coordinating, subordinating";
            } else if (question.type.includes("interjections")) {
                label.textContent = "Emotional words: express feeling/surprise - often with exclamation marks";
            } else if (question.type.includes("mixed")) {
                label.textContent = "Complete analysis: identifying all parts of speech in sentences";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create parts of speech visualization
        function createSpeechVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const currentQuestion = appState.currentQuestions[appState.currentQuestionIndex];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-blue);">Parts of Speech Explorer</h3>
                
                <div class="speech-display">
                    <div class="display-title">Current Grammar Concept</div>
                    <div class="speech-container">
                        <div class="speech-scenario">${currentQuestion.question}</div>
                        <div class="speech-highlight">
                            <strong>Key Concept:</strong> <span class="highlight-text">${getSpeechConcept(currentQuestion.type)}</span>
                        </div>
                    </div>
                </div>
                
                <!-- Interactive Sentence Builder -->
                <div class="sentence-canvas">
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 1.5rem; margin-bottom: 20px; color: var(--secondary-teal);">Interactive Sentence Builder</div>
                        
                        <!-- Word Bank -->
                        <div class="word-bank">
                            <div class="word-token noun" draggable="true" onclick="addWordToSentence('The', 'noun')">The</div>
                            <div class="word-token adjective" draggable="true" onclick="addWordToSentence('quick', 'adjective')">quick</div>
                            <div class="word-token noun" draggable="true" onclick="addWordToSentence('fox', 'noun')">fox</div>
                            <div class="word-token verb" draggable="true" onclick="addWordToSentence('jumps', 'verb')">jumps</div>
                            <div class="word-token preposition" draggable="true" onclick="addWordToSentence('over', 'preposition')">over</div>
                            <div class="word-token adjective" draggable="true" onclick="addWordToSentence('lazy', 'adjective')">lazy</div>
                            <div class="word-token noun" draggable="true" onclick="addWordToSentence('dog', 'noun')">dog</div>
                            <div class="word-token adverb" draggable="true" onclick="addWordToSentence('quickly', 'adverb')">quickly</div>
                            <div class="word-token conjunction" draggable="true" onclick="addWordToSentence('and', 'conjunction')">and</div>
                            <div class="word-token interjection" draggable="true" onclick="addWordToSentence('Wow', 'interjection')">Wow!</div>
                        </div>
                        
                        <!-- Sentence Builder Area -->
                        <div class="sentence-builder" id="sentenceBuilder">
                            <div style="color: var(--text-muted); font-style: italic;">Drag words here to build a sentence...</div>
                        </div>
                        
                        <!-- Controls -->
                        <div style="margin-top: 15px;">
                            <button class="canvas-btn" onclick="clearSentenceBuilder()">Clear</button>
                            <button class="canvas-btn" onclick="analyzeSentence()">Analyze</button>
                            <button class="canvas-btn" onclick="getRandomSentence()">Random Sentence</button>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-bottom: 20px; color: var(--text-secondary); font-size: 0.9rem;">
                    Interactive Grammar Builder - Drag words to create sentences and analyze their parts!
                </div>
                
                <div class="speech-grid">
                    ${partsOfSpeech.map(part => `
                        <div class="speech-card ${part.name.toLowerCase()} ${part.name.toLowerCase()}-glow" style="border-color: ${part.color}" onclick="showPartDemo('${part.name}')">
                            <div class="speech-icon speech-glow" style="color: ${part.color}">${part.icon}</div>
                            <div class="speech-title" style="color: ${part.color}">${part.name}</div>
                            <div class="speech-description">${part.description}</div>
                            <div class="speech-examples">
                                <strong>Examples:</strong> ${part.examples}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <!-- Color-coded Sentences -->
                <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <div class="display-title">Color-coded Sentence Analysis</div>
                    ${colorCodedSentences.map((sentence, index) => `
                        <div class="color-coded-sentence" style="animation-delay: ${index * 0.2}s">
                            <div style="font-size: 1.1rem; margin-bottom: 10px;">${sentence.sentence}</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary);">
                                <strong>Analysis:</strong> ${sentence.analysis}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <table class="speech-table">
                    <thead>
                        <tr>
                            <th>Part of Speech</th>
                            <th>Function</th>
                            <th>Questions Answered</th>
                            <th>Examples</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${partsOfSpeech.slice(0, 4).map(part => `
                            <tr>
                                <td style="font-weight: bold; color: ${part.color};">${part.name}</td>
                                <td>${part.description}</td>
                                <td>${getQuestionsForPart(part.name)}</td>
                                <td style="font-style: italic;">${part.examples.split(',')[0]}...</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
                
                <div class="noun-container noun-glow">
                    <div class="noun-title">Noun Types & Examples</div>
                    <div class="noun-grid">
                        ${nounTypes.map(noun => `
                            <div class="noun-card">
                                <div class="noun-icon">üìö</div>
                                <div class="noun-type">${noun.type}</div>
                                <div class="noun-steps">
                                    <strong>Definition:</strong> ${noun.definition}<br>
                                    <strong>Examples:</strong> ${noun.examples}<br>
                                    <strong>Usage:</strong> ${noun.usage}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="verb-container verb-glow">
                    <div class="verb-title">Verb Types & Examples</div>
                    <div class="verb-grid">
                        ${verbTypes.slice(0, 4).map(verb => `
                            <div class="verb-card">
                                <div class="verb-icon">‚ö°</div>
                                <div class="verb-type">${verb.type}</div>
                                <div class="verb-steps">
                                    <strong>Definition:</strong> ${verb.definition}<br>
                                    <strong>Examples:</strong> ${verb.examples}<br>
                                    <strong>Usage:</strong> ${verb.usage}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="adjective-container adjective-glow">
                    <div class="adjective-title">Adjective Types & Examples</div>
                    <div class="adjective-grid">
                        ${adjectiveTypes.slice(0, 4).map(adj => `
                            <div class="adjective-card">
                                <div class="adjective-icon">üé®</div>
                                <div class="adjective-type">${adj.type}</div>
                                <div class="adjective-steps">
                                    <strong>Definition:</strong> ${adj.definition}<br>
                                    <strong>Examples:</strong> ${adj.examples}<br>
                                    <strong>Usage:</strong> ${adj.usage}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <!-- Grammar Rules -->
                <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid var(--accent-green);">
                    <div style="color: var(--accent-green); font-weight: bold; margin-bottom: 15px; text-align: center; font-size: 1.3rem;">Important Grammar Rules</div>
                    ${grammarRules.map((rule, index) => `
                        <div class="grammar-rule rule-${rule.rule.toLowerCase().split(' ')[0]}" style="animation-delay: ${index * 0.1}s">
                            <div class="rule-title">${rule.rule}</div>
                            <div style="color: var(--text-secondary); margin-bottom: 5px;">${rule.description}</div>
                            <div style="background: var(--dark-surface); padding: 8px; border-radius: 4px; margin: 5px 0;">
                                <strong>Example:</strong> ${rule.example}
                            </div>
                            <div style="font-size: 0.9rem; color: var(--accent-amber);">
                                <strong>Tip:</strong> ${rule.tip}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="builder-container">
                    <div class="builder-title">Interactive Grammar Analyzer</div>
                    <div class="builder-controls">
                        <textarea class="builder-input" id="sentenceInput" placeholder="Type or paste a sentence here to analyze its parts of speech... Example: 'The quick brown fox jumps over the lazy dog.'"></textarea>
                        <div class="builder-buttons">
                            <button class="builder-btn" onclick="analyzeInputSentence()">Analyze Sentence</button>
                            <button class="builder-btn" onclick="getGrammarChallenge()">Get Challenge</button>
                            <button class="builder-btn" onclick="clearGrammarAnalyzer()">Clear</button>
                        </div>
                    </div>
                    <div class="builder-display" id="builderDisplay">
                        Your sentence analysis will appear here...
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-purple);">
                    <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px;">Quick Parts of Speech Guide:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Noun:</strong> Person, place, thing, idea (answers: Who? What?)<br>
                        <strong>Verb:</strong> Action or state of being (answers: What is happening?)<br>
                        <strong>Adjective:</strong> Describes noun/pronoun (answers: What kind? Which one? How many?)<br>
                        <strong>Adverb:</strong> Modifies verb/adjective/adverb (answers: How? When? Where? To what extent?)<br>
                        <strong>Pronoun:</strong> Replaces noun (I, you, he, she, it, we, they, etc.)<br>
                        <strong>Preposition:</strong> Shows relationship (in, on, at, by, with, etc.)<br>
                        <strong>Conjunction:</strong> Connects words/phrases/clauses (and, but, or, because, etc.)<br>
                        <strong>Interjection:</strong> Expresses emotion (Wow! Ouch! Hey! etc.)
                    </div>
                </div>
                
                <div class="grammar-study-container">
                    <div class="display-title">Grammar Study Strategies</div>
                    <div class="grammar-study-grid">
                        ${grammarStudyConcepts.map(concept => `
                            <div class="study-card">
                                <div class="study-icon">üìö</div>
                                <div class="study-concept">${concept.concept}</div>
                                <div class="study-description">
                                    <strong>Description:</strong> ${concept.description}<br>
                                    <strong>Examples:</strong> ${concept.examples}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="solution-container">
                    <div class="display-title">Step-by-Step Learning Path</div>
                    <div class="solution-steps" id="solutionSteps">
                        ${generateLearningPath(currentQuestion)}
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--secondary-teal);">
                    <div style="color: var(--secondary-teal); font-weight: bold; margin-bottom: 10px; text-align: center;">Grammar Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Read Aloud:</strong> Hearing sentences helps identify parts of speech<br>
                        <strong>Ask Questions:</strong> Who/What? (noun), What's happening? (verb), What kind? (adjective)<br>
                        <strong>Look for Patterns:</strong> Nouns often follow articles (a, an, the)<br>
                        <strong>Check Endings:</strong> Many adverbs end in -ly<br>
                        <strong>Practice Daily:</strong> Analyze sentences from books, articles, conversations<br>
                        <em>Mastering parts of speech builds foundation for effective writing, reading comprehension, and communication!</em>
                    </div>
                </div>
            `;
            
            // Initialize drag and drop for word tokens
            setTimeout(() => {
                initializeDragAndDrop();
            }, 100);
            
            return vizDiv;
        }

        // Helper functions
        function getSpeechConcept(typeString) {
            const conceptMap = {
                "nouns": "Nouns - Naming words: people, places, things, ideas (proper, common, abstract, concrete)",
                "verbs": "Verbs - Action/state words: show what happens or state of being (action, linking, helping)",
                "adjectives": "Adjectives - Describing words: modify nouns/pronouns (comparative, superlative degrees)",
                "adverbs": "Adverbs - Modifying words: modify verbs/adjectives/adverbs (how, when, where, to what extent)",
                "pronouns": "Pronouns - Replacing words: stand in for nouns (personal, possessive, reflexive)",
                "prepositions": "Prepositions - Relationship words: show position/time (begin prepositional phrases)",
                "conjunctions": "Conjunctions - Connecting words: join words/phrases/clauses (coordinating, subordinating)",
                "interjections": "Interjections - Emotional words: express feeling/surprise (often with exclamation marks)",
                "mixed": "Mixed Analysis - Complete sentence analysis: identifying all parts of speech"
            };
            
            return conceptMap[typeString] || "Parts of Speech";
        }

        function getQuestionsForPart(partName) {
            const questionMap = {
                "Nouns": "Who? What?",
                "Verbs": "What is happening? What is?",
                "Adjectives": "What kind? Which one? How many?",
                "Adverbs": "How? When? Where? To what extent?",
                "Pronouns": "Replaces which noun?",
                "Prepositions": "Shows what relationship?",
                "Conjunctions": "What does it connect?",
                "Interjections": "What emotion does it express?"
            };
            return questionMap[partName] || "Varies";
        }

        function generateLearningPath(question) {
            let steps = [];
            
            if (question.type.includes("nouns")) {
                steps = [
                    "Step 1: Identify what is being named in the sentence",
                    "Step 2: Determine if it's a person, place, thing, or idea",
                    "Step 3: Check if it's proper (capitalized) or common",
                    "Step 4: Determine if it's concrete (physical) or abstract (idea)",
                    "Step 5: Verify if it's singular or plural, possessive or not"
                ];
            } else if (question.type.includes("verbs")) {
                steps = [
                    "Step 1: Identify the action or state in the sentence",
                    "Step 2: Determine if it's an action verb or linking verb",
                    "Step 3: Check for helping verbs in verb phrases",
                    "Step 4: Identify the tense (past, present, future)",
                    "Step 5: Verify subject-verb agreement"
                ];
            } else if (question.type.includes("adjectives")) {
                steps = [
                    "Step 1: Find words that describe nouns or pronouns",
                    "Step 2: Determine what question they answer (What kind? Which one? How many?)",
                    "Step 3: Check for comparative (-er) or superlative (-est) forms",
                    "Step 4: Identify proper adjectives (capitalized from proper nouns)",
                    "Step 5: Look for coordinate adjectives (separated by commas)"
                ];
            } else {
                steps = [
                    "Step 1: Read the sentence carefully",
                    "Step 2: Identify the part of speech being tested",
                    "Step 3: Recall the definition and function of that part",
                    "Step 4: Apply the rules to the specific example",
                    "Step 5: Verify your answer matches the grammatical function"
                ];
            }
            
            return steps.map((step, index) => `
                <div class="speech-step speech-reveal" style="animation-delay: ${index * 0.1}s">
                    <span class="step-number">${index + 1}</span>
                    <span class="step-description">${step}</span>
                    ${index === steps.length - 1 ? `
                        <div style="margin-top: 10px; padding: 10px; background: rgba(170, 0, 255, 0.05); border-radius: 6px;">
                            <strong>Correct Answer:</strong> ${question.options[question.answer.charCodeAt(0) - 65]}
                        </div>
                        <div style="margin-top: 10px; font-style: italic; color: var(--text-secondary);">
                            ${question.explanation}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Interactive functions
        function initializeDragAndDrop() {
            const wordTokens = document.querySelectorAll('.word-token');
            const sentenceBuilder = document.getElementById('sentenceBuilder');
            
            if (!sentenceBuilder) return;
            
            wordTokens.forEach(token => {
                token.addEventListener('dragstart', handleDragStart);
                token.addEventListener('click', function() {
                    addWordToSentence(this.textContent.replace('!', ''), this.className.includes('noun') ? 'noun' : 
                                                                           this.className.includes('verb') ? 'verb' :
                                                                           this.className.includes('adjective') ? 'adjective' :
                                                                           this.className.includes('adverb') ? 'adverb' :
                                                                           this.className.includes('pronoun') ? 'pronoun' :
                                                                           this.className.includes('preposition') ? 'preposition' :
                                                                           this.className.includes('conjunction') ? 'conjunction' :
                                                                           this.className.includes('interjection') ? 'interjection' : 'noun');
                });
            });
            
            sentenceBuilder.addEventListener('dragover', handleDragOver);
            sentenceBuilder.addEventListener('drop', handleDrop);
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.textContent);
            e.dataTransfer.setData('type', e.target.className.includes('noun') ? 'noun' : 
                                          e.target.className.includes('verb') ? 'verb' :
                                          e.target.className.includes('adjective') ? 'adjective' :
                                          e.target.className.includes('adverb') ? 'adverb' :
                                          e.target.className.includes('pronoun') ? 'pronoun' :
                                          e.target.className.includes('preposition') ? 'preposition' :
                                          e.target.className.includes('conjunction') ? 'conjunction' :
                                          e.target.className.includes('interjection') ? 'interjection' : 'noun');
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
            const text = e.dataTransfer.getData('text/plain');
            const type = e.dataTransfer.getData('type');
            addWordToSentence(text, type);
        }

        window.addWordToSentence = function(word, type) {
            const sentenceBuilder = document.getElementById('sentenceBuilder');
            if (!sentenceBuilder) return;
            
            // Remove placeholder text if present
            if (sentenceBuilder.children.length === 1 && sentenceBuilder.children[0].style.fontStyle === 'italic') {
                sentenceBuilder.innerHTML = '';
            }
            
            const wordElement = document.createElement('div');
            wordElement.className = `word-token ${type}`;
            wordElement.textContent = word;
            wordElement.style.animation = 'constructSentence 0.5s ease forwards';
            
            sentenceBuilder.appendChild(wordElement);
        };

        window.clearSentenceBuilder = function() {
            const sentenceBuilder = document.getElementById('sentenceBuilder');
            if (sentenceBuilder) {
                sentenceBuilder.innerHTML = '<div style="color: var(--text-muted); font-style: italic;">Drag words here to build a sentence...</div>';
            }
        };

        window.analyzeSentence = function() {
            const sentenceBuilder = document.getElementById('sentenceBuilder');
            const builderDisplay = document.getElementById('builderDisplay');
            
            if (!sentenceBuilder || !builderDisplay) return;
            
            const words = Array.from(sentenceBuilder.querySelectorAll('.word-token'));
            
            if (words.length === 0) {
                builderDisplay.innerHTML = "Please build a sentence first by dragging words into the builder area.";
                return;
            }
            
            const sentence = words.map(w => w.textContent).join(' ');
            const analysis = words.map((word, index) => {
                const type = word.className.includes('noun') ? 'Noun' :
                            word.className.includes('verb') ? 'Verb' :
                            word.className.includes('adjective') ? 'Adjective' :
                            word.className.includes('adverb') ? 'Adverb' :
                            word.className.includes('pronoun') ? 'Pronoun' :
                            word.className.includes('preposition') ? 'Preposition' :
                            word.className.includes('conjunction') ? 'Conjunction' :
                            word.className.includes('interjection') ? 'Interjection' : 'Unknown';
                
                const color = type === 'Noun' ? '#00BFA5' :
                             type === 'Verb' ? '#FFAB00' :
                             type === 'Adjective' ? '#AA00FF' :
                             type === 'Adverb' ? '#FF4081' :
                             type === 'Pronoun' ? '#00C853' :
                             type === 'Preposition' ? '#FF6D00' :
                             type === 'Conjunction' ? '#00B8D4' :
                             type === 'Interjection' ? '#2962FF' : '#FFFFFF';
                
                return `
                    <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: var(--dark-surface); border-radius: 6px; margin: 5px 0;">
                        <div style="width: 20px; height: 20px; border-radius: 50%; background: ${color};"></div>
                        <div style="font-weight: bold; color: ${color};">${word.textContent}</div>
                        <div style="margin-left: auto; color: var(--text-secondary);">${type}</div>
                    </div>
                `;
            }).join('');
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Sentence Analysis</div>
                    
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid var(--accent-purple);">
                        <div style="font-size: 1.2rem; font-weight: bold; margin-bottom: 10px;">Your Sentence:</div>
                        <div style="font-size: 1.1rem;">"${sentence}"</div>
                    </div>
                    
                    <div style="text-align: left; margin-top: 20px;">
                        <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px;">Parts of Speech Breakdown:</div>
                        ${analysis}
                    </div>
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Tip:</strong> A complete sentence typically needs at least a subject (noun/pronoun) and a predicate (verb).
                    </div>
                </div>
            `;
        };

        window.getRandomSentence = function() {
            const sentences = [
                "The quick brown fox jumps over the lazy dog.",
                "She quickly finished her difficult homework before dinner.",
                "Wow! You have truly mastered these complex concepts!",
                "My friends and I will visit the museum tomorrow.",
                "Because it was raining, we decided to stay indoors.",
                "The beautiful flowers in the garden smell wonderful.",
                "He carefully placed the fragile vase on the table.",
                "Oh no! I forgot to bring my books to school!"
            ];
            
            const randomSentence = sentences[Math.floor(Math.random() * sentences.length)];
            const sentenceInput = document.getElementById('sentenceInput');
            if (sentenceInput) {
                sentenceInput.value = randomSentence;
            }
        };

        // Grammar analyzer functions
        window.analyzeInputSentence = function() {
            const sentenceInput = document.getElementById('sentenceInput');
            const builderDisplay = document.getElementById('builderDisplay');
            
            if (!sentenceInput || !builderDisplay) return;
            
            const sentence = sentenceInput.value.trim();
            
            if (!sentence) {
                builderDisplay.innerHTML = "Please enter a sentence to analyze.";
                return;
            }
            
            // Simple parts of speech analysis (simplified for demo)
            const words = sentence.split(' ');
            const analysis = analyzeWords(words);
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Sentence Analysis</div>
                    
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid var(--accent-purple);">
                        <div style="font-size: 1.2rem; font-weight: bold; margin-bottom: 10px;">Your Sentence:</div>
                        <div style="font-size: 1.1rem;">"${sentence}"</div>
                    </div>
                    
                    <div style="text-align: left; margin-top: 20px;">
                        <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px;">Parts of Speech Breakdown:</div>
                        ${analysis.map((word, index) => `
                            <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: var(--dark-surface); border-radius: 6px; margin: 5px 0; animation: typeWord 0.5s ease ${index * 0.1}s forwards; opacity: 0;">
                                <div style="width: 20px; height: 20px; border-radius: 50%; background: ${word.color};"></div>
                                <div style="font-weight: bold; color: ${word.color};">${word.text}</div>
                                <div style="margin-left: auto; color: var(--text-secondary);">${word.type}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Remember:</strong> This is a simplified analysis. Context determines parts of speech!
                    </div>
                </div>
            `;
        };

        function analyzeWords(words) {
            const articles = ['the', 'a', 'an'];
            const commonPrepositions = ['in', 'on', 'at', 'by', 'with', 'for', 'to', 'from', 'of', 'about', 'over', 'under', 'between', 'through'];
            const commonConjunctions = ['and', 'but', 'or', 'because', 'although', 'while', 'if', 'when'];
            const commonPronouns = ['i', 'you', 'he', 'she', 'it', 'we', 'they', 'me', 'him', 'her', 'us', 'them', 'my', 'your', 'his', 'her', 'its', 'our', 'their'];
            const commonInterjections = ['wow', 'ouch', 'hey', 'oh', 'well', 'oops', 'hooray', 'yikes'];
            
            return words.map(word => {
                const cleanWord = word.toLowerCase().replace(/[.,!?;:]/g, '');
                let type = 'Noun'; // Default
                let color = '#00BFA5';
                
                // Very basic analysis (real implementation would be more sophisticated)
                if (articles.includes(cleanWord)) {
                    type = 'Article';
                    color = '#7A94A8';
                } else if (commonPrepositions.includes(cleanWord)) {
                    type = 'Preposition';
                    color = '#FF6D00';
                } else if (commonConjunctions.includes(cleanWord)) {
                    type = 'Conjunction';
                    color = '#00B8D4';
                } else if (commonPronouns.includes(cleanWord)) {
                    type = 'Pronoun';
                    color = '#00C853';
                } else if (commonInterjections.includes(cleanWord)) {
                    type = 'Interjection';
                    color = '#2962FF';
                } else if (word.endsWith('ly') && word.length > 2) {
                    type = 'Adverb';
                    color = '#FF4081';
                } else if (word.endsWith('ing') && word.length > 3) {
                    type = 'Verb (Gerund/Present Participle)';
                    color = '#FFAB00';
                } else if (word.endsWith('ed') && word.length > 2) {
                    type = 'Verb (Past Tense)';
                    color = '#FFAB00';
                } else if (['is', 'am', 'are', 'was', 'were', 'be', 'been', 'being'].includes(cleanWord)) {
                    type = 'Verb (Linking)';
                    color = '#FFAB00';
                } else if (['have', 'has', 'had', 'do', 'does', 'did', 'will', 'would', 'can', 'could', 'may', 'might', 'must', 'should'].includes(cleanWord)) {
                    type = 'Verb (Helping)';
                    color = '#FFAB00';
                } else if (cleanWord.length > 0) {
                    // Check if it's likely an adjective (ends with common adjective endings)
                    const adjEndings = ['able', 'ible', 'al', 'ful', 'ic', 'ive', 'less', 'ous', 'y'];
                    if (adjEndings.some(ending => cleanWord.endsWith(ending))) {
                        type = 'Adjective';
                        color = '#AA00FF';
                    }
                }
                
                return {
                    text: word,
                    type: type,
                    color: color
                };
            });
        }

        window.getGrammarChallenge = function() {
            const sentenceInput = document.getElementById('sentenceInput');
            
            if (!sentenceInput) return;
            
            const challenges = [
                "Identify all nouns in: 'The curious children explored the ancient castle.'",
                "Find the verbs in: 'She has been studying diligently for her exams.'",
                "List adjectives in: 'The tall, ancient oak tree provided cool, refreshing shade.'",
                "Identify adverbs in: 'He quickly and quietly completed the task yesterday.'",
                "Find pronouns in: 'They gave their presentation to us, and we appreciated it.'",
                "Identify prepositions in: 'The book on the shelf between the vases is mine.'",
                "Find conjunctions in: 'I wanted to go, but I was tired, so I stayed home.'",
                "Identify interjections in: 'Wow! That was amazing! Oh, I wish I could do that!'"
            ];
            
            const randomChallenge = challenges[Math.floor(Math.random() * challenges.length)];
            sentenceInput.value = randomChallenge;
            sentenceInput.focus();
        };

        window.clearGrammarAnalyzer = function() {
            const sentenceInput = document.getElementById('sentenceInput');
            const builderDisplay = document.getElementById('builderDisplay');
            
            if (sentenceInput) sentenceInput.value = '';
            if (builderDisplay) {
                builderDisplay.innerHTML = "Your sentence analysis will appear here...";
            }
        };

        window.showPartDemo = function(partName) {
            const builderDisplay = document.getElementById('builderDisplay');
            
            const part = partsOfSpeech.find(p => p.name === partName);
            if (!part || !builderDisplay) return;
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; color: ${part.color}; margin-bottom: 15px;">
                        ${part.icon} ${part.name} Details
                    </div>
                    
                    <div style="background: rgba(${parseInt(part.color.slice(1,3), 16)}, ${parseInt(part.color.slice(3,5), 16)}, ${parseInt(part.color.slice(5,7), 16)}, 0.1); padding: 20px; border-radius: 8px; margin: 15px 0; border: 2px solid ${part.color};">
                        <div style="font-weight: bold; margin-bottom: 10px; color: ${part.color};">Definition:</div>
                        <div style="margin-bottom: 15px;">${part.description}</div>
                        
                        <div style="font-weight: bold; margin-bottom: 10px; color: ${part.color};">Key Characteristics:</div>
                        <div style="margin-bottom: 15px;">${part.characteristics}</div>
                        
                        <div style="font-weight: bold; margin-bottom: 10px; color: ${part.color};">Examples:</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                            ${part.examples.split(', ').map(example => `
                                <div style="padding: 8px 12px; background: var(--dark-surface); border-radius: 20px; border: 1px solid ${part.color}; color: ${part.color};">
                                    ${example}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Tip:</strong> ${getPartTip(partName)}
                    </div>
                </div>
            `;
        };

        function getPartTip(partName) {
            const tips = {
                "Nouns": "Look for words that answer 'Who?' or 'What?'",
                "Verbs": "Look for words that show action or state of being",
                "Adjectives": "Look for words that describe nouns (answer 'What kind?')",
                "Adverbs": "Look for words ending in -ly that describe verbs",
                "Pronouns": "Look for words that replace nouns (I, you, he, she, etc.)",
                "Prepositions": "Look for small words showing position (in, on, at)",
                "Conjunctions": "Look for connecting words (and, but, because)",
                "Interjections": "Look for emotional words often with exclamation marks"
            };
            return tips[partName] || "Practice identifying this part in sentences you read daily.";
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            languageFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            languageFact.appendChild(createLanguageFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createSpeechVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin your grammar journey!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
