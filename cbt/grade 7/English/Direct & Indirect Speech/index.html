<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 7 English - Direct & Indirect Speech | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Speech Theme */
        :root {
            --primary-blue: #2962FF;
            --secondary-teal: #00BFA5;
            --accent-amber: #FFAB00;
            --accent-purple: #AA00FF;
            --accent-pink: #FF4081;
            --accent-green: #00C853;
            --accent-orange: #FF6D00;
            --accent-cyan: #00B8D4;
            --dark-bg: #0D1B2A;
            --dark-surface: #1B2B3A;
            --dark-card: #253447;
            --dark-border: #3A4A5A;
            --text-primary: #FFFFFF;
            --text-secondary: #B8D0E0;
            --text-muted: #7A94A8;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            --glow: 0 0 20px rgba(41, 98, 255, 0.3);
            --direct-glow: 0 0 15px rgba(0, 191, 165, 0.4);
            --indirect-glow: 0 0 15px rgba(255, 171, 0, 0.4);
            --speech-glow: 0 0 15px rgba(170, 0, 255, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Speech Pattern Background */
        .speech-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(41, 98, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 191, 165, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 171, 0, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0D1B2A, #1B2B3A);
            opacity: 0.8;
        }

        .floating-text {
            position: absolute;
            color: rgba(255, 255, 255, 0.05);
            font-size: 1.5rem;
            font-weight: normal;
            animation: floatText 30s linear infinite;
            font-family: 'Georgia', serif;
            max-width: 200px;
            text-align: center;
            line-height: 1.3;
        }

        @keyframes floatText {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-100px) translateX(100px) rotate(5deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-100px) rotate(-5deg); opacity: 0.1; }
            75% { transform: translateY(100px) translateX(50px) rotate(5deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 27, 42, 0.9);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(41, 98, 255, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-blue);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(41, 98, 255, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(41, 98, 255, 0.4);
        }

        .btn-primary:hover {
            background: #1A56DB;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(41, 98, 255, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-teal);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 191, 165, 0.4);
        }

        .btn-secondary:hover {
            background: #009688;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 191, 165, 0.5);
        }

        .btn-amber {
            background: var(--accent-amber);
            color: #000;
            box-shadow: 0 4px 15px rgba(255, 171, 0, 0.4);
        }

        .btn-amber:hover {
            background: #FF9800;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 171, 0, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(41, 98, 255, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .writing-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-purple);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(41, 98, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: rgba(41, 98, 255, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(0, 200, 83, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .option.incorrect {
            background: rgba(255, 64, 129, 0.1);
            border-color: var(--accent-pink);
            color: var(--accent-pink);
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-teal);
        }

        .option.correct .option-letter {
            background: var(--accent-green);
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--accent-pink);
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(0, 200, 83, 0.1);
            border-left: 5px solid var(--accent-green);
        }

        .feedback-incorrect {
            background: rgba(255, 64, 129, 0.1);
            border-left: 5px solid var(--accent-pink);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--accent-green);
        }

        .feedback-incorrect .feedback-icon {
            background: var(--accent-pink);
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--accent-green);
        }

        .feedback-incorrect .feedback-title {
            color: var(--accent-pink);
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Speech Display */
        .speech-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .display-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        .speech-container {
            padding: 20px;
            background: var(--dark-surface);
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-purple);
        }

        .speech-scenario {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .speech-highlight {
            background: rgba(170, 0, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            border: 1px solid var(--accent-purple);
        }

        .highlight-text {
            color: var(--accent-purple);
            font-weight: bold;
        }

        /* Speech Skills Grid */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .skills-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .skills-grid {
                grid-template-columns: 1fr;
            }
        }

        .skill-card {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid transparent;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .skill-card:hover {
            transform: translateY(-5px);
        }

        .skill-card.direct {
            border-color: var(--secondary-teal);
        }

        .skill-card.indirect {
            border-color: var(--accent-amber);
        }

        .skill-card.pronouns {
            border-color: var(--accent-purple);
        }

        .skill-card.tenses {
            border-color: var(--accent-pink);
        }

        .skill-card.time {
            border-color: var(--accent-green);
        }

        .skill-card.place {
            border-color: var(--accent-orange);
        }

        .skill-card.questions {
            border-color: var(--accent-cyan);
        }

        .skill-card.commands {
            border-color: var(--primary-blue);
        }

        .skill-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .direct .skill-icon {
            color: var(--secondary-teal);
        }

        .indirect .skill-icon {
            color: var(--accent-amber);
        }

        .pronouns .skill-icon {
            color: var(--accent-purple);
        }

        .tenses .skill-icon {
            color: var(--accent-pink);
        }

        .time .skill-icon {
            color: var(--accent-green);
        }

        .place .skill-icon {
            color: var(--accent-orange);
        }

        .questions .skill-icon {
            color: var(--accent-cyan);
        }

        .commands .skill-icon {
            color: var(--primary-blue);
        }

        .skill-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .direct .skill-title {
            color: var(--secondary-teal);
        }

        .indirect .skill-title {
            color: var(--accent-amber);
        }

        .pronouns .skill-title {
            color: var(--accent-purple);
        }

        .tenses .skill-title {
            color: var(--accent-pink);
        }

        .time .skill-title {
            color: var(--accent-green);
        }

        .place .skill-title {
            color: var(--accent-orange);
        }

        .questions .skill-title {
            color: var(--accent-cyan);
        }

        .commands .skill-title {
            color: var(--primary-blue);
        }

        .skill-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .skill-examples {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 10px;
            background: var(--dark-surface);
            padding: 8px;
            border-radius: 4px;
        }

        /* Speech Table */
        .speech-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .speech-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-purple);
            border-bottom: 2px solid var(--accent-purple);
        }

        .speech-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .speech-table tr:hover {
            background: rgba(170, 0, 255, 0.05);
        }

        /* Detailed Skills Display */
        .skills-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--secondary-teal);
        }

        .skills-title {
            color: var(--secondary-teal);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .skills-inner-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .skills-inner-grid {
                grid-template-columns: 1fr;
            }
        }

        .skill-detail-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .skill-detail-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--secondary-teal);
        }

        .skill-detail-type {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--secondary-teal);
            font-size: 1.2rem;
        }

        .skill-detail-steps {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Direct vs Indirect Display */
        .comparison-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-amber);
        }

        .comparison-title {
            color: var(--accent-amber);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }

        .comparison-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .comparison-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .comparison-type {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.2rem;
        }

        /* Interactive Speech Builder */
        .builder-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--primary-blue);
        }

        .builder-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .builder-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .builder-select {
            padding: 10px 15px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-blue);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .builder-input {
            padding: 15px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-blue);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            resize: vertical;
            min-height: 100px;
        }

        .builder-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .builder-btn {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-blue);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .builder-btn:hover {
            background: rgba(41, 98, 255, 0.1);
            transform: translateY(-2px);
        }

        .builder-display {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        /* Writing Study Display */
        .writing-study-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .writing-study-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .writing-study-grid {
                grid-template-columns: 1fr;
            }
        }

        .study-card {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--accent-green);
        }

        .study-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent-green);
        }

        .study-concept {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent-green);
        }

        .study-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal), var(--accent-amber));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Speech Visual Elements */
        .speech-step {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 191, 165, 0.05);
            border-radius: 6px;
            border-left: 4px solid var(--secondary-teal);
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--secondary-teal);
            color: white;
            border-radius: 50%;
            font-weight: bold;
        }

        .step-description {
            flex: 1;
        }

        .word-box {
            display: inline-block;
            padding: 5px 10px;
            margin: 0 5px;
            background: rgba(255, 171, 0, 0.1);
            border-radius: 4px;
            border: 1px solid var(--accent-amber);
            font-weight: bold;
        }

        .key-point {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--accent-pink);
            border-radius: 50%;
            margin: 0 5px;
        }

        .detail-line {
            display: inline-block;
            height: 2px;
            width: 30px;
            background: var(--primary-blue);
            margin: 0 5px;
            vertical-align: middle;
        }

        .speech-marker {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--accent-amber);
            margin: 0 5px;
            position: relative;
        }

        .speech-marker::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-amber);
            opacity: 0.3;
        }

        /* Example Sentences */
        .example-sentence {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-amber);
        }

        .sentence-title {
            color: var(--accent-amber);
            font-weight: bold;
            margin-bottom: 15px;
        }

        .sentence-content {
            line-height: 1.6;
            color: var(--text-primary);
            margin-bottom: 15px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
        }

        /* Key Points List */
        .key-points {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .key-points-title {
            color: var(--primary-blue);
            font-weight: bold;
            margin-bottom: 15px;
        }

        .key-point-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background: var(--dark-card);
            border-radius: 6px;
        }

        .key-point-icon {
            color: var(--accent-green);
            font-size: 1.2rem;
            margin-top: 2px;
        }

        /* Before-After Examples */
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .before-after {
                grid-template-columns: 1fr;
            }
        }

        .before-example {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--accent-pink);
        }

        .after-example {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--accent-green);
        }

        .example-title {
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .before-example .example-title {
            color: var(--accent-pink);
        }

        .after-example .example-title {
            color: var(--accent-green);
        }

        /* Step-by-Step Process */
        .process-steps {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .process-title {
            color: var(--accent-purple);
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .process-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--dark-surface);
            border-radius: 8px;
            border-left: 4px solid var(--accent-purple);
        }

        .step-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-purple);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-heading {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-purple);
        }

        /* Common Mistakes */
        .mistakes-container {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-pink);
        }

        .mistakes-title {
            color: var(--accent-pink);
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .mistake-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 15px;
            padding: 15px;
            background: var(--dark-surface);
            border-radius: 6px;
        }

        .mistake-icon {
            color: var(--accent-pink);
            font-size: 1.2rem;
            margin-top: 2px;
        }

        .mistake-heading {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-pink);
        }

        /* Tense Change Table */
        .tense-table-container {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--secondary-teal);
        }

        .tense-title {
            color: var(--secondary-teal);
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .tense-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .tense-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: center;
            color: var(--secondary-teal);
            border: 1px solid var(--dark-border);
        }

        .tense-table td {
            padding: 10px;
            border: 1px solid var(--dark-border);
            color: var(--text-primary);
            text-align: center;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .skills-grid {
                grid-template-columns: 1fr;
            }
            
            .skills-inner-grid {
                grid-template-columns: 1fr;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 0.7; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes speechReveal {
            0% { transform: translateX(-100px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .speech-reveal {
            animation: speechReveal 0.5s ease forwards;
        }
        
        @keyframes directGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(0, 191, 165, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(0, 191, 165, 0.2); }
        }
        
        .direct-glow {
            animation: directGlow 2s ease-in-out infinite;
        }
        
        @keyframes indirectGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 171, 0, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(255, 171, 0, 0.2); }
        }
        
        .indirect-glow {
            animation: indirectGlow 2s ease-in-out infinite;
        }
        
        @keyframes speechGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(170, 0, 255, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(170, 0, 255, 0.2); }
        }
        
        .speech-glow {
            animation: speechGlow 2s ease-in-out infinite;
        }
        
        @keyframes floatSymbol {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        
        .float-symbol {
            animation: floatSymbol 3s ease-in-out infinite;
        }
        
        @keyframes writingGlow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .writing-glow {
            animation: writingGlow 2s ease-in-out infinite;
        }
        
        @keyframes constructSpeech {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .construct-speech {
            animation: constructSpeech 0.5s ease forwards;
        }
        
        /* Speech Text Styling */
        .speech-text {
            font-family: 'Georgia', serif;
            line-height: 1.8;
            white-space: pre-wrap;
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--dark-border);
        }
        
        .direct-speech {
            border-left: 4px solid var(--secondary-teal);
            background: rgba(0, 191, 165, 0.05);
        }
        
        .indirect-speech {
            border-left: 4px solid var(--accent-amber);
            background: rgba(255, 171, 0, 0.05);
        }
        
        .quote-mark {
            color: var(--accent-purple);
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        /* Interactive Speech Elements */
        .speech-element {
            padding: 10px 15px;
            margin: 5px;
            border-radius: 6px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .speech-element:hover {
            transform: translateY(-2px);
        }
        
        .direct-element {
            border-color: var(--secondary-teal);
            background: rgba(0, 191, 165, 0.1);
        }
        
        .indirect-element {
            border-color: var(--accent-amber);
            background: rgba(255, 171, 0, 0.1);
        }
        
        .element-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }
        
        /* Tense Highlighting */
        .tense-highlight {
            padding: 3px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .present-tense {
            background: rgba(0, 200, 83, 0.2);
            color: var(--accent-green);
        }
        
        .past-tense {
            background: rgba(255, 171, 0, 0.2);
            color: var(--accent-amber);
        }
        
        .future-tense {
            background: rgba(41, 98, 255, 0.2);
            color: var(--primary-blue);
        }
    </style>
</head>
<body>
    <!-- Speech Pattern Background -->
    <div class="speech-bg" id="speechBg">
        <!-- Text snippets will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 7 English - Direct & Indirect Speech</h1>
            <p class="welcome-subtitle">Master the art of reported speech! Learn to convert direct speech to indirect speech and vice versa. Understand pronoun changes, tense shifts, time expressions, and reporting verbs. Develop essential grammar skills for accurate communication!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üó£Ô∏è üîä üìù üîÑ ‚è∞ üë§</span>
                <span class="topic-name">Reported Speech & Tense Conversion</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Speech Conversion Journey</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 50</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 2%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Writing fact display -->
                <div id="writingFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Speech Conversion Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Practice Again</button>
                <button class="btn btn-secondary" id="viewTopics">Other English Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const speechBg = document.getElementById('speechBg');
            
            // Create floating text snippets
            const textSnippets = [
                "Direct",
                "Indirect",
                "He said",
                "She said",
                "Told me",
                "Asked",
                "Quoted",
                "Reported",
                "Tense",
                "Pronoun"
            ];
            
            for (let i = 0; i < 20; i++) {
                const text = document.createElement('div');
                text.className = 'floating-text float-symbol';
                text.textContent = textSnippets[Math.floor(Math.random() * textSnippets.length)];
                text.style.left = `${Math.random() * 100}%`;
                text.style.top = `${Math.random() * 100}%`;
                text.style.animationDelay = `${Math.random() * 5}s`;
                text.style.fontSize = `${1 + Math.random() * 1.5}rem`;
                
                // Color based on text content
                const colors = [
                    'rgba(0, 191, 165, 0.1)',    // Teal (Direct)
                    'rgba(255, 171, 0, 0.1)',    // Amber (Indirect)
                    'rgba(170, 0, 255, 0.1)',    // Purple
                    'rgba(255, 64, 129, 0.1)',   // Pink
                    'rgba(0, 200, 83, 0.1)',     // Green
                    'rgba(41, 98, 255, 0.1)'     // Blue
                ];
                text.style.color = colors[Math.floor(Math.random() * colors.length)];
                
                speechBg.appendChild(text);
            }
        }

        // 50 Direct & Indirect Speech Questions
        const questions = [
            // Basics (1-5)
            {
                type: "basics",
                question: "What is direct speech?",
                options: ["The exact words someone said, in quotation marks", "A summary of what someone said", "Changing someone's words", "Using 'that' in sentences"],
                answer: "A",
                explanation: "Direct speech gives the exact words spoken by someone, enclosed in quotation marks."
            },
            {
                type: "basics",
                question: "What is indirect speech?",
                options: ["Reporting what someone said without using their exact words", "Using quotation marks", "Exact words someone spoke", "Writing in present tense"],
                answer: "A",
                explanation: "Indirect speech reports what someone said without using their exact words or quotation marks."
            },
            {
                type: "basics",
                question: "Which punctuation marks are used in direct speech?",
                options: ["Quotation marks", "Parentheses", "Asterisks", "Hyphens"],
                answer: "A",
                explanation: "Direct speech always uses quotation marks to show the exact words spoken."
            },
            // Tense Changes (6-15)
            {
                type: "tenses",
                question: "Direct: 'I am happy.' Indirect: He said he ____ happy.",
                options: ["was", "is", "will be", "has been"],
                answer: "A",
                explanation: "Present simple (am) changes to past simple (was) in indirect speech."
            },
            {
                type: "tenses",
                question: "Direct: 'She works hard.' Indirect: He said she ____ hard.",
                options: ["worked", "works", "will work", "is working"],
                answer: "A",
                explanation: "Present simple (works) changes to past simple (worked) in indirect speech."
            },
            {
                type: "tenses",
                question: "Direct: 'They are playing.' Indirect: She said they ____.",
                options: ["were playing", "are playing", "will play", "play"],
                answer: "A",
                explanation: "Present continuous (are playing) changes to past continuous (were playing)."
            },
            {
                type: "tenses",
                question: "Direct: 'I have finished.' Indirect: He said he ____.",
                options: ["had finished", "has finished", "finished", "will finish"],
                answer: "A",
                explanation: "Present perfect (have finished) changes to past perfect (had finished)."
            },
            {
                type: "tenses",
                question: "Direct: 'I will come.' Indirect: She said she ____ come.",
                options: ["would", "will", "shall", "is coming"],
                answer: "A",
                explanation: "Future simple (will) changes to conditional (would) in indirect speech."
            },
            {
                type: "tenses",
                question: "Direct: 'I can swim.' Indirect: He said he ____ swim.",
                options: ["could", "can", "will", "might"],
                answer: "A",
                explanation: "Modal 'can' changes to 'could' in indirect speech."
            },
            {
                type: "tenses",
                question: "Direct: 'I must go.' Indirect: She said she ____ go.",
                options: ["had to", "must", "will", "should"],
                answer: "A",
                explanation: "Modal 'must' often changes to 'had to' in indirect speech."
            },
            // Pronoun Changes (16-25)
            {
                type: "pronouns",
                question: "Direct: 'I like apples.' (Sarah speaking) Indirect: Sarah said ____ liked apples.",
                options: ["she", "I", "they", "you"],
                answer: "A",
                explanation: "First person 'I' changes to third person 'she' when reporting Sarah's speech."
            },
            {
                type: "pronouns",
                question: "Direct: 'You are late.' (to me) Indirect: He said ____ was late.",
                options: ["I", "you", "he", "they"],
                answer: "A",
                explanation: "Second person 'you' (referring to me) changes to first person 'I' in indirect speech."
            },
            {
                type: "pronouns",
                question: "Direct: 'We are tired.' Indirect: They said ____ were tired.",
                options: ["they", "we", "you", "he"],
                answer: "A",
                explanation: "First person plural 'we' changes to third person 'they' in indirect speech."
            },
            {
                type: "pronouns",
                question: "Direct: 'This is my book.' Indirect: She said that ____ was her book.",
                options: ["that", "this", "the", "a"],
                answer: "A",
                explanation: "'This' changes to 'that' in indirect speech when referring to something near the speaker."
            },
            {
                type: "pronouns",
                question: "Direct: 'These are mine.' Indirect: He said those ____ his.",
                options: ["were", "are", "is", "will be"],
                answer: "A",
                explanation: "'These' changes to 'those' and tense changes from present to past."
            },
            // Time Expressions (26-35)
            {
                type: "time",
                question: "Direct: 'I saw him yesterday.' Indirect: She said she had seen him ____.",
                options: ["the day before", "yesterday", "today", "tomorrow"],
                answer: "A",
                explanation: "'Yesterday' changes to 'the day before' or 'the previous day' in indirect speech."
            },
            {
                type: "time",
                question: "Direct: 'I will do it tomorrow.' Indirect: He said he would do it ____.",
                options: ["the next day", "tomorrow", "today", "yesterday"],
                answer: "A",
                explanation: "'Tomorrow' changes to 'the next day' or 'the following day' in indirect speech."
            },
            {
                type: "time",
                question: "Direct: 'I am busy now.' Indirect: She said she was busy ____.",
                options: ["then", "now", "today", "soon"],
                answer: "A",
                explanation: "'Now' changes to 'then' in indirect speech."
            },
            {
                type: "time",
                question: "Direct: 'I came here today.' Indirect: He said he had gone there ____.",
                options: ["that day", "today", "yesterday", "now"],
                answer: "A",
                explanation: "'Today' changes to 'that day' in indirect speech."
            },
            {
                type: "time",
                question: "Direct: 'I saw her last week.' Indirect: She said she had seen her ____.",
                options: ["the week before", "last week", "this week", "next week"],
                answer: "A",
                explanation: "'Last week' changes to 'the week before' or 'the previous week'."
            },
            // Questions (36-45)
            {
                type: "questions",
                question: "Direct: 'Are you coming?' Indirect: He asked ____ I was coming.",
                options: ["if", "that", "when", "why"],
                answer: "A",
                explanation: "Yes/no questions use 'if' or 'whether' in indirect speech."
            },
            {
                type: "questions",
                question: "Direct: 'Where do you live?' Indirect: She asked where ____ lived.",
                options: ["I", "you", "she", "they"],
                answer: "A",
                explanation: "Wh-questions keep the question word and change word order to statement form."
            },
            {
                type: "questions",
                question: "Direct: 'What is your name?' Indirect: He asked what ____ name was.",
                options: ["my", "your", "his", "her"],
                answer: "A",
                explanation: "Pronouns change from second person ('your') to first person ('my') when reporting questions asked to you."
            },
            {
                type: "questions",
                question: "Direct: 'Do you like pizza?' Indirect: She asked ____ I liked pizza.",
                options: ["if", "that", "when", "why"],
                answer: "A",
                explanation: "Yes/no questions in direct speech use 'if' or 'whether' in indirect speech."
            },
            {
                type: "questions",
                question: "Direct: 'When will you arrive?' Indirect: He asked when ____ would arrive.",
                options: ["I", "you", "he", "they"],
                answer: "A",
                explanation: "Pronouns change and tense shifts occur in reported questions."
            },
            // Commands and Requests (46-50)
            {
                type: "commands",
                question: "Direct: 'Close the door.' Indirect: He told me ____ the door.",
                options: ["to close", "close", "closing", "closed"],
                answer: "A",
                explanation: "Commands in direct speech use 'to + infinitive' in indirect speech."
            },
            {
                type: "commands",
                question: "Direct: 'Please help me.' Indirect: She asked me ____ her.",
                options: ["to help", "help", "helping", "helped"],
                answer: "A",
                explanation: "Requests use 'to + infinitive' in indirect speech."
            },
            {
                type: "commands",
                question: "Direct: 'Don't touch that!' Indirect: He told me ____ touch that.",
                options: ["not to", "to not", "don't", "didn't"],
                answer: "A",
                explanation: "Negative commands use 'not to + infinitive' in indirect speech."
            },
            {
                type: "commands",
                question: "Direct: 'Be quiet.' Indirect: The teacher told the students ____ quiet.",
                options: ["to be", "be", "being", "been"],
                answer: "A",
                explanation: "Commands with 'be' use 'to be' in indirect speech."
            },
            {
                type: "commands",
                question: "Direct: 'Finish your work.' Indirect: She told him ____ his work.",
                options: ["to finish", "finish", "finishing", "finished"],
                answer: "A",
                explanation: "Commands are reported using 'told/asked + object + to + infinitive'."
            }
        ];

        // Speech conversion skills
        const speechSkills = [
            {
                name: "Direct Speech",
                description: "Reporting exact words with quotation marks",
                examples: "'I am tired,' she said.",
                characteristics: "Exact words, quotation marks, present tense often",
                icon: "üó£Ô∏è",
                color: "#00BFA5"
            },
            {
                name: "Indirect Speech",
                description: "Reporting meaning without exact words",
                examples: "She said that she was tired.",
                characteristics: "No quotation marks, tense changes, pronoun changes",
                icon: "üîä",
                color: "#FFAB00"
            },
            {
                name: "Pronoun Changes",
                description: "Adjusting pronouns based on perspective",
                examples: "I ‚Üí he/she, you ‚Üí I/he/she, we ‚Üí they",
                characteristics: "Perspective shift, contextual adjustment",
                icon: "üë§",
                color: "#AA00FF"
            },
            {
                name: "Tense Shifts",
                description: "Changing verb tenses in reported speech",
                examples: "Present ‚Üí Past, will ‚Üí would, can ‚Üí could",
                characteristics: "Backshifting, time reference changes",
                icon: "üîÑ",
                color: "#FF4081"
            },
            {
                name: "Time Expressions",
                description: "Adjusting time references",
                examples: "Now ‚Üí then, today ‚Üí that day, tomorrow ‚Üí next day",
                characteristics: "Time reference adjustment, contextual",
                icon: "‚è∞",
                color: "#00C853"
            },
            {
                name: "Place References",
                description: "Changing place references",
                examples: "Here ‚Üí there, this ‚Üí that, these ‚Üí those",
                characteristics: "Spatial adjustment, proximity changes",
                icon: "üìç",
                color: "#FF6D00"
            },
            {
                name: "Reported Questions",
                description: "Converting questions to statements",
                examples: "Word order change, 'if/whether' for yes/no questions",
                characteristics: "Statement word order, question words retained",
                icon: "‚ùì",
                color: "#00B8D4"
            },
            {
                name: "Reported Commands",
                description: "Converting commands to infinitives",
                examples: "'Go' ‚Üí 'to go', 'Don't go' ‚Üí 'not to go'",
                characteristics: "Infinitive form, 'tell/ask + to + verb'",
                icon: "‚ö°",
                color: "#2962FF"
            }
        ];

        // Tense change rules
        const tenseChanges = [
            {
                direct: "Present Simple (I work)",
                indirect: "Past Simple (he worked)",
                example: "'I work hard.' ‚Üí He said he worked hard."
            },
            {
                direct: "Present Continuous (I am working)",
                indirect: "Past Continuous (he was working)",
                example: "'I am studying.' ‚Üí She said she was studying."
            },
            {
                direct: "Present Perfect (I have worked)",
                indirect: "Past Perfect (he had worked)",
                example: "'I have finished.' ‚Üí He said he had finished."
            },
            {
                direct: "Past Simple (I worked)",
                indirect: "Past Perfect (he had worked)",
                example: "'I saw her.' ‚Üí She said she had seen her."
            },
            {
                direct: "Future Simple (I will work)",
                indirect: "Conditional (he would work)",
                example: "'I will come.' ‚Üí He said he would come."
            },
            {
                direct: "can (I can work)",
                indirect: "could (he could work)",
                example: "'I can swim.' ‚Üí She said she could swim."
            },
            {
                direct: "may (I may work)",
                indirect: "might (he might work)",
                example: "'I may go.' ‚Üí He said he might go."
            },
            {
                direct: "must (I must work)",
                indirect: "had to (he had to work)",
                example: "'I must leave.' ‚Üí She said she had to leave."
            }
        ];

        // Time expression changes
        const timeChanges = [
            {
                direct: "now",
                indirect: "then",
                example: "'I'm busy now.' ‚Üí He said he was busy then."
            },
            {
                direct: "today",
                indirect: "that day",
                example: "'I'll do it today.' ‚Üí She said she would do it that day."
            },
            {
                direct: "tomorrow",
                indirect: "the next/following day",
                example: "'I'll see you tomorrow.' ‚Üí He said he would see me the next day."
            },
            {
                direct: "yesterday",
                indirect: "the day before",
                example: "'I saw her yesterday.' ‚Üí She said she had seen her the day before."
            },
            {
                direct: "last week",
                indirect: "the week before",
                example: "'I called last week.' ‚Üí He said he had called the week before."
            },
            {
                direct: "next month",
                indirect: "the following month",
                example: "'I'll travel next month.' ‚Üí She said she would travel the following month."
            },
            {
                direct: "here",
                indirect: "there",
                example: "'I live here.' ‚Üí He said he lived there."
            },
            {
                direct: "this",
                indirect: "that",
                example: "'I like this book.' ‚Üí She said she liked that book."
            }
        ];

        // Common mistakes
        const commonMistakes = [
            {
                mistake: "Not Changing Tenses",
                description: "Keeping present tense in indirect speech when it should be past",
                example: "Direct: 'I am happy.' Wrong: He said he is happy. Correct: He said he was happy.",
                correction: "Remember to backshift tenses (present ‚Üí past)"
            },
            {
                mistake: "Wrong Pronoun Changes",
                description: "Not adjusting pronouns for the new perspective",
                example: "Direct: 'I like it.' (John speaking) Wrong: John said I like it. Correct: John said he liked it.",
                correction: "Change pronouns according to who is speaking and who is being reported"
            },
            {
                mistake: "Keeping Quotation Marks",
                description: "Using quotation marks in indirect speech",
                example: "Wrong: He said that 'he was tired'. Correct: He said that he was tired.",
                correction: "Indirect speech doesn't use quotation marks"
            },
            {
                mistake: "Wrong Time Expressions",
                description: "Not changing time expressions",
                example: "Direct: 'I'll do it tomorrow.' Wrong: He said he would do it tomorrow. Correct: He said he would do it the next day.",
                correction: "Adjust time expressions (now‚Üíthen, today‚Üíthat day, etc.)"
            }
        ];

        // Speech conversion steps
        const speechSteps = [
            {
                step: 1,
                title: "Identify Reporting Verb",
                description: "Determine if it's 'said', 'told', 'asked', etc.",
                tips: "Said (no object), told (needs object), asked (for questions)"
            },
            {
                step: 2,
                title: "Remove Quotation Marks",
                description: "Take out the quotation marks from direct speech",
                tips: "Indirect speech doesn't use quotation marks"
            },
            {
                step: 3,
                title: "Change Pronouns",
                description: "Adjust pronouns based on who is speaking",
                tips: "I ‚Üí he/she, you ‚Üí I/he/she, we ‚Üí they"
            },
            {
                step: 4,
                title: "Change Tenses",
                description: "Backshift tenses (present ‚Üí past)",
                tips: "Present simple ‚Üí Past simple, will ‚Üí would, can ‚Üí could"
            },
            {
                step: 5,
                title: "Change Time/Place",
                description: "Adjust time and place expressions",
                tips: "Now ‚Üí then, today ‚Üí that day, here ‚Üí there"
            },
            {
                step: 6,
                title: "Change Word Order",
                description: "For questions, change to statement order",
                tips: "Questions become statements in indirect speech"
            },
            {
                step: 7,
                title: "Add 'that' (Optional)",
                description: "Add 'that' after reporting verb (optional)",
                tips: "'That' can often be omitted in informal speech"
            }
        ];

        // Writing facts
        const writingFacts = [
            "Direct speech is also called 'quoted speech'!",
            "Indirect speech is sometimes called 'reported speech'!",
            "In some languages, tense changes don't occur in reported speech!",
            "Shakespeare used both direct and indirect speech extensively!",
            "Journalists often use indirect speech to summarize interviews!",
            "The word 'that' in indirect speech is called a 'complementizer'!",
            "Some languages have special verb forms for reported speech!",
            "Direct speech makes stories more vivid and immediate!"
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent speech conversion!",
            "Perfect tense shifting!",
            "Great pronoun adjustment!",
            "Amazing! You're a speech conversion champion!",
            "Perfect grasp of indirect speech!",
            "You're a future linguist or translator in the making!",
            "Outstanding grammar skills!",
            "Brilliant reporting verb usage!",
            "You think like a professional writer!",
            "Speech conversion mastery achieved!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const writingFact = document.getElementById('writingFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade7Speech');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade7Speech', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade7Speech_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a speech conversion expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent grammar skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing your speech conversion!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review the rules and try again!";
            } else {
                scoreMessage.textContent = "Keep learning! Speech conversion is essential for accurate reporting and communication!";
            }
        }

        // Create writing fact display
        function createWritingFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'writing-fact';
            
            factDiv.innerHTML = `<strong>Interesting Grammar Fact:</strong> ${writingFacts[Math.floor(Math.random() * writingFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "basics": "üìù",
                "tenses": "üîÑ",
                "pronouns": "üë§",
                "time": "‚è∞",
                "questions": "‚ùì",
                "commands": "‚ö°"
            };
            
            let conceptName = "Basics";
            let conceptIcon = "üìù";
            
            if (question.type.includes("basics")) {
                conceptName = "Speech Basics";
                conceptIcon = conceptIcons.basics;
            } else if (question.type.includes("tenses")) {
                conceptName = "Tense Changes";
                conceptIcon = conceptIcons.tenses;
            } else if (question.type.includes("pronouns")) {
                conceptName = "Pronoun Changes";
                conceptIcon = conceptIcons.pronouns;
            } else if (question.type.includes("time")) {
                conceptName = "Time Expressions";
                conceptIcon = conceptIcons.time;
            } else if (question.type.includes("questions")) {
                conceptName = "Reported Questions";
                conceptIcon = conceptIcons.questions;
            } else if (question.type.includes("commands")) {
                conceptName = "Reported Commands";
                conceptIcon = conceptIcons.commands;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("basics")) {
                label.textContent = "Understanding direct vs indirect speech";
            } else if (question.type.includes("tenses")) {
                label.textContent = "Changing verb tenses in reported speech";
            } else if (question.type.includes("pronouns")) {
                label.textContent = "Adjusting pronouns based on perspective";
            } else if (question.type.includes("time")) {
                label.textContent = "Modifying time expressions in reported speech";
            } else if (question.type.includes("questions")) {
                label.textContent = "Converting questions to reported statements";
            } else if (question.type.includes("commands")) {
                label.textContent = "Reporting commands and requests";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create speech conversion visualization
        function createSpeechVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const currentQuestion = appState.currentQuestions[appState.currentQuestionIndex];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-blue);">Direct & Indirect Speech Explorer</h3>
                
                <div class="speech-display">
                    <div class="display-title">Current Speech Concept</div>
                    <div class="speech-container">
                        <div class="speech-scenario">${currentQuestion.question}</div>
                        <div class="speech-highlight">
                            <strong>Key Concept:</strong> <span class="highlight-text">${getSpeechConcept(currentQuestion.type)}</span>
                        </div>
                    </div>
                </div>
                
                <!-- Skills Grid -->
                <div class="skills-grid">
                    ${speechSkills.map(skill => `
                        <div class="skill-card ${skill.name.toLowerCase().replace(/ /g, '-')}" style="border-color: ${skill.color}" onclick="showSkillDemo('${skill.name}')">
                            <div class="skill-icon writing-glow" style="color: ${skill.color}">${skill.icon}</div>
                            <div class="skill-title" style="color: ${skill.color}">${skill.name}</div>
                            <div class="skill-description">${skill.description}</div>
                            <div class="skill-examples">
                                <strong>Example:</strong> ${skill.examples}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <!-- Tense Change Table -->
                <div class="tense-table-container">
                    <div class="tense-title">Tense Changes in Indirect Speech</div>
                    <table class="tense-table">
                        <thead>
                            <tr>
                                <th>Direct Speech</th>
                                <th>Indirect Speech</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${tenseChanges.map((change, index) => `
                                <tr style="animation-delay: ${index * 0.1}s">
                                    <td><span class="tense-highlight present-tense">${change.direct}</span></td>
                                    <td><span class="tense-highlight past-tense">${change.indirect}</span></td>
                                    <td style="font-size: 0.9rem; color: var(--text-secondary);">${change.example}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                
                <!-- Time Expression Changes -->
                <div class="comparison-container">
                    <div class="comparison-title">Time & Place Expression Changes</div>
                    <div class="comparison-grid">
                        ${timeChanges.map((item, index) => `
                            <div class="comparison-card" style="animation-delay: ${index * 0.1}s">
                                <div class="comparison-type">${item.direct} ‚Üí ${item.indirect}</div>
                                <div style="margin-top: 10px; font-size: 0.9rem; color: var(--text-secondary);">
                                    ${item.example}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <!-- Step-by-Step Process -->
                <div class="process-steps">
                    <div class="process-title">7-Step Speech Conversion Process</div>
                    ${speechSteps.map((step, index) => `
                        <div class="process-step" style="animation-delay: ${index * 0.1}s">
                            <div class="step-icon">${step.step}</div>
                            <div class="step-content">
                                <div class="step-heading">${step.title}</div>
                                <div style="color: var(--text-secondary); margin-bottom: 5px;">${step.description}</div>
                                <div style="font-size: 0.9rem; color: var(--accent-amber);">
                                    <strong>Tip:</strong> ${step.tips}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <!-- Common Mistakes -->
                <div class="mistakes-container">
                    <div class="mistakes-title">Common Mistakes to Avoid</div>
                    ${commonMistakes.map((mistake, index) => `
                        <div class="mistake-item" style="animation-delay: ${index * 0.1}s">
                            <div class="mistake-icon">‚ùå</div>
                            <div style="flex: 1;">
                                <div class="mistake-heading">${mistake.mistake}</div>
                                <div style="color: var(--text-secondary); margin-bottom: 5px;">${mistake.description}</div>
                                <div style="background: var(--dark-card); padding: 8px; border-radius: 4px; margin: 5px 0; font-size: 0.9rem;">
                                    <strong>Example:</strong> ${mistake.example}
                                </div>
                                <div style="font-size: 0.9rem; color: var(--accent-green);">
                                    <strong>Correction:</strong> ${mistake.correction}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <!-- Interactive Speech Builder -->
                <div class="builder-container">
                    <div class="builder-title">Interactive Speech Converter</div>
                    <div class="builder-controls">
                        <select class="builder-select" id="conversionType">
                            <option value="directToIndirect">Direct ‚Üí Indirect</option>
                            <option value="indirectToDirect">Indirect ‚Üí Direct</option>
                        </select>
                        <textarea class="builder-input" id="speechInput" placeholder="Enter direct or indirect speech here... Example: 'I am happy,' she said."></textarea>
                        <div class="builder-buttons">
                            <button class="builder-btn" onclick="convertSpeech()">Convert Speech</button>
                            <button class="builder-btn" onclick="analyzeSpeech()">Analyze Changes</button>
                            <button class="builder-btn" onclick="getPracticeSentence()">Get Practice Sentence</button>
                            <button class="builder-btn" onclick="clearSpeechBuilder()">Clear</button>
                        </div>
                    </div>
                    <div class="builder-display" id="builderDisplay">
                        Your speech conversion will appear here...
                    </div>
                </div>
                
                <!-- Practice Activities -->
                <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <div class="display-title">Practice Activities</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                        <button class="builder-btn" onclick="practiceTenseChanges()">Practice Tense Changes</button>
                        <button class="builder-btn" onclick="practicePronounChanges()">Practice Pronoun Changes</button>
                        <button class="builder-btn" onclick="practiceTimeExpressions()">Practice Time Expressions</button>
                        <button class="builder-btn" onclick="practiceQuestions()">Practice Reported Questions</button>
                    </div>
                </div>
                
                <!-- Quick Reference Guide -->
                <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid var(--secondary-teal);">
                    <div style="color: var(--secondary-teal); font-weight: bold; margin-bottom: 15px; text-align: center;">Quick Reference Guide</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="padding: 15px; background: var(--dark-surface); border-radius: 8px;">
                            <div style="font-weight: bold; color: var(--secondary-teal); margin-bottom: 10px;">Direct Speech</div>
                            <ul style="color: var(--text-secondary); font-size: 0.9rem; padding-left: 20px;">
                                <li>Uses quotation marks</li>
                                <li>Exact words spoken</li>
                                <li>Present tense often</li>
                                <li>Includes speaker tags</li>
                                <li>Example: 'I am tired,' she said.</li>
                            </ul>
                        </div>
                        <div style="padding: 15px; background: var(--dark-surface); border-radius: 8px;">
                            <div style="font-weight: bold; color: var(--accent-amber); margin-bottom: 10px;">Indirect Speech</div>
                            <ul style="color: var(--text-secondary); font-size: 0.9rem; padding-left: 20px;">
                                <li>No quotation marks</li>
                                <li>Reported meaning</li>
                                <li>Past tense usually</li>
                                <li>Uses 'that' (optional)</li>
                                <li>Example: She said that she was tired.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
            
            return vizDiv;
        }

        // Helper functions
        function getSpeechConcept(typeString) {
            const conceptMap = {
                "basics": "Speech Basics - Understanding direct vs indirect speech",
                "tenses": "Tense Changes - Shifting verb tenses in reported speech",
                "pronouns": "Pronoun Changes - Adjusting pronouns based on perspective",
                "time": "Time Expressions - Modifying time references in reported speech",
                "questions": "Reported Questions - Converting questions to statements",
                "commands": "Reported Commands - Reporting commands and requests"
            };
            
            return conceptMap[typeString] || "Speech Conversion";
        }

        // Interactive practice functions
        window.practiceTenseChanges = function() {
            const builderDisplay = document.getElementById('builderDisplay');
            if (!builderDisplay) return;
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Practice: Tense Changes in Reported Speech</div>
                    
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid var(--secondary-teal);">
                        <div style="font-weight: bold; margin-bottom: 10px; color: var(--secondary-teal);">Tense Backshifting Rules:</div>
                        <div style="color: var(--text-secondary); line-height: 1.6; text-align: left;">
                            When converting from direct to indirect speech, tenses usually move one step back in time:
                            <ul style="padding-left: 20px; margin-top: 10px;">
                                <li>Present Simple ‚Üí Past Simple</li>
                                <li>Present Continuous ‚Üí Past Continuous</li>
                                <li>Present Perfect ‚Üí Past Perfect</li>
                                <li>Past Simple ‚Üí Past Perfect (or stays Past Simple)</li>
                                <li>Future (will) ‚Üí Conditional (would)</li>
                                <li>can ‚Üí could</li>
                                <li>may ‚Üí might</li>
                                <li>must ‚Üí had to</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="text-align: left; margin-top: 20px;">
                        <div style="color: var(--secondary-teal); font-weight: bold; margin-bottom: 10px;">Practice Examples:</div>
                        
                        <div class="before-after">
                            <div class="before-example">
                                <div class="example-title">Direct Speech</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. 'I <span class="tense-highlight present-tense">am</span> studying.'<br>
                                    2. 'She <span class="tense-highlight present-tense">works</span> here.'<br>
                                    3. 'They <span class="tense-highlight present-tense">have finished</span>.'<br>
                                    4. 'I <span class="tense-highlight present-tense">will call</span> you.'<br>
                                    5. 'I <span class="tense-highlight present-tense">can help</span>.'
                                </div>
                            </div>
                            <div class="after-example">
                                <div class="example-title">Indirect Speech</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. He said he <span class="tense-highlight past-tense">was</span> studying.<br>
                                    2. He said she <span class="tense-highlight past-tense">worked</span> there.<br>
                                    3. They said they <span class="tense-highlight past-tense">had finished</span>.<br>
                                    4. She said she <span class="tense-highlight past-tense">would call</span> me.<br>
                                    5. He said he <span class="tense-highlight past-tense">could help</span>.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Exception:</strong> If the reporting verb is in present tense (says, tells), or if the statement is still true, tense may not change. Example: 'The earth is round,' he said. ‚Üí He said the earth is round. (Still true)
                    </div>
                </div>
            `;
        };

        window.practicePronounChanges = function() {
            const builderDisplay = document.getElementById('builderDisplay');
            if (!builderDisplay) return;
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Practice: Pronoun Changes in Reported Speech</div>
                    
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid var(--accent-purple);">
                        <div style="font-weight: bold; margin-bottom: 10px; color: var(--accent-purple);">Pronoun Adjustment Rules:</div>
                        <div style="color: var(--text-secondary); line-height: 1.6; text-align: left;">
                            Pronouns change based on who is speaking and who is being reported:
                            <ul style="padding-left: 20px; margin-top: 10px;">
                                <li>I ‚Üí he/she (speaker changes to third person)</li>
                                <li>you ‚Üí I/he/she (depending on who 'you' refers to)</li>
                                <li>we ‚Üí they</li>
                                <li>my ‚Üí his/her</li>
                                <li>your ‚Üí my/his/her</li>
                                <li>our ‚Üí their</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="text-align: left; margin-top: 20px;">
                        <div style="color: var(--accent-purple); font-weight: bold; margin-bottom: 10px;">Practice Examples:</div>
                        
                        <div class="before-after">
                            <div class="before-example">
                                <div class="example-title">Direct Speech</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. Sarah: '<span style="color: var(--accent-pink);">I</span> like <span style="color: var(--accent-pink);">my</span> job.'<br>
                                    2. Tom to me: '<span style="color: var(--accent-pink);">You</span> are late.'<br>
                                    3. Team: '<span style="color: var(--accent-pink);">We</span> won <span style="color: var(--accent-pink);">our</span> game.'<br>
                                    4. Teacher to class: '<span style="color: var(--accent-pink);">You</span> must do <span style="color: var(--accent-pink);">your</span> homework.'<br>
                                    5. John to Mary: '<span style="color: var(--accent-pink);">I</span> love <span style="color: var(--accent-pink);">you</span>.'
                                </div>
                            </div>
                            <div class="after-example">
                                <div class="example-title">Indirect Speech</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. Sarah said <span style="color: var(--accent-green);">she</span> liked <span style="color: var(--accent-green);">her</span> job.<br>
                                    2. Tom said <span style="color: var(--accent-green);">I</span> was late.<br>
                                    3. The team said <span style="color: var(--accent-green);">they</span> had won <span style="color: var(--accent-green);">their</span> game.<br>
                                    4. The teacher told the class <span style="color: var(--accent-green);">they</span> had to do <span style="color: var(--accent-green);">their</span> homework.<br>
                                    5. John told Mary <span style="color: var(--accent-green);">he</span> loved <span style="color: var(--accent-green);">her</span>.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Tip:</strong> Always consider the context. Who is speaking? Who is being spoken to? Who is being spoken about?
                    </div>
                </div>
            `;
        };

        window.practiceTimeExpressions = function() {
            const builderDisplay = document.getElementById('builderDisplay');
            if (!builderDisplay) return;
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Practice: Time Expression Changes</div>
                    
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid var(--accent-green);">
                        <div style="font-weight: bold; margin-bottom: 10px; color: var(--accent-green);">Common Time Expression Changes:</div>
                        <div style="color: var(--text-secondary); line-height: 1.6; text-align: left;">
                            Time expressions change because the time perspective shifts in reported speech:
                            <ul style="padding-left: 20px; margin-top: 10px;">
                                <li>now ‚Üí then</li>
                                <li>today ‚Üí that day</li>
                                <li>tomorrow ‚Üí the next/following day</li>
                                <li>yesterday ‚Üí the day before</li>
                                <li>last week ‚Üí the week before</li>
                                <li>next month ‚Üí the following month</li>
                                <li>ago ‚Üí before</li>
                                <li>here ‚Üí there</li>
                                <li>this ‚Üí that</li>
                                <li>these ‚Üí those</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="text-align: left; margin-top: 20px;">
                        <div style="color: var(--accent-green); font-weight: bold; margin-bottom: 10px;">Practice Examples:</div>
                        
                        <div class="before-after">
                            <div class="before-example">
                                <div class="example-title">Direct Speech</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. 'I'm busy <span style="color: var(--accent-pink);">now</span>.'<br>
                                    2. 'I'll do it <span style="color: var(--accent-pink);">tomorrow</span>.'<br>
                                    3. 'I saw her <span style="color: var(--accent-pink);">yesterday</span>.'<br>
                                    4. 'I live <span style="color: var(--accent-pink);">here</span>.'<br>
                                    5. 'I like <span style="color: var(--accent-pink);">this</span> book.'
                                </div>
                            </div>
                            <div class="after-example">
                                <div class="example-title">Indirect Speech</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. He said he was busy <span style="color: var(--accent-green);">then</span>.<br>
                                    2. She said she would do it <span style="color: var(--accent-green);">the next day</span>.<br>
                                    3. He said he had seen her <span style="color: var(--accent-green);">the day before</span>.<br>
                                    4. She said she lived <span style="color: var(--accent-green);">there</span>.<br>
                                    5. He said he liked <span style="color: var(--accent-green);">that</span> book.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Remember:</strong> Time expressions change because we're reporting speech from a different time perspective than when it was originally said.
                    </div>
                </div>
            `;
        };

        window.practiceQuestions = function() {
            const builderDisplay = document.getElementById('builderDisplay');
            if (!builderDisplay) return;
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Practice: Reported Questions</div>
                    
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid var(--accent-cyan);">
                        <div style="font-weight: bold; margin-bottom: 10px; color: var(--accent-cyan);">Rules for Reported Questions:</div>
                        <div style="color: var(--text-secondary); line-height: 1.6; text-align: left;">
                            Questions become statements in indirect speech:
                            <ul style="padding-left: 20px; margin-top: 10px;">
                                <li>Use 'asked' instead of 'said'</li>
                                <li>Change word order to statement order (subject + verb)</li>
                                <li>For yes/no questions: use 'if' or 'whether'</li>
                                <li>For wh-questions: keep the question word</li>
                                <li>Change tenses, pronouns, and time expressions as usual</li>
                                <li>Remove question marks</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div style="text-align: left; margin-top: 20px;">
                        <div style="color: var(--accent-cyan); font-weight: bold; margin-bottom: 10px;">Practice Examples:</div>
                        
                        <div class="before-after">
                            <div class="before-example">
                                <div class="example-title">Direct Questions</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. 'Are you coming?'<br>
                                    2. 'Where do you live?'<br>
                                    3. 'What time is it?'<br>
                                    4. 'Do you like pizza?'<br>
                                    5. 'When will you arrive?'
                                </div>
                            </div>
                            <div class="after-example">
                                <div class="example-title">Reported Questions</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                    1. He asked <span style="color: var(--accent-green);">if I was</span> coming.<br>
                                    2. She asked <span style="color: var(--accent-green);">where I lived</span>.<br>
                                    3. He asked <span style="color: var(--accent-green);">what time it was</span>.<br>
                                    4. She asked <span style="color: var(--accent-green);">if I liked</span> pizza.<br>
                                    5. He asked <span style="color: var(--accent-green);">when I would</span> arrive.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Note:</strong> The word order in reported questions is the same as in statements: subject comes before the verb. No auxiliary 'do/does/did' is used.
                    </div>
                </div>
            `;
        };

        // Speech builder functions
        window.convertSpeech = function() {
            const speechInput = document.getElementById('speechInput');
            const conversionType = document.getElementById('conversionType').value;
            const builderDisplay = document.getElementById('builderDisplay');
            
            if (!speechInput || !builderDisplay) return;
            
            const input = speechInput.value.trim();
            
            if (!input) {
                builderDisplay.innerHTML = "Please enter speech to convert.";
                return;
            }
            
            // Simple conversion examples (in a real app, this would use NLP)
            const examples = {
                directToIndirect: [
                    { direct: "'I am happy,' she said.", indirect: "She said that she was happy." },
                    { direct: "'I will come tomorrow,' he said.", indirect: "He said that he would come the next day." },
                    { direct: "'Do you like coffee?' she asked.", indirect: "She asked if I liked coffee." },
                    { direct: "'Close the door,' he told me.", indirect: "He told me to close the door." }
                ],
                indirectToDirect: [
                    { indirect: "She said that she was tired.", direct: "'I am tired,' she said." },
                    { indirect: "He said he would call me the next day.", direct: "'I will call you tomorrow,' he said." },
                    { indirect: "She asked if I had finished.", direct: "'Have you finished?' she asked." },
                    { indirect: "He told me to be quiet.", direct: "'Be quiet,' he told me." }
                ]
            };
            
            const randomExample = examples[conversionType][Math.floor(Math.random() * examples[conversionType].length)];
            
            let analysis = "";
            if (conversionType === 'directToIndirect') {
                analysis = `
                    <div style="margin-top: 15px; padding: 10px; background: var(--dark-surface); border-radius: 6px;">
                        <div style="font-weight: bold; color: var(--accent-amber); margin-bottom: 5px;">Conversion Analysis:</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            1. Removed quotation marks<br>
                            2. Changed 'said' to reporting verb<br>
                            3. Added 'that' (optional)<br>
                            4. Changed pronouns (I ‚Üí she)<br>
                            5. Changed tense (am ‚Üí was)<br>
                            6. Removed comma before reporting verb
                        </div>
                    </div>
                `;
            } else {
                analysis = `
                    <div style="margin-top: 15px; padding: 10px; background: var(--dark-surface); border-radius: 6px;">
                        <div style="font-weight: bold; color: var(--accent-amber); margin-bottom: 5px;">Conversion Analysis:</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            1. Added quotation marks<br>
                            2. Moved reporting verb to end<br>
                            3. Removed 'that'<br>
                            4. Changed pronouns (she ‚Üí I)<br>
                            5. Changed tense (was ‚Üí am)<br>
                            6. Added comma before reporting verb
                        </div>
                    </div>
                `;
            }
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Speech Conversion Example</div>
                    
                    <div class="before-after">
                        <div class="before-example">
                            <div class="example-title">${conversionType === 'directToIndirect' ? 'Direct Speech' : 'Indirect Speech'}</div>
                            <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                ${randomExample[conversionType === 'directToIndirect' ? 'direct' : 'indirect']}
                            </div>
                        </div>
                        <div class="after-example">
                            <div class="example-title">${conversionType === 'directToIndirect' ? 'Indirect Speech' : 'Direct Speech'}</div>
                            <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;">
                                ${randomExample[conversionType === 'directToIndirect' ? 'indirect' : 'direct']}
                            </div>
                        </div>
                    </div>
                    
                    ${analysis}
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Note:</strong> This is an example conversion. For your specific sentence, apply the conversion rules step by step.
                    </div>
                </div>
            `;
        };

        window.analyzeSpeech = function() {
            const speechInput = document.getElementById('speechInput');
            const builderDisplay = document.getElementById('builderDisplay');
            
            if (!speechInput || !builderDisplay) return;
            
            const input = speechInput.value.trim();
            
            if (!input) {
                builderDisplay.innerHTML = "Please enter speech to analyze.";
                return;
            }
            
            // Simple analysis
            const hasQuotes = input.includes("'") || input.includes('"');
            const hasSaid = input.toLowerCase().includes('said');
            const hasAsked = input.toLowerCase().includes('asked');
            const hasTold = input.toLowerCase().includes('told');
            const hasQuestionMark = input.includes('?');
            const hasExclamation = input.includes('!');
            
            let speechType = "Unknown";
            let analysis = "";
            
            if (hasQuotes && (hasSaid || hasAsked || hasTold)) {
                speechType = "Direct Speech";
                analysis = "Contains quotation marks and reporting verbs - likely direct speech.";
            } else if ((hasSaid || hasAsked || hasTold) && !hasQuotes && !hasQuestionMark) {
                speechType = "Indirect Speech";
                analysis = "Has reporting verbs but no quotation marks or question marks - likely indirect speech.";
            } else if (hasQuestionMark && !hasQuotes) {
                speechType = "Possible Reported Question";
                analysis = "Has question mark but no quotes - could be a reported question.";
            } else {
                speechType = "Unclear/Other";
                analysis = "Doesn't match clear direct or indirect speech patterns.";
            }
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.3rem; color: var(--primary-blue); margin-bottom: 15px;">Speech Analysis</div>
                    
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid var(--accent-purple);">
                        <div style="font-weight: bold; margin-bottom: 10px; color: var(--accent-purple);">Analysis Results:</div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0;">
                            <div style="background: var(--dark-surface); padding: 15px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: bold; color: var(--secondary-teal);">${speechType}</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">Speech Type</div>
                            </div>
                            
                            <div style="background: var(--dark-surface); padding: 15px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: bold; color: ${hasQuotes ? 'var(--accent-green)' : 'var(--accent-pink)'};">${hasQuotes ? 'Yes' : 'No'}</div>
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">Quotation Marks</div>
                            </div>
                        </div>
                        
                        <div style="background: var(--dark-surface); padding: 15px; border-radius: 6px; margin: 10px 0;">
                            <div style="font-weight: bold; color: var(--accent-amber); margin-bottom: 5px;">Analysis:</div>
                            <div style="color: var(--text-primary);">${analysis}</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Elements Found:</strong> ${hasQuotes ? 'Quotation marks, ' : ''}${hasSaid ? 'Said, ' : ''}${hasAsked ? 'Asked, ' : ''}${hasTold ? 'Told, ' : ''}${hasQuestionMark ? 'Question mark, ' : ''}${hasExclamation ? 'Exclamation mark' : ''}
                    </div>
                </div>
            `;
        };

        window.getPracticeSentence = function() {
            const speechInput = document.getElementById('speechInput');
            
            if (!speechInput) return;
            
            const practiceSentences = [
                "'I am going to the market,' she said.",
                "He told me that he would finish the work.",
                "'Do you know the answer?' the teacher asked.",
                "She said she had seen the movie the week before.",
                "'Close the window,' he told the children.",
                "They asked if we were coming to the party.",
                "'I can't believe it!' he exclaimed.",
                "She told him to be careful on the road."
            ];
            
            const randomSentence = practiceSentences[Math.floor(Math.random() * practiceSentences.length)];
            speechInput.value = randomSentence;
            speechInput.focus();
        };

        window.clearSpeechBuilder = function() {
            const speechInput = document.getElementById('speechInput');
            const builderDisplay = document.getElementById('builderDisplay');
            
            if (speechInput) speechInput.value = '';
            if (builderDisplay) {
                builderDisplay.innerHTML = "Your speech conversion will appear here...";
            }
        };

        window.showSkillDemo = function(skillName) {
            const builderDisplay = document.getElementById('builderDisplay');
            
            const skill = speechSkills.find(s => s.name === skillName);
            if (!skill || !builderDisplay) return;
            
            builderDisplay.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; color: ${skill.color}; margin-bottom: 15px;">
                        ${skill.icon} ${skill.name} Details
                    </div>
                    
                    <div style="background: rgba(${parseInt(skill.color.slice(1,3), 16)}, ${parseInt(skill.color.slice(3,5), 16)}, ${parseInt(skill.color.slice(5,7), 16)}, 0.1); padding: 20px; border-radius: 8px; margin: 15px 0; border: 2px solid ${skill.color};">
                        <div style="font-weight: bold; margin-bottom: 10px; color: ${skill.color};">Definition:</div>
                        <div style="margin-bottom: 15px;">${skill.description}</div>
                        
                        <div style="font-weight: bold; margin-bottom: 10px; color: ${skill.color};">Key Characteristics:</div>
                        <div style="margin-bottom: 15px;">${skill.characteristics}</div>
                        
                        <div style="font-weight: bold; margin-bottom: 10px; color: ${skill.color};">Examples:</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                            <div style="padding: 8px 12px; background: var(--dark-surface); border-radius: 20px; border: 1px solid ${skill.color}; color: ${skill.color};">
                                ${skill.examples}
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Practice Tip:</strong> ${getSkillPracticeTip(skillName)}
                    </div>
                </div>
            `;
        };

        function getSkillPracticeTip(skillName) {
            const tips = {
                "Direct Speech": "Practice by writing dialogue for short stories or plays.",
                "Indirect Speech": "Try summarizing conversations you hear or read.",
                "Pronoun Changes": "Take sentences and change the perspective (I ‚Üí he/she, you ‚Üí I, etc.).",
                "Tense Shifts": "Practice converting present tense sentences to past tense.",
                "Time Expressions": "Make lists of time words and their indirect speech equivalents.",
                "Place References": "Practice changing 'here' to 'there', 'this' to 'that', etc.",
                "Reported Questions": "Convert direct questions to indirect speech and vice versa.",
                "Reported Commands": "Practice changing commands to 'told/asked + to + infinitive' form."
            };
            return tips[skillName] || "Practice this skill with different types of sentences regularly.";
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            writingFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            writingFact.appendChild(createWritingFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createSpeechVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin your speech conversion journey!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
