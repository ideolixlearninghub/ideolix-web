<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 9 Math - Algebraic Expressions & Factorisation | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Algebra Theme */
        :root {
            --expressions-blue: #2196F3;
            --simplify-green: #4CAF50;
            --factorise-purple: #9C27B0;
            --expand-orange: #FF9800;
            --formulas-red: #F44336;
            --applications-teal: #009688;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --algebra-glow: 0 0 20px rgba(33, 150, 243, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(33, 150, 243, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(76, 175, 80, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(156, 39, 176, 0.05) 0%, transparent 50%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            border-radius: 10px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info h1 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 30px 20px;
        }

        .welcome-title {
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--expressions-blue), var(--simplify-green), var(--factorise-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 25px;
            max-width: 800px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(33, 150, 243, 0.15);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 20px;
            border: 2px solid var(--expressions-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--expressions-blue);
        }

        /* Algebra Symbols */
        .algebra-symbol {
            font-family: 'Cambria Math', 'Times New Roman', serif;
            font-weight: bold;
        }

        .variable {
            color: var(--expressions-blue);
            font-style: italic;
        }

        .coefficient {
            color: var(--simplify-green);
        }

        .exponent {
            font-size: 0.8em;
            vertical-align: super;
            color: var(--factorise-purple);
        }

        /* Concepts Grid */
        .concepts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin: 25px 0;
        }

        @media (max-width: 768px) {
            .concepts-grid {
                grid-template-columns: 1fr;
            }
        }

        .concept-card {
            background: var(--dark-surface);
            border-radius: 16px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .concept-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
        }

        .concept-card.expressions {
            border-color: var(--expressions-blue);
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), transparent);
        }

        .concept-card.simplify {
            border-color: var(--simplify-green);
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), transparent);
        }

        .concept-card.factorise {
            border-color: var(--factorise-purple);
            background: linear-gradient(135deg, rgba(156, 39, 176, 0.1), transparent);
        }

        .concept-card.expand {
            border-color: var(--expand-orange);
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), transparent);
        }

        .concept-card.formulas {
            border-color: var(--formulas-red);
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.1), transparent);
        }

        .concept-card.applications {
            border-color: var(--applications-teal);
            background: linear-gradient(135deg, rgba(0, 150, 136, 0.1), transparent);
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .concept-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .concept-card.expressions .concept-title {
            color: var(--expressions-blue);
        }

        .concept-card.simplify .concept-title {
            color: var(--simplify-green);
        }

        .concept-card.factorise .concept-title {
            color: var(--factorise-purple);
        }

        .concept-card.expand .concept-title {
            color: var(--expand-orange);
        }

        .concept-card.formulas .concept-title {
            color: var(--formulas-red);
        }

        .concept-card.applications .concept-title {
            color: var(--applications-teal);
        }

        .concept-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.6;
            flex-grow: 1;
        }

        .concept-examples {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--dark-border);
        }

        .concept-examples h4 {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .example-list {
            list-style-type: none;
        }

        .example-list li {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 6px;
            padding-left: 20px;
            position: relative;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        .example-list li:before {
            content: "â†’";
            position: absolute;
            left: 0;
            color: var(--expressions-blue);
            font-weight: bold;
        }

        /* Input Group */
        .input-group {
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            font-size: 1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--expressions-blue);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--expressions-blue);
            color: white;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }

        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(33, 150, 243, 0.4);
        }

        .btn-green {
            background: var(--simplify-green);
            color: white;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .btn-green:hover {
            background: #388E3C;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
        }

        .btn-purple {
            background: var(--factorise-purple);
            color: white;
            box-shadow: 0 4px 12px rgba(156, 39, 176, 0.3);
        }

        .btn-purple:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(156, 39, 176, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--expressions-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Page */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 20px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 8px;
            background: var(--dark-surface);
            border-radius: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--expressions-blue), var(--simplify-green), var(--factorise-purple));
            border-radius: 8px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }

        .question-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--text-primary);
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        .algebra-tip {
            background: rgba(255, 152, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid var(--expand-orange);
            font-style: italic;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Options */
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin: 20px 0;
        }

        .option {
            padding: 15px;
            background: var(--dark-card);
            border: 2px solid var(--dark-border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        .option:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--expressions-blue);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--simplify-green);
            color: var(--simplify-green);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: var(--formulas-red);
            color: var(--formulas-red);
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 25px;
            height: 25px;
            background: var(--expressions-blue);
            border-radius: 50%;
            margin-right: 12px;
            font-weight: bold;
            color: white;
        }

        .option.correct .option-letter {
            background: var(--simplify-green);
        }

        .option.incorrect .option-letter {
            background: var(--formulas-red);
        }

        /* Feedback */
        .feedback-container {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 4px solid var(--simplify-green);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 4px solid var(--formulas-red);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--simplify-green);
        }

        .feedback-incorrect .feedback-icon {
            background: var(--formulas-red);
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .feedback-correct .feedback-title {
            color: var(--simplify-green);
        }

        .feedback-incorrect .feedback-title {
            color: var(--formulas-red);
        }

        .feedback-explanation {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Navigation */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Side */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--dark-border);
            overflow: auto;
            max-height: 800px;
        }

        /* Algebra Visualizers */
        .algebra-visualizer {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid;
        }

        .visualizer-title {
            color: inherit;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .algebra-example {
            background: var(--dark-surface);
            border-radius: 6px;
            padding: 12px;
            margin: 10px 0;
            font-size: 1rem;
            line-height: 1.5;
            font-family: 'Cambria Math', 'Times New Roman', serif;
            text-align: center;
        }

        .highlight-algebra {
            background: rgba(255, 193, 7, 0.3);
            padding: 2px 4px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Step-by-Step Solver */
        .solver-section {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--expressions-blue);
        }

        .solver-display {
            background: var(--dark-surface);
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            font-size: 1rem;
            line-height: 1.6;
            min-height: 100px;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        .solver-step {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .solver-step:before {
            content: "â†’";
            position: absolute;
            left: 0;
            color: var(--expressions-blue);
        }

        /* Simplification Practice */
        .simplify-section {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--simplify-green);
        }

        .simplify-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
            justify-content: center;
        }

        /* Factorisation Practice */
        .factorise-section {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--factorise-purple);
        }

        .factorise-display {
            background: var(--dark-surface);
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            font-size: 1rem;
            line-height: 1.6;
            text-align: center;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        /* Expansion Practice */
        .expand-section {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--expand-orange);
        }

        .expand-input {
            width: 100%;
            height: 80px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 6px;
            padding: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            line-height: 1.5;
            resize: vertical;
            margin: 10px 0;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        .expand-input:focus {
            outline: none;
            border-color: var(--expand-orange);
        }

        /* Formulas Practice */
        .formulas-section {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--formulas-red);
        }

        .formula-controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .formula-controls {
                grid-template-columns: 1fr;
            }
        }

        .formula-button {
            padding: 10px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
        }

        .formula-button:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--formulas-red);
            transform: scale(1.05);
        }

        /* Applications */
        .applications-section {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--applications-teal);
        }

        .application-problem {
            background: var(--dark-surface);
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Comparison */
        .comparison-section {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid var(--formulas-red);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--dark-surface);
            border-radius: 6px;
            overflow: hidden;
        }

        .comparison-table th {
            background: var(--dark-card);
            padding: 12px;
            text-align: left;
            font-size: 0.9rem;
            border-bottom: 2px solid var(--formulas-red);
            color: var(--formulas-red);
        }

        .comparison-table td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
            font-size: 0.85rem;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        .comparison-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 30px 20px;
        }

        .results-title {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--expressions-blue), var(--simplify-green), var(--factorise-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            margin: 0 auto 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--expressions-blue), var(--simplify-green), var(--factorise-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--expressions-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Algebra Badge */
        .algebra-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 8px;
            text-transform: uppercase;
        }

        .expressions-badge {
            background: rgba(33, 150, 243, 0.2);
            color: var(--expressions-blue);
        }

        .simplify-badge {
            background: rgba(76, 175, 80, 0.2);
            color: var(--simplify-green);
        }

        .factorise-badge {
            background: rgba(156, 39, 176, 0.2);
            color: var(--factorise-purple);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        @keyframes highlight {
            0% { background-color: transparent; }
            50% { background-color: rgba(33, 150, 243, 0.2); }
            100% { background-color: transparent; }
        }

        .highlight {
            animation: highlight 1s ease;
        }

        @keyframes algebraGlow {
            0% { box-shadow: 0 0 5px currentColor; }
            50% { box-shadow: 0 0 20px currentColor; }
            100% { box-shadow: 0 0 5px currentColor; }
        }

        .algebra-glow {
            animation: algebraGlow 2s infinite;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 1.8rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .formula-controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <h1 class="welcome-title">Grade 9 Mathematics: Algebraic Expressions & Factorisation</h1>
            <p class="welcome-subtitle">Master the language of algebra! Learn to simplify, expand, factorise, and manipulate algebraic expressions. Understand how these skills form the foundation for solving equations and real-world problems.</p>
            
            <div class="topic-badge">
                <span class="topic-icon">xÂ² + âˆ’ Ã— Ã·</span>
                <span class="topic-name">Expressions, Simplification, Expansion, Factorisation</span>
            </div>
            
            <div class="concepts-grid">
                <div class="concept-card expressions" onclick="showConceptDetail('expressions')">
                    <div class="concept-icon">x</div>
                    <h3 class="concept-title">Algebraic Expressions</h3>
                    <p class="concept-description">Combinations of variables, constants, and operations that represent mathematical relationships.</p>
                    <div class="concept-examples">
                        <h4>Examples:</h4>
                        <ul class="example-list">
                            <li>3x + 4</li>
                            <li>2xÂ² - 5x + 1</li>
                            <li>4ab - 2a + 3b</li>
                        </ul>
                    </div>
                </div>
                
                <div class="concept-card simplify" onclick="showConceptDetail('simplify')">
                    <div class="concept-icon">=</div>
                    <h3 class="concept-title">Simplifying Expressions</h3>
                    <p class="concept-description">Combining like terms to write expressions in their simplest form.</p>
                    <div class="concept-examples">
                        <h4>Examples:</h4>
                        <ul class="example-list">
                            <li>2x + 3x = 5x</li>
                            <li>4a - 2a = 2a</li>
                            <li>xÂ² + 3xÂ² = 4xÂ²</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card factorise" onclick="showConceptDetail('factorise')">
                    <div class="concept-icon">( )</div>
                    <h3 class="concept-title">Factorisation</h3>
                    <p class="concept-description">Breaking down expressions into products of simpler expressions.</p>
                    <div class="concept-examples">
                        <h4>Examples:</h4>
                        <ul class="example-list">
                            <li>2x + 4 = 2(x + 2)</li>
                            <li>xÂ² - 9 = (x-3)(x+3)</li>
                            <li>xÂ² + 5x + 6 = (x+2)(x+3)</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card expand" onclick="showConceptDetail('expand')">
                    <div class="concept-icon">â†’</div>
                    <h3 class="concept-title">Expanding Brackets</h3>
                    <p class="concept-description">Removing brackets by multiplying terms using distributive law.</p>
                    <div class="concept-examples">
                        <h4>Examples:</h4>
                        <ul class="example-list">
                            <li>2(x+3) = 2x + 6</li>
                            <li>(x+2)(x+3) = xÂ²+5x+6</li>
                            <li>(a+b)Â² = aÂ²+2ab+bÂ²</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card formulas" onclick="showConceptDetail('formulas')">
                    <div class="concept-icon">aÂ²-bÂ²</div>
                    <h3 class="concept-title">Algebraic Formulas</h3>
                    <p class="concept-description">Important identities and formulas for quick expansion and factorisation.</p>
                    <div class="concept-examples">
                        <h4>Examples:</h4>
                        <ul class="example-list">
                            <li>(a+b)Â² = aÂ²+2ab+bÂ²</li>
                            <li>(a-b)Â² = aÂ²-2ab+bÂ²</li>
                            <li>aÂ²-bÂ² = (a-b)(a+b)</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card applications" onclick="showConceptDetail('applications')">
                    <div class="concept-icon">â–³</div>
                    <h3 class="concept-title">Real Applications</h3>
                    <p class="concept-description">Using algebraic expressions to solve geometry, physics, and real-world problems.</p>
                    <div class="concept-examples">
                        <h4>Examples:</h4>
                        <ul class="example-list">
                            <li>Area formulas</li>
                            <li>Perimeter calculations</li>
                            <li>Cost calculations</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your name:</label>
                <input type="text" id="studentName" placeholder="Your name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>ðŸ“š Begin Algebra Practice</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 80</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1.25%"></div>
                </div>
            </div>

            <div class="question-container">
                <div id="algebraTip"></div>
                
                <h2 class="question-text" id="questionText"></h2>
                
                <div class="options-container" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-explanation" id="feedbackExplanation"></div>
                </div>
            </div>
            
            <!-- Visualization Area -->
            <div class="content-wrapper">
                <div class="visualization-container">
                    <!-- Step-by-Step Solver -->
                    <div class="solver-section">
                        <div class="visualizer-title">Algebra Step-by-Step Solver</div>
                        <div class="solver-display" id="solverDisplay">
                            Enter an algebraic expression to see step-by-step solution
                        </div>
                        
                        <div class="simplify-controls">
                            <input type="text" id="solverInput" placeholder="e.g., 2(x+3) + 4x" style="flex-grow: 1; padding: 10px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 6px; color: var(--text-primary);">
                            <button class="btn btn-small btn-primary" onclick="solveAlgebra()">Solve</button>
                            <button class="btn btn-small btn-outline" onclick="clearSolver()">Clear</button>
                        </div>
                        
                        <div id="solverResult" style="margin-top: 10px; color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                            Enter expression and click Solve
                        </div>
                    </div>
                    
                    <!-- Simplification Practice -->
                    <div class="simplify-section">
                        <div class="visualizer-title">Simplify Expressions</div>
                        <div class="factorise-display" id="simplifyDisplay">
                            Simplify: 3x + 2x + 5
                        </div>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-green" onclick="checkSimplify('5x+5')">5x+5</button>
                            <button class="btn btn-small btn-outline" onclick="checkSimplify('6x+5')">6x+5</button>
                            <button class="btn btn-small btn-outline" onclick="checkSimplify('5x+6')">5x+6</button>
                            <button class="btn btn-small btn-outline" onclick="checkSimplify('3x+7')">3x+7</button>
                        </div>
                        
                        <div id="simplifyFeedback" style="margin: 10px 0; color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                            Combine like terms (terms with same variable and exponent)
                        </div>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-outline" onclick="newSimplify()">New Problem</button>
                            <button class="btn btn-small btn-outline" onclick="showSimplifySteps()">Show Steps</button>
                        </div>
                    </div>
                    
                    <!-- Factorisation Practice -->
                    <div class="factorise-section">
                        <div class="visualizer-title">Factorise Expressions</div>
                        <div class="factorise-display" id="factoriseDisplay">
                            Factorise: 2x + 6
                        </div>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-purple" onclick="checkFactorise('2(x+3)')">2(x+3)</button>
                            <button class="btn btn-small btn-outline" onclick="checkFactorise('2(x+6)')">2(x+6)</button>
                            <button class="btn btn-small btn-outline" onclick="checkFactorise('x(2+6)')">x(2+6)</button>
                            <button class="btn btn-small btn-outline" onclick="checkFactorise('(x+2)(x+3)')">(x+2)(x+3)</button>
                        </div>
                        
                        <div id="factoriseFeedback" style="margin: 10px 0; color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                            Find the highest common factor (HCF)
                        </div>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-outline" onclick="newFactorise()">New Problem</button>
                            <button class="btn btn-small btn-purple" onclick="explainFactorise()">Explain Method</button>
                        </div>
                    </div>
                    
                    <!-- Expansion Practice -->
                    <div class="expand-section">
                        <div class="visualizer-title">Expand Brackets</div>
                        <div style="margin-bottom: 10px; color: var(--text-secondary); text-align: center;">
                            Expand: <span id="expandPrompt" style="color: var(--expand-orange); font-weight: bold; font-family: 'Cambria Math';">2(x + 3)</span>
                        </div>
                        
                        <textarea class="expand-input" id="expandInput" placeholder="Enter your answer..."></textarea>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-purple" onclick="checkExpansion()">Check Answer</button>
                            <button class="btn btn-small btn-outline" onclick="newExpansion()">New Problem</button>
                            <button class="btn btn-small btn-outline" onclick="showExpansionExample()">Example</button>
                        </div>
                        
                        <div id="expansionFeedback" style="margin-top: 10px; color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                            Multiply each term inside brackets by the term outside
                        </div>
                    </div>
                    
                    <!-- Formulas Practice -->
                    <div class="formulas-section">
                        <div class="visualizer-title">Algebraic Formulas</div>
                        
                        <div class="formula-controls">
                            <div class="formula-button" onclick="showFormula('squareSum')">
                                <div style="font-size: 1.2rem; margin-bottom: 5px;">(a+b)Â²</div>
                                Square of Sum
                            </div>
                            <div class="formula-button" onclick="showFormula('squareDiff')">
                                <div style="font-size: 1.2rem; margin-bottom: 5px;">(a-b)Â²</div>
                                Square of Difference
                            </div>
                            <div class="formula-button" onclick="showFormula('diffSquares')">
                                <div style="font-size: 1.2rem; margin-bottom: 5px;">aÂ²-bÂ²</div>
                                Difference of Squares
                            </div>
                            <div class="formula-button" onclick="showFormula('distributive')">
                                <div style="font-size: 1.2rem; margin-bottom: 5px;">a(b+c)</div>
                                Distributive Law
                            </div>
                        </div>
                        
                        <div id="formulaExample" style="margin: 15px 0; padding: 10px; background: var(--dark-card); border-radius: 6px; text-align: center; font-size: 0.9rem; font-family: 'Cambria Math';">
                            Click a formula to see examples
                        </div>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-outline" onclick="practiceFormula()">Practice Formula</button>
                            <button class="btn btn-small btn-outline" onclick="explainAllFormulas()">All Formulas</button>
                        </div>
                    </div>
                    
                    <!-- Applications -->
                    <div class="applications-section">
                        <div class="visualizer-title">Real-World Applications</div>
                        
                        <div class="application-problem" id="applicationProblem">
                            A rectangle has length (x+3) cm and width (x+2) cm. What is its area?
                        </div>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-green" onclick="checkApplication('xÂ²+5x+6 cmÂ²')">xÂ²+5x+6 cmÂ²</button>
                            <button class="btn btn-small btn-outline" onclick="checkApplication('2x+5 cmÂ²')">2x+5 cmÂ²</button>
                            <button class="btn btn-small btn-outline" onclick="checkApplication('xÂ²+6 cmÂ²')">xÂ²+6 cmÂ²</button>
                            <button class="btn btn-small btn-outline" onclick="checkApplication('5x+6 cmÂ²')">5x+6 cmÂ²</button>
                        </div>
                        
                        <div id="applicationFeedback" style="margin: 10px 0; color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                            Area = length Ã— width = (x+3)(x+2)
                        </div>
                        
                        <div class="simplify-controls">
                            <button class="btn btn-small btn-outline" onclick="newApplication()">New Problem</button>
                            <button class="btn btn-small btn-outline" onclick="showApplicationSolution()">Show Solution</button>
                        </div>
                    </div>
                    
                    <!-- Comparison Table -->
                    <div class="comparison-section">
                        <div class="visualizer-title">Comparing Algebraic Processes</div>
                        
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Process</th>
                                    <th>What it does</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr onclick="explainProcess('simplify')">
                                    <td>Simplify</td>
                                    <td>Combine like terms</td>
                                    <td>2x+3x â†’ 5x</td>
                                </tr>
                                <tr onclick="explainProcess('expand')">
                                    <td>Expand</td>
                                    <td>Remove brackets</td>
                                    <td>2(x+3) â†’ 2x+6</td>
                                </tr>
                                <tr onclick="explainProcess('factorise')">
                                    <td>Factorise</td>
                                    <td>Put into brackets</td>
                                    <td>2x+6 â†’ 2(x+3)</td>
                                </tr>
                                <tr onclick="explainProcess('evaluate')">
                                    <td>Evaluate</td>
                                    <td>Substitute values</td>
                                    <td>2x+3 when x=4 â†’ 11</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div id="processDetail" style="margin-top: 15px; padding: 10px; background: var(--dark-surface); border-radius: 6px; color: var(--text-secondary); font-size: 0.85rem; display: none;">
                            Click a process for detailed explanation
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Algebra Practice Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="expressionsScore">0</div>
                        <div class="stat-label">Expressions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="simplifyScore">0</div>
                        <div class="stat-label">Simplification</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="factoriseScore">0</div>
                        <div class="stat-label">Factorisation</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="timeSpent">0min</div>
                        <div class="stat-label">Time Spent</div>
                    </div>
                </div>
                
                <div class="btn-group" style="margin-top: 20px;">
                    <button class="btn btn-primary" id="retryTopic">Try Again</button>
                    <button class="btn btn-green" id="viewTopics">Other Topics</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive questions array - 80+ questions on Algebraic Expressions
        const questions = [
            // Basic Algebraic Expressions (1-15)
            {
                question: "What is an algebraic expression?",
                options: ["A combination of variables, constants, and operations", "An equation with an equal sign", "A number only", "A word problem"],
                answer: "A",
                explanation: "An algebraic expression contains variables, constants, and operations but no equal sign.",
                type: "expressions"
            },
            {
                question: "In 3x + 5, what is 3 called?",
                options: ["Coefficient", "Constant", "Variable", "Exponent"],
                answer: "A",
                explanation: "3 is the coefficient - it multiplies the variable x.",
                type: "expressions"
            },
            {
                question: "In 3x + 5, what is 5 called?",
                options: ["Constant term", "Coefficient", "Variable", "Exponent"],
                answer: "A",
                explanation: "5 is the constant term - it doesn't change with the variable.",
                type: "expressions"
            },
            {
                question: "What is the variable in 4y - 2?",
                options: ["y", "4", "-2", "4y"],
                answer: "A",
                explanation: "y is the variable - it can represent different values.",
                type: "expressions"
            },
            {
                question: "Which is NOT an algebraic expression?",
                options: ["5 = 2x + 1", "3x + 4", "2a - 5", "xÂ² + 2x"],
                answer: "A",
                explanation: "5 = 2x + 1 is an equation (has equal sign), not just an expression.",
                type: "expressions"
            },
            {
                question: "How many terms in 2x + 3y - 5?",
                options: ["3", "2", "1", "4"],
                answer: "A",
                explanation: "Terms: 2x, 3y, and -5. Three terms separated by + or -.",
                type: "expressions"
            },
            {
                question: "Which are like terms?",
                options: ["3x and 5x", "3x and 3y", "xÂ² and x", "2 and 2x"],
                answer: "A",
                explanation: "Like terms have the same variable(s) with same exponent. 3x and 5x both have x to power 1.",
                type: "expressions"
            },
            {
                question: "What is the degree of 3xÂ² + 2x + 1?",
                options: ["2", "3", "1", "0"],
                answer: "A",
                explanation: "Degree is the highest exponent of the variable. xÂ² has exponent 2.",
                type: "expressions"
            },
            {
                question: "Which is a binomial?",
                options: ["x + 3", "3x", "x + y + z", "4"],
                answer: "A",
                explanation: "Binomial has two terms. x + 3 has terms x and 3.",
                type: "expressions"
            },
            {
                question: "Which is a monomial?",
                options: ["5x", "x + 2", "a + b + c", "xÂ² - 4"],
                answer: "A",
                explanation: "Monomial has one term. 5x is a single term.",
                type: "expressions"
            },
            {
                question: "Which is a trinomial?",
                options: ["xÂ² + 2x + 1", "2x", "x + y", "3"],
                answer: "A",
                explanation: "Trinomial has three terms. xÂ² + 2x + 1 has three terms.",
                type: "expressions"
            },
            {
                question: "What is the coefficient of x in -5x?",
                options: ["-5", "5", "1", "0"],
                answer: "A",
                explanation: "The coefficient is -5 (including the sign).",
                type: "expressions"
            },
            {
                question: "Evaluate 2x + 3 when x = 4",
                options: ["11", "14", "5", "24"],
                answer: "A",
                explanation: "2(4) + 3 = 8 + 3 = 11",
                type: "expressions"
            },
            {
                question: "What does 3ab mean?",
                options: ["3 Ã— a Ã— b", "3 + a + b", "3 divided by a and b", "3 to the power a and b"],
                answer: "A",
                explanation: "In algebra, adjacent letters/numbers mean multiplication: 3ab = 3 Ã— a Ã— b",
                type: "expressions"
            },
            {
                question: "Which represents '5 more than x'?",
                options: ["x + 5", "5x", "x - 5", "5 - x"],
                answer: "A",
                explanation: "'5 more than x' means add 5 to x: x + 5",
                type: "expressions"
            },

            // Simplification Questions (16-30)
            {
                question: "Simplify: 2x + 3x",
                options: ["5x", "6x", "5xÂ²", "6"],
                answer: "A",
                explanation: "Add coefficients of like terms: 2x + 3x = (2+3)x = 5x",
                type: "simplify"
            },
            {
                question: "Simplify: 4a - 2a",
                options: ["2a", "2", "6a", "2aÂ²"],
                answer: "A",
                explanation: "4a - 2a = (4-2)a = 2a",
                type: "simplify"
            },
            {
                question: "Simplify: 3x + 4 + 2x - 1",
                options: ["5x + 3", "5x + 5", "6x + 3", "x + 3"],
                answer: "A",
                explanation: "3x + 2x = 5x, 4 - 1 = 3. So 5x + 3",
                type: "simplify"
            },
            {
                question: "Simplify: xÂ² + 3xÂ²",
                options: ["4xÂ²", "3xâ´", "4x", "3xÂ²"],
                answer: "A",
                explanation: "xÂ² + 3xÂ² = (1+3)xÂ² = 4xÂ²",
                type: "simplify"
            },
            {
                question: "Simplify: 5y - y",
                options: ["4y", "5", "4", "5yÂ²"],
                answer: "A",
                explanation: "5y - y = (5-1)y = 4y (y means 1y)",
                type: "simplify"
            },
            {
                question: "Simplify: 2a + 3b + a - b",
                options: ["3a + 2b", "3a + 4b", "a + 2b", "3a - 2b"],
                answer: "A",
                explanation: "2a + a = 3a, 3b - b = 2b. So 3a + 2b",
                type: "simplify"
            },
            {
                question: "Simplify: 4x + 3 - 2x + 5",
                options: ["2x + 8", "2x - 2", "6x + 8", "2x + 2"],
                answer: "A",
                explanation: "4x - 2x = 2x, 3 + 5 = 8. So 2x + 8",
                type: "simplify"
            },
            {
                question: "Simplify: x + x + x",
                options: ["3x", "xÂ³", "3", "x + 3"],
                answer: "A",
                explanation: "x + x + x = 3x",
                type: "simplify"
            },
            {
                question: "Simplify: 5 - 2x + 3 + x",
                options: ["8 - x", "8 - 3x", "2 - x", "8 + x"],
                answer: "A",
                explanation: "5 + 3 = 8, -2x + x = -x. So 8 - x",
                type: "simplify"
            },
            {
                question: "Simplify: 3aÂ² + 2aÂ² - aÂ²",
                options: ["4aÂ²", "5aÂ²", "6aÂ²", "aÂ²"],
                answer: "A",
                explanation: "3aÂ² + 2aÂ² - aÂ² = (3+2-1)aÂ² = 4aÂ²",
                type: "simplify"
            },
            {
                question: "Simplify: 2x + 3y + 4x - y",
                options: ["6x + 2y", "6x + 4y", "2x + 2y", "6x - 2y"],
                answer: "A",
                explanation: "2x + 4x = 6x, 3y - y = 2y. So 6x + 2y",
                type: "simplify"
            },
            {
                question: "Simplify: 5 - (x + 2)",
                options: ["3 - x", "7 - x", "3 + x", "5 - x - 2"],
                answer: "A",
                explanation: "5 - (x + 2) = 5 - x - 2 = 3 - x",
                type: "simplify"
            },
            {
                question: "Simplify: 3(x + 2) + 2(x - 1)",
                options: ["5x + 4", "5x + 8", "x + 4", "5x"],
                answer: "A",
                explanation: "3(x+2) = 3x+6, 2(x-1) = 2x-2. Sum: 5x + 4",
                type: "simplify"
            },
            {
                question: "Simplify: 2a + 3b - a + 2b",
                options: ["a + 5b", "a + b", "3a + 5b", "a - 5b"],
                answer: "A",
                explanation: "2a - a = a, 3b + 2b = 5b. So a + 5b",
                type: "simplify"
            },
            {
                question: "Simplify: xÂ² + 2x + 3xÂ² - x",
                options: ["4xÂ² + x", "4xÂ² - x", "3xÂ² + x", "4x + xÂ²"],
                answer: "A",
                explanation: "xÂ² + 3xÂ² = 4xÂ², 2x - x = x. So 4xÂ² + x",
                type: "simplify"
            },

            // Factorisation Questions (31-45)
            {
                question: "Factorise: 2x + 4",
                options: ["2(x + 2)", "2(x + 4)", "x(2 + 4)", "4(x + 2)"],
                answer: "A",
                explanation: "HCF of 2x and 4 is 2. So 2x + 4 = 2(x + 2)",
                type: "factorise"
            },
            {
                question: "Factorise: 3a - 6",
                options: ["3(a - 2)", "3(a - 6)", "a(3 - 6)", "6(a - 1)"],
                answer: "A",
                explanation: "HCF of 3a and 6 is 3. So 3a - 6 = 3(a - 2)",
                type: "factorise"
            },
            {
                question: "Factorise: 5x + 10",
                options: ["5(x + 2)", "5(x + 10)", "x(5 + 10)", "10(x + 1)"],
                answer: "A",
                explanation: "HCF of 5x and 10 is 5. So 5x + 10 = 5(x + 2)",
                type: "factorise"
            },
            {
                question: "Factorise: 4y - 8",
                options: ["4(y - 2)", "4(y - 8)", "y(4 - 8)", "8(y - 1)"],
                answer: "A",
                explanation: "HCF of 4y and 8 is 4. So 4y - 8 = 4(y - 2)",
                type: "factorise"
            },
            {
                question: "Factorise: xÂ² + 3x",
                options: ["x(x + 3)", "x(x + 3x)", "xÂ²(1 + 3)", "3x(x + 1)"],
                answer: "A",
                explanation: "HCF of xÂ² and 3x is x. So xÂ² + 3x = x(x + 3)",
                type: "factorise"
            },
            {
                question: "Factorise: 2aÂ² + 4a",
                options: ["2a(a + 2)", "2a(a + 4)", "a(2a + 4)", "4a(a + 1)"],
                answer: "A",
                explanation: "HCF of 2aÂ² and 4a is 2a. So 2aÂ² + 4a = 2a(a + 2)",
                type: "factorise"
            },
            {
                question: "Factorise: 6x - 9",
                options: ["3(2x - 3)", "3(2x - 9)", "6(x - 1.5)", "9(2x/3 - 1)"],
                answer: "A",
                explanation: "HCF of 6x and 9 is 3. So 6x - 9 = 3(2x - 3)",
                type: "factorise"
            },
            {
                question: "Factorise: 8y + 12",
                options: ["4(2y + 3)", "4(2y + 12)", "8(y + 1.5)", "2(4y + 6)"],
                answer: "A",
                explanation: "HCF of 8y and 12 is 4. So 8y + 12 = 4(2y + 3)",
                type: "factorise"
            },
            {
                question: "Factorise: ab + ac",
                options: ["a(b + c)", "b(a + c)", "c(a + b)", "a + b + c"],
                answer: "A",
                explanation: "HCF of ab and ac is a. So ab + ac = a(b + c)",
                type: "factorise"
            },
            {
                question: "Factorise: 5xÂ² - 10x",
                options: ["5x(x - 2)", "5x(x - 10)", "x(5x - 10)", "10x(0.5x - 1)"],
                answer: "A",
                explanation: "HCF of 5xÂ² and 10x is 5x. So 5xÂ² - 10x = 5x(x - 2)",
                type: "factorise"
            },
            {
                question: "Factorise: 3xy + 6y",
                options: ["3y(x + 2)", "3y(x + 6)", "y(3x + 6)", "6y(x/2 + 1)"],
                answer: "A",
                explanation: "HCF of 3xy and 6y is 3y. So 3xy + 6y = 3y(x + 2)",
                type: "factorise"
            },
            {
                question: "Factorise: 4a - 2",
                options: ["2(2a - 1)", "2(2a - 2)", "4(a - 0.5)", "2(2a)"],
                answer: "A",
                explanation: "HCF of 4a and 2 is 2. So 4a - 2 = 2(2a - 1)",
                type: "factorise"
            },
            {
                question: "Factorise: xÂ² - x",
                options: ["x(x - 1)", "x(x - x)", "xÂ²(1 - 1/x)", "x(1 - 1)"],
                answer: "A",
                explanation: "HCF of xÂ² and x is x. So xÂ² - x = x(x - 1)",
                type: "factorise"
            },
            {
                question: "Factorise: 12x + 18",
                options: ["6(2x + 3)", "6(2x + 18)", "12(x + 1.5)", "3(4x + 6)"],
                answer: "A",
                explanation: "HCF of 12x and 18 is 6. So 12x + 18 = 6(2x + 3)",
                type: "factorise"
            },
            {
                question: "What is factorisation?",
                options: ["Writing as product of factors", "Simplifying expressions", "Solving equations", "Adding terms"],
                answer: "A",
                explanation: "Factorisation means writing an expression as a product of its factors.",
                type: "factorise"
            },

            // Expansion Questions (46-60)
            {
                question: "Expand: 2(x + 3)",
                options: ["2x + 6", "2x + 3", "x + 6", "2x + 5"],
                answer: "A",
                explanation: "2(x + 3) = 2Ã—x + 2Ã—3 = 2x + 6",
                type: "expand"
            },
            {
                question: "Expand: 3(a - 2)",
                options: ["3a - 6", "3a - 2", "a - 6", "3a + 6"],
                answer: "A",
                explanation: "3(a - 2) = 3Ã—a - 3Ã—2 = 3a - 6",
                type: "expand"
            },
            {
                question: "Expand: 4(2x + 1)",
                options: ["8x + 4", "8x + 1", "2x + 4", "8x"],
                answer: "A",
                explanation: "4(2x + 1) = 4Ã—2x + 4Ã—1 = 8x + 4",
                type: "expand"
            },
            {
                question: "Expand: 5(3 - y)",
                options: ["15 - 5y", "15 - y", "3 - 5y", "15y"],
                answer: "A",
                explanation: "5(3 - y) = 5Ã—3 - 5Ã—y = 15 - 5y",
                type: "expand"
            },
            {
                question: "Expand: x(x + 4)",
                options: ["xÂ² + 4x", "x + 4x", "xÂ² + 4", "2x + 4"],
                answer: "A",
                explanation: "x(x + 4) = xÃ—x + xÃ—4 = xÂ² + 4x",
                type: "expand"
            },
            {
                question: "Expand: 2x(x - 3)",
                options: ["2xÂ² - 6x", "2x - 6x", "2xÂ² - 3", "xÂ² - 6x"],
                answer: "A",
                explanation: "2x(x - 3) = 2xÃ—x - 2xÃ—3 = 2xÂ² - 6x",
                type: "expand"
            },
            {
                question: "Expand: (x + 2)(x + 3)",
                options: ["xÂ² + 5x + 6", "xÂ² + 6", "2x + 5", "xÂ² + 5x"],
                answer: "A",
                explanation: "(x+2)(x+3) = xÂ² + 3x + 2x + 6 = xÂ² + 5x + 6",
                type: "expand"
            },
            {
                question: "Expand: (x - 1)(x + 4)",
                options: ["xÂ² + 3x - 4", "xÂ² + 4x - 1", "xÂ² + 5x - 4", "xÂ² - 4"],
                answer: "A",
                explanation: "(x-1)(x+4) = xÂ² + 4x - x - 4 = xÂ² + 3x - 4",
                type: "expand"
            },
            {
                question: "Expand: (x + 5)(x - 2)",
                options: ["xÂ² + 3x - 10", "xÂ² + 7x - 10", "xÂ² - 10", "xÂ² + 3x"],
                answer: "A",
                explanation: "(x+5)(x-2) = xÂ² - 2x + 5x - 10 = xÂ² + 3x - 10",
                type: "expand"
            },
            {
                question: "Expand: (a + b)Â²",
                options: ["aÂ² + 2ab + bÂ²", "aÂ² + bÂ²", "aÂ² + ab + bÂ²", "2a + 2b"],
                answer: "A",
                explanation: "(a+b)Â² = (a+b)(a+b) = aÂ² + ab + ab + bÂ² = aÂ² + 2ab + bÂ²",
                type: "expand"
            },
            {
                question: "Expand: (x - 3)Â²",
                options: ["xÂ² - 6x + 9", "xÂ² - 9", "xÂ² - 3x + 9", "xÂ² + 6x + 9"],
                answer: "A",
                explanation: "(x-3)Â² = (x-3)(x-3) = xÂ² - 3x - 3x + 9 = xÂ² - 6x + 9",
                type: "expand"
            },
            {
                question: "Expand: (2x + 1)(x + 3)",
                options: ["2xÂ² + 7x + 3", "2xÂ² + 4x + 3", "2xÂ² + 7x", "xÂ² + 7x + 3"],
                answer: "A",
                explanation: "(2x+1)(x+3) = 2xÂ² + 6x + x + 3 = 2xÂ² + 7x + 3",
                type: "expand"
            },
            {
                question: "Expand: 3(x + 2) + 2(x - 1)",
                options: ["5x + 4", "5x + 8", "x + 4", "5x"],
                answer: "A",
                explanation: "3(x+2)=3x+6, 2(x-1)=2x-2. Sum: 5x + 4",
                type: "expand"
            },
            {
                question: "Expand: x(2x - 5)",
                options: ["2xÂ² - 5x", "2x - 5x", "2xÂ² - 5", "xÂ² - 5x"],
                answer: "A",
                explanation: "x(2x - 5) = 2xÂ² - 5x",
                type: "expand"
            },
            {
                question: "Expand: (x + 1)(x - 1)",
                options: ["xÂ² - 1", "xÂ² + 1", "xÂ² - 2x + 1", "xÂ² + 2x + 1"],
                answer: "A",
                explanation: "(x+1)(x-1) = xÂ² - x + x - 1 = xÂ² - 1",
                type: "expand"
            },

            // Formulas Questions (61-75)
            {
                question: "What is (a+b)Â² equal to?",
                options: ["aÂ² + 2ab + bÂ²", "aÂ² + bÂ²", "aÂ² + ab + bÂ²", "2a + 2b"],
                answer: "A",
                explanation: "Square of sum formula: (a+b)Â² = aÂ² + 2ab + bÂ²",
                type: "formulas"
            },
            {
                question: "What is (a-b)Â² equal to?",
                options: ["aÂ² - 2ab + bÂ²", "aÂ² - bÂ²", "aÂ² - ab + bÂ²", "aÂ² + bÂ²"],
                answer: "A",
                explanation: "Square of difference formula: (a-b)Â² = aÂ² - 2ab + bÂ²",
                type: "formulas"
            },
            {
                question: "What is aÂ² - bÂ² equal to?",
                options: ["(a-b)(a+b)", "(a+b)Â²", "(a-b)Â²", "aÂ² + bÂ²"],
                answer: "A",
                explanation: "Difference of squares: aÂ² - bÂ² = (a-b)(a+b)",
                type: "formulas"
            },
            {
                question: "Expand using formula: (x+4)Â²",
                options: ["xÂ² + 8x + 16", "xÂ² + 4x + 16", "xÂ² + 16", "xÂ² + 8x"],
                answer: "A",
                explanation: "(x+4)Â² = xÂ² + 2(x)(4) + 4Â² = xÂ² + 8x + 16",
                type: "formulas"
            },
            {
                question: "Expand using formula: (y-3)Â²",
                options: ["yÂ² - 6y + 9", "yÂ² - 9", "yÂ² - 3y + 9", "yÂ² + 6y + 9"],
                answer: "A",
                explanation: "(y-3)Â² = yÂ² - 2(y)(3) + 3Â² = yÂ² - 6y + 9",
                type: "formulas"
            },
            {
                question: "Factorise using formula: xÂ² - 9",
                options: ["(x-3)(x+3)", "(x-9)(x+9)", "(x-3)Â²", "(x+3)Â²"],
                answer: "A",
                explanation: "xÂ² - 9 = xÂ² - 3Â² = (x-3)(x+3)",
                type: "formulas"
            },
            {
                question: "Factorise using formula: yÂ² - 16",
                options: ["(y-4)(y+4)", "(y-16)(y+16)", "(y-4)Â²", "(y+4)Â²"],
                answer: "A",
                explanation: "yÂ² - 16 = yÂ² - 4Â² = (y-4)(y+4)",
                type: "formulas"
            },
            {
                question: "What is (x+5)(x-5) equal to?",
                options: ["xÂ² - 25", "xÂ² + 25", "xÂ² - 10x + 25", "xÂ² + 10x + 25"],
                answer: "A",
                explanation: "Using difference of squares: (x+5)(x-5) = xÂ² - 5Â² = xÂ² - 25",
                type: "formulas"
            },
            {
                question: "Expand: (2x+1)Â²",
                options: ["4xÂ² + 4x + 1", "4xÂ² + 1", "2xÂ² + 4x + 1", "4xÂ² + 2x + 1"],
                answer: "A",
                explanation: "(2x+1)Â² = (2x)Â² + 2(2x)(1) + 1Â² = 4xÂ² + 4x + 1",
                type: "formulas"
            },
            {
                question: "Expand: (3a-2)Â²",
                options: ["9aÂ² - 12a + 4", "9aÂ² - 4", "3aÂ² - 12a + 4", "9aÂ² - 6a + 4"],
                answer: "A",
                explanation: "(3a-2)Â² = (3a)Â² - 2(3a)(2) + 2Â² = 9aÂ² - 12a + 4",
                type: "formulas"
            },
            {
                question: "Factorise: 4xÂ² - 9",
                options: ["(2x-3)(2x+3)", "(4x-9)(4x+9)", "(2x-9)(2x+9)", "(x-3)(x+3)"],
                answer: "A",
                explanation: "4xÂ² - 9 = (2x)Â² - 3Â² = (2x-3)(2x+3)",
                type: "formulas"
            },
            {
                question: "Which formula is aÂ² - bÂ² = (a-b)(a+b)?",
                options: ["Difference of squares", "Square of sum", "Square of difference", "Distributive law"],
                answer: "A",
                explanation: "aÂ² - bÂ² = (a-b)(a+b) is the difference of squares formula.",
                type: "formulas"
            },
            {
                question: "Which is the square of sum formula?",
                options: ["(a+b)Â² = aÂ²+2ab+bÂ²", "(a-b)Â² = aÂ²-2ab+bÂ²", "aÂ²-bÂ² = (a-b)(a+b)", "a(b+c) = ab+ac"],
                answer: "A",
                explanation: "(a+b)Â² = aÂ²+2ab+bÂ² is the square of sum formula.",
                type: "formulas"
            },
            {
                question: "Factorise: 25 - xÂ²",
                options: ["(5-x)(5+x)", "(25-x)(25+x)", "(5-x)Â²", "(x-5)(x+5)"],
                answer: "A",
                explanation: "25 - xÂ² = 5Â² - xÂ² = (5-x)(5+x)",
                type: "formulas"
            },
            {
                question: "Expand: (x+7)(x-7)",
                options: ["xÂ² - 49", "xÂ² + 49", "xÂ² - 14x + 49", "xÂ² - 14"],
                answer: "A",
                explanation: "(x+7)(x-7) = xÂ² - 7Â² = xÂ² - 49",
                type: "formulas"
            },

            // Applications Questions (76-90)
            {
                question: "Rectangle has length (x+3) and width (x+2). What is area?",
                options: ["xÂ²+5x+6", "2x+5", "xÂ²+6", "x+5"],
                answer: "A",
                explanation: "Area = length Ã— width = (x+3)(x+2) = xÂ²+5x+6",
                type: "applications"
            },
            {
                question: "If x=3, find value of 2x+5",
                options: ["11", "10", "8", "6"],
                answer: "A",
                explanation: "2(3) + 5 = 6 + 5 = 11",
                type: "applications"
            },
            {
                question: "Perimeter of square with side (x+2) is?",
                options: ["4x+8", "x+2", "xÂ²+4", "2x+4"],
                answer: "A",
                explanation: "Perimeter = 4 Ã— side = 4(x+2) = 4x+8",
                type: "applications"
            },
            {
                question: "If a=2, b=3, find aÂ² + bÂ²",
                options: ["13", "5", "25", "6"],
                answer: "A",
                explanation: "2Â² + 3Â² = 4 + 9 = 13",
                type: "applications"
            },
            {
                question: "Cost of x items at $5 each?",
                options: ["5x", "x+5", "5", "x/5"],
                answer: "A",
                explanation: "Total cost = price Ã— quantity = 5 Ã— x = 5x",
                type: "applications"
            }
        ];

        // Additional questions beyond 90
        const additionalQuestions = [
            {
                question: "Simplify: 3(x-2) + 2(x+1)",
                options: ["5x-4", "5x+4", "x-4", "5x"],
                answer: "A",
                explanation: "3(x-2)=3x-6, 2(x+1)=2x+2. Sum: 5x-4",
                type: "simplify"
            },
            {
                question: "Factorise: 6xy + 9yÂ²",
                options: ["3y(2x+3y)", "3y(2x+9y)", "y(6x+9y)", "3(2xy+3yÂ²)"],
                answer: "A",
                explanation: "HCF is 3y: 6xy+9yÂ²=3y(2x+3y)",
                type: "factorise"
            },
            {
                question: "Expand: (2x-1)(3x+2)",
                options: ["6xÂ²+x-2", "6xÂ²+7x-2", "6xÂ²-x-2", "5xÂ²+x-2"],
                answer: "A",
                explanation: "(2x-1)(3x+2)=6xÂ²+4x-3x-2=6xÂ²+x-2",
                type: "expand"
            },
            {
                question: "Factorise: xÂ²+6x+9",
                options: ["(x+3)Â²", "(x+9)Â²", "(x+6)(x+3)", "(x+3)(x+3)"],
                answer: "A",
                explanation: "xÂ²+6x+9 = (x)Â²+2(x)(3)+3Â² = (x+3)Â²",
                type: "formulas"
            }
        ];

        // Combine all questions
        const allQuestions = [...questions, ...additionalQuestions];

        // Algebra tips
        const algebraTips = [
            "Tip: Like terms have the same variable(s) with same exponent.",
            "Tip: To simplify, combine like terms by adding/subtracting coefficients.",
            "Tip: Factorisation is the reverse of expansion - find common factors.",
            "Tip: (a+b)Â² = aÂ² + 2ab + bÂ² - remember the middle term 2ab!",
            "Tip: aÂ² - bÂ² = (a-b)(a+b) - difference of squares formula.",
            "Tip: Always check your work by expanding factorised forms.",
            "Tip: In 3(x+2), multiply 3 by both terms inside brackets.",
            "Tip: Degree of polynomial = highest power of the variable."
        ];

        // Simplification examples
        const simplifyExamples = [
            { problem: "3x + 2x + 5", answer: "5x+5", steps: ["Combine like terms: 3x + 2x = 5x", "Bring down constant: +5", "Result: 5x + 5"] },
            { problem: "4a - 2a + 3", answer: "2a+3", steps: ["Combine like terms: 4a - 2a = 2a", "Bring down constant: +3", "Result: 2a + 3"] },
            { problem: "2x + 3 + 4x - 1", answer: "6x+2", steps: ["Combine x terms: 2x + 4x = 6x", "Combine constants: 3 - 1 = 2", "Result: 6x + 2"] },
            { problem: "xÂ² + 2xÂ² - x", answer: "3xÂ²-x", steps: ["Combine xÂ² terms: xÂ² + 2xÂ² = 3xÂ²", "Bring down -x", "Result: 3xÂ² - x"] }
        ];

        // Factorisation examples
        const factoriseExamples = [
            { problem: "2x + 6", answer: "2(x+3)", method: "Find HCF of 2x and 6 is 2" },
            { problem: "3a - 9", answer: "3(a-3)", method: "Find HCF of 3a and 9 is 3" },
            { problem: "xÂ² + 3x", answer: "x(x+3)", method: "Find HCF of xÂ² and 3x is x" },
            { problem: "4y + 8", answer: "4(y+2)", method: "Find HCF of 4y and 8 is 4" }
        ];

        // Expansion examples
        const expansionExamples = [
            { problem: "2(x+3)", answer: "2x+6", steps: ["Multiply 2 by x: 2Ã—x = 2x", "Multiply 2 by 3: 2Ã—3 = 6", "Result: 2x + 6"] },
            { problem: "3(a-2)", answer: "3a-6", steps: ["Multiply 3 by a: 3Ã—a = 3a", "Multiply 3 by -2: 3Ã—(-2) = -6", "Result: 3a - 6"] },
            { problem: "x(x+4)", answer: "xÂ²+4x", steps: ["Multiply x by x: xÃ—x = xÂ²", "Multiply x by 4: xÃ—4 = 4x", "Result: xÂ² + 4x"] },
            { problem: "2x(x-3)", answer: "2xÂ²-6x", steps: ["Multiply 2x by x: 2xÃ—x = 2xÂ²", "Multiply 2x by -3: 2xÃ—(-3) = -6x", "Result: 2xÂ² - 6x"] }
        ];

        // Application problems
        const applicationProblems = [
            {
                problem: "A rectangle has length (x+3) cm and width (x+2) cm. What is its area?",
                answer: "xÂ²+5x+6 cmÂ²",
                solution: "Area = length Ã— width = (x+3)(x+2) = xÂ²+2x+3x+6 = xÂ²+5x+6"
            },
            {
                problem: "Perimeter of square with side (x+4) cm?",
                answer: "4x+16 cm",
                solution: "Perimeter = 4 Ã— side = 4(x+4) = 4x+16"
            },
            {
                problem: "If pens cost $2 each, cost of x pens?",
                answer: "2x dollars",
                solution: "Total cost = price Ã— quantity = 2 Ã— x = 2x"
            },
            {
                problem: "Evaluate 3x+5 when x=4",
                answer: "17",
                solution: "3(4) + 5 = 12 + 5 = 17"
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            studentName: "",
            startTime: null,
            currentSimplify: 0,
            currentFactorise: 0,
            currentExpansion: 0,
            currentApplication: 0,
            expressionsScore: 0,
            simplifyScore: 0,
            factoriseScore: 0,
            expandScore: 0,
            formulasScore: 0,
            applicationsScore: 0
        };

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const backToHomeBtn = document.getElementById('backToHome');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const algebraTip = document.getElementById('algebraTip');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const feedbackExplanation = document.getElementById('feedbackExplanation');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const expressionsScore = document.getElementById('expressionsScore');
        const simplifyScore = document.getElementById('simplifyScore');
        const factoriseScore = document.getElementById('factoriseScore');
        const timeSpent = document.getElementById('timeSpent');
        const solverDisplay = document.getElementById('solverDisplay');
        const solverResult = document.getElementById('solverResult');
        const simplifyDisplay = document.getElementById('simplifyDisplay');
        const simplifyFeedback = document.getElementById('simplifyFeedback');
        const factoriseDisplay = document.getElementById('factoriseDisplay');
        const factoriseFeedback = document.getElementById('factoriseFeedback');
        const expandPrompt = document.getElementById('expandPrompt');
        const expandInput = document.getElementById('expandInput');
        const expansionFeedback = document.getElementById('expansionFeedback');
        const formulaExample = document.getElementById('formulaExample');
        const applicationProblem = document.getElementById('applicationProblem');
        const applicationFeedback = document.getElementById('applicationFeedback');
        const processDetail = document.getElementById('processDetail');

        // Initialize
        function initApp() {
            setupEventListeners();
            showWelcomePage();
            setupVisualizationTools();
        }

        // Setup visualization tools
        function setupVisualizationTools() {
            newSimplify();
            newFactorise();
            newExpansion();
            newApplication();
        }

        // Simplification functions
        function newSimplify() {
            appState.currentSimplify = (appState.currentSimplify + 1) % simplifyExamples.length;
            const example = simplifyExamples[appState.currentSimplify];
            simplifyDisplay.textContent = `Simplify: ${example.problem}`;
            simplifyFeedback.textContent = "Combine like terms (same variable and exponent)";
            simplifyFeedback.style.color = "var(--text-secondary)";
        }

        function checkSimplify(selectedAnswer) {
            const example = simplifyExamples[appState.currentSimplify];
            
            if (selectedAnswer === example.answer) {
                simplifyFeedback.innerHTML = `<span style="color: var(--simplify-green)">Correct! ${example.problem} = ${example.answer}</span>`;
                simplifyFeedback.classList.add('highlight');
                setTimeout(() => simplifyFeedback.classList.remove('highlight'), 1000);
            } else {
                simplifyFeedback.innerHTML = `<span style="color: var(--formulas-red)">Incorrect. ${example.problem} = ${example.answer}</span>`;
            }
        }

        function showSimplifySteps() {
            const example = simplifyExamples[appState.currentSimplify];
            let steps = `SIMPLIFICATION STEPS:\n\n${example.problem}\n`;
            example.steps.forEach(step => {
                steps += `\n${step}`;
            });
            steps += `\n\n= ${example.answer}`;
            alert(steps);
        }

        // Factorisation functions
        function newFactorise() {
            appState.currentFactorise = (appState.currentFactorise + 1) % factoriseExamples.length;
            const example = factoriseExamples[appState.currentFactorise];
            factoriseDisplay.textContent = `Factorise: ${example.problem}`;
            factoriseFeedback.textContent = example.method;
            factoriseFeedback.style.color = "var(--text-secondary)";
        }

        function checkFactorise(selectedAnswer) {
            const example = factoriseExamples[appState.currentFactorise];
            
            if (selectedAnswer === example.answer) {
                factoriseFeedback.innerHTML = `<span style="color: var(--simplify-green)">Correct! ${example.problem} = ${example.answer}</span><br>Method: ${example.method}`;
                factoriseFeedback.classList.add('highlight');
                setTimeout(() => factoriseFeedback.classList.remove('highlight'), 1000);
            } else {
                factoriseFeedback.innerHTML = `<span style="color: var(--formulas-red)">Incorrect. ${example.problem} = ${example.answer}</span><br>Method: ${example.method}`;
            }
        }

        function explainFactorise() {
            const example = factoriseExamples[appState.currentFactorise];
            alert(`FACTORISATION METHOD:\n\n${example.problem}\n\nStep 1: Find Highest Common Factor (HCF)\nHCF of ${example.problem} is ${example.answer.split('(')[0]}\n\nStep 2: Divide each term by HCF\n${example.problem} Ã· ${example.answer.split('(')[0]} = ${example.answer.split('(')[1].replace(')', '')}\n\nStep 3: Write as product\n${example.answer}`);
        }

        // Expansion functions
        function newExpansion() {
            appState.currentExpansion = (appState.currentExpansion + 1) % expansionExamples.length;
            const example = expansionExamples[appState.currentExpansion];
            expandPrompt.textContent = example.problem;
            expandInput.value = '';
            expansionFeedback.textContent = "Multiply each term inside brackets";
            expansionFeedback.style.color = "var(--text-secondary)";
        }

        function checkExpansion() {
            const answer = expandInput.value.trim();
            const example = expansionExamples[appState.currentExpansion];
            
            if (!answer) {
                expansionFeedback.textContent = "Please enter an answer";
                expansionFeedback.style.color = "var(--expand-orange)";
                return;
            }
            
            // Allow different forms
            const correctForms = [
                example.answer,
                example.answer.replace('2x+6', '2x + 6'),
                example.answer.replace('3a-6', '3a - 6'),
                example.answer.replace('xÂ²+4x', 'x^2+4x'),
                example.answer.replace('2xÂ²-6x', '2x^2-6x')
            ];
            
            if (correctForms.includes(answer)) {
                expansionFeedback.innerHTML = `<span style="color: var(--simplify-green)">Correct! ${example.problem} = ${example.answer}</span>`;
                expandInput.style.borderColor = "var(--simplify-green)";
                setTimeout(() => {
                    newExpansion();
                    expandInput.style.borderColor = "var(--dark-border)";
                }, 1500);
            } else {
                expansionFeedback.innerHTML = `<span style="color: var(--formulas-red)">Try again. ${example.problem} = ${example.answer}</span>`;
                expandInput.style.borderColor = "var(--formulas-red)";
            }
        }

        function showExpansionExample() {
            const example = expansionExamples[appState.currentExpansion];
            let explanation = `EXPANSION:\n\n${example.problem}\n\n`;
            example.steps.forEach(step => {
                explanation += `\n${step}`;
            });
            explanation += `\n\n= ${example.answer}`;
            alert(explanation);
        }

        // Formula functions
        function showFormula(type) {
            let examples = "";
            switch(type) {
                case 'squareSum':
                    examples = "(a+b)Â² = aÂ² + 2ab + bÂ²\n\nExamples:\n(x+3)Â² = xÂ² + 6x + 9\n(2x+1)Â² = 4xÂ² + 4x + 1\n(a+5)Â² = aÂ² + 10a + 25";
                    break;
                case 'squareDiff':
                    examples = "(a-b)Â² = aÂ² - 2ab + bÂ²\n\nExamples:\n(x-4)Â² = xÂ² - 8x + 16\n(3a-2)Â² = 9aÂ² - 12a + 4\n(y-1)Â² = yÂ² - 2y + 1";
                    break;
                case 'diffSquares':
                    examples = "aÂ² - bÂ² = (a-b)(a+b)\n\nExamples:\nxÂ² - 9 = (x-3)(x+3)\n4yÂ² - 25 = (2y-5)(2y+5)\n16 - xÂ² = (4-x)(4+x)";
                    break;
                case 'distributive':
                    examples = "a(b+c) = ab + ac\n\nExamples:\n3(x+2) = 3x + 6\n2x(x-3) = 2xÂ² - 6x\n-4(2a+1) = -8a - 4";
                    break;
            }
            formulaExample.innerHTML = `<span style="color: var(--formulas-red); font-weight: bold;">FORMULA:</span><br>${examples}`;
            formulaExample.classList.add('highlight');
            setTimeout(() => formulaExample.classList.remove('highlight'), 1000);
        }

        function practiceFormula() {
            const formulas = [
                { problem: "(x+4)Â²", answer: "xÂ²+8x+16" },
                { problem: "(y-3)Â²", answer: "yÂ²-6y+9" },
                { problem: "xÂ²-16", answer: "(x-4)(x+4)" },
                { problem: "3(x+5)", answer: "3x+15" }
            ];
            const problem = formulas[Math.floor(Math.random() * formulas.length)];
            
            const userAnswer = prompt(`Simplify using formula:\n${problem.problem}\n\nEnter your answer:`);
            if (userAnswer && (userAnswer === problem.answer || userAnswer === problem.answer.replace('Â²', '^2'))) {
                alert(`âœ“ Correct!\n${problem.problem} = ${problem.answer}`);
            } else {
                alert(`âœ— The correct answer is:\n${problem.problem} = ${problem.answer}`);
            }
        }

        function explainAllFormulas() {
            alert(`IMPORTANT ALGEBRAIC FORMULAS:

1. Square of Sum:
   (a+b)Â² = aÂ² + 2ab + bÂ²
   Example: (x+3)Â² = xÂ² + 6x + 9

2. Square of Difference:
   (a-b)Â² = aÂ² - 2ab + bÂ²
   Example: (x-4)Â² = xÂ² - 8x + 16

3. Difference of Squares:
   aÂ² - bÂ² = (a-b)(a+b)
   Example: xÂ² - 9 = (x-3)(x+3)

4. Distributive Law:
   a(b+c) = ab + ac
   Example: 3(x+2) = 3x + 6

5. Perfect Square Trinomial:
   aÂ² + 2ab + bÂ² = (a+b)Â²
   aÂ² - 2ab + bÂ² = (a-b)Â²

6. Sum/Difference of Cubes:
   aÂ³ + bÂ³ = (a+b)(aÂ² - ab + bÂ²)
   aÂ³ - bÂ³ = (a-b)(aÂ² + ab + bÂ²)

Remember these formulas for quick calculations!`);
        }

        // Application functions
        function newApplication() {
            appState.currentApplication = (appState.currentApplication + 1) % applicationProblems.length;
            const problem = applicationProblems[appState.currentApplication];
            applicationProblem.textContent = problem.problem;
            applicationFeedback.textContent = "Click the correct answer";
            applicationFeedback.style.color = "var(--text-secondary)";
        }

        function checkApplication(selectedAnswer) {
            const problem = applicationProblems[appState.currentApplication];
            
            if (selectedAnswer === problem.answer) {
                applicationFeedback.innerHTML = `<span style="color: var(--simplify-green)">Correct! ${problem.problem}\nAnswer: ${problem.answer}</span>`;
                applicationFeedback.classList.add('highlight');
                setTimeout(() => applicationFeedback.classList.remove('highlight'), 1000);
            } else {
                applicationFeedback.innerHTML = `<span style="color: var(--formulas-red)">Incorrect. ${problem.problem}\nCorrect answer: ${problem.answer}</span>`;
            }
        }

        function showApplicationSolution() {
            const problem = applicationProblems[appState.currentApplication];
            alert(`SOLUTION:\n\n${problem.problem}\n\n${problem.solution}\n\nAnswer: ${problem.answer}`);
        }

        // Solver functions
        function solveAlgebra() {
            const input = document.getElementById('solverInput').value.trim();
            if (!input) {
                solverResult.textContent = "Please enter an expression";
                solverResult.style.color = "var(--expand-orange)";
                return;
            }
            
            let result = "";
            let steps = [];
            
            try {
                // Simple algebra solver
                if (input.includes('(') && input.includes(')')) {
                    // Expansion
                    const match = input.match(/(\d*)([a-zA-Z])?\(([^)]+)\)/);
                    if (match) {
                        const coeff = match[1] ? parseInt(match[1]) : 1;
                        const variable = match[2] || '';
                        const inside = match[3];
                        
                        steps.push(`${input}`);
                        steps.push(`= ${coeff}${variable} Ã— (${inside})`);
                        
                        if (inside.includes('+') || inside.includes('-')) {
                            const terms = inside.split(/(?=[+-])/);
                            const expanded = terms.map(term => {
                                const termMatch = term.match(/([+-]?\d*)([a-zA-Z]?)/);
                                const termCoeff = termMatch[1] ? (termMatch[1] === '+' ? 1 : termMatch[1] === '-' ? -1 : parseInt(termMatch[1])) : 1;
                                const termVar = termMatch[2] || '';
                                
                                const newCoeff = coeff * termCoeff;
                                const newVar = variable + termVar;
                                
                                return (newCoeff >= 0 ? '+' : '') + (newCoeff === 1 && newVar ? '' : newCoeff === -1 && newVar ? '-' : newCoeff) + newVar;
                            }).join('');
                            
                            steps.push(`= ${expanded.replace(/^\+/, '')}`);
                            result = expanded.replace(/^\+/, '');
                        }
                    }
                } else if (input.includes('+') || input.includes('-')) {
                    // Simplification
                    const terms = input.split(/(?=[+-])/).filter(term => term);
                    const likeTerms = {};
                    
                    steps.push(`${input}`);
                    
                    terms.forEach(term => {
                        const match = term.match(/([+-]?\d*)([a-zA-ZÂ²]*)/);
                        const coeff = match[1] ? (match[1] === '+' ? 1 : match[1] === '-' ? -1 : parseInt(match[1])) : 1;
                        const varPart = match[2] || 'constant';
                        
                        if (!likeTerms[varPart]) likeTerms[varPart] = 0;
                        likeTerms[varPart] += coeff;
                    });
                    
                    const simplified = Object.entries(likeTerms)
                        .filter(([_, coeff]) => coeff !== 0)
                        .map(([varPart, coeff]) => {
                            const sign = coeff >= 0 ? '+' : '-';
                            const absCoeff = Math.abs(coeff);
                            return sign + (absCoeff === 1 && varPart !== 'constant' ? '' : absCoeff) + 
                                   (varPart === 'constant' ? '' : varPart);
                        })
                        .join('')
                        .replace(/^\+/, '');
                    
                    if (simplified) {
                        steps.push(`= ${simplified}`);
                        result = simplified;
                    } else {
                        steps.push(`= 0`);
                        result = "0";
                    }
                }
                
                if (!result) {
                    result = "Enter a simpler expression like: 2(x+3), 3x+2x, etc.";
                }
                
            } catch (e) {
                result = "Error: Please check your input format";
            }
            
            solverDisplay.innerHTML = steps.map(step => `<div class="solver-step">${step}</div>`).join('');
            solverResult.innerHTML = `<strong>Result:</strong> ${result}`;
            solverResult.style.color = result.includes("Error") ? "var(--formulas-red)" : "var(--simplify-green)";
        }

        function clearSolver() {
            document.getElementById('solverInput').value = '';
            solverDisplay.textContent = "Enter an algebraic expression to see step-by-step solution";
            solverResult.textContent = "Enter expression and click Solve";
            solverResult.style.color = "var(--text-secondary)";
        }

        // Comparison functions
        function explainProcess(type) {
            const explanations = {
                simplify: {
                    name: "Simplification",
                    description: "Combining like terms to write expressions in simplest form.",
                    examples: "2x + 3x â†’ 5x\n4a - 2a + 3 â†’ 2a + 3",
                    method: "Add/subtract coefficients of terms with same variables and exponents"
                },
                expand: {
                    name: "Expansion",
                    description: "Removing brackets by multiplying terms using distributive law.",
                    examples: "2(x+3) â†’ 2x+6\n(x+2)(x+3) â†’ xÂ²+5x+6",
                    method: "Multiply each term inside brackets by each term outside"
                },
                factorise: {
                    name: "Factorisation",
                    description: "Writing expressions as products of simpler expressions.",
                    examples: "2x+6 â†’ 2(x+3)\nxÂ²-9 â†’ (x-3)(x+3)",
                    method: "Find highest common factor or use algebraic formulas"
                },
                evaluate: {
                    name: "Evaluation",
                    description: "Finding numerical value by substituting values for variables.",
                    examples: "2x+3 when x=4 â†’ 11\nxÂ² when x=5 â†’ 25",
                    method: "Replace variables with given numbers and calculate"
                }
            };
            
            const exp = explanations[type];
            processDetail.innerHTML = `
                <strong style="color: var(--expressions-blue)">${exp.name}</strong><br>
                <strong>Description:</strong> ${exp.description}<br>
                <strong>Examples:</strong> ${exp.examples}<br>
                <strong>Method:</strong> ${exp.method}
            `;
            processDetail.style.display = 'block';
        }

        // Concept detail
        window.showConceptDetail = function(concept) {
            let info = "";
            
            if (concept === 'expressions') {
                info = `xâ€¯ ALGEBRAIC EXPRESSIONSâ€¯x

Definition:
An algebraic expression is a mathematical phrase that contains variables, constants, and operations (+, -, Ã—, Ã·) but NO equal sign.

Parts of an Expression:
â€¢ Variables: Letters representing unknown values (x, y, a, b)
â€¢ Constants: Fixed numbers (2, 5, -3, Â½)
â€¢ Coefficients: Numbers multiplying variables (3 in 3x)
â€¢ Terms: Parts separated by + or - signs
â€¢ Operators: +, -, Ã—, Ã·

Types of Expressions:
1. Monomial: One term (3x, 5, 2aÂ²)
2. Binomial: Two terms (x+2, 3a-4b)
3. Trinomial: Three terms (xÂ²+2x+1)
4. Polynomial: Many terms

Degree of Expression:
Highest power of the variable:
â€¢ 3x + 2 â†’ Degree 1 (linear)
â€¢ xÂ² + 3x - 1 â†’ Degree 2 (quadratic)
â€¢ xÂ³ + 2xÂ² â†’ Degree 3 (cubic)

Examples:
â€¢ 2x + 5 (binomial, degree 1)
â€¢ 3aÂ² - 2a + 1 (trinomial, degree 2)
â€¢ 4xy + 3x - 2y (trinomial, degree 2 in x and y)`;
            } else if (concept === 'simplify') {
                info = `=â€¯ SIMPLIFYING EXPRESSIONSâ€¯=

What is Simplification?
Combining like terms to write expressions in their simplest, most compact form.

Like Terms:
Terms that have:
â€¢ Same variable(s)
â€¢ Same exponent(s) on each variable

Examples of Like Terms:
â€¢ 3x and 5x (both have x to power 1)
â€¢ 2xÂ² and 4xÂ² (both have xÂ²)
â€¢ 3ab and 2ab (both have a and b)
â€¢ 4 and 7 (both constants)

NOT Like Terms:
â€¢ 3x and 3y (different variables)
â€¢ xÂ² and x (different exponents)
â€¢ 2ab and 2a (different variables)

How to Simplify:
1. Identify like terms
2. Add/subtract their coefficients
3. Keep the variable part unchanged

Examples:
3x + 2x + 5 = 5x + 5
4a - 2a + 3 = 2a + 3
2xÂ² + 3xÂ² - x = 5xÂ² - x

Why Simplify?
â€¢ Easier to work with
â€¢ Reveals structure
â€¢ Required before solving equations
â€¢ Makes evaluation easier`;
            } else if (concept === 'factorise') {
                info = `( )â€¯ FACTORISATIONâ€¯( )

What is Factorisation?
Writing an expression as a product of its factors (reverse of expansion).

Types of Factorisation:
1. Common Factor: ab + ac = a(b + c)
2. Difference of Squares: aÂ² - bÂ² = (a-b)(a+b)
3. Perfect Square: aÂ² + 2ab + bÂ² = (a+b)Â²
4. Quadratic Trinomial: xÂ² + 5x + 6 = (x+2)(x+3)

Common Factor Method:
1. Find Highest Common Factor (HCF) of all terms
2. Divide each term by HCF
3. Write as: HCF Ã— (remaining expression)

Examples:
2x + 6 = 2(x + 3)
3aÂ² - 6a = 3a(a - 2)
4xy + 8y = 4y(x + 2)

Difference of Squares:
aÂ² - bÂ² = (a - b)(a + b)

Examples:
xÂ² - 9 = (x-3)(x+3)
4yÂ² - 25 = (2y-5)(2y+5)
16 - aÂ² = (4-a)(4+a)

Why Factorise?
â€¢ Solve equations (set each factor = 0)
â€¢ Simplify fractions
â€¢ Find common denominators
â€¢ Reveal roots/zeros of functions`;
            } else if (concept === 'expand') {
                info = `â†’â€¯ EXPANDING BRACKETSâ€¯â†’

What is Expansion?
Removing brackets by multiplying terms (reverse of factorisation).

Distributive Law:
a(b + c) = ab + ac

Single Bracket:
2(x + 3) = 2Ã—x + 2Ã—3 = 2x + 6
3(a - 2) = 3Ã—a - 3Ã—2 = 3a - 6
x(x + 4) = xÃ—x + xÃ—4 = xÂ² + 4x

Double Brackets (FOIL Method):
First, Outer, Inner, Last
(x+2)(x+3) = xÃ—x + xÃ—3 + 2Ã—x + 2Ã—3
           = xÂ² + 3x + 2x + 6
           = xÂ² + 5x + 6

Special Cases:
1. (a+b)Â² = aÂ² + 2ab + bÂ²
2. (a-b)Â² = aÂ² - 2ab + bÂ²
3. (a+b)(a-b) = aÂ² - bÂ²

Examples:
(x+4)Â² = xÂ² + 8x + 16
(y-3)Â² = yÂ² - 6y + 9
(2x+1)(2x-1) = 4xÂ² - 1

Why Expand?
â€¢ Simplify expressions
â€¢ Prepare for solving
â€¢ Combine with other terms
â€¢ Check factorisation`;
            } else if (concept === 'formulas') {
                info = `aÂ²-bÂ²â€¯ ALGEBRAIC FORMULASâ€¯(a+b)Â²

Essential Formulas to Memorize:

1. Square of Sum:
   (a + b)Â² = aÂ² + 2ab + bÂ²
   Example: (x+3)Â² = xÂ² + 6x + 9

2. Square of Difference:
   (a - b)Â² = aÂ² - 2ab + bÂ²
   Example: (x-4)Â² = xÂ² - 8x + 16

3. Difference of Squares:
   aÂ² - bÂ² = (a - b)(a + b)
   Example: xÂ² - 9 = (x-3)(x+3)

4. Distributive Law:
   a(b + c) = ab + ac
   Example: 3(x+2) = 3x + 6

5. Perfect Square Trinomial:
   aÂ² + 2ab + bÂ² = (a+b)Â²
   aÂ² - 2ab + bÂ² = (a-b)Â²

6. Sum of Cubes:
   aÂ³ + bÂ³ = (a+b)(aÂ² - ab + bÂ²)

7. Difference of Cubes:
   aÂ³ - bÂ³ = (a-b)(aÂ² + ab + bÂ²)

How to Use Formulas:
â€¢ Recognize pattern
â€¢ Identify a and b
â€¢ Apply formula
â€¢ Simplify result

Why Memorize Formulas?
â€¢ Faster calculations
â€¢ Fewer errors
â€¢ Better problem-solving
â€¢ Foundation for advanced math`;
            } else {
                info = `â–³â€¯ REAL-WORLD APPLICATIONSâ€¯$

Where Algebra is Used:

1. Geometry:
   â€¢ Area: rectangle = length Ã— width
     If length = (x+3), width = (x+2)
     Area = (x+3)(x+2) = xÂ² + 5x + 6
   
   â€¢ Perimeter: square = 4 Ã— side
     If side = (x+4)
     Perimeter = 4(x+4) = 4x + 16

2. Business & Economics:
   â€¢ Cost: Total = price Ã— quantity
     If price = $5, quantity = x
     Cost = 5x
   
   â€¢ Profit: Profit = Revenue - Cost
     If Revenue = 10x, Cost = 3x + 20
     Profit = 7x - 20

3. Science & Engineering:
   â€¢ Distance: d = speed Ã— time
   â€¢ Physics formulas
   â€¢ Chemical equations

4. Everyday Life:
   â€¢ Shopping calculations
   â€¢ Recipe adjustments
   â€¢ Travel planning
   â€¢ Budgeting

Example Problem:
A garden is (x+5) m long and (x+3) m wide.
What is the area?
Solution: Area = (x+5)(x+3) = xÂ² + 8x + 15 mÂ²

Algebra helps us:
â€¢ Model real situations
â€¢ Make predictions
â€¢ Solve problems
â€¢ Make decisions`;
            }
            
            alert(info);
        };

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', showWelcomePage);
            viewTopicsBtn.addEventListener('click', () => alert("Other Math topics would be available here."));
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') startPractice();
            });
        }

        // Create algebra tip display
        function createAlgebraTip() {
            const tipDiv = document.createElement('div');
            tipDiv.className = 'algebra-tip';
            tipDiv.innerHTML = `<strong>Algebra Tip:</strong> ${algebraTips[Math.floor(Math.random() * algebraTips.length)]}`;
            return tipDiv;
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            appState.startTime = new Date();
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const percentage = Math.round((appState.score / allQuestions.length) * 100);
            const timeDiff = new Date() - appState.startTime;
            const minutes = Math.floor(timeDiff / 60000);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            expressionsScore.textContent = appState.expressionsScore;
            simplifyScore.textContent = appState.simplifyScore;
            factoriseScore.textContent = appState.factoriseScore;
            timeSpent.textContent = `${minutes}min`;
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You've mastered algebraic expressions!";
            } else if (percentage >= 75) {
                scoreMessage.textContent = "Excellent work! Your algebra skills are impressive!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Good job! You're developing strong algebraic thinking!";
            } else {
                scoreMessage.textContent = "Keep practicing! Algebra is the language of mathematics!";
            }
        }

        // Load question
        function loadQuestion() {
            const question = allQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${allQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / allQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            algebraTip.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            algebraTip.appendChild(createAlgebraTip());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = allQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                
                // Track scores by question type
                if (question.type === 'expressions') appState.expressionsScore++;
                if (question.type === 'simplify') appState.simplifyScore++;
                if (question.type === 'factorise') appState.factoriseScore++;
                if (question.type === 'expand') appState.expandScore++;
                if (question.type === 'formulas') appState.formulasScore++;
                if (question.type === 'applications') appState.applicationsScore++;
                
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation);
            }
            
            nextQuestionBtn.disabled = false;
        }

        // Show feedback
        function showFeedback(isCorrect, explanation) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = 'âœ“';
                feedbackTitle.textContent = 'Correct!';
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = 'âœ—';
                feedbackTitle.textContent = 'Incorrect';
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < allQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Skip question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < allQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
        }

        // Retry topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            appState.expressionsScore = 0;
            appState.simplifyScore = 0;
            appState.factoriseScore = 0;
            appState.expandScore = 0;
            appState.formulasScore = 0;
            appState.applicationsScore = 0;
            showPracticePage();
        }

        // Start practice
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin algebra practice!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            appState.expressionsScore = 0;
            appState.simplifyScore = 0;
            appState.factoriseScore = 0;
            appState.expandScore = 0;
            appState.formulasScore = 0;
            appState.applicationsScore = 0;
            
            showPracticePage();
        }

        // Initialize app
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
