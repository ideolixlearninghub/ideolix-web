<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 Math - Algebraic Expressions & Equations | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Algebra Theme */
        :root {
            --primary-blue: #2196F3;
            --secondary-green: #4CAF50;
            --accent-purple: #9C27B0;
            --accent-orange: #FF9800;
            --accent-red: #F44336;
            --accent-yellow: #FFC107;
            --accent-teal: #009688;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(33, 150, 243, 0.3);
            --variable-glow: 0 0 15px rgba(255, 193, 7, 0.4);
            --equation-glow: 0 0 15px rgba(76, 175, 80, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Algebra Pattern Background */
        .algebra-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(33, 150, 243, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 193, 7, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(156, 39, 176, 0.1) 0%, transparent 50%);
            opacity: 0.3;
        }

        .floating-symbol {
            position: absolute;
            color: rgba(255, 255, 255, 0.05);
            font-size: 3rem;
            font-weight: bold;
            animation: floatSymbol 20s linear infinite;
        }

        @keyframes floatSymbol {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-100px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-100px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(100px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(33, 150, 243, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-blue);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-green);
            color: white;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
        }

        .btn-secondary:hover {
            background: #388E3C;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-blue), var(--accent-orange));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .math-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-teal);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-orange));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(33, 150, 243, 0.1);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-green);
        }

        .option.correct .option-letter {
            background: var(--primary-blue);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(33, 150, 243, 0.1);
            border-left: 5px solid var(--primary-blue);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-blue);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-blue);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Algebraic Expression Display */
        .expression-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid var(--accent-orange);
            text-align: center;
            font-size: 1.5rem;
        }

        .display-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        /* Variable Display */
        .variable-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .variable-box {
            background: rgba(255, 193, 7, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            min-width: 80px;
            border: 2px solid var(--accent-yellow);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .variable-box:hover {
            transform: scale(1.1);
        }

        .variable-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-yellow);
        }

        .variable-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Equation Solver */
        .equation-solver {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--secondary-green);
        }

        .equation-step {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            min-height: 60px;
        }

        .step-number {
            background: var(--accent-teal);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-expression {
            flex: 1;
            font-size: 1.2rem;
            font-family: 'Courier New', monospace;
        }

        .step-explanation {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Balance Scale */
        .balance-scale-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .balance-scale {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150px;
            position: relative;
            margin: 20px 0;
        }

        .scale-beam {
            width: 80%;
            height: 4px;
            background: var(--text-secondary);
            position: relative;
        }

        .scale-pivot {
            width: 20px;
            height: 20px;
            background: var(--accent-red);
            border-radius: 50%;
            position: absolute;
        }

        .scale-left, .scale-right {
            position: absolute;
            width: 40%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .scale-left {
            left: 0;
        }

        .scale-right {
            right: 0;
        }

        .scale-weight {
            background: var(--dark-surface);
            padding: 10px 15px;
            border-radius: 8px;
            margin: 5px;
            border: 2px solid var(--primary-blue);
            font-family: 'Courier New', monospace;
        }

        /* Term Collection */
        .term-collection {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .terms-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        .term {
            background: var(--dark-surface);
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: move;
            font-family: 'Courier New', monospace;
        }

        .term.coefficient {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .term.variable {
            border-color: var(--accent-yellow);
            background: rgba(255, 193, 7, 0.1);
        }

        .term.constant {
            border-color: var(--secondary-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .term.operator {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        /* Like Terms */
        .like-terms-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
        }

        .like-terms-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .like-terms-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .like-term-box {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .like-term-box:hover {
            transform: translateY(-3px);
        }

        .like-term-box.selected {
            background: rgba(33, 150, 243, 0.2);
            border: 2px solid var(--primary-blue);
        }

        /* Substitution Box */
        .substitution-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-orange);
        }

        .substitution-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .substitution-input input {
            padding: 10px;
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 6px;
            color: var(--text-primary);
            width: 80px;
            text-align: center;
        }

        /* Expression Builder */
        .expression-builder {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .builder-area {
            background: var(--dark-surface);
            min-height: 100px;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .builder-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .builder-button {
            padding: 8px 15px;
            background: var(--dark-surface);
            border: 2px solid var(--primary-blue);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .builder-button:hover {
            background: rgba(33, 150, 243, 0.1);
        }

        /* Word Problems */
        .word-problem {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Algebra Table */
        .algebra-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .algebra-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-orange);
            border-bottom: 2px solid var(--accent-orange);
        }

        .algebra-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .algebra-table tr:hover {
            background: rgba(255, 152, 0, 0.05);
        }

        /* Interactive Practice */
        .interactive-practice {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
        }

        .practice-title {
            color: var(--accent-teal);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .practice-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .practice-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-teal);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-button:hover {
            background: rgba(0, 150, 136, 0.1);
            transform: translateY(-2px);
        }

        .practice-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .like-terms-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes equationSolve {
            0% { transform: translateX(-20px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .equation-solve {
            animation: equationSolve 0.5s ease forwards;
        }
        
        @keyframes balanceTilt {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-2deg); }
            75% { transform: rotate(2deg); }
        }
        
        .balance-tilt {
            animation: balanceTilt 2s ease-in-out infinite;
        }
        
        @keyframes variableGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(255, 193, 7, 0.2); }
        }
        
        .variable-glow {
            animation: variableGlow 2s ease-in-out infinite;
        }
        
        @keyframes termCombine {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .term-combine {
            animation: termCombine 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <!-- Algebra Pattern Background -->
    <div class="algebra-bg" id="algebraBg">
        <!-- Symbols will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 6 Mathematics</h1>
            <p class="welcome-subtitle">Unlock the language of mathematics! Learn about variables, algebraic expressions, simple equations, and how to solve real-world problems using algebra. Discover how letters can represent numbers and solve mysteries with equations!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">ùë•ùë¶‚ûó‚ú®</span>
                <span class="topic-name">Algebraic Expressions & Simple Equations</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Algebra Adventure</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 120</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0.8%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Math fact display -->
                <div id="mathFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Algebra Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const algebraBg = document.getElementById('algebraBg');
            
            // Create floating algebra symbols
            const symbols = ['ùë•', 'ùë¶', 'ùëß', '=', '+', '-', '√ó', '√∑', '()', '2', '3', 'a', 'b', 'c'];
            
            for (let i = 0; i < 30; i++) {
                const symbol = document.createElement('div');
                symbol.className = 'floating-symbol';
                symbol.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                symbol.style.left = `${Math.random() * 100}%`;
                symbol.style.top = `${Math.random() * 100}%`;
                symbol.style.animationDelay = `${Math.random() * 20}s`;
                symbol.style.fontSize = `${1 + Math.random() * 3}rem`;
                
                // Color variables differently
                if (['ùë•', 'ùë¶', 'ùëß', 'a', 'b', 'c'].includes(symbol.textContent)) {
                    symbol.style.color = 'rgba(255, 193, 7, 0.1)';
                } else {
                    symbol.style.color = 'rgba(33, 150, 243, 0.1)';
                }
                
                algebraBg.appendChild(symbol);
            }
        }

        // Questions array - 120+ Grade 6 Algebraic Expressions and Equations questions
        const questions = [
            // Variables and Expressions Basics (1-20)
            {
                type: "variables_basics",
                question: "What is a variable in algebra?",
                options: ["A letter representing an unknown number", "A fixed number", "An equation", "An operation sign"],
                answer: "A",
                explanation: "A variable is a symbol (usually a letter) that represents an unknown number. Example: In x + 5 = 12, 'x' is the variable."
            },
            {
                type: "variables_basics",
                question: "Which is an algebraic expression?",
                options: ["3x + 7", "3 + 7 = 10", "x = 5", "10 √∑ 2 = 5"],
                answer: "A",
                explanation: "3x + 7 is an algebraic expression (contains variables and constants). Others are equations or arithmetic expressions."
            },
            {
                type: "variables_basics",
                question: "What does 'coefficient' mean?",
                options: ["Number multiplying a variable", "The variable itself", "The constant term", "The equals sign"],
                answer: "A",
                explanation: "Coefficient is the number multiplying a variable. In 5x, 5 is the coefficient of x."
            },
            {
                type: "variables_basics",
                question: "Identify the constant in: 4y - 9",
                options: ["-9", "4", "y", "4y"],
                answer: "A",
                explanation: "Constant is a fixed number. In 4y - 9, -9 is the constant term (doesn't change with variables)."
            },
            {
                type: "variables_basics",
                question: "How many terms in: 3x + 2y - 7?",
                options: ["3", "2", "4", "1"],
                answer: "A",
                explanation: "Terms are parts separated by + or - signs. 3x, 2y, and -7 are three terms."
            },
            // Evaluating Expressions (21-40)
            {
                type: "evaluating_expressions",
                question: "If x = 3, what is 2x + 5?",
                options: ["11", "10", "13", "8"],
                answer: "A",
                explanation: "2x + 5 when x = 3: 2√ó3 + 5 = 6 + 5 = 11"
            },
            {
                type: "evaluating_expressions",
                question: "If a = 4, b = 2, what is 3a - b?",
                options: ["10", "6", "5", "14"],
                answer: "A",
                explanation: "3a - b = 3√ó4 - 2 = 12 - 2 = 10"
            },
            {
                type: "evaluating_expressions",
                question: "Evaluate 5y - 3 when y = 2",
                options: ["7", "4", "13", "10"],
                answer: "A",
                explanation: "5y - 3 = 5√ó2 - 3 = 10 - 3 = 7"
            },
            {
                type: "evaluating_expressions",
                question: "If m = 6, what is m¬≤ + 4?",
                options: ["40", "36", "10", "24"],
                answer: "A",
                explanation: "m¬≤ + 4 = 6¬≤ + 4 = 36 + 4 = 40"
            },
            {
                type: "evaluating_expressions",
                question: "Find value of 2(x+3) when x = 4",
                options: ["14", "11", "20", "24"],
                answer: "A",
                explanation: "2(x+3) = 2√ó(4+3) = 2√ó7 = 14"
            },
            // Like Terms and Simplifying (41-60)
            {
                type: "like_terms",
                question: "Which are like terms?",
                options: ["3x and 5x", "3x and 3y", "3x and 5", "x¬≤ and x"],
                answer: "A",
                explanation: "Like terms have the same variable raised to the same power. 3x and 5x both have x to power 1."
            },
            {
                type: "like_terms",
                question: "Simplify: 4x + 3x",
                options: ["7x", "12x", "7x¬≤", "12"],
                answer: "A",
                explanation: "4x + 3x = (4+3)x = 7x (add coefficients, keep variable same)"
            },
            {
                type: "like_terms",
                question: "Simplify: 5y - 2y + y",
                options: ["4y", "8y", "3y", "2y"],
                answer: "A",
                explanation: "5y - 2y + y = (5-2+1)y = 4y"
            },
            {
                type: "like_terms",
                question: "Combine like terms: 2a + 3b + 4a",
                options: ["6a + 3b", "9ab", "6a + 7b", "5a + 3b"],
                answer: "A",
                explanation: "2a and 4a are like terms: 2a+4a=6a, 3b stays separate: 6a + 3b"
            },
            {
                type: "like_terms",
                question: "Simplify: 7x - 3x + 2x - x",
                options: ["5x", "7x", "11x", "3x"],
                answer: "A",
                explanation: "7x - 3x + 2x - x = (7-3+2-1)x = 5x"
            },
            // Simple Equations (61-80)
            {
                type: "simple_equations",
                question: "Solve: x + 5 = 12",
                options: ["x = 7", "x = 17", "x = 6", "x = 5"],
                answer: "A",
                explanation: "x + 5 = 12 ‚Üí Subtract 5 from both sides: x = 12 - 5 = 7"
            },
            {
                type: "simple_equations",
                question: "Solve: y - 3 = 8",
                options: ["y = 11", "y = 5", "y = 24", "y = 2.67"],
                answer: "A",
                explanation: "y - 3 = 8 ‚Üí Add 3 to both sides: y = 8 + 3 = 11"
            },
            {
                type: "simple_equations",
                question: "Solve: 2x = 14",
                options: ["x = 7", "x = 12", "x = 28", "x = 16"],
                answer: "A",
                explanation: "2x = 14 ‚Üí Divide both sides by 2: x = 14 √∑ 2 = 7"
            },
            {
                type: "simple_equations",
                question: "Solve: x/4 = 3",
                options: ["x = 12", "x = 7", "x = 1", "x = 0.75"],
                answer: "A",
                explanation: "x/4 = 3 ‚Üí Multiply both sides by 4: x = 3 √ó 4 = 12"
            },
            {
                type: "simple_equations",
                question: "Solve: 3x + 2 = 11",
                options: ["x = 3", "x = 4", "x = 9", "x = 13"],
                answer: "A",
                explanation: "3x + 2 = 11 ‚Üí Subtract 2: 3x = 9 ‚Üí Divide by 3: x = 3"
            },
            // Two-step Equations (81-100)
            {
                type: "two_step_equations",
                question: "Solve: 2x - 5 = 7",
                options: ["x = 6", "x = 1", "x = 12", "x = 2"],
                answer: "A",
                explanation: "2x - 5 = 7 ‚Üí Add 5: 2x = 12 ‚Üí Divide by 2: x = 6"
            },
            {
                type: "two_step_equations",
                question: "Solve: 4y + 3 = 19",
                options: ["y = 4", "y = 5.5", "y = 16", "y = 22"],
                answer: "A",
                explanation: "4y + 3 = 19 ‚Üí Subtract 3: 4y = 16 ‚Üí Divide by 4: y = 4"
            },
            {
                type: "two_step_equations",
                question: "Solve: x/2 - 4 = 3",
                options: ["x = 14", "x = 3.5", "x = -2", "x = 10"],
                answer: "A",
                explanation: "x/2 - 4 = 3 ‚Üí Add 4: x/2 = 7 ‚Üí Multiply by 2: x = 14"
            },
            {
                type: "two_step_equations",
                question: "Solve: 5 - 2x = 1",
                options: ["x = 2", "x = 3", "x = 4", "x = -2"],
                answer: "A",
                explanation: "5 - 2x = 1 ‚Üí Subtract 5: -2x = -4 ‚Üí Divide by -2: x = 2"
            },
            // Word Problems to Equations (101-120)
            {
                type: "word_problems",
                question: "A number increased by 8 is 15. Write equation.",
                options: ["x + 8 = 15", "x - 8 = 15", "8x = 15", "x/8 = 15"],
                answer: "A",
                explanation: "'Increased by' means add: x + 8 = 15"
            },
            {
                type: "word_problems",
                question: "Twice a number is 18. Find the number.",
                options: ["9", "20", "16", "36"],
                answer: "A",
                explanation: "Twice means √ó2: 2x = 18 ‚Üí x = 9"
            },
            {
                type: "word_problems",
                question: "3 less than a number is 12. Find number.",
                options: ["15", "9", "4", "36"],
                answer: "A",
                explanation: "3 less than x: x - 3 = 12 ‚Üí x = 15"
            },
            {
                type: "word_problems",
                question: "If 5 pencils cost $x, cost of 1 pencil?",
                options: ["x/5", "5x", "x+5", "x-5"],
                answer: "A",
                explanation: "5 pencils = $x, so 1 pencil = x √∑ 5 = x/5 dollars"
            },
            {
                type: "word_problems",
                question: "Perimeter of square is 4s. If P=20, find s.",
                options: ["5", "16", "24", "80"],
                answer: "A",
                explanation: "4s = 20 ‚Üí s = 20 √∑ 4 = 5"
            },
            // Distributive Property (121-140)
            {
                type: "distributive",
                question: "Expand: 3(x + 4)",
                options: ["3x + 12", "3x + 4", "x + 12", "3x + 7"],
                answer: "A",
                explanation: "3(x+4) = 3√óx + 3√ó4 = 3x + 12"
            },
            {
                type: "distributive",
                question: "Expand: 2(3y - 5)",
                options: ["6y - 10", "6y - 5", "3y - 10", "5y - 3"],
                answer: "A",
                explanation: "2(3y-5) = 2√ó3y - 2√ó5 = 6y - 10"
            },
            {
                type: "distributive",
                question: "Simplify: 4(x+2) + 3x",
                options: ["7x + 8", "4x + 14", "7x + 2", "12x + 8"],
                answer: "A",
                explanation: "4(x+2)+3x = 4x+8+3x = 7x+8"
            },
            // Expressions from Patterns (141-160)
            {
                type: "patterns",
                question: "Pattern: 3, 6, 9, 12... Rule?",
                options: ["Add 3", "Multiply by 2", "Add 4", "Subtract 3"],
                answer: "A",
                explanation: "Each term increases by 3: 3+3=6, 6+3=9, etc."
            },
            {
                type: "patterns",
                question: "nth term of 5, 10, 15, 20...?",
                options: ["5n", "n+5", "10n", "5n+5"],
                answer: "A",
                explanation: "Position 1: 5√ó1=5, Position 2: 5√ó2=10 ‚Üí nth term = 5n"
            },
            // Mixed Practice (161-180)
            {
                type: "mixed",
                question: "Is this equation? 2x + 3 = 11",
                options: ["Yes", "No", "Sometimes", "Only if x=4"],
                answer: "A",
                explanation: "Contains equals sign and can be solved for x ‚Üí Yes, it's an equation"
            },
            {
                type: "mixed",
                question: "Algebraic expression for 'sum of x and 7'",
                options: ["x + 7", "x - 7", "7x", "x/7"],
                answer: "A",
                explanation: "Sum means addition: x + 7"
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent algebraic thinking!",
            "Perfect equation solving!",
            "Great variable manipulation!",
            "Amazing! You're an algebra expert!",
            "Perfect understanding of expressions!",
            "You're an equation solving champion!",
            "Outstanding simplification skills!",
            "Brilliant substitution work!",
            "You think like a mathematician!",
            "Algebra mastery achieved!"
        ];

        // Algebra terms and definitions
        const algebraTerms = [
            {
                term: "Variable",
                definition: "A letter representing an unknown number",
                example: "x, y, z in equations"
            },
            {
                term: "Constant",
                definition: "A fixed number that doesn't change",
                example: "5, -3, 2.7 in expressions"
            },
            {
                term: "Coefficient",
                definition: "Number multiplying a variable",
                example: "In 4x, 4 is the coefficient"
            },
            {
                term: "Expression",
                definition: "Combination of variables, constants, and operations",
                example: "3x + 2y - 7"
            },
            {
                term: "Equation",
                definition: "Statement that two expressions are equal",
                example: "2x + 3 = 11"
            },
            {
                term: "Like Terms",
                definition: "Terms with same variable raised to same power",
                example: "3x and 5x are like terms"
            }
        ];

        // Equation solving steps
        const equationExamples = [
            {
                equation: "x + 5 = 12",
                steps: [
                    "x + 5 = 12",
                    "x + 5 - 5 = 12 - 5",
                    "x = 7"
                ]
            },
            {
                equation: "2y = 14",
                steps: [
                    "2y = 14",
                    "2y √∑ 2 = 14 √∑ 2",
                    "y = 7"
                ]
            },
            {
                equation: "3x - 2 = 10",
                steps: [
                    "3x - 2 = 10",
                    "3x - 2 + 2 = 10 + 2",
                    "3x = 12",
                    "3x √∑ 3 = 12 √∑ 3",
                    "x = 4"
                ]
            }
        ];

        // Word problem examples
        const wordProblems = [
            {
                problem: "A number increased by 7 is 15. Find the number.",
                equation: "x + 7 = 15",
                solution: "x = 8"
            },
            {
                problem: "Twice a number decreased by 4 is 10. Find the number.",
                equation: "2x - 4 = 10",
                solution: "x = 7"
            },
            {
                problem: "If 3 pencils cost $x, what does 1 pencil cost?",
                equation: "Cost of 1 = x √∑ 3",
                solution: "x/3 dollars"
            }
        ];

        // Interesting math facts about algebra
        const mathFacts = [
            "The word 'algebra' comes from Arabic 'al-jabr' meaning 'reunion of broken parts'!",
            "Algebra was developed by Persian mathematician Al-Khwarizmi in the 9th century!",
            "The 'x' in algebra was popularized by Ren√© Descartes in the 1600s!",
            "Ancient Babylonians were solving algebraic equations as early as 2000 BC!",
            "The equals sign (=) was invented in 1557 by Welsh mathematician Robert Recorde!",
            "In algebra, letters at the end of alphabet (x, y, z) are usually variables!",
            "The longest equation in mathematics has about 200 terabytes of data!",
            "The Fundamental Theorem of Algebra states every polynomial has at least one root!"
        ];

        // Patterns and sequences
        const numberPatterns = [
            {
                pattern: "2, 4, 6, 8, 10...",
                rule: "Add 2",
                nthTerm: "2n"
            },
            {
                pattern: "3, 6, 9, 12, 15...",
                rule: "Add 3",
                nthTerm: "3n"
            },
            {
                pattern: "1, 4, 9, 16, 25...",
                rule: "Square numbers",
                nthTerm: "n¬≤"
            },
            {
                pattern: "2, 5, 8, 11, 14...",
                rule: "Add 3",
                nthTerm: "3n - 1"
            }
        ];

        // Substitution examples
        const substitutionExamples = [
            {
                expression: "2x + 3",
                values: [{x: 1}, {x: 2}, {x: 3}, {x: 4}],
                results: [5, 7, 9, 11]
            },
            {
                expression: "y¬≤ - 4",
                values: [{y: 2}, {y: 3}, {y: 4}, {y: 5}],
                results: [0, 5, 12, 21]
            },
            {
                expression: "3a + 2b",
                values: [{a: 2, b: 3}, {a: 4, b: 1}, {a: 0, b: 5}],
                results: [12, 14, 10]
            }
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const mathFact = document.getElementById('mathFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade6MathAlgebra');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade6MathAlgebra', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade6MathAlgebra_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade6MathAlgebra_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're an algebra expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent equation solving skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep learning to master algebra!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Practice more with expressions and equations!";
            } else {
                scoreMessage.textContent = "Keep learning! Algebra is the gateway to advanced mathematics!";
            }
        }

        // Create math fact display
        function createMathFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'math-fact';
            
            factDiv.innerHTML = `<strong>Amazing Algebra Fact:</strong> ${mathFacts[Math.floor(Math.random() * mathFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "variables_basics": "ùë•",
                "evaluating_expressions": "üî¢",
                "like_terms": "‚ú®",
                "simple_equations": "‚öñÔ∏è",
                "two_step_equations": "‚ÜïÔ∏è",
                "word_problems": "üìö",
                "distributive": "üì¶",
                "patterns": "üìà",
                "mixed": "üéØ"
            };
            
            let conceptName = "Variables Basics";
            let conceptIcon = "ùë•";
            
            if (question.type.includes("variables_basics")) {
                conceptName = "Variables Basics";
                conceptIcon = conceptIcons.variables_basics;
            } else if (question.type.includes("evaluating_expressions")) {
                conceptName = "Evaluating Expressions";
                conceptIcon = conceptIcons.evaluating_expressions;
            } else if (question.type.includes("like_terms")) {
                conceptName = "Like Terms";
                conceptIcon = conceptIcons.like_terms;
            } else if (question.type.includes("simple_equations")) {
                conceptName = "Simple Equations";
                conceptIcon = conceptIcons.simple_equations;
            } else if (question.type.includes("two_step_equations")) {
                conceptName = "Two-step Equations";
                conceptIcon = conceptIcons.two_step_equations;
            } else if (question.type.includes("word_problems")) {
                conceptName = "Word Problems";
                conceptIcon = conceptIcons.word_problems;
            } else if (question.type.includes("distributive")) {
                conceptName = "Distributive Property";
                conceptIcon = conceptIcons.distributive;
            } else if (question.type.includes("patterns")) {
                conceptName = "Number Patterns";
                conceptIcon = conceptIcons.patterns;
            } else if (question.type.includes("mixed")) {
                conceptName = "Mixed Practice";
                conceptIcon = conceptIcons.mixed;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("variables_basics")) {
                label.textContent = "Understanding variables, constants, coefficients, and terms";
            } else if (question.type.includes("evaluating_expressions")) {
                label.textContent = "Substituting values into algebraic expressions";
            } else if (question.type.includes("like_terms")) {
                label.textContent = "Combining terms with the same variable and power";
            } else if (question.type.includes("simple_equations")) {
                label.textContent = "Solving one-step equations using inverse operations";
            } else if (question.type.includes("two_step_equations")) {
                label.textContent = "Solving equations requiring two operations";
            } else if (question.type.includes("word_problems")) {
                label.textContent = "Translating real-world situations into algebraic equations";
            } else if (question.type.includes("distributive")) {
                label.textContent = "Multiplying a term across terms in parentheses";
            } else if (question.type.includes("patterns")) {
                label.textContent = "Finding rules and nth terms for number sequences";
            } else if (question.type.includes("mixed")) {
                label.textContent = "Mixed review of all algebra concepts";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create algebra visualization
        function createAlgebraVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            // Generate random numbers for examples
            const randNum1 = Math.floor(Math.random() * 10) + 1;
            const randNum2 = Math.floor(Math.random() * 10) + 1;
            const randVar = ['x', 'y', 'z'][Math.floor(Math.random() * 3)];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-orange);">Algebraic Expressions & Equations</h3>
                
                <div class="expression-display">
                    <div style="font-size: 2rem; font-family: 'Courier New', monospace;">
                        ${randNum1}${randVar} + ${randNum2} = ${randNum1 * 2 + randNum2}
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: var(--text-secondary);">
                        When ${randVar} = 2: ${randNum1}√ó2 + ${randNum2} = ${randNum1 * 2 + randNum2}
                    </div>
                </div>
                
                <div class="variable-container">
                    ${algebraTerms.map(term => `
                        <div class="variable-box variable-glow">
                            <div class="variable-name">${term.term}</div>
                            <div class="variable-label">${term.definition}</div>
                            <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 5px;">
                                ${term.example}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="equation-solver">
                    <div class="display-title">Solving Equations Step-by-Step</div>
                    
                    ${equationExamples.map((eq, idx) => `
                        <div class="method-display" style="margin-bottom: 15px;">
                            <div class="method-title" style="color: var(--secondary-green);">Example ${idx + 1}: ${eq.equation}</div>
                            <div class="method-steps">
                                ${eq.steps.map((step, stepIdx) => `
                                    <div class="equation-step equation-solve" style="animation-delay: ${stepIdx * 0.2}s;">
                                        <span class="step-number">${stepIdx + 1}</span>
                                        <div>
                                            <span class="step-expression">${step}</span>
                                            ${stepIdx < eq.steps.length - 1 ? '<div class="step-explanation">' + getStepExplanation(eq.steps[stepIdx], eq.steps[stepIdx + 1]) + '</div>' : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="balance-scale-container">
                    <div class="display-title">Balance Scale - Equation Balance</div>
                    <div class="balance-scale">
                        <div class="scale-left" id="scaleLeft">
                            <div class="scale-weight">2x + 3</div>
                        </div>
                        <div class="scale-pivot"></div>
                        <div class="scale-beam"></div>
                        <div class="scale-pivot"></div>
                        <div class="scale-right" id="scaleRight">
                            <div class="scale-weight">11</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn btn-small btn-secondary" onclick="balanceEquation()">Balance the Equation</button>
                        <button class="btn btn-small btn-outline" onclick="resetBalance()">Reset</button>
                    </div>
                    <div style="text-align: center; margin-top: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Rule:</strong> Whatever you do to one side, you must do to the other!
                    </div>
                </div>
                
                <div class="like-terms-container">
                    <div class="display-title">Like Terms - Click to Combine</div>
                    <div class="like-terms-grid" id="likeTermsGrid">
                        <!-- Like terms will be generated by JavaScript -->
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <div id="likeTermsResult" style="font-size: 1.2rem; min-height: 30px;"></div>
                    </div>
                </div>
                
                <div class="substitution-container">
                    <div class="display-title">Expression Evaluation</div>
                    <div style="text-align: center; margin: 15px 0;">
                        <span style="font-size: 1.5rem; font-family: 'Courier New', monospace;">3x + 2</span>
                    </div>
                    <div class="substitution-input">
                        <span>If x = </span>
                        <input type="number" id="subValue" value="2" min="1" max="10">
                        <span>, then 3x + 2 = </span>
                        <span id="subResult" style="font-weight: bold; color: var(--accent-orange);">8</span>
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn btn-small btn-primary" onclick="calculateSubstitution()">Calculate</button>
                        <button class="btn btn-small btn-outline" onclick="randomSubstitution()">Random x</button>
                    </div>
                </div>
                
                <div class="word-problem">
                    <div style="color: var(--accent-teal); font-weight: bold; margin-bottom: 10px;">Real-World Algebra:</div>
                    "Sarah has twice as many pencils as John. If John has x pencils, how many does Sarah have?"
                    <div style="margin-top: 10px;">
                        <strong>Expression:</strong> 2x (Sarah's pencils)
                    </div>
                    <div style="margin-top: 5px;">
                        <strong>If x = 5:</strong> 2 √ó 5 = 10 pencils
                    </div>
                </div>
                
                <table class="algebra-table">
                    <thead>
                        <tr>
                            <th>Algebra Concept</th>
                            <th>Example</th>
                            <th>Meaning</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-yellow);">Variable</td>
                            <td>x, y, z</td>
                            <td>Unknown number we're trying to find</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--primary-blue);">Coefficient</td>
                            <td>5 in 5x</td>
                            <td>Number multiplying the variable</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--secondary-green);">Constant</td>
                            <td>7 in x + 7</td>
                            <td>Fixed number that doesn't change</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-purple);">Expression</td>
                            <td>3x + 2y - 5</td>
                            <td>Combination of variables and constants</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-orange);">Equation</td>
                            <td>2x + 3 = 11</td>
                            <td>Statement that two expressions are equal</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="interactive-practice">
                    <div class="practice-title">Interactive Algebra Practice</div>
                    <div class="practice-controls">
                        <div class="practice-button" onclick="simplifyExpression()">Simplify Expression</div>
                        <div class="practice-button" onclick="solveEquation()">Solve Equation</div>
                        <div class="practice-button" onclick="createPattern()">Create Pattern</div>
                        <div class="practice-button" onclick="wordToAlgebra()">Word to Algebra</div>
                    </div>
                    <div class="practice-display" id="practiceDisplay">
                        Click buttons above to practice different algebra skills
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-orange);">
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Quick Practice:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. If x = 4, what is 2x + 3?<br>
                        2. Simplify: 3x + 2x - x<br>
                        3. Solve: x + 7 = 15<br>
                        4. Expand: 2(x + 3)<br>
                        5. Write expression: "5 more than y"
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--accent-teal);">
                    <div style="color: var(--accent-teal); font-weight: bold; margin-bottom: 10px; text-align: center;">Algebra Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Variables:</strong> Letters representing unknown numbers<br>
                        <strong>Like Terms:</strong> Same variable + same power ‚Üí Combine!<br>
                        <strong>Equations:</strong> Balance scale - keep both sides equal<br>
                        <strong>Check:</strong> Always substitute back to verify!
                    </div>
                </div>
            `;
            
            // Generate like terms grid
            generateLikeTermsGrid();
            
            // Initialize substitution
            calculateSubstitution();
            
            return vizDiv;
        }

        // Helper functions
        function getStepExplanation(currentStep, nextStep) {
            if (currentStep.includes("+") && nextStep.includes("-")) {
                return "Subtract from both sides to isolate variable term";
            } else if (currentStep.includes("-") && nextStep.includes("+")) {
                return "Add to both sides to isolate variable term";
            } else if (currentStep.includes("√ó") && nextStep.includes("√∑")) {
                return "Divide both sides to solve for variable";
            } else if (currentStep.includes("√∑") && nextStep.includes("√ó")) {
                return "Multiply both sides to solve for variable";
            }
            return "Perform inverse operation";
        }

        function generateLikeTermsGrid() {
            const grid = document.getElementById('likeTermsGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            const terms = ['3x', '2x', '5x', '4y', 'y', '7', '2', '-x', '3y', '4', '6x', '2y'];
            
            terms.forEach(term => {
                const box = document.createElement('div');
                box.className = 'like-term-box';
                box.textContent = term;
                box.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    updateLikeTermsResult();
                });
                grid.appendChild(box);
            });
        }

        function updateLikeTermsResult() {
            const resultDiv = document.getElementById('likeTermsResult');
            if (!resultDiv) return;
            
            const selected = document.querySelectorAll('.like-term-box.selected');
            const terms = Array.from(selected).map(box => box.textContent);
            
            if (terms.length === 0) {
                resultDiv.textContent = 'Select terms to combine';
                return;
            }
            
            // Group like terms
            const termMap = {};
            terms.forEach(term => {
                // Extract coefficient and variable
                let coeff = 1;
                let variable = '';
                
                if (term === '-x') {
                    coeff = -1;
                    variable = 'x';
                } else if (term.includes('x')) {
                    const num = term.replace('x', '');
                    coeff = num === '' ? 1 : num === '-' ? -1 : parseInt(num);
                    variable = 'x';
                } else if (term.includes('y')) {
                    const num = term.replace('y', '');
                    coeff = num === '' ? 1 : num === '-' ? -1 : parseInt(num);
                    variable = 'y';
                } else {
                    coeff = parseInt(term);
                    variable = 'constant';
                }
                
                if (!termMap[variable]) termMap[variable] = 0;
                termMap[variable] += coeff;
            });
            
            // Build result string
            let resultParts = [];
            if (termMap.x && termMap.x !== 0) {
                resultParts.push((termMap.x === 1 ? '' : termMap.x === -1 ? '-' : termMap.x) + 'x');
            }
            if (termMap.y && termMap.y !== 0) {
                resultParts.push((termMap.y === 1 ? '' : termMap.y === -1 ? '-' : termMap.y) + 'y');
            }
            if (termMap.constant && termMap.constant !== 0) {
                resultParts.push(termMap.constant.toString());
            }
            
            resultDiv.textContent = resultParts.join(' + ').replace('+ -', '- ') || '0';
            resultDiv.classList.add('term-combine');
            setTimeout(() => resultDiv.classList.remove('term-combine'), 500);
        }

        // Global functions for interactive practice
        window.balanceEquation = function() {
            const left = document.getElementById('scaleLeft');
            const right = document.getElementById('scaleRight');
            const beam = document.querySelector('.scale-beam');
            
            if (left && right) {
                // Animate solving 2x + 3 = 11
                setTimeout(() => {
                    left.innerHTML = '<div class="scale-weight">2x + 3 - 3</div>';
                    right.innerHTML = '<div class="scale-weight">11 - 3</div>';
                    beam.classList.add('balance-tilt');
                }, 500);
                
                setTimeout(() => {
                    left.innerHTML = '<div class="scale-weight">2x</div>';
                    right.innerHTML = '<div class="scale-weight">8</div>';
                }, 1500);
                
                setTimeout(() => {
                    left.innerHTML = '<div class="scale-weight">2x √∑ 2</div>';
                    right.innerHTML = '<div class="scale-weight">8 √∑ 2</div>';
                }, 2500);
                
                setTimeout(() => {
                    left.innerHTML = '<div class="scale-weight">x</div>';
                    right.innerHTML = '<div class="scale-weight">4</div>';
                    beam.classList.remove('balance-tilt');
                }, 3500);
            }
        };

        window.resetBalance = function() {
            const left = document.getElementById('scaleLeft');
            const right = document.getElementById('scaleRight');
            const beam = document.querySelector('.scale-beam');
            
            if (left && right) {
                left.innerHTML = '<div class="scale-weight">2x + 3</div>';
                right.innerHTML = '<div class="scale-weight">11</div>';
                beam.classList.remove('balance-tilt');
            }
        };

        window.calculateSubstitution = function() {
            const input = document.getElementById('subValue');
            const result = document.getElementById('subResult');
            
            if (input && result) {
                const x = parseInt(input.value) || 0;
                const calculation = 3 * x + 2;
                result.textContent = calculation;
                result.classList.add('pulse');
                setTimeout(() => result.classList.remove('pulse'), 500);
            }
        };

        window.randomSubstitution = function() {
            const input = document.getElementById('subValue');
            if (input) {
                input.value = Math.floor(Math.random() * 10) + 1;
                calculateSubstitution();
            }
        };

        window.simplifyExpression = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const expressions = [
                "3x + 2x + 5",
                "4y - y + 3",
                "2a + 3b + a - b",
                "5x + 2 - 3x + 4"
            ];
            
            const expression = expressions[Math.floor(Math.random() * expressions.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary-blue);">Simplify: ${expression}</div>
                    <div style="margin-bottom: 15px;">
                        <strong>Step 1:</strong> Identify like terms (same variable)
                    </div>
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 15px 0; font-family: 'Courier New', monospace; font-size: 1.2rem;">
                        ${expression}
                    </div>
                    <div style="margin-top: 20px; font-size: 1.1rem; color: var(--accent-orange);">
                        <strong>Simplified:</strong> ${simplifyAlgebraicExpression(expression)}
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        Combine coefficients of like terms, constants together
                    </div>
                </div>
            `;
        };

        window.solveEquation = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const equations = [
                {eq: "x + 7 = 15", solution: "x = 8"},
                {eq: "2y = 18", solution: "y = 9"},
                {eq: "3z - 5 = 10", solution: "z = 5"},
                {eq: "a/4 = 3", solution: "a = 12"}
            ];
            
            const equation = equations[Math.floor(Math.random() * equations.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--secondary-green);">Solve: ${equation.eq}</div>
                    <div style="margin-bottom: 15px;">
                        <strong>Remember:</strong> Do the same operation to both sides!
                    </div>
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 15px 0; font-family: 'Courier New', monospace; font-size: 1.2rem;">
                        ${getEquationSteps(equation.eq)}
                    </div>
                    <div style="margin-top: 20px; font-size: 1.3rem; color: var(--accent-orange); font-weight: bold;">
                        ${equation.solution}
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        Check: Substitute back into original equation to verify
                    </div>
                </div>
            `;
        };

        window.createPattern = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const patterns = [
                {sequence: "2, 4, 6, 8, 10", rule: "Add 2", nth: "2n"},
                {sequence: "3, 6, 9, 12, 15", rule: "Add 3", nth: "3n"},
                {sequence: "5, 10, 15, 20, 25", rule: "Add 5", nth: "5n"},
                {sequence: "1, 4, 9, 16, 25", rule: "Square numbers", nth: "n¬≤"}
            ];
            
            const pattern = patterns[Math.floor(Math.random() * patterns.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-purple);">Number Pattern</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-family: 'Courier New', monospace;">
                        ${pattern.sequence}
                    </div>
                    <div style="margin-bottom: 15px;">
                        What's the pattern rule?
                    </div>
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <div style="margin-bottom: 10px;">
                            <strong>Rule:</strong> ${pattern.rule}
                        </div>
                        <div>
                            <strong>nth term:</strong> ${pattern.nth}
                        </div>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        Position 1: ${pattern.nth.replace('n', '1')}<br>
                        Position 2: ${pattern.nth.replace('n', '2')}<br>
                        Position 10: ${pattern.nth.replace('n', '10')}
                    </div>
                </div>
            `;
        };

        window.wordToAlgebra = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const problems = [
                {phrase: "A number increased by 5", expression: "x + 5"},
                {phrase: "Twice a number", expression: "2x"},
                {phrase: "3 less than a number", expression: "x - 3"},
                {phrase: "The product of 4 and a number", expression: "4x"}
            ];
            
            const problem = problems[Math.floor(Math.random() * problems.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-teal);">Translate to Algebra</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-style: italic;">
                        "${problem.phrase}"
                    </div>
                    <div style="margin-bottom: 15px;">
                        Let x represent "a number"
                    </div>
                    <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin: 15px 0; font-size: 1.3rem;">
                        <strong>Algebraic Expression:</strong> ${problem.expression}
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Key Words:</strong><br>
                        "increased by" ‚Üí +<br>
                        "twice" ‚Üí √ó2<br>
                        "less than" ‚Üí -<br>
                        "product of" ‚Üí √ó
                    </div>
                </div>
            `;
        };

        // Helper functions for algebra operations
        function simplifyAlgebraicExpression(expr) {
            // Simple simplification for demonstration
            if (expr === "3x + 2x + 5") return "5x + 5";
            if (expr === "4y - y + 3") return "3y + 3";
            if (expr === "2a + 3b + a - b") return "3a + 2b";
            if (expr === "5x + 2 - 3x + 4") return "2x + 6";
            return expr;
        }

        function getEquationSteps(equation) {
            if (equation === "x + 7 = 15") {
                return "x + 7 = 15<br>x + 7 - 7 = 15 - 7<br>x = 8";
            } else if (equation === "2y = 18") {
                return "2y = 18<br>2y √∑ 2 = 18 √∑ 2<br>y = 9";
            } else if (equation === "3z - 5 = 10") {
                return "3z - 5 = 10<br>3z - 5 + 5 = 10 + 5<br>3z = 15<br>3z √∑ 3 = 15 √∑ 3<br>z = 5";
            } else if (equation === "a/4 = 3") {
                return "a/4 = 3<br>a/4 √ó 4 = 3 √ó 4<br>a = 12";
            }
            return equation;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            mathFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            mathFact.appendChild(createMathFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createAlgebraVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
