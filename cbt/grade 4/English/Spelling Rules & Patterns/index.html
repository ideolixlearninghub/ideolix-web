<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 4 English - Spelling Rules & Patterns | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Dark Theme */
        :root {
            --primary-amber: #FFB300;
            --secondary-indigo: #3F51B5;
            --accent-green: #4CAF50;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(255, 179, 0, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Background Slideshow */
        .slideshow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-amber), var(--secondary-indigo));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 179, 0, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-amber);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-amber);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-amber);
            box-shadow: 0 0 0 3px rgba(255, 179, 0, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-amber);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 179, 0, 0.4);
        }

        .btn-primary:hover {
            background: #FFA000;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 179, 0, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-indigo);
            color: white;
            box-shadow: 0 4px 15px rgba(63, 81, 181, 0.4);
        }

        .btn-secondary:hover {
            background: #3949AB;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(63, 81, 181, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-amber);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-amber), var(--secondary-indigo));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(255, 179, 0, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .spelling-rule {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--primary-amber);
            font-style: italic;
            color: var(--text-secondary);
        }

        .word-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .spelling-box {
            background: linear-gradient(135deg, var(--primary-amber), var(--secondary-indigo));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            min-width: 200px;
            box-shadow: 0 4px 15px rgba(255, 179, 0, 0.3);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .word-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .spelling-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .spelling-options {
                grid-template-columns: 1fr;
            }
        }

        .spelling-option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }

        .spelling-option:hover {
            border-color: var(--primary-amber);
            background: rgba(255, 179, 0, 0.05);
            transform: translateY(-2px);
        }

        .spelling-option.correct {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .spelling-option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-indigo);
        }

        .spelling-option.correct .option-letter {
            background: var(--accent-green);
        }

        .spelling-option.incorrect .option-letter {
            background: #F44336;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: none;
        }

        .feedback-correct {
            background: rgba(76, 175, 80, 0.1);
            border-left: 5px solid var(--accent-green);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--accent-green);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--accent-green);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
        }

        /* Spelling Pattern Diagram */
        .spelling-pattern-diagram {
            max-width: 500px;
            margin: 20px auto;
            position: relative;
            height: 180px;
        }

        .pattern-element {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 140px;
        }

        .pattern-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            border: 2px solid var(--primary-amber);
            font-size: 1.2rem;
        }

        .pattern-label {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-amber), var(--secondary-indigo));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-amber), var(--secondary-indigo));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-amber);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Fill in the blank style */
        .fill-blank {
            display: inline-block;
            padding: 5px 10px;
            background: var(--dark-surface);
            border-radius: 6px;
            border-bottom: 2px solid var(--primary-amber);
            min-width: 100px;
            text-align: center;
            margin: 0 5px;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .spelling-box {
                min-width: 160px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); background: var(--accent-green); }
            100% { transform: scale(1); }
        }
        
        @keyframes incorrectAnswer {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }
    </style>
</head>
<body>
    <!-- Background Slideshow -->
    <div class="slideshow" id="slideshow">
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1455390582262-044cdead277a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1506784983877-45594efa4cbe?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1495465798138-718f86d1a4bc?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 4 English</h1>
            <p class="welcome-subtitle">Master spelling rules and patterns! Learn the secrets of English spelling through rules like "i before e", silent letters, plural endings, and common spelling patterns to become a spelling champion!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">✍️</span>
                <span class="topic-name">Spelling Rules & Patterns</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Spelling Adventure</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1%"></div>
                </div>
            </div>

            <div class="question-container">
                <h2 class="question-text" id="questionText"></h2>
                
                <!-- Spelling rule display -->
                <div id="spellingRule"></div>
                
                <!-- Word display area -->
                <div id="wordDisplay"></div>
                
                <!-- Spelling pattern diagram -->
                <div id="spellingPatternDiagram"></div>
                
                <div class="spelling-options" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-message"></div>
                    <div class="feedback-explanation"></div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Spelling Master Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize slideshow
        function initSlideshow() {
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }

        // Questions array - 100 Grade 4 English questions covering spelling rules and patterns
        const questions = [
            // Basic Spelling Rules (1-30)
            {
                type: "rule",
                question: "What is the correct spelling rule for words ending with 'y' when adding a suffix?",
                options: ["Change y to i and add es/ed", "Keep y and add s/ed", "Add es without changing y", "Remove y and add i"],
                answer: "A",
                explanation: "When a word ends in a consonant + y, change the y to i before adding es or ed (e.g., cry → cries, try → tried)."
            },
            {
                type: "rule",
                question: "Which spelling follows the 'i before e' rule correctly?",
                options: ["Believe", "Recieve", "Weird", "Theif"],
                answer: "A",
                explanation: "'I before e except after c, or when sounding like 'ay' as in neighbor or weigh.' 'Believe' follows the rule correctly."
            },
            {
                type: "rule",
                question: "How do you make words ending in 'ch', 'sh', 's', 'x', or 'z' plural?",
                options: ["Add -es", "Add -s only", "Add -ies", "No change"],
                answer: "A",
                explanation: "Words ending in ch, sh, s, x, or z add -es to form the plural (e.g., church → churches, box → boxes)."
            },
            {
                type: "rule",
                question: "What happens when you add a suffix to a word ending in silent 'e'?",
                options: ["Drop the e before vowel suffixes", "Keep the e always", "Add an extra e", "Change e to i"],
                answer: "A",
                explanation: "When adding a vowel suffix (-ing, -ed, -er, -est), drop the silent e (e.g., bake → baking, hope → hoping)."
            },
            {
                type: "rule",
                question: "Which word follows the 'double the consonant' rule correctly?",
                options: ["Running", "Runing", "Runing", "Runeing"],
                answer: "A",
                explanation: "When adding a vowel suffix to a one-syllable word ending in consonant-vowel-consonant, double the final consonant (run → running)."
            },
            {
                type: "rule",
                question: "What is the correct way to spell the plural of 'baby'?",
                options: ["Babies", "Babys", "Babyes", "Babyies"],
                answer: "A",
                explanation: "Words ending in consonant + y change y to i and add es: baby → babies."
            },
            {
                type: "rule",
                question: "Which spelling is correct for the word meaning 'full of hope'?",
                options: ["Hopeful", "Hopefful", "Hopefull", "Hopefull"],
                answer: "A",
                explanation: "When adding -ful to hope, keep the silent e: hopeful."
            },
            {
                type: "rule",
                question: "How do you spell the comparative form of 'big'?",
                options: ["Bigger", "Biger", "Biggar", "Biggr"],
                answer: "A",
                explanation: "One-syllable words ending in consonant-vowel-consonant double the final consonant before -er: big → bigger."
            },
            {
                type: "rule",
                question: "What is the correct spelling of the word meaning 'to make happy'?",
                options: ["Happier", "Happyer", "Happeyer", "Happiar"],
                answer: "A",
                explanation: "Words ending in consonant + y change y to i before -er: happy → happier."
            },
            {
                type: "rule",
                question: "Which follows the rule for adding -ing to 'make'?",
                options: ["Making", "Makeing", "Makking", "Makeeing"],
                answer: "A",
                explanation: "When adding -ing to words ending in silent e, drop the e: make → making."
            },
            {
                type: "rule",
                question: "What is the plural of 'fox'?",
                options: ["Foxes", "Foxs", "Foxies", "Foxen"],
                answer: "A",
                explanation: "Words ending in x add -es to form the plural: fox → foxes."
            },
            {
                type: "rule",
                question: "Which spelling is correct for the word meaning 'most beautiful'?",
                options: ["Most beautiful", "Most beautifulest", "Most beautyful", "Most beautyfull"],
                answer: "A",
                explanation: "For words of three or more syllables, use 'most' instead of adding -est: most beautiful."
            },
            {
                type: "rule",
                question: "How do you spell the past tense of 'try'?",
                options: ["Tried", "Tryed", "Tried", "Tryied"],
                answer: "A",
                explanation: "Words ending in consonant + y change y to i before -ed: try → tried."
            },
            {
                type: "rule",
                question: "What is the correct plural of 'city'?",
                options: ["Cities", "Citys", "Cityes", "Citiees"],
                answer: "A",
                explanation: "Words ending in consonant + y change y to i and add es: city → cities."
            },
            {
                type: "rule",
                question: "Which follows the rule for adding -er to 'sad'?",
                options: ["Sadder", "Sader", "Saddder", "Sadr"],
                answer: "A",
                explanation: "One-syllable words ending in consonant-vowel-consonant double the final consonant: sad → sadder."
            },
            {
                type: "rule",
                question: "What is the correct spelling of 'amaze' + -ing?",
                options: ["Amazing", "Amazeing", "Amazzing", "Amazeing"],
                answer: "A",
                explanation: "When adding -ing to words ending in silent e, drop the e: amaze → amazing."
            },
            {
                type: "rule",
                question: "How do you make 'dish' plural?",
                options: ["Dishes", "Dishs", "Dishees", "Dishies"],
                answer: "A",
                explanation: "Words ending in sh add -es to form the plural: dish → dishes."
            },
            {
                type: "rule",
                question: "Which spelling is correct for 'love' + -able?",
                options: ["Lovable", "Loveable", "Lovvable", "Loveible"],
                answer: "A",
                explanation: "When adding -able to words ending in silent e, usually drop the e: love → lovable."
            },
            {
                type: "rule",
                question: "What is the plural of 'bush'?",
                options: ["Bushes", "Bushs", "Bushees", "Bushies"],
                answer: "A",
                explanation: "Words ending in sh add -es to form the plural: bush → bushes."
            },
            {
                type: "rule",
                question: "How do you spell the comparative of 'funny'?",
                options: ["Funnier", "Funnyer", "Funneyer", "Funnir"],
                answer: "A",
                explanation: "Words ending in consonant + y change y to i before -er: funny → funnier."
            },
            {
                type: "rule",
                question: "Which is correct for 'hope' + -ing?",
                options: ["Hoping", "Hopeing", "Hoppeing", "Hopeing"],
                answer: "A",
                explanation: "When adding -ing to words ending in silent e, drop the e: hope → hoping."
            },
            {
                type: "rule",
                question: "What is the plural of 'quiz'?",
                options: ["Quizzes", "Quizs", "Quizies", "Quizzen"],
                answer: "A",
                explanation: "Words ending in z double the z and add -es: quiz → quizzes."
            },
            {
                type: "rule",
                question: "How do you spell 'big' + -est?",
                options: ["Biggest", "Bigest", "Biggest", "Biggeest"],
                answer: "A",
                explanation: "One-syllable words ending in consonant-vowel-consonant double the final consonant before -est: big → biggest."
            },
            {
                type: "rule",
                question: "Which spelling follows the 'i before e' rule?",
                options: ["Field", "Feild", "Fieled", "Feeld"],
                answer: "A",
                explanation: "Field follows 'i before e except after c' rule."
            },
            {
                type: "rule",
                question: "What is the plural of 'wish'?",
                options: ["Wishes", "Wishs", "Wishies", "Wishses"],
                answer: "A",
                explanation: "Words ending in sh add -es to form the plural: wish → wishes."
            },
            {
                type: "rule",
                question: "How do you spell 'cry' + -ed?",
                options: ["Cried", "Cryed", "Cryied", "Cryed"],
                answer: "A",
                explanation: "Words ending in consonant + y change y to i before -ed: cry → cried."
            },
            {
                type: "rule",
                question: "Which is correct for 'make' + -er?",
                options: ["Maker", "Makeer", "Makker", "Makeir"],
                answer: "A",
                explanation: "When adding -er to words ending in silent e, keep the e: make → maker."
            },
            {
                type: "rule",
                question: "What is the plural of 'match'?",
                options: ["Matches", "Matchs", "Matchies", "Matchen"],
                answer: "A",
                explanation: "Words ending in ch add -es to form the plural: match → matches."
            },
            {
                type: "rule",
                question: "How do you spell 'happy' + -ness?",
                options: ["Happiness", "Happyness", "Hapiness", "Happieness"],
                answer: "A",
                explanation: "Words ending in consonant + y change y to i before adding -ness: happy → happiness."
            },
            {
                type: "rule",
                question: "Which follows the rule for 'see' + -ing?",
                options: ["Seeing", "Seeeing", "Seing", "Seeing"],
                answer: "A",
                explanation: "When adding -ing to words ending in double e, keep both e's: see → seeing."
            },
            // Silent Letters (31-50)
            {
                type: "pattern",
                question: "Which word has a silent 'k'?",
                options: ["Knee", "Keep", "Kite", "Kind"],
                answer: "A",
                explanation: "The 'k' in 'knee' is silent - it's pronounced 'nee'."
            },
            {
                type: "pattern",
                question: "In which word is the 'b' silent?",
                options: ["Comb", "Baby", "Big", "About"],
                answer: "A",
                explanation: "The 'b' in 'comb' is silent - it's pronounced 'kome'."
            },
            {
                type: "pattern",
                question: "Which word contains a silent 'w'?",
                options: ["Write", "Water", "Window", "Wonder"],
                answer: "A",
                explanation: "The 'w' in 'write' is silent - it's pronounced 'rite'."
            },
            {
                type: "pattern",
                question: "In which word is the 'l' silent?",
                options: ["Could", "Lemon", "Little", "Color"],
                answer: "A",
                explanation: "The 'l' in 'could' is silent - it's pronounced 'cood'."
            },
            {
                type: "pattern",
                question: "Which word has a silent 'g'?",
                options: ["Gnat", "Goat", "Girl", "Game"],
                answer: "A",
                explanation: "The 'g' in 'gnat' is silent - it's pronounced 'nat'."
            },
            {
                type: "pattern",
                question: "In which word is the 't' silent?",
                options: ["Castle", "Table", "Time", "Team"],
                answer: "A",
                explanation: "The 't' in 'castle' is silent - it's pronounced 'cas-uhl'."
            },
            {
                type: "pattern",
                question: "Which word contains a silent 'h'?",
                options: ["Honor", "House", "Help", "Happen"],
                answer: "A",
                explanation: "The 'h' in 'honor' is silent - it's pronounced 'onor'."
            },
            {
                type: "pattern",
                question: "In which word is the 'p' silent?",
                options: ["Psychology", "Paper", "Pencil", "People"],
                answer: "A",
                explanation: "The 'p' in 'psychology' is silent - it's pronounced 'sy-kol-uh-jee'."
            },
            {
                type: "pattern",
                question: "Which word has a silent 'n'?",
                options: ["Autumn", "Nine", "None", "Name"],
                answer: "A",
                explanation: "The 'n' in 'autumn' is silent - it's pronounced 'aw-tum'."
            },
            {
                type: "pattern",
                question: "In which word is the 's' silent?",
                options: ["Island", "Sun", "Same", "See"],
                answer: "A",
                explanation: "The 's' in 'island' is silent - it's pronounced 'eye-land'."
            },
            {
                type: "pattern",
                question: "Which word contains a silent 'c'?",
                options: ["Science", "Cat", "Car", "Can"],
                answer: "A",
                explanation: "The first 'c' in 'science' is silent - it's pronounced 'sye-ens'."
            },
            {
                type: "pattern",
                question: "In which word is the 'd' silent?",
                options: ["Wednesday", "Dog", "Door", "Did"],
                answer: "A",
                explanation: "The first 'd' in 'Wednesday' is silent - it's pronounced 'wenz-day'."
            },
            {
                type: "pattern",
                question: "Which word has a silent 'u'?",
                options: ["Build", "Use", "Under", "Up"],
                answer: "A",
                explanation: "The 'u' in 'build' is silent - it's pronounced 'bild'."
            },
            {
                type: "pattern",
                question: "In which word is the 'e' silent?",
                options: ["Name", "Elephant", "Every", "End"],
                answer: "A",
                explanation: "The final 'e' in 'name' is silent - it makes the 'a' long (naym)."
            },
            {
                type: "pattern",
                question: "Which word contains a silent 'b' at the end?",
                options: ["Lamb", "Bob", "Club", "Crab"],
                answer: "A",
                explanation: "The 'b' in 'lamb' is silent - it's pronounced 'lam'."
            },
            {
                type: "pattern",
                question: "In which word is the 'g' silent?",
                options: ["Sign", "Go", "Gift", "Game"],
                answer: "A",
                explanation: "The 'g' in 'sign' is silent - it's pronounced 'sine'."
            },
            {
                type: "pattern",
                question: "Which word has a silent 'w'?",
                options: ["Wrong", "Work", "Wish", "Well"],
                answer: "A",
                explanation: "The 'w' in 'wrong' is silent - it's pronounced 'rong'."
            },
            {
                type: "pattern",
                question: "In which word is the 't' silent?",
                options: ["Listen", "Talk", "Tell", "Time"],
                answer: "A",
                explanation: "The 't' in 'listen' is silent - it's pronounced 'lis-uhn'."
            },
            {
                type: "pattern",
                question: "Which word contains a silent 'k'?",
                options: ["Knife", "Kite", "Kind", "Keep"],
                answer: "A",
                explanation: "The 'k' in 'knife' is silent - it's pronounced 'nife'."
            },
            {
                type: "pattern",
                question: "In which word is the 'h' silent?",
                options: ["Hour", "Home", "Help", "Hope"],
                answer: "A",
                explanation: "The 'h' in 'hour' is silent - it's pronounced 'our'."
            },
            // Common Spelling Patterns (51-80)
            {
                type: "pattern",
                question: "Which word uses the 'ough' pattern correctly?",
                options: ["Thought", "Thowt", "Thot", "Thawt"],
                answer: "A",
                explanation: "'Ough' can make different sounds. In 'thought', it sounds like 'aw'."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word that sounds like 'fone'?",
                options: ["Phone", "Fone", "Phown", "Fown"],
                answer: "A",
                explanation: "The 'ph' pattern makes the 'f' sound in English, as in phone, photo, phonics."
            },
            {
                type: "pattern",
                question: "Which word follows the 'tion' pattern?",
                options: ["Attention", "Attenshun", "Attencion", "Attension"],
                answer: "A",
                explanation: "'Tion' makes the 'shun' sound in English, as in attention, nation, action."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to make a choice'?",
                options: ["Decide", "Deside", "Decaide", "Decied"],
                answer: "A",
                explanation: "The 'cide' pattern is common in words like decide, suicide, homicide."
            },
            {
                type: "pattern",
                question: "Which word uses the 'ight' pattern?",
                options: ["Right", "Rite", "Riht", "Ryte"],
                answer: "A",
                explanation: "'Ight' makes the 'ite' sound in English, as in right, night, light."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word that means 'a large body of water'?",
                options: ["Ocean", "Oshan", "Otion", "Ochen"],
                answer: "A",
                explanation: "'Ce' often makes the 'sh' sound when followed by e, i, or y, as in ocean."
            },
            {
                type: "pattern",
                question: "Which word follows the 'ous' pattern?",
                options: ["Famous", "Famus", "Faymous", "Famouse"],
                answer: "A",
                explanation: "'Ous' is a common ending for adjectives, as in famous, dangerous, joyous."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'very big'?",
                options: ["Gigantic", "Gijantic", "Gygantic", "Gigantik"],
                answer: "A",
                explanation: "The 'ic' ending is common for adjectives, as in gigantic, fantastic, specific."
            },
            {
                type: "pattern",
                question: "Which word uses the 'ai' pattern correctly?",
                options: ["Rain", "Rane", "Rayn", "Raine"],
                answer: "A",
                explanation: "'Ai' often makes the long 'a' sound in English, as in rain, pain, train."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to speak'?",
                options: ["Talk", "Tawk", "Tauk", "Tolk"],
                answer: "A",
                explanation: "'Alk' makes the 'awk' sound in English, as in talk, walk, chalk."
            },
            {
                type: "pattern",
                question: "Which word follows the 'ea' pattern?",
                options: ["Read", "Reed", "Reid", "Reade"],
                answer: "A",
                explanation: "'Ea' can make different sounds. In 'read', it makes the long 'e' sound."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to put words on paper'?",
                options: ["Write", "Right", "Rite", "Wright"],
                answer: "A",
                explanation: "'Wr' makes the 'r' sound at the beginning of words, as in write, wrong, wrap."
            },
            {
                type: "pattern",
                question: "Which word uses the 'oo' pattern?",
                options: ["School", "Skool", "Schoole", "Schule"],
                answer: "A",
                explanation: "'Oo' makes different sounds. In 'school', it makes the 'oo' sound."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'a number'?",
                options: ["Eight", "Ate", "Aight", "Eigt"],
                answer: "A",
                explanation: "'Eigh' makes the long 'a' sound in English, as in eight, weight, neighbor."
            },
            {
                type: "pattern",
                question: "Which word follows the 'ch' pattern?",
                options: ["Chair", "Chare", "Chaire", "Chayr"],
                answer: "A",
                explanation: "'Ch' makes different sounds. In 'chair', it makes the 'ch' sound."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to go up'?",
                options: ["Climb", "Clime", "Clim", "Clym"],
                answer: "A",
                explanation: "'Mb' at the end of words has a silent 'b', as in climb, comb, lamb."
            },
            {
                type: "pattern",
                question: "Which word uses the 'gh' pattern?",
                options: ["Light", "Lite", "Lyte", "Liht"],
                answer: "A",
                explanation: "'Gh' can be silent or make the 'f' sound. In 'light', it's silent."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to teach'?",
                options: ["Instruct", "Instrukt", "Instruckt", "Instruc"],
                answer: "A",
                explanation: "'Ct' is a common ending in words like instruct, construct, conduct."
            },
            {
                type: "pattern",
                question: "Which word follows the 'ou' pattern?",
                options: ["House", "Howse", "Hows", "Housse"],
                answer: "A",
                explanation: "'Ou' often makes the 'ow' sound in English, as in house, mouse, out."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'a friend'?",
                options: ["Companion", "Companeon", "Compannon", "Companean"],
                answer: "A",
                explanation: "'Ion' is a common ending in words like companion, opinion, union."
            },
            {
                type: "pattern",
                question: "Which word uses the 'ie' pattern?",
                options: ["Piece", "Peice", "Piese", "Peise"],
                answer: "A",
                explanation: "'Ie' often makes the long 'e' sound in English, as in piece, field, believe."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'not any'?",
                options: ["None", "Nun", "Nohn", "Nown"],
                answer: "A",
                explanation: "'One' makes the 'un' sound in some words, as in none, done, gone."
            },
            {
                type: "pattern",
                question: "Which word follows the 'ough' pattern?",
                options: ["Through", "Thru", "Threw", "Throu"],
                answer: "A",
                explanation: "'Ough' can make different sounds. In 'through', it sounds like 'oo'."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to look at'?",
                options: ["Watch", "Wotch", "Wach", "Wotsh"],
                answer: "A",
                explanation: "'Tch' makes the 'ch' sound after short vowels, as in watch, catch, match."
            },
            {
                type: "pattern",
                question: "Which word uses the 'augh' pattern?",
                options: ["Daughter", "Dawter", "Doter", "Daughtur"],
                answer: "A",
                explanation: "'Augh' often makes the 'aw' sound in English, as in daughter, caught, taught."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to think'?",
                options: ["Consider", "Considder", "Consieder", "Considur"],
                answer: "A",
                explanation: "'Er' is a common ending in words like consider, answer, summer."
            },
            {
                type: "pattern",
                question: "Which word follows the 'ey' pattern?",
                options: ["They", "Thay", "Thae", "Thei"],
                answer: "A",
                explanation: "'Ey' can make the long 'a' sound in English, as in they, grey, convey."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'a test'?",
                options: ["Exam", "Eggzam", "Exsam", "Egsam"],
                answer: "A",
                explanation: "'Ex' makes the 'egz' sound when followed by a vowel, as in exam, exact, exist."
            },
            {
                type: "pattern",
                question: "Which word uses the 'ue' pattern?",
                options: ["Blue", "Bloo", "Blew", "Bleu"],
                answer: "A",
                explanation: "'Ue' often makes the 'oo' sound in English, as in blue, true, glue."
            },
            {
                type: "pattern",
                question: "What is the correct spelling of the word meaning 'to ask for'?",
                options: ["Request", "Reequest", "Requesst", "Reequest"],
                answer: "A",
                explanation: "'Est' is a common ending in words like request, forest, honest."
            },
            // Commonly Misspelled Words (81-100)
            {
                type: "common",
                question: "Which is the correct spelling?",
                options: ["Because", "Becouse", "Becaus", "Becuase"],
                answer: "A",
                explanation: "'Because' is one of the most commonly misspelled words. Remember: be + cause."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'to come before'?",
                options: ["Before", "Befor", "Beefore", "Befour"],
                answer: "A",
                explanation: "'Before' combines be + fore. Remember it has one 'e' in the middle."
            },
            {
                type: "common",
                question: "Which spelling is correct?",
                options: ["Friend", "Freind", "Frend", "Friened"],
                answer: "A",
                explanation: "'Friend' follows the 'i before e' rule. Remember: 'i' comes before 'e' in friend."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'a learning place'?",
                options: ["School", "Schoole", "Skool", "Schule"],
                answer: "A",
                explanation: "'School' has a silent 'h'. Remember it's spelled with 'ch' not 'k'."
            },
            {
                type: "common",
                question: "Which is the correct spelling?",
                options: ["People", "Peaple", "Peeple", "Peopel"],
                answer: "A",
                explanation: "'People' has 'eo' in the middle. Remember it's not 'ea' like in 'peas'."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'a parent'?",
                options: ["Parent", "Perent", "Pareent", "Parrent"],
                answer: "A",
                explanation: "'Parent' has 'ar' not 'er'. Remember it's like 'car' with 'ent'."
            },
            {
                type: "common",
                question: "Which spelling is correct?",
                options: ["Beautiful", "Beutiful", "Beautyful", "Beautifull"],
                answer: "A",
                explanation: "'Beautiful' comes from 'beauty' + 'ful'. Remember it has 'eau' at the beginning."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'to receive'?",
                options: ["Receive", "Recieve", "Receve", "Receave"],
                answer: "A",
                explanation: "'Receive' follows 'i before e except after c'. After 'c', it's 'ei'."
            },
            {
                type: "common",
                question: "Which is the correct spelling?",
                options: ["Wednesday", "Wensday", "Wednsday", "Wedensday"],
                answer: "A",
                explanation: "'Wednesday' has a silent 'd'. Remember it's named after the god Odin (Woden)."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'to go to'?",
                options: ["Together", "Togather", "Together", "Togeather"],
                answer: "A",
                explanation: "'Together' is to + get + her. Remember it has 'e' in the middle, not 'a'."
            },
            {
                type: "common",
                question: "Which spelling is correct?",
                options: ["Tomorrow", "Tommorrow", "Tommorow", "Tomorow"],
                answer: "A",
                explanation: "'Tomorrow' has one 'm' and two 'r's. Remember: to + morrow."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'a lot'?",
                options: ["A lot", "Alot", "Allot", "A-lot"],
                answer: "A",
                explanation: "'A lot' is always two words. 'Alot' is not a word in standard English."
            },
            {
                type: "common",
                question: "Which is the correct spelling?",
                options: ["Definitely", "Definately", "Definitly", "Defenitely"],
                answer: "A",
                explanation: "'Definitely' comes from 'finite' + 'ly'. Remember it has 'ite' not 'ate'."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'to separate'?",
                options: ["Separate", "Seperate", "Sepperate", "Seperrate"],
                answer: "A",
                explanation: "'Separate' has 'a' in the middle. Remember: there's 'a rat' in separate."
            },
            {
                type: "common",
                question: "Which spelling is correct?",
                options: ["Occasion", "Occassion", "Ocassion", "Occation"],
                answer: "A",
                explanation: "'Occasion' has one 'c' and two 's's. Remember: double 's' in the middle."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'to go by'?",
                options: ["Through", "Thru", "Threw", "Throu"],
                answer: "A",
                explanation: "'Through' has 'ough' making the 'oo' sound. 'Thru' is informal."
            },
            {
                type: "common",
                question: "Which is the correct spelling?",
                options: ["Necessary", "Neccessary", "Necesary", "Nessessary"],
                answer: "A",
                explanation: "'Necessary' has one 'c' and two 's's. Remember: one collar, two sleeves."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'very good'?",
                options: ["Excellent", "Excellant", "Excelent", "Exelent"],
                answer: "A",
                explanation: "'Excellent' has double 'l' and 'ent' at the end. Remember it comes from 'excel'."
            },
            {
                type: "common",
                question: "Which spelling is correct?",
                options: ["Environment", "Enviroment", "Enviroment", "Environement"],
                answer: "A",
                explanation: "'Environment' has 'n' before 'm'. Remember: 'iron' is in the environment."
            },
            {
                type: "common",
                question: "What is the correct spelling of the word meaning 'to continue'?",
                options: ["Continue", "Continew", "Continou", "Contineu"],
                answer: "A",
                explanation: "'Continue' ends with 'ue'. Remember it's related to 'continuous'."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent spelling!",
            "Fantastic spelling knowledge!",
            "Great job! You're a spelling champion!",
            "Amazing! Your spelling skills are impressive!",
            "Well done! Perfect spelling!",
            "You're a spelling expert!",
            "Perfect! You've mastered that rule!",
            "Outstanding spelling ability!",
            "Brilliant! You spell like a pro!",
            "You're on fire! Great spelling insight!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const spellingRule = document.getElementById('spellingRule');
        const wordDisplay = document.getElementById('wordDisplay');
        const spellingPatternDiagram = document.getElementById('spellingPatternDiagram');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initSlideshow();
            loadStateFromStorage();
            setupEventListeners();
            
            // Show appropriate page based on state
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade4EnglishSpelling');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                // If we have a saved state but no questions, initialize them
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade4EnglishSpelling', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            // Create a copy of questions and shuffle them
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            // Allow pressing Enter to start practice
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            
            // Clear any previous input
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            
            // Display student name
            studentNameDisplay.textContent = appState.studentName;
            
            // Load the current question
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            // Calculate results
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            // Update results display
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            // Get highest score from localStorage
            const highest = localStorage.getItem('ideolixGrade4EnglishSpelling_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            // Save new highest score if applicable
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade4EnglishSpelling_highestScore', appState.score);
            }
            
            // Set encouraging message based on score
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a spelling rules and patterns expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent spelling knowledge!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing to become a spelling master!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review the questions you missed and try again!";
            } else {
                scoreMessage.textContent = "Keep practicing! Spelling skills improve with regular learning!";
            }
        }

        // Create spelling rule display
        function createSpellingRule() {
            const ruleDiv = document.createElement('div');
            ruleDiv.className = 'spelling-rule';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "rule") {
                ruleDiv.innerHTML = `
                    <strong>Spelling Rule Reminder:</strong> Remember common spelling rules like "i before e except after c", 
                    changing y to i, and doubling final consonants when adding suffixes.
                `;
            } else if (question.type === "pattern") {
                ruleDiv.innerHTML = `
                    <strong>Pattern Reminder:</strong> English has many spelling patterns like silent letters, 
                    common word endings (-tion, -ous), and letter combinations that make specific sounds.
                `;
            } else if (question.type === "common") {
                ruleDiv.innerHTML = `
                    <strong>Common Words:</strong> Some words are frequently misspelled. Pay attention to 
                    tricky spellings and remember memory tricks to help you spell them correctly.
                `;
            }
            
            return ruleDiv;
        }

        // Create spelling pattern diagram
        function createSpellingPatternDiagram() {
            const container = document.createElement('div');
            container.className = 'spelling-pattern-diagram';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "rule") {
                // Rule diagram
                container.innerHTML = `
                    <div class="pattern-element" style="top: 10%; left: 10%;">
                        <div class="pattern-icon">📝</div>
                        <div class="pattern-label">Base Word</div>
                    </div>
                    <div class="pattern-element" style="top: 10%; left: 70%;">
                        <div class="pattern-icon">➕</div>
                        <div class="pattern-label">Add Suffix</div>
                    </div>
                    <div class="pattern-element" style="top: 60%; left: 40%;">
                        <div class="pattern-icon">⚡</div>
                        <div class="pattern-label">Apply Rule</div>
                    </div>
                `;
            } else if (question.type === "pattern") {
                // Pattern diagram
                container.innerHTML = `
                    <div class="pattern-element" style="top: 10%; left: 10%;">
                        <div class="pattern-icon">🔤</div>
                        <div class="pattern-label">Letters</div>
                    </div>
                    <div class="pattern-element" style="top: 10%; left: 70%;">
                        <div class="pattern-icon">🔊</div>
                        <div class="pattern-label">Sound Pattern</div>
                    </div>
                    <div class="pattern-element" style="top: 60%; left: 40%;">
                        <div class="pattern-icon">🎯</div>
                        <div class="pattern-label">Spelling Pattern</div>
                    </div>
                `;
            } else if (question.type === "common") {
                // Common words diagram
                container.innerHTML = `
                    <div class="pattern-element" style="top: 10%; left: 10%;">
                        <div class="pattern-icon">⚠️</div>
                        <div class="pattern-label">Tricky Part</div>
                    </div>
                    <div class="pattern-element" style="top: 10%; left: 70%;">
                        <div class="pattern-icon">💡</div>
                        <div class="pattern-label">Memory Trick</div>
                    </div>
                    <div class="pattern-element" style="top: 60%; left: 40%;">
                        <div class="pattern-icon">✅</div>
                        <div class="pattern-label">Correct Spelling</div>
                    </div>
                `;
            }
            
            return container;
        }

        // Create word display
        function createWordDisplay() {
            const display = document.createElement('div');
            display.className = 'word-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "rule") {
                // For rule questions - show a word that needs a suffix
                const wordExamples = {
                    "Change y to i and add es/ed": "CRY + ed = ?",
                    "I before e except after c": "BR__VE (complete the word)",
                    "Add -es to ch/sh/s/x/z": "WISH + plural = ?",
                    "Drop silent e before vowel suffixes": "BAKE + ing = ?",
                    "Double final consonant": "RUN + ing = ?",
                    "Words ending in consonant + y change y to i": "BABY + plural = ?",
                    "Adding -ful to hope": "HOPE + ful = ?",
                    "One-syllable CVC words double final consonant": "BIG + er = ?",
                    "Happy + -er": "HAPPY + er = ?",
                    "Make + -ing": "MAKE + ing = ?",
                    "Fox plural": "FOX + plural = ?",
                    "Most beautiful": "MOST BEAUTIFUL",
                    "Try + -ed": "TRY + ed = ?",
                    "City plural": "CITY + plural = ?",
                    "Sad + -er": "SAD + er = ?",
                    "Amaze + -ing": "AMAZE + ing = ?",
                    "Dish plural": "DISH + plural = ?",
                    "Love + -able": "LOVE + able = ?",
                    "Bush plural": "BUSH + plural = ?",
                    "Funny + -er": "FUNNY + er = ?",
                    "Hope + -ing": "HOPE + ing = ?",
                    "Quiz plural": "QUIZ + plural = ?",
                    "Big + -est": "BIG + est = ?",
                    "Field": "F__LD (complete)",
                    "Wish plural": "WISH + plural = ?",
                    "Cry + -ed": "CRY + ed = ?",
                    "Make + -er": "MAKE + er = ?",
                    "Match plural": "MATCH + plural = ?",
                    "Happy + -ness": "HAPPY + ness = ?",
                    "See + -ing": "SEE + ing = ?"
                };
                
                const wordBox = document.createElement('div');
                wordBox.className = 'spelling-box';
                wordBox.textContent = wordExamples[question.explanation.split('.')[0]] || "Apply the rule";
                
                const label = document.createElement('div');
                label.className = 'word-label';
                label.textContent = "Apply the spelling rule:";
                
                display.appendChild(wordBox);
                display.appendChild(label);
            } else if (question.type === "pattern" || question.type === "common") {
                // For pattern and common word questions
                const wordBox = document.createElement('div');
                wordBox.className = 'spelling-box';
                
                // Extract word from question or explanation
                const questionText = question.question;
                const wordMatch = questionText.match(/word(?: that)? (?:meaning|sounds like|spelled) ['"](.+?)['"]/);
                const optionMatch = questionText.match(/Which (?:word|spelling|is) (?:the|correct)/);
                
                if (wordMatch) {
                    wordBox.textContent = wordMatch[1].toUpperCase();
                } else if (optionMatch) {
                    // Find a word from options
                    const firstOption = question.options[0];
                    wordBox.textContent = firstOption.toUpperCase();
                } else {
                    wordBox.textContent = "SPELLING";
                }
                
                const label = document.createElement('div');
                label.className = 'word-label';
                label.textContent = "Identify the correct spelling:";
                
                display.appendChild(wordBox);
                display.appendChild(label);
            }
            
            return display;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            // Update progress
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            // Set question text
            questionText.textContent = question.question;
            
            // Clear previous content
            spellingRule.innerHTML = '';
            wordDisplay.innerHTML = '';
            spellingPatternDiagram.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            // Create spelling rule, word display, and diagram
            spellingRule.appendChild(createSpellingRule());
            wordDisplay.appendChild(createWordDisplay());
            spellingPatternDiagram.appendChild(createSpellingPatternDiagram());
            
            // Create option elements with spelling-specific styling
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'spelling-option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            // Disable all options
            const allOptions = document.querySelectorAll('.spelling-option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            // Mark correct/incorrect
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                // Correct answer
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                
                // Add animation for correct answer
                optionElement.style.animation = 'correctAnswer 0.5s ease';
                
                // Show positive feedback
                showFeedback(true, question.explanation);
            } else {
                // Incorrect answer
                optionElement.classList.add('incorrect');
                appState.answered++;
                
                // Add animation for incorrect answer
                optionElement.style.animation = 'incorrectAnswer 0.3s ease';
                
                // Show negative feedback
                showFeedback(false, question.explanation, question.answer);
            }
            
            // Enable next question button
            nextQuestionBtn.disabled = false;
            
            // Save progress
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '✓';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '✗';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic with new shuffled questions
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            // Re-shuffle questions
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page (simulated)
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
            // In a real implementation, this would be: window.location.href = "grade4-english-topics.html";
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            // Initialize questions if needed
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
