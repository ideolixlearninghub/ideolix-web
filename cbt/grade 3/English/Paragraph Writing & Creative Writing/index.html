<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 3 English - Paragraph Writing & Creative Writing | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Dark Theme */
        :root {
            --primary-green: #00C853;
            --secondary-orange: #FF6D00;
            --accent-purple: #7C4DFF;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(0, 200, 83, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Background Slideshow */
        .slideshow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-green), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(0, 200, 83, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-green);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 200, 83, 0.4);
        }

        .btn-primary:hover {
            background: #00B248;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 200, 83, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-orange);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 109, 0, 0.4);
        }

        .btn-secondary:hover {
            background: #E65C00;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 109, 0, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-green);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Topic Selection Page */
        .topics-page {
            display: none;
        }

        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .topic-card {
            background: var(--dark-surface);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }

        .topic-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-green);
            box-shadow: var(--shadow), var(--glow);
        }

        .topic-icon {
            width: 60px;
            height: 60px;
            margin-bottom: 15px;
            border-radius: 12px;
            background: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
        }

        .topic-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .topic-description {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-green), var(--secondary-orange));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(0, 200, 83, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-green);
            background: rgba(0, 200, 83, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(0, 200, 83, 0.1);
            border-color: var(--primary-green);
            color: var(--primary-green);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
        }

        .option.correct .option-letter {
            background: var(--primary-green);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: none;
        }

        .feedback-correct {
            background: rgba(0, 200, 83, 0.1);
            border-left: 5px solid var(--primary-green);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-green);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-green);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-green), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-green), var(--secondary-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-green);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .topics-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* Special styling for writing examples */
        .writing-example {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-purple);
            font-family: 'Courier New', monospace;
            line-height: 1.6;
        }

        .paragraph-example {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--primary-green);
            line-height: 1.6;
        }

        .speech-example {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--secondary-orange);
            line-height: 1.6;
        }

        .letter-example {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #FF4081;
            line-height: 1.6;
        }

        .correct-example {
            color: var(--primary-green);
            font-weight: bold;
        }

        .incorrect-example {
            color: #F44336;
            text-decoration: line-through;
        }

        .highlight {
            background-color: rgba(255, 215, 0, 0.2);
            padding: 2px 4px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Background Slideshow -->
    <div class="slideshow" id="slideshow">
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1509228468518-180dd4864904?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1559757148-5c350d0d3c56?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 3 English - Writing Skills</h1>
            <p class="welcome-subtitle">Master the art of writing! Learn how to write paragraphs, understand direct and indirect speech, write informal letters, and express your creativity through stories and descriptions.</p>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startLearning">
                    <span>Start Learning</span>
                </button>
            </div>
        </div>

        <!-- Topics Selection Page -->
        <div class="topics-page card fade-in" id="topicsPage">
            <h2 class="welcome-title">Choose a Writing Topic</h2>
            <p class="welcome-subtitle">Select a topic to practice and improve your writing skills.</p>
            
            <div class="topics-grid">
                <div class="topic-card" data-topic="paragraph-writing">
                    <div class="topic-icon">üìù</div>
                    <h3 class="topic-title">Paragraph Writing</h3>
                    <p class="topic-description">Learn to organize your ideas into clear, well-structured paragraphs with topic sentences and supporting details.</p>
                </div>
                
                <div class="topic-card" data-topic="direct-indirect-speech">
                    <div class="topic-icon">üó£Ô∏è</div>
                    <h3 class="topic-title">Direct & Indirect Speech</h3>
                    <p class="topic-description">Understand how to report what someone said using direct and indirect speech with proper punctuation.</p>
                </div>
                
                <div class="topic-card" data-topic="letter-writing">
                    <div class="topic-icon">‚úâÔ∏è</div>
                    <h3 class="topic-title">Letter Writing (Informal)</h3>
                    <p class="topic-description">Learn the format and language for writing friendly letters to family and friends.</p>
                </div>
                
                <div class="topic-card" data-topic="creative-writing">
                    <div class="topic-icon">‚ú®</div>
                    <h3 class="topic-title">Creative Writing</h3>
                    <p class="topic-description">Express your imagination through stories, descriptions, and creative pieces with vivid details.</p>
                </div>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 60</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1%"></div>
                </div>
            </div>

            <div class="question-container">
                <h2 class="question-text" id="questionText"></h2>
                
                <div class="options-container" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-message"></div>
                    <div class="feedback-explanation"></div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Practice Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Retry Topic</button>
                <button class="btn btn-secondary" id="viewTopics">View Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize slideshow
        function initSlideshow() {
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }

        // Questions by topic
        const questionsByTopic = {
            "paragraph-writing": [
                {
                    question: "What is the main purpose of a topic sentence in a paragraph?",
                    options: ["To introduce the main idea", "To provide examples", "To add details", "To end the paragraph"],
                    answer: "A",
                    explanation: "The topic sentence introduces the main idea that the rest of the paragraph will explain or support with details."
                },
                {
                    question: "Which of these would make the best topic sentence for a paragraph about dogs?",
                    options: ["Dogs make wonderful pets for many reasons.", "Some dogs are big and some are small.", "I have a dog named Max.", "Dogs need food and water."],
                    answer: "A",
                    explanation: "This topic sentence clearly states the main idea that will be developed in the paragraph - why dogs make good pets."
                },
                {
                    question: "What are supporting sentences in a paragraph?",
                    options: ["Sentences that give details about the main idea", "The first sentence of the paragraph", "Sentences that ask questions", "The last sentence of the paragraph"],
                    answer: "A",
                    explanation: "Supporting sentences provide details, examples, facts, or explanations that develop and support the main idea introduced in the topic sentence."
                },
                {
                    question: "Which of these is a good supporting sentence for the topic: 'Winter is my favorite season'?",
                    options: ["I love building snowmen and having snowball fights.", "Summer is hot and sunny.", "Spring has beautiful flowers.", "Fall has colorful leaves."],
                    answer: "A",
                    explanation: "This supporting sentence provides specific details about why winter is the favorite season, directly supporting the topic sentence."
                },
                {
                    question: "What is the purpose of a concluding sentence in a paragraph?",
                    options: ["To summarize the main idea", "To introduce a new topic", "To ask a question", "To provide more examples"],
                    answer: "A",
                    explanation: "The concluding sentence wraps up the paragraph by restating the main idea in a new way or providing a final thought."
                },
                {
                    question: "Which of these would make a good concluding sentence for a paragraph about healthy eating?",
                    options: ["Eating healthy foods helps us grow strong and have energy.", "Pizza is my favorite food.", "Some people don't like vegetables.", "Tomorrow we will learn about exercise."],
                    answer: "A",
                    explanation: "This concluding sentence effectively summarizes the importance of healthy eating, which was likely the main idea of the paragraph."
                },
                {
                    question: "How many main ideas should a paragraph have?",
                    options: ["One", "Two", "Three", "As many as possible"],
                    answer: "A",
                    explanation: "A good paragraph focuses on one main idea, which is introduced in the topic sentence and supported by the other sentences."
                },
                {
                    question: "What is the correct order of sentences in a paragraph?",
                    options: ["Topic sentence, supporting sentences, concluding sentence", "Concluding sentence, topic sentence, supporting sentences", "Supporting sentences, topic sentence, concluding sentence", "Any order is fine"],
                    answer: "A",
                    explanation: "A well-organized paragraph begins with a topic sentence, followed by supporting sentences, and ends with a concluding sentence."
                },
                {
                    question: "Which of these is NOT a good supporting detail for the topic 'Why reading is important'?",
                    options: ["My favorite color is blue.", "Reading helps us learn new things.", "Books can take us to imaginary places.", "Reading improves our vocabulary."],
                    answer: "A",
                    explanation: "This sentence about a favorite color is unrelated to the topic of why reading is important and doesn't support the main idea."
                },
                {
                    question: "What should all sentences in a paragraph relate to?",
                    options: ["The main idea", "Different ideas", "The title", "The next paragraph"],
                    answer: "A",
                    explanation: "All sentences in a paragraph should relate to and support the main idea introduced in the topic sentence to maintain unity and coherence."
                },
                {
                    question: "Which transition word would best connect these sentences: 'I finished my homework. ___ I played outside.'?",
                    options: ["Then", "But", "Because", "Although"],
                    answer: "A",
                    explanation: "'Then' shows the sequence of events - first finishing homework, then playing outside."
                },
                {
                    question: "What is the main idea of this paragraph: 'Apples are healthy fruits. They contain vitamins that help our bodies. Eating an apple each day can keep you from getting sick. Apples also give us energy.'",
                    options: ["Apples are healthy fruits", "Apples contain vitamins", "Apples prevent sickness", "Apples give energy"],
                    answer: "A",
                    explanation: "The first sentence 'Apples are healthy fruits' is the topic sentence that introduces the main idea, which the other sentences support."
                },
                {
                    question: "Which of these would be the best topic sentence for a paragraph about recycling?",
                    options: ["Recycling helps protect our environment in several ways.", "I put paper in the blue bin.", "Some people don't recycle.", "Plastic bottles can be recycled."],
                    answer: "A",
                    explanation: "This topic sentence clearly states the main idea that will be developed - how recycling helps the environment."
                },
                {
                    question: "What is wrong with this paragraph: 'Dogs are friendly. Cats can be independent. Fish live in water. Birds can fly.'",
                    options: ["It has no main idea", "It has no topic sentence", "It has no concluding sentence", "All of the above"],
                    answer: "A",
                    explanation: "This paragraph jumps between different topics without focusing on one main idea or having a clear topic sentence."
                },
                {
                    question: "Which sentence would make the best conclusion for a paragraph about the benefits of exercise?",
                    options: ["Regular exercise is important for staying healthy and strong.", "Some people exercise at gyms.", "I don't like running.", "Tomorrow we will learn about nutrition."],
                    answer: "A",
                    explanation: "This concluding sentence effectively summarizes the main idea about the benefits of exercise."
                }
            ],
            "direct-indirect-speech": [
                {
                    question: "What is direct speech?",
                    options: ["The exact words someone said, in quotation marks", "Telling what someone said without their exact words", "Speaking loudly", "Writing in paragraphs"],
                    answer: "A",
                    explanation: "Direct speech shows the exact words someone said, enclosed in quotation marks."
                },
                {
                    question: "Which punctuation is used to show direct speech?",
                    options: ["Quotation marks", "Commas", "Periods", "Exclamation marks"],
                    answer: "A",
                    explanation: "Quotation marks (\" \") are used to enclose the exact words someone said in direct speech."
                },
                {
                    question: "How would you write this as direct speech: Mom said she was making dinner.",
                    options: ["Mom said, \"I am making dinner.\"", "Mom said I am making dinner.", "\"Mom said I am making dinner.\"", "Mom said 'I am making dinner'"],
                    answer: "A",
                    explanation: "This correctly uses quotation marks around the exact words Mom said and includes the reporting clause 'Mom said'."
                },
                {
                    question: "What is indirect speech?",
                    options: ["Reporting what someone said without using their exact words", "The exact words someone said", "Speaking quietly", "Writing in a notebook"],
                    answer: "A",
                    explanation: "Indirect speech (also called reported speech) tells what someone said without using their exact words, and doesn't use quotation marks."
                },
                {
                    question: "Which of these is indirect speech?",
                    options: ["She said that she was tired.", "She said, \"I am tired.\"", "\"I am tired,\" she said.", "She exclaimed, \"I'm so tired!\""],
                    answer: "A",
                    explanation: "This reports what she said without using her exact words, making it indirect speech."
                },
                {
                    question: "How would you change this direct speech to indirect: \"I like ice cream,\" said Tom.",
                    options: ["Tom said that he liked ice cream.", "Tom said, \"He likes ice cream.\"", "Tom said I like ice cream.", "Tom said that I like ice cream."],
                    answer: "A",
                    explanation: "In indirect speech, we change pronouns (I ‚Üí he) and sometimes verb tenses, and remove quotation marks."
                },
                {
                    question: "What change happens to pronouns in indirect speech?",
                    options: ["They change to match who is speaking", "They stay the same", "They are removed", "They become names"],
                    answer: "A",
                    explanation: "In indirect speech, pronouns change to match the perspective of the person reporting the speech."
                },
                {
                    question: "How would you write this as indirect speech: \"We are going to the park,\" they said.",
                    options: ["They said that they were going to the park.", "They said we are going to the park.", "They said, \"They are going to the park.\"", "They said that we were going to the park."],
                    answer: "A",
                    explanation: "This correctly changes 'we' to 'they' and adjusts the verb tense for indirect speech."
                },
                {
                    question: "Which of these is correctly punctuated direct speech?",
                    options: ["My teacher said, \"Complete your homework.\"", "My teacher said \"Complete your homework.\"", "My teacher said, Complete your homework.", "\"My teacher said, Complete your homework.\""],
                    answer: "A",
                    explanation: "This correctly uses a comma before the quotation marks and places the period inside the quotation marks."
                },
                {
                    question: "How would you change this to direct speech: He said that he had finished his book.",
                    options: ["He said, \"I have finished my book.\"", "He said \"I finished my book.\"", "\"He said I have finished my book.\"", "He said, I have finished my book."],
                    answer: "A",
                    explanation: "This correctly uses quotation marks around the exact words and changes the pronouns appropriately."
                },
                {
                    question: "What is the reporting verb in this sentence: Sarah exclaimed, \"What a surprise!\"",
                    options: ["exclaimed", "Sarah", "surprise", "What"],
                    answer: "A",
                    explanation: "The reporting verb 'exclaimed' introduces the direct speech and tells us how Sarah said it."
                },
                {
                    question: "How would you write this as indirect speech: \"I can swim well,\" boasted Michael.",
                    options: ["Michael boasted that he could swim well.", "Michael boasted, \"He can swim well.\"", "Michael boasted I can swim well.", "Michael boasted that I can swim well."],
                    answer: "A",
                    explanation: "This correctly changes the pronoun and modal verb for indirect speech while keeping the reporting verb 'boasted'."
                },
                {
                    question: "Which of these shows direct speech?",
                    options: ["\"It's raining outside,\" she noticed.", "She noticed that it was raining outside.", "She said it was raining.", "According to her, it was raining."],
                    answer: "A",
                    explanation: "This uses quotation marks to show the exact words she said, making it direct speech."
                },
                {
                    question: "How would you change this to indirect speech: \"We will win the game,\" the coach promised.",
                    options: ["The coach promised that they would win the game.", "The coach promised, \"They will win the game.\"", "The coach promised we will win the game.", "The coach promised that we would win the game."],
                    answer: "A",
                    explanation: "This correctly changes the pronouns and verb tense for indirect speech."
                },
                {
                    question: "What is missing from this direct speech: My sister said I love drawing.",
                    options: ["Quotation marks and comma", "A period", "Capital letters", "A verb"],
                    answer: "A",
                    explanation: "This needs quotation marks around the exact words and a comma after 'said': 'My sister said, \"I love drawing.\"'"
                }
            ],
            "letter-writing": [
                {
                    question: "What is an informal letter?",
                    options: ["A friendly letter to someone you know well", "A formal letter to a company", "A business letter", "A letter to the government"],
                    answer: "A",
                    explanation: "An informal letter is a personal letter written to friends, family, or people you know well, using casual language."
                },
                {
                    question: "Where does your address go in an informal letter?",
                    options: ["At the top right corner", "At the bottom", "In the middle", "On the left side"],
                    answer: "A",
                    explanation: "In an informal letter, your address is typically written at the top right corner of the page."
                },
                {
                    question: "How do you start an informal letter?",
                    options: ["With a greeting like 'Dear [Name],'", "With 'To whom it may concern'", "With your address", "With the date"],
                    answer: "A",
                    explanation: "Informal letters typically begin with a friendly greeting like 'Dear Grandma,' or 'Hi Sarah,' followed by a comma."
                },
                {
                    question: "What is the purpose of the first paragraph in an informal letter?",
                    options: ["To ask about the person you're writing to", "To ask for something", "To say goodbye", "To give your address"],
                    answer: "A",
                    explanation: "The first paragraph of an informal letter usually asks about the recipient's well-being or refers to previous contact."
                },
                {
                    question: "What type of language is appropriate in an informal letter?",
                    options: ["Friendly and conversational", "Very formal", "Technical language", "Short phrases only"],
                    answer: "A",
                    explanation: "Informal letters use friendly, conversational language as if you're talking to the person."
                },
                {
                    question: "How do you end an informal letter?",
                    options: ["With a closing like 'Love,' or 'Your friend,'", "With 'Sincerely,'", "With just your name", "With the date"],
                    answer: "A",
                    explanation: "Informal letters typically end with a friendly closing like 'Love,' 'Best wishes,' or 'Your friend,' followed by your name."
                },
                {
                    question: "Where does the date go in an informal letter?",
                    options: ["Below your address", "At the very top", "At the bottom", "After the greeting"],
                    answer: "A",
                    explanation: "The date is typically written below your address at the top right of the page."
                },
                {
                    question: "What is appropriate to include in the body of an informal letter?",
                    options: ["News about your life and questions for the recipient", "Only facts and figures", "Complaints", "A list of demands"],
                    answer: "A",
                    explanation: "The body of an informal letter typically shares news, stories, and asks questions to continue the conversation."
                },
                {
                    question: "Which greeting would be most appropriate for a letter to your cousin?",
                    options: ["Dear Alex,", "To whom it may concern,", "Dear Sir/Madam,", "Hello to the Johnson family,"],
                    answer: "A",
                    explanation: "'Dear Alex,' is a friendly, appropriate greeting for a letter to a family member."
                },
                {
                    question: "How would you sign off a letter to your best friend?",
                    options: ["Your best friend,", "Sincerely,", "Respectfully,", "Best regards,"],
                    answer: "A",
                    explanation: "'Your best friend,' is a warm, personal closing appropriate for a letter to a close friend."
                },
                {
                    question: "What should you include in the second paragraph of an informal letter?",
                    options: ["The main news or reason for writing", "Your address", "The closing", "A formal request"],
                    answer: "A",
                    explanation: "The second paragraph typically contains the main news, stories, or reason for writing the letter."
                },
                {
                    question: "Which of these would be a good opening for an informal letter?",
                    options: ["How are you? I hope you're doing well.", "This letter is to inform you that...", "Pursuant to our conversation...", "I am writing to complain about..."],
                    answer: "A",
                    explanation: "This friendly opening is appropriate for an informal letter, showing concern for the recipient."
                },
                {
                    question: "What is the purpose of the last paragraph in an informal letter?",
                    options: ["To wrap up and say goodbye", "To introduce yourself", "To give your address", "To ask for money"],
                    answer: "A",
                    explanation: "The final paragraph typically wraps up the letter, expresses hope to see the person soon, and says goodbye."
                },
                {
                    question: "Which of these is an appropriate topic for an informal letter?",
                    options: ["Telling your grandma about your school play", "Applying for a job", "Complaining to a company", "Requesting information"],
                    answer: "A",
                    explanation: "Sharing personal news and experiences is appropriate content for an informal letter to family."
                },
                {
                    question: "How is an informal letter different from a formal letter?",
                    options: ["It uses friendly language and personal topics", "It has more rules", "It is longer", "It uses technical terms"],
                    answer: "A",
                    explanation: "Informal letters use casual, friendly language and discuss personal matters, unlike formal letters which have strict formats and professional topics."
                }
            ],
            "creative-writing": [
                {
                    question: "What is creative writing?",
                    options: ["Writing that uses imagination and creativity", "Writing facts and information", "Writing letters", "Writing school reports"],
                    answer: "A",
                    explanation: "Creative writing expresses ideas and stories in an imaginative way, often using literary techniques."
                },
                {
                    question: "Which of these is an example of creative writing?",
                    options: ["A story about a magical forest", "A science textbook", "A news article", "A recipe"],
                    answer: "A",
                    explanation: "A story about a magical forest uses imagination and creativity, making it an example of creative writing."
                },
                {
                    question: "What are characters in a story?",
                    options: ["The people or animals in the story", "The letters of the alphabet", "The punctuation marks", "The pictures"],
                    answer: "A",
                    explanation: "Characters are the people, animals, or creatures that the story is about."
                },
                {
                    question: "What is the setting of a story?",
                    options: ["Where and when the story happens", "The main problem", "The ending", "The title"],
                    answer: "A",
                    explanation: "The setting is the time and place where the story occurs."
                },
                {
                    question: "What is the plot of a story?",
                    options: ["The sequence of events in the story", "The characters", "The setting", "The moral"],
                    answer: "A",
                    explanation: "The plot is what happens in the story - the sequence of events from beginning to end."
                },
                {
                    question: "What are descriptive words?",
                    options: ["Words that help readers imagine what you're describing", "Words that ask questions", "Short words", "Words in other languages"],
                    answer: "A",
                    explanation: "Descriptive words (adjectives and adverbs) help create vivid pictures in the reader's mind."
                },
                {
                    question: "Which of these is the most descriptive sentence?",
                    options: ["The tiny, fluffy kitten played with a bright red ball of yarn.", "The cat played with yarn.", "A kitten was there with some yarn.", "The cat and yarn were together."],
                    answer: "A",
                    explanation: "This sentence uses specific, descriptive words like 'tiny,' 'fluffy,' and 'bright red' to create a clear image."
                },
                {
                    question: "What is dialogue in a story?",
                    options: ["The conversations between characters", "The description of settings", "The narrator's thoughts", "The chapter titles"],
                    answer: "A",
                    explanation: "Dialogue is what the characters say to each other, usually shown with quotation marks."
                },
                {
                    question: "How can you make your writing more interesting?",
                    options: ["Use sensory details (sight, sound, smell, etc.)", "Use only short sentences", "Use difficult words", "Write very fast"],
                    answer: "A",
                    explanation: "Using sensory details helps readers experience the story through multiple senses, making it more engaging."
                },
                {
                    question: "What is the beginning of a story called?",
                    options: ["The introduction", "The conclusion", "The climax", "The title"],
                    answer: "A",
                    explanation: "The introduction is the beginning of the story where characters, setting, and the situation are introduced."
                },
                {
                    question: "What is the middle of a story called?",
                    options: ["The development", "The introduction", "The conclusion", "The title"],
                    answer: "A",
                    explanation: "The development is the middle part where the main events happen and the story builds toward the climax."
                },
                {
                    question: "What is the end of a story called?",
                    options: ["The conclusion", "The introduction", "The development", "The title"],
                    answer: "A",
                    explanation: "The conclusion is the ending where the story's problems are resolved and the narrative wraps up."
                },
                {
                    question: "What does 'show, don't tell' mean in writing?",
                    options: ["Describe actions and feelings rather than just stating them", "Use pictures instead of words", "Tell the reader everything", "Only show happy things"],
                    answer: "A",
                    explanation: "'Show, don't tell' means describing what characters do and how they behave to reveal their feelings, rather than just saying 'he was sad.'"
                },
                {
                    question: "Which of these 'shows' instead of 'tells'?",
                    options: ["Tears rolled down her cheeks as she hugged the teddy bear.", "She was very sad.", "She felt unhappy.", "Sadness overwhelmed her."],
                    answer: "A",
                    explanation: "This sentence shows sadness through specific actions (tears, hugging teddy bear) rather than just stating the emotion."
                },
                {
                    question: "What is a story climax?",
                    options: ["The most exciting part of the story", "The beginning", "The ending", "The title"],
                    answer: "A",
                    explanation: "The climax is the most intense and exciting point in the story, where the main conflict reaches its peak."
                }
            ]
        };

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: "",
            currentTopic: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent writing skills!",
            "Fantastic knowledge!",
            "Great job!",
            "Amazing!",
            "Well done!",
            "You're a writing expert!",
            "Perfect!",
            "Outstanding!",
            "Brilliant!",
            "You're on fire!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const topicsPage = document.getElementById('topicsPage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startLearningBtn = document.getElementById('startLearning');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');
        const topicCards = document.querySelectorAll('.topic-card');

        // Initialize the app
        function initApp() {
            initSlideshow();
            loadStateFromStorage();
            setupEventListeners();
            
            // Show appropriate page based on state
            if (appState.studentName && appState.currentTopic && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else if (appState.studentName) {
                showTopicsPage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade3EnglishWriting');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentTopic = parsed.currentTopic || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade3EnglishWriting', JSON.stringify(appState));
        }

        // Initialize and shuffle questions for a topic
        function initializeQuestions(topic) {
            // Create a copy of questions for the topic and shuffle them
            appState.currentQuestions = [...questionsByTopic[topic]];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startLearningBtn.addEventListener('click', startLearning);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            // Add event listeners to topic cards
            topicCards.forEach(card => {
                card.addEventListener('click', () => selectTopic(card.dataset.topic));
            });
            
            // Allow pressing Enter to start learning
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startLearning();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            topicsPage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            
            // Clear any previous input
            studentNameInput.value = appState.studentName || '';
        }

        // Show topics page
        function showTopicsPage() {
            welcomePage.style.display = 'none';
            topicsPage.style.display = 'block';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            topicsPage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            
            // Display student name
            studentNameDisplay.textContent = appState.studentName;
            
            // Load the current question
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            topicsPage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            // Calculate results
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            // Update results display
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            // Get highest score from localStorage
            const highest = localStorage.getItem(`ideolixGrade3EnglishWriting_${appState.currentTopic}_highestScore`) || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            // Save new highest score if applicable
            if (appState.score > highest) {
                localStorage.setItem(`ideolixGrade3EnglishWriting_${appState.currentTopic}_highestScore`, appState.score);
            }
            
            // Set encouraging message based on score
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a writing expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have strong writing skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing to become a writing master!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review the concepts you missed and try again!";
            } else {
                scoreMessage.textContent = "Keep practicing! You'll get better with more practice!";
            }
        }

        // Start learning - show topic selection
        function startLearning() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert('Please enter your name to continue.');
                return;
            }
            
            appState.studentName = name;
            saveStateToStorage();
            showTopicsPage();
        }

        // Select a topic and start practice
        function selectTopic(topic) {
            appState.currentTopic = topic;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            // Initialize and shuffle questions for the selected topic
            initializeQuestions(topic);
            
            // Save state and show practice page
            saveStateToStorage();
            showPracticePage();
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            // Update progress
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            // Set question text
            questionText.textContent = question.question;
            
            // Clear previous options and feedback
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            // Create option elements
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            // Disable all options
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            // Mark correct/incorrect
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                // Correct answer
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                
                // Show positive feedback
                showFeedback(true, question.explanation);
            } else {
                // Incorrect answer
                optionElement.classList.add('incorrect');
                appState.answered++;
                
                // Show negative feedback
                showFeedback(false, question.explanation, question.answer);
            }
            
            // Enable next question button
            nextQuestionBtn.disabled = false;
            
            // Save progress
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    feedbackMessage.textContent = `Correct answer: ${String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65))}`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic with new shuffled questions
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            // Re-shuffle questions
            initializeQuestions(appState.currentTopic);
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            showTopicsPage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
