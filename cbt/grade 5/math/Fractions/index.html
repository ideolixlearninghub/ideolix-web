<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 5 Math - Fractions | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Fractions Theme */
        :root {
            --primary-pink: #E91E63;
            --secondary-purple: #9C27B0;
            --accent-amber: #FFC107;
            --accent-teal: #00BCD4;
            --accent-green: #4CAF50;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(233, 30, 99, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Background Slideshow */
        .slideshow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-pink), var(--secondary-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(233, 30, 99, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-pink);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-pink);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-pink);
            box-shadow: 0 0 0 3px rgba(233, 30, 99, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-pink);
            color: white;
            box-shadow: 0 4px 15px rgba(233, 30, 99, 0.4);
        }

        .btn-primary:hover {
            background: #C2185B;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
        }

        .btn-secondary:hover {
            background: #7B1FA2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(156, 39, 176, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-pink);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Page */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-pink), var(--secondary-purple));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(233, 30, 99, 0.5);
        }

        /* Question Content Layout */
        .question-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
            min-height: 400px;
        }

        @media (max-width: 768px) {
            .question-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        .question-section {
            background: var(--dark-surface);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid var(--dark-border);
        }

        .example-section {
            background: var(--dark-surface);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid var(--dark-border);
        }

        .question-text {
            font-size: 1.6rem;
            margin-bottom: 20px;
            line-height: 1.5;
            color: var(--text-primary);
            min-height: 80px;
        }

        /* Fraction Display */
        .fraction-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }

        .fraction {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
            font-size: 2.5rem;
            font-weight: bold;
        }

        .numerator {
            padding: 5px 20px;
            border-bottom: 3px solid var(--primary-pink);
            color: var(--accent-teal);
        }

        .denominator {
            padding: 5px 20px;
            color: var(--accent-amber);
        }

        .fraction-line {
            height: 3px;
            background: var(--primary-pink);
            width: 100%;
            margin: 5px 0;
        }

        .fraction-comparison {
            display: flex;
            align-items: center;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .comparison-symbol {
            font-size: 2.5rem;
            color: var(--accent-green);
            font-weight: bold;
        }

        /* Options Container */
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .option {
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-pink);
            background: rgba(233, 30, 99, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(233, 30, 99, 0.1);
            border-color: var(--primary-pink);
            color: var(--primary-pink);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: var(--primary-pink);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
        }

        .option.correct .option-letter {
            background: var(--primary-pink);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        /* Example Section */
        .example-title {
            font-size: 1.3rem;
            color: var(--primary-pink);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .math-fact {
            background: rgba(0, 188, 212, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-teal);
            font-style: italic;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .example-display {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .process-display {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .process-step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border-left: 3px solid var(--accent-green);
        }

        .step-icon {
            font-size: 1.5rem;
            color: var(--accent-green);
        }

        .step-content h4 {
            color: var(--accent-green);
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .step-content p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* Fraction Model Display */
        .fraction-model {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
        }

        .fraction-part {
            width: 40px;
            height: 40px;
            background: var(--accent-amber);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--dark-bg);
        }

        .fraction-part.filled {
            background: var(--accent-teal);
        }

        .fraction-part.empty {
            background: rgba(255, 193, 7, 0.3);
        }

        /* Number Line Display */
        .number-line {
            width: 100%;
            height: 50px;
            position: relative;
            margin: 20px 0;
        }

        .number-line-line {
            position: absolute;
            top: 50%;
            left: 5%;
            right: 5%;
            height: 3px;
            background: var(--text-secondary);
            transform: translateY(-50%);
        }

        .number-line-tick {
            position: absolute;
            top: 30%;
            width: 2px;
            height: 15px;
            background: var(--text-secondary);
        }

        .number-line-label {
            position: absolute;
            top: 60%;
            transform: translateX(-50%);
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .number-line-point {
            position: absolute;
            top: 20%;
            width: 12px;
            height: 12px;
            background: var(--primary-pink);
            border-radius: 50%;
            transform: translateX(-50%);
        }

        /* Feedback Container */
        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: none;
            grid-column: 1 / -1;
        }

        .feedback-correct {
            background: rgba(233, 30, 99, 0.1);
            border-left: 5px solid var(--primary-pink);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-pink);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-pink);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            grid-column: 1 / -1;
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-pink), var(--secondary-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-pink), var(--secondary-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-pink);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes fractionHighlight {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .fraction-highlight {
            animation: fractionHighlight 0.5s ease;
        }
        
        @keyframes fractionBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .fraction-bounce {
            animation: fractionBounce 0.5s ease;
        }
    </style>
</head>
<body>
    <!-- Background Slideshow -->
    <div class="slideshow" id="slideshow">
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1554224155-6726b3ff858f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1589256469067-ea99122bbdc4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1532094349884-543bc11b234d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 5 Mathematics</h1>
            <p class="welcome-subtitle">Master fractions! Learn about equivalent fractions, simplifying, comparing, and ordering fractions. Understand numerators, denominators, and how fractions represent parts of a whole. Build a solid foundation for all future math concepts!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">½</span>
                <span class="topic-name">Fractions Mastery (Equivalent, Simplifying, Comparing)</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Fractions Adventure</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 110</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1%"></div>
                </div>
            </div>

            <div class="question-content">
                <!-- Left Column: Question and Options -->
                <div class="question-section">
                    <h2 class="question-text" id="questionText"></h2>
                    <div id="fractionDisplay"></div>
                    <div class="options-container" id="optionsContainer"></div>
                </div>
                
                <!-- Right Column: Examples and Process -->
                <div class="example-section">
                    <h3 class="example-title">Examples & Process</h3>
                    <div id="mathFact" class="math-fact"></div>
                    <div id="visualDisplay" class="example-display"></div>
                    <div id="processDisplay" class="process-display"></div>
                </div>
                
                <!-- Feedback spans both columns -->
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-message"></div>
                    <div class="feedback-explanation"></div>
                </div>
                
                <!-- Navigation spans both columns -->
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Fractions Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize slideshow
        function initSlideshow() {
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }

        // 110+ Fractions Questions
        const questions = [
            // Understanding Fractions Basics (1-15)
            {
                type: "fraction_basics",
                question: "What does the denominator represent in a fraction?",
                options: ["Total number of equal parts", "Number of parts taken", "The fraction line", "The whole number"],
                answer: "A",
                explanation: "The denominator (bottom number) shows how many equal parts the whole is divided into."
            },
            {
                type: "fraction_basics",
                question: "What does the numerator represent in a fraction?",
                options: ["Number of parts taken", "Total number of equal parts", "The fraction line", "The whole number"],
                answer: "A",
                explanation: "The numerator (top number) shows how many parts are being considered."
            },
            {
                type: "fraction_basics",
                question: "In the fraction 3/5, what does the 5 represent?",
                options: ["The whole is divided into 5 equal parts", "3 parts are taken", "The fraction is 5/3", "There are 5 wholes"],
                answer: "A",
                explanation: "The denominator 5 means the whole is divided into 5 equal parts."
            },
            {
                type: "fraction_basics",
                question: "In the fraction 2/7, what does the 2 represent?",
                options: ["2 parts are taken", "The whole is divided into 7 parts", "There are 2 wholes", "The fraction is 7/2"],
                answer: "A",
                explanation: "The numerator 2 means 2 of the 7 equal parts are being considered."
            },
            {
                type: "fraction_basics",
                question: "Which fraction represents one whole?",
                options: ["4/4", "1/4", "4/1", "0/4"],
                answer: "A",
                explanation: "4/4 means all 4 parts of the whole are taken, which equals one whole."
            },
            {
                type: "fraction_basics",
                question: "What fraction of the shape is shaded if 3 out of 8 equal parts are shaded?",
                options: ["3/8", "8/3", "5/8", "3/5"],
                answer: "A",
                explanation: "3 shaded parts out of 8 total parts = 3/8."
            },
            {
                type: "fraction_basics",
                question: "If a pizza is cut into 6 equal slices and you eat 2 slices, what fraction did you eat?",
                options: ["2/6", "4/6", "6/2", "2/4"],
                answer: "A",
                explanation: "2 slices eaten out of 6 total slices = 2/6."
            },
            {
                type: "fraction_basics",
                question: "Which fraction represents zero?",
                options: ["0/5", "5/0", "5/5", "1/5"],
                answer: "A",
                explanation: "0/5 means 0 parts taken out of 5, which equals 0."
            },
            {
                type: "fraction_basics",
                question: "What is the fraction for 5 out of 9 equal parts?",
                options: ["5/9", "9/5", "4/9", "5/4"],
                answer: "A",
                explanation: "5 parts out of 9 total = 5/9."
            },
            {
                type: "fraction_basics",
                question: "Which is a proper fraction?",
                options: ["3/4", "5/3", "4/4", "3/2"],
                answer: "A",
                explanation: "A proper fraction has numerator smaller than denominator (3 < 4)."
            },
            // Equivalent Fractions (16-45)
            {
                type: "equivalent_fractions",
                question: "What fraction is equivalent to 1/2?",
                options: ["2/4", "1/4", "2/1", "3/4"],
                answer: "A",
                explanation: "1/2 = 2/4 because if you multiply numerator and denominator by 2, you get 2/4."
            },
            {
                type: "equivalent_fractions",
                question: "Which fraction is equivalent to 2/3?",
                options: ["4/6", "3/2", "2/6", "1/3"],
                answer: "A",
                explanation: "2/3 = 4/6 (multiply numerator and denominator by 2)."
            },
            {
                type: "equivalent_fractions",
                question: "Find a fraction equivalent to 3/4 with denominator 12.",
                options: ["9/12", "3/12", "4/12", "12/9"],
                answer: "A",
                explanation: "3/4 = 9/12 (multiply numerator and denominator by 3)."
            },
            {
                type: "equivalent_fractions",
                question: "What is equivalent to 5/10?",
                options: ["1/2", "5/5", "10/5", "2/5"],
                answer: "A",
                explanation: "5/10 simplifies to 1/2 (divide numerator and denominator by 5)."
            },
            {
                type: "equivalent_fractions",
                question: "Which is equivalent to 6/8?",
                options: ["3/4", "2/4", "6/4", "8/6"],
                answer: "A",
                explanation: "6/8 = 3/4 (divide numerator and denominator by 2)."
            },
            {
                type: "equivalent_fractions",
                question: "Find equivalent fraction to 2/5 with denominator 15.",
                options: ["6/15", "2/15", "5/15", "15/6"],
                answer: "A",
                explanation: "2/5 = 6/15 (multiply numerator and denominator by 3)."
            },
            {
                type: "equivalent_fractions",
                question: "What fraction is equivalent to 7/14?",
                options: ["1/2", "7/7", "14/7", "2/1"],
                answer: "A",
                explanation: "7/14 = 1/2 (divide numerator and denominator by 7)."
            },
            {
                type: "equivalent_fractions",
                question: "Which is equivalent to 9/12?",
                options: ["3/4", "9/4", "12/9", "4/3"],
                answer: "A",
                explanation: "9/12 = 3/4 (divide numerator and denominator by 3)."
            },
            {
                type: "equivalent_fractions",
                question: "Find equivalent to 4/6 with denominator 18.",
                options: ["12/18", "4/18", "6/18", "18/12"],
                answer: "A",
                explanation: "4/6 = 12/18 (multiply numerator and denominator by 3)."
            },
            {
                type: "equivalent_fractions",
                question: "What is equivalent to 8/10?",
                options: ["4/5", "2/5", "8/5", "10/8"],
                answer: "A",
                explanation: "8/10 = 4/5 (divide numerator and denominator by 2)."
            },
            {
                type: "equivalent_fractions",
                question: "Which fraction is NOT equivalent to 1/3?",
                options: ["3/6", "2/6", "4/12", "5/15"],
                answer: "A",
                explanation: "3/6 = 1/2, not 1/3. 2/6, 4/12, and 5/15 all equal 1/3."
            },
            {
                type: "equivalent_fractions",
                question: "Find the missing number: 3/5 = ?/20",
                options: ["12", "4", "15", "8"],
                answer: "A",
                explanation: "3/5 = 12/20 (multiply numerator and denominator by 4: 3×4=12, 5×4=20)."
            },
            {
                type: "equivalent_fractions",
                question: "Complete: 2/7 = 8/?",
                options: ["28", "14", "56", "16"],
                answer: "A",
                explanation: "2/7 = 8/28 (multiply numerator and denominator by 4: 2×4=8, 7×4=28)."
            },
            {
                type: "equivalent_fractions",
                question: "What is the missing number: 5/8 = 15/?",
                options: ["24", "40", "16", "32"],
                answer: "A",
                explanation: "5/8 = 15/24 (multiply numerator and denominator by 3: 5×3=15, 8×3=24)."
            },
            {
                type: "equivalent_fractions",
                question: "Complete: 7/9 = ?/27",
                options: ["21", "18", "24", "63"],
                answer: "A",
                explanation: "7/9 = 21/27 (multiply numerator and denominator by 3: 7×3=21, 9×3=27)."
            },
            // Simplifying Fractions (46-75)
            {
                type: "simplifying_fractions",
                question: "Simplify 4/8 to lowest terms.",
                options: ["1/2", "2/4", "4/4", "8/4"],
                answer: "A",
                explanation: "4/8 = 1/2 (divide numerator and denominator by 4)."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 6/9.",
                options: ["2/3", "3/4", "6/6", "9/6"],
                answer: "A",
                explanation: "6/9 = 2/3 (divide numerator and denominator by 3)."
            },
            {
                type: "simplifying_fractions",
                question: "Reduce 10/15 to simplest form.",
                options: ["2/3", "5/3", "10/10", "3/2"],
                answer: "A",
                explanation: "10/15 = 2/3 (divide numerator and denominator by 5)."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 12/16.",
                options: ["3/4", "6/8", "12/12", "4/3"],
                answer: "A",
                explanation: "12/16 = 3/4 (divide numerator and denominator by 4)."
            },
            {
                type: "simplifying_fractions",
                question: "Reduce 18/24 to lowest terms.",
                options: ["3/4", "6/8", "9/12", "18/18"],
                answer: "A",
                explanation: "18/24 = 3/4 (divide numerator and denominator by 6)."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 20/25.",
                options: ["4/5", "5/4", "10/12", "20/20"],
                answer: "A",
                explanation: "20/25 = 4/5 (divide numerator and denominator by 5)."
            },
            {
                type: "simplifying_fractions",
                question: "Reduce 14/21.",
                options: ["2/3", "7/3", "14/14", "3/2"],
                answer: "A",
                explanation: "14/21 = 2/3 (divide numerator and denominator by 7)."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 16/20.",
                options: ["4/5", "8/10", "16/16", "5/4"],
                answer: "A",
                explanation: "16/20 = 4/5 (divide numerator and denominator by 4)."
            },
            {
                type: "simplifying_fractions",
                question: "Reduce 24/30.",
                options: ["4/5", "6/7", "12/15", "24/24"],
                answer: "A",
                explanation: "24/30 = 4/5 (divide numerator and denominator by 6)."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 28/35.",
                options: ["4/5", "7/5", "14/17", "28/28"],
                answer: "A",
                explanation: "28/35 = 4/5 (divide numerator and denominator by 7)."
            },
            {
                type: "simplifying_fractions",
                question: "Reduce 32/40 to simplest form.",
                options: ["4/5", "8/10", "16/20", "32/32"],
                answer: "A",
                explanation: "32/40 = 4/5 (divide numerator and denominator by 8)."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 36/48.",
                options: ["3/4", "6/8", "9/12", "36/36"],
                answer: "A",
                explanation: "36/48 = 3/4 (divide numerator and denominator by 12)."
            },
            {
                type: "simplifying_fractions",
                question: "Reduce 45/60.",
                options: ["3/4", "5/6", "9/12", "15/20"],
                answer: "A",
                explanation: "45/60 = 3/4 (divide numerator and denominator by 15)."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 50/75.",
                options: ["2/3", "5/7", "10/15", "25/25"],
                answer: "A",
                explanation: "50/75 = 2/3 (divide numerator and denominator by 25)."
            },
            {
                type: "simplifying_fractions",
                question: "Reduce 64/80.",
                options: ["4/5", "8/10", "16/20", "32/40"],
                answer: "A",
                explanation: "64/80 = 4/5 (divide numerator and denominator by 16)."
            },
            // Comparing Fractions (76-105)
            {
                type: "comparing_fractions",
                question: "Which is greater: 1/2 or 1/3?",
                options: ["1/2", "1/3", "They are equal", "Cannot compare"],
                answer: "A",
                explanation: "1/2 > 1/3 because when the whole is divided into fewer pieces, each piece is larger."
            },
            {
                type: "comparing_fractions",
                question: "Compare: 2/5 _ 3/5",
                options: ["<", ">", "=", "≠"],
                answer: "A",
                explanation: "2/5 < 3/5 because with same denominator, compare numerators: 2 < 3."
            },
            {
                type: "comparing_fractions",
                question: "Which is smaller: 3/8 or 5/8?",
                options: ["3/8", "5/8", "They are equal", "Cannot tell"],
                answer: "A",
                explanation: "3/8 < 5/8 (same denominator, compare numerators: 3 < 5)."
            },
            {
                type: "comparing_fractions",
                question: "Compare: 1/4 _ 2/8",
                options: ["=", "<", ">", "≠"],
                answer: "A",
                explanation: "1/4 = 2/8 because they are equivalent fractions (2/8 simplifies to 1/4)."
            },
            {
                type: "comparing_fractions",
                question: "Which is greater: 2/3 or 3/4?",
                options: ["3/4", "2/3", "They are equal", "Cannot compare"],
                answer: "A",
                explanation: "2/3 = 8/12, 3/4 = 9/12, so 3/4 > 2/3."
            },
            {
                type: "comparing_fractions",
                question: "Compare: 5/6 _ 7/8",
                options: ["<", ">", "=", "≈"],
                answer: "A",
                explanation: "5/6 = 20/24, 7/8 = 21/24, so 5/6 < 7/8."
            },
            {
                type: "comparing_fractions",
                question: "Which is smaller: 3/7 or 4/9?",
                options: ["4/9", "3/7", "They are equal", "Cannot determine"],
                answer: "A",
                explanation: "3/7 = 27/63, 4/9 = 28/63, so 3/7 < 4/9."
            },
            {
                type: "comparing_fractions",
                question: "Compare: 2/5 _ 3/7",
                options: ["<", ">", "=", "≈"],
                answer: "A",
                explanation: "2/5 = 14/35, 3/7 = 15/35, so 2/5 < 3/7."
            },
            {
                type: "comparing_fractions",
                question: "Which is greater: 5/8 or 7/12?",
                options: ["5/8", "7/12", "They are equal", "Cannot compare"],
                answer: "A",
                explanation: "5/8 = 15/24, 7/12 = 14/24, so 5/8 > 7/12."
            },
            {
                type: "comparing_fractions",
                question: "Compare: 4/9 _ 5/11",
                options: [">", "<", "=", "≠"],
                answer: "A",
                explanation: "4/9 = 44/99, 5/11 = 45/99, so 4/9 < 5/11."
            },
            {
                type: "comparing_fractions",
                question: "Order from least to greatest: 1/2, 2/3, 3/4",
                options: ["1/2, 2/3, 3/4", "3/4, 2/3, 1/2", "2/3, 1/2, 3/4", "1/2, 3/4, 2/3"],
                answer: "A",
                explanation: "1/2 = 6/12, 2/3 = 8/12, 3/4 = 9/12. So: 6/12 < 8/12 < 9/12."
            },
            {
                type: "comparing_fractions",
                question: "Order from greatest to least: 5/6, 3/4, 2/3",
                options: ["5/6, 3/4, 2/3", "2/3, 3/4, 5/6", "3/4, 5/6, 2/3", "5/6, 2/3, 3/4"],
                answer: "A",
                explanation: "5/6 = 20/24, 3/4 = 18/24, 2/3 = 16/24. So: 20/24 > 18/24 > 16/24."
            },
            {
                type: "comparing_fractions",
                question: "Which fraction is between 1/2 and 3/4?",
                options: ["5/8", "1/4", "7/8", "3/8"],
                answer: "A",
                explanation: "1/2 = 4/8, 3/4 = 6/8. 5/8 is between 4/8 and 6/8."
            },
            {
                type: "comparing_fractions",
                question: "Find a fraction between 1/3 and 1/2.",
                options: ["5/12", "1/4", "2/3", "1/6"],
                answer: "A",
                explanation: "1/3 = 4/12, 1/2 = 6/12. 5/12 is between 4/12 and 6/12."
            },
            // Mixed and Word Problems (106-115)
            {
                type: "mixed_fractions",
                question: "John ate 3/8 of a pizza and Mary ate 1/4. Who ate more?",
                options: ["John", "Mary", "They ate equal amounts", "Cannot tell"],
                answer: "A",
                explanation: "1/4 = 2/8. 3/8 > 2/8, so John ate more."
            },
            {
                type: "mixed_fractions",
                question: "A recipe needs 3/4 cup of flour. You have 2/3 cup. Do you have enough?",
                options: ["No, need more", "Yes, have enough", "Exactly enough", "Cannot determine"],
                answer: "A",
                explanation: "3/4 = 9/12, 2/3 = 8/12. 8/12 < 9/12, so not enough."
            },
            {
                type: "mixed_fractions",
                question: "Which is the largest: 1/2, 2/5, 3/8?",
                options: ["1/2", "2/5", "3/8", "All equal"],
                answer: "A",
                explanation: "1/2 = 0.5, 2/5 = 0.4, 3/8 = 0.375. 1/2 is largest."
            },
            {
                type: "mixed_fractions",
                question: "Simplify and compare: 6/8 _ 9/12",
                options: ["=", "<", ">", "≠"],
                answer: "A",
                explanation: "6/8 = 3/4, 9/12 = 3/4. They are equal."
            },
            {
                type: "mixed_fractions",
                question: "Which fraction is NOT in simplest form?",
                options: ["4/6", "3/5", "7/8", "5/9"],
                answer: "A",
                explanation: "4/6 simplifies to 2/3. The others are already in simplest form."
            },
            // Additional Questions (116-125)
            {
                type: "equivalent_fractions",
                question: "Find 3 equivalent fractions for 2/3.",
                options: ["4/6, 6/9, 8/12", "2/6, 3/9, 4/12", "1/3, 2/6, 3/9", "3/2, 6/4, 9/6"],
                answer: "A",
                explanation: "Multiply numerator and denominator by same number: ×2=4/6, ×3=6/9, ×4=8/12."
            },
            {
                type: "simplifying_fractions",
                question: "Simplify 100/150 to lowest terms.",
                options: ["2/3", "1/2", "3/5", "10/15"],
                answer: "A",
                explanation: "100/150 = 2/3 (divide numerator and denominator by 50)."
            },
            {
                type: "comparing_fractions",
                question: "Which symbol makes this true: 7/10 _ 3/5?",
                options: [">", "<", "=", "≈"],
                answer: "A",
                explanation: "3/5 = 6/10. 7/10 > 6/10, so 7/10 > 3/5."
            },
            {
                type: "mixed_fractions",
                question: "If 5/6 = ?/24, what is the missing number?",
                options: ["20", "4", "30", "18"],
                answer: "A",
                explanation: "5/6 = 20/24 (multiply numerator and denominator by 4)."
            },
            {
                type: "mixed_fractions",
                question: "Order from least to greatest: 5/12, 1/2, 2/3, 3/4",
                options: ["5/12, 1/2, 2/3, 3/4", "1/2, 2/3, 3/4, 5/12", "3/4, 2/3, 1/2, 5/12", "5/12, 2/3, 1/2, 3/4"],
                answer: "A",
                explanation: "5/12 = 5/12, 1/2 = 6/12, 2/3 = 8/12, 3/4 = 9/12. So: 5/12 < 6/12 < 8/12 < 9/12."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent fraction skills!",
            "Fantastic understanding of equivalent fractions!",
            "Great work! You're a fractions expert!",
            "Amazing! Your simplifying skills are impressive!",
            "Well done! Perfect fraction comparison!",
            "You're a fractions champion!",
            "Perfect! You understand numerators and denominators!",
            "Outstanding mathematical reasoning with fractions!",
            "Brilliant! You handle fractions like a pro!",
            "You're on fire! Great attention to fraction details!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const fractionDisplay = document.getElementById('fractionDisplay');
        const mathFact = document.getElementById('mathFact');
        const visualDisplay = document.getElementById('visualDisplay');
        const processDisplay = document.getElementById('processDisplay');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Helper function to create fraction display
        function createFractionHTML(numerator, denominator) {
            return `
                <div class="fraction fraction-highlight">
                    <div class="numerator">${numerator}</div>
                    <div class="fraction-line"></div>
                    <div class="denominator">${denominator}</div>
                </div>
            `;
        }

        // Helper function to create comparison display
        function createComparisonHTML(frac1, frac2, symbol = "?") {
            const [num1, den1] = frac1.split('/');
            const [num2, den2] = frac2.split('/');
            
            return `
                <div class="fraction-comparison">
                    <div class="fraction fraction-bounce">
                        <div class="numerator">${num1}</div>
                        <div class="fraction-line"></div>
                        <div class="denominator">${den1}</div>
                    </div>
                    <div class="comparison-symbol">${symbol}</div>
                    <div class="fraction fraction-bounce" style="animation-delay: 0.2s;">
                        <div class="numerator">${num2}</div>
                        <div class="fraction-line"></div>
                        <div class="denominator">${den2}</div>
                    </div>
                </div>
            `;
        }

        // Initialize the app
        function initApp() {
            initSlideshow();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade5MathFractions');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade5MathFractions', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade5MathFractions_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade5MathFractions_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a fractions expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent fraction skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing fraction concepts!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review equivalent fractions and simplifying!";
            } else {
                scoreMessage.textContent = "Keep learning! Fractions get easier with practice!";
            }
        }

        // Create math fact display
        function createMathFact() {
            const facts = [
                "The word 'fraction' comes from Latin 'fractus' meaning 'broken'!",
                "Ancient Egyptians used fractions over 4,000 years ago, but only with numerator 1 (like 1/2, 1/3)!",
                "The fraction bar was first used by Arab mathematician Al-Hassār in the 12th century!",
                "The largest numerator and denominator in a simplified fraction is called a 'vulgar fraction'!",
                "In music, fractions are used to represent note durations (½ note, ¼ note, etc.)!",
                "The decimal system is based on fractions with denominators 10, 100, 1000, etc.!",
                "The golden ratio (about 1.618) can be expressed as the continued fraction 1 + 1/(1 + 1/(1 + 1/(1 + ...)))!",
                "Cooking measurements use fractions extensively (¼ cup, ½ teaspoon, etc.)!"
            ];
            
            return `<strong>Math Fact:</strong> ${facts[Math.floor(Math.random() * facts.length)]}`;
        }

        // Create visual display
        function createVisualDisplay() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            let visualHTML = '';
            
            if (question.type.includes("equivalent_fractions") || question.type.includes("simplifying")) {
                // Extract fractions from question
                const text = question.question;
                const fractions = text.match(/\d+\/\d+/g);
                
                if (fractions && fractions.length > 0) {
                    const [num, den] = fractions[0].split('/').map(Number);
                    
                    visualHTML = `
                        <div style="margin-bottom: 10px; color: var(--accent-teal); font-weight: bold;">Fraction Model:</div>
                        <div class="fraction-model">
                            ${Array.from({length: den}, (_, i) => `
                                <div class="fraction-part ${i < num ? 'filled' : 'empty'}">
                                    ${i < num ? '✓' : ''}
                                </div>
                            `).join('')}
                        </div>
                        <div style="margin-top: 10px; color: var(--text-secondary); font-size: 0.9rem;">
                            ${num} out of ${den} parts are filled (${fractions[0]})
                        </div>
                    `;
                }
            } else if (question.type.includes("comparing")) {
                visualHTML = `
                    <div style="margin-bottom: 10px; color: var(--accent-green); font-weight: bold;">Number Line:</div>
                    <div class="number-line">
                        <div class="number-line-line"></div>
                        <div class="number-line-tick" style="left: 5%;"></div>
                        <div class="number-line-label" style="left: 5%;">0</div>
                        <div class="number-line-tick" style="left: 30%;"></div>
                        <div class="number-line-label" style="left: 30%;">¼</div>
                        <div class="number-line-tick" style="left: 50%;"></div>
                        <div class="number-line-label" style="left: 50%;">½</div>
                        <div class="number-line-tick" style="left: 70%;"></div>
                        <div class="number-line-label" style="left: 70%;">¾</div>
                        <div class="number-line-tick" style="left: 95%;"></div>
                        <div class="number-line-label" style="left: 95%;">1</div>
                    </div>
                    <div style="margin-top: 10px; color: var(--text-secondary); font-size: 0.9rem;">
                        Use the number line to compare fraction values!
                    </div>
                `;
            }
            
            return visualHTML;
        }

        // Create process display
        function createProcessDisplay() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            let processHTML = '';
            
            if (question.type.includes("equivalent_fractions")) {
                processHTML = `
                    <div class="process-step">
                        <div class="step-icon">1️⃣</div>
                        <div class="step-content">
                            <h4>Find Common Factor</h4>
                            <p>Look for a number that divides both numerator and denominator</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">2️⃣</div>
                        <div class="step-content">
                            <h4>Multiply or Divide</h4>
                            <p>Multiply/divide both numerator and denominator by the same number</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">3️⃣</div>
                        <div class="step-content">
                            <h4>Check Equivalence</h4>
                            <p>The new fraction should have the same value as the original</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">✅</div>
                        <div class="step-content">
                            <h4>Verify</h4>
                            <p>Cross-multiply to check if fractions are equivalent</p>
                        </div>
                    </div>
                `;
            } else if (question.type.includes("simplifying")) {
                processHTML = `
                    <div class="process-step">
                        <div class="step-icon">1️⃣</div>
                        <div class="step-content">
                            <h4>Find Greatest Common Factor</h4>
                            <p>Find the largest number that divides both numerator and denominator</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">2️⃣</div>
                        <div class="step-content">
                            <h4>Divide Both Parts</h4>
                            <p>Divide numerator and denominator by the GCF</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">3️⃣</div>
                        <div class="step-content">
                            <h4>Check Simplicity</h4>
                            <p>Ensure no number (except 1) divides both parts</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">✅</div>
                        <div class="step-content">
                            <h4>Verify</h4>
                            <p>The simplified fraction should be in lowest terms</p>
                        </div>
                    </div>
                `;
            } else if (question.type.includes("comparing")) {
                processHTML = `
                    <div class="process-step">
                        <div class="step-icon">1️⃣</div>
                        <div class="step-content">
                            <h4>Find Common Denominator</h4>
                            <p>Find a common denominator for both fractions</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">2️⃣</div>
                        <div class="step-content">
                            <h4>Convert Fractions</h4>
                            <p>Rewrite both fractions with the common denominator</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">3️⃣</div>
                        <div class="step-content">
                            <h4>Compare Numerators</h4>
                            <p>With same denominator, compare the numerators</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">✅</div>
                        <div class="step-content">
                            <h4>Determine Relationship</h4>
                            <p>Larger numerator means larger fraction</p>
                        </div>
                    </div>
                `;
            } else {
                processHTML = `
                    <div class="process-step">
                        <div class="step-icon">🔍</div>
                        <div class="step-content">
                            <h4>Understand the Fraction</h4>
                            <p>Numerator = parts taken, Denominator = total parts</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">📝</div>
                        <div class="step-content">
                            <h4>Identify What's Asked</h4>
                            <p>Is it equivalence, simplification, or comparison?</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">🧮</div>
                        <div class="step-content">
                            <h4>Apply Rules</h4>
                            <p>Use appropriate method for the fraction operation</p>
                        </div>
                    </div>
                    <div class="process-step">
                        <div class="step-icon">✓</div>
                        <div class="step-content">
                            <h4>Check Your Work</h4>
                            <p>Verify answer makes sense in context</p>
                        </div>
                    </div>
                `;
            }
            
            return processHTML;
        }

        // Create fraction display based on question
        function createFractionDisplay() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            let displayHTML = '';
            
            // Extract fractions from question text
            const text = question.question;
            const fractions = text.match(/\d+\/\d+/g);
            
            if (fractions && fractions.length === 1) {
                // Single fraction
                const [num, den] = fractions[0].split('/');
                displayHTML = createFractionHTML(num, den);
            } else if (fractions && fractions.length === 2) {
                // Comparison
                displayHTML = createComparisonHTML(fractions[0], fractions[1]);
            } else if (question.type.includes("equivalent_fractions") && text.includes("=")) {
                // Equivalent fraction with equals
                const match = text.match(/(\d+\/\d+)\s*=\s*(\d+\/\d+|\?\/\d+|\d+\/\?)/);
                if (match) {
                    const [_, frac1, frac2] = match;
                    if (frac2.includes('?')) {
                        displayHTML = createFractionHTML(frac1.split('/')[0], frac1.split('/')[1]);
                    } else {
                        displayHTML = createComparisonHTML(frac1, frac2, "=");
                    }
                }
            }
            
            return displayHTML;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            // Update displays
            fractionDisplay.innerHTML = createFractionDisplay();
            mathFact.innerHTML = createMathFact();
            visualDisplay.innerHTML = createVisualDisplay();
            processDisplay.innerHTML = createProcessDisplay();
            
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            // Create answer options
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '✓';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '✗';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
