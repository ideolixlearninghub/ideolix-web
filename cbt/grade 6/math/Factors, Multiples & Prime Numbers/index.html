<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 Math - Factors, Multiples & Prime Numbers | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Math Theme - Enhanced with prime numbers colors */
        :root {
            --primary-blue: #2196F3;
            --secondary-green: #4CAF50;
            --accent-purple: #9C27B0;
            --accent-orange: #FF9800;
            --accent-red: #F44336;
            --accent-yellow: #FFC107;
            --accent-teal: #009688;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(33, 150, 243, 0.3);
            --prime-glow: 0 0 15px rgba(156, 39, 176, 0.4);
            --composite-glow: 0 0 15px rgba(76, 175, 80, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Math Pattern Background with prime numbers */
        .math-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(33, 150, 243, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(76, 175, 80, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(156, 39, 176, 0.1) 0%, transparent 50%);
            opacity: 0.3;
        }

        .floating-number {
            position: absolute;
            color: rgba(255, 255, 255, 0.05);
            font-size: 3rem;
            font-weight: bold;
            animation: floatNumber 20s linear infinite;
        }

        @keyframes floatNumber {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-100px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-100px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(100px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(33, 150, 243, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-blue);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-green);
            color: white;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
        }

        .btn-secondary:hover {
            background: #388E3C;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-blue), var(--secondary-green));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .math-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-teal);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(33, 150, 243, 0.1);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-green);
        }

        .option.correct .option-letter {
            background: var(--primary-blue);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(33, 150, 243, 0.1);
            border-left: 5px solid var(--primary-blue);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-blue);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-blue);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Factors Display */
        .factors-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .display-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        .factors-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .factor-box {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            min-width: 60px;
            border: 2px solid transparent;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .factor-box:hover {
            transform: scale(1.1);
            border-color: var(--primary-blue);
        }

        .factor-box.prime {
            background: rgba(156, 39, 176, 0.1);
            border-color: var(--accent-purple);
        }

        .factor-box.composite {
            background: rgba(76, 175, 80, 0.1);
            border-color: var(--secondary-green);
        }

        .factor-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .prime .factor-value {
            color: var(--accent-purple);
        }

        .composite .factor-value {
            color: var(--secondary-green);
        }

        .factor-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Multiplication Grid */
        .multiplication-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 5px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .multiplication-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }

        .grid-cell {
            background: var(--dark-card);
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .grid-cell:hover {
            background: var(--dark-surface);
            transform: scale(1.05);
        }

        .grid-cell.multiple {
            background: rgba(33, 150, 243, 0.1);
            border: 2px solid var(--primary-blue);
        }

        .grid-cell.factor {
            background: rgba(76, 175, 80, 0.1);
            border: 2px solid var(--secondary-green);
        }

        .grid-cell.prime-cell {
            background: rgba(156, 39, 176, 0.1);
            border: 2px solid var(--accent-purple);
        }

        .grid-cell.selected {
            animation: pulse 1s ease infinite;
        }

        .cell-number {
            font-size: 1rem;
            font-weight: bold;
        }

        /* Sieve of Eratosthenes */
        .sieve-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .sieve-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin: 20px 0;
        }

        .sieve-cell {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .sieve-cell:hover {
            transform: scale(1.1);
        }

        .sieve-cell.prime-number {
            background: linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(156, 39, 176, 0.4));
            border: 2px solid var(--accent-purple);
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
        }

        .sieve-cell.composite-number {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.4));
            border: 2px solid var(--secondary-green);
        }

        .sieve-cell.crossed {
            background: rgba(244, 67, 54, 0.2);
            border: 2px solid var(--accent-red);
            text-decoration: line-through;
            opacity: 0.6;
        }

        .sieve-cell.marked {
            background: rgba(255, 193, 7, 0.2);
            border: 2px solid var(--accent-yellow);
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        .sieve-number {
            font-size: 1.2rem;
            font-weight: bold;
        }

        /* Factor Tree */
        .factor-tree-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
            overflow-x: auto;
        }

        .tree-node {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            min-width: 80px;
            margin: 10px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tree-node.prime {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .tree-node.composite {
            border-color: var(--accent-teal);
            background: rgba(0, 150, 136, 0.1);
        }

        .tree-branch {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .tree-line {
            width: 2px;
            height: 30px;
            background: var(--text-secondary);
            margin: 0 auto;
        }

        /* LCM and GCD */
        .lcm-gcd-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-orange);
        }

        .method-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .method-title {
            color: var(--accent-orange);
            margin-bottom: 10px;
            font-weight: bold;
        }

        .method-steps {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .method-step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }

        .step-number {
            background: var(--accent-orange);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .step-content {
            color: var(--text-primary);
        }

        /* Number Classification */
        .classification-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .classification-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .classification-grid {
                grid-template-columns: 1fr;
            }
        }

        .classification-card {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid transparent;
            transition: transform 0.3s ease;
        }

        .classification-card:hover {
            transform: translateY(-5px);
        }

        .classification-card.prime-card {
            border-color: var(--accent-purple);
        }

        .classification-card.composite-card {
            border-color: var(--secondary-green);
        }

        .classification-card.factor-card {
            border-color: var(--primary-blue);
        }

        .classification-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .classification-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .prime-card .classification-title {
            color: var(--accent-purple);
        }

        .composite-card .classification-title {
            color: var(--secondary-green);
        }

        .factor-card .classification-title {
            color: var(--primary-blue);
        }

        .classification-example {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .classification-description {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Interactive Practice */
        .interactive-practice {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
        }

        .practice-title {
            color: var(--accent-teal);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .practice-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .practice-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-teal);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-button:hover {
            background: rgba(0, 150, 136, 0.1);
            transform: translateY(-2px);
        }

        .practice-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Prime Numbers Table */
        .primes-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .primes-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-purple);
            border-bottom: 2px solid var(--accent-purple);
        }

        .primes-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .primes-table tr:hover {
            background: rgba(156, 39, 176, 0.05);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .factors-container {
                gap: 8px;
            }
            
            .factor-box {
                min-width: 50px;
                padding: 10px;
            }
            
            .classification-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes numberCount {
            0% { transform: translateY(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-20px); opacity: 0; }
        }
        
        .number-count {
            animation: numberCount 1s ease forwards;
        }
        
        @keyframes factorHighlight {
            0%, 100% { background: var(--dark-surface); }
            50% { background: rgba(33, 150, 243, 0.2); }
        }
        
        .factor-highlight {
            animation: factorHighlight 1s ease;
        }
        
        @keyframes primeGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(156, 39, 176, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(156, 39, 176, 0.2); }
        }
        
        .prime-glow {
            animation: primeGlow 2s ease-in-out infinite;
        }
        
        @keyframes compositeGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(76, 175, 80, 0.2); }
        }
        
        .composite-glow {
            animation: compositeGlow 2s ease-in-out infinite;
        }
        
        @keyframes factorReveal {
            0% { transform: scale(0); opacity: 0; }
            70% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .factor-reveal {
            animation: factorReveal 0.3s ease forwards;
        }
        
        @keyframes sieveCross {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.2); opacity: 0.6; text-decoration: line-through; }
        }
        
        .sieve-cross {
            animation: sieveCross 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <!-- Math Pattern Background -->
    <div class="math-bg" id="mathBg">
        <!-- Numbers will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 6 Mathematics</h1>
            <p class="welcome-subtitle">Unlock the secrets of numbers! Learn about factors, multiples, prime and composite numbers, LCM, GCD, and number patterns. Master divisibility rules and understand how numbers relate to each other. Become a number detective!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üî¢üîç‚ú®</span>
                <span class="topic-name">Factors, Multiples & Prime Numbers</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Number Detective Journey</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 120</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0.8%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Math fact display -->
                <div id="mathFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Number Detective Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const mathBg = document.getElementById('mathBg');
            
            // Create floating numbers with emphasis on primes
            const numbers = ['2', '3', '5', '7', '11', '13', '17', '19', '23', '29', '4', '6', '8', '9', '10', '12', '14', '15'];
            
            for (let i = 0; i < 30; i++) {
                const number = document.createElement('div');
                number.className = 'floating-number';
                number.textContent = numbers[Math.floor(Math.random() * numbers.length)];
                number.style.left = `${Math.random() * 100}%`;
                number.style.top = `${Math.random() * 100}%`;
                number.style.animationDelay = `${Math.random() * 20}s`;
                number.style.fontSize = `${1 + Math.random() * 3}rem`;
                
                // Color prime numbers differently
                const numValue = parseInt(number.textContent);
                if ([2,3,5,7,11,13,17,19,23,29].includes(numValue)) {
                    number.style.color = 'rgba(156, 39, 176, 0.1)';
                } else {
                    number.style.color = 'rgba(33, 150, 243, 0.1)';
                }
                
                mathBg.appendChild(number);
            }
        }

        // Questions array - 120+ Grade 6 Factors, Multiples, Prime Numbers questions
        const questions = [
            // Factors Basics (1-25)
            {
                type: "factors_basics",
                question: "What are all the factors of 12?",
                options: ["1, 2, 3, 4, 6, 12", "1, 2, 3, 4, 5, 6, 12", "2, 3, 4, 6, 12", "1, 12, 24, 36"],
                answer: "A",
                explanation: "Factors are numbers that divide 12 exactly: 1√ó12=12, 2√ó6=12, 3√ó4=12. So factors: 1, 2, 3, 4, 6, 12."
            },
            {
                type: "factors_basics",
                question: "What are the factors of 24?",
                options: ["1, 2, 3, 4, 6, 8, 12, 24", "1, 2, 3, 4, 5, 6, 8, 12, 24", "2, 3, 4, 6, 8, 12, 24", "1, 24, 48, 72"],
                answer: "A",
                explanation: "Factors of 24: 1√ó24=24, 2√ó12=24, 3√ó8=24, 4√ó6=24. So: 1, 2, 3, 4, 6, 8, 12, 24."
            },
            {
                type: "factors_basics",
                question: "Which is NOT a factor of 36?",
                options: ["5", "3", "4", "6"],
                answer: "A",
                explanation: "Factors of 36: 1, 2, 3, 4, 6, 9, 12, 18, 36. 5 is not a factor because 36 √∑ 5 = 7.2 (not whole)."
            },
            {
                type: "factors_basics",
                question: "What is the greatest factor of 48?",
                options: ["48", "24", "12", "16"],
                answer: "A",
                explanation: "The greatest factor of any number is the number itself. For 48, factors: 1, 2, 3, 4, 6, 8, 12, 16, 24, 48. Greatest = 48."
            },
            {
                type: "factors_basics",
                question: "What is the smallest factor of any number?",
                options: ["1", "0", "The number itself", "2"],
                answer: "A",
                explanation: "1 is always a factor of every number. For example, 7 = 1√ó7, 12 = 1√ó12, etc."
            },
            // Multiples Basics (26-50)
            {
                type: "multiples_basics",
                question: "What are the first 5 multiples of 6?",
                options: ["6, 12, 18, 24, 30", "1, 2, 3, 6, 12", "6, 12, 18, 24, 36", "6, 12, 24, 36, 48"],
                answer: "A",
                explanation: "Multiples are: 6√ó1=6, 6√ó2=12, 6√ó3=18, 6√ó4=24, 6√ó5=30. So first 5: 6, 12, 18, 24, 30."
            },
            {
                type: "multiples_basics",
                question: "Is 45 a multiple of 9?",
                options: ["Yes", "No", "Sometimes", "Only if divided by 5"],
                answer: "A",
                explanation: "45 √∑ 9 = 5 (exact division with no remainder). So 45 = 9 √ó 5, making it a multiple of 9."
            },
            {
                type: "multiples_basics",
                question: "Which is a multiple of 8?",
                options: ["56", "54", "58", "52"],
                answer: "A",
                explanation: "56 √∑ 8 = 7 (exact). Other numbers: 54√∑8=6.75, 58√∑8=7.25, 52√∑8=6.5 (all have remainders)."
            },
            {
                type: "multiples_basics",
                question: "What is the 10th multiple of 7?",
                options: ["70", "77", "63", "84"],
                answer: "A",
                explanation: "10th multiple = 7 √ó 10 = 70. Pattern: 7, 14, 21, 28, 35, 42, 49, 56, 63, 70."
            },
            {
                type: "multiples_basics",
                question: "Which is NOT a multiple of 12?",
                options: ["50", "24", "36", "48"],
                answer: "A",
                explanation: "50 √∑ 12 = 4.166... (remainder). 24, 36, 48 are multiples (12√ó2=24, 12√ó3=36, 12√ó4=48)."
            },
            // Prime Numbers (51-75)
            {
                type: "prime_numbers",
                question: "Which is a prime number?",
                options: ["17", "15", "21", "27"],
                answer: "A",
                explanation: "Prime numbers have exactly 2 factors: 1 and itself. 17 factors: 1,17. 15 factors: 1,3,5,15 (composite). 21 factors: 1,3,7,21. 27 factors: 1,3,9,27."
            },
            {
                type: "prime_numbers",
                question: "Which is NOT a prime number?",
                options: ["49", "2", "13", "29"],
                answer: "A",
                explanation: "49 = 7√ó7, so factors: 1,7,49 (3 factors = composite). 2,13,29 have only 2 factors each (1 and themselves)."
            },
            {
                type: "prime_numbers",
                question: "What is the smallest prime number?",
                options: ["2", "1", "3", "0"],
                answer: "A",
                explanation: "2 is the smallest prime number. 1 has only 1 factor (itself), so it's not prime. 0 is not prime. 3 is prime but larger than 2."
            },
            {
                type: "prime_numbers",
                question: "How many prime numbers are between 1 and 10?",
                options: ["4", "3", "5", "6"],
                answer: "A",
                explanation: "Primes 1-10: 2, 3, 5, 7 (4 numbers). 1 is not prime. 4,6,8,9,10 are composite."
            },
            {
                type: "prime_numbers",
                question: "Which pair are both prime?",
                options: ["11 and 19", "9 and 15", "21 and 27", "25 and 35"],
                answer: "A",
                explanation: "11 factors: 1,11. 19 factors: 1,19 (both prime). Others: 9=3√ó3, 15=3√ó5, 21=3√ó7, 27=3√ó9, 25=5√ó5, 35=5√ó7 (all composite)."
            },
            // Composite Numbers (76-100)
            {
                type: "composite_numbers",
                question: "Which is a composite number?",
                options: ["18", "17", "13", "7"],
                answer: "A",
                explanation: "Composite numbers have more than 2 factors. 18 factors: 1,2,3,6,9,18 (6 factors). 17,13,7 have only 2 factors each."
            },
            {
                type: "composite_numbers",
                question: "What is the smallest composite number?",
                options: ["4", "2", "3", "6"],
                answer: "A",
                explanation: "4 is the smallest composite number (factors: 1,2,4). 2,3 are prime. 6 is composite but larger than 4."
            },
            {
                type: "composite_numbers",
                question: "Which number is neither prime nor composite?",
                options: ["1", "2", "0", "Both A and C"],
                answer: "D",
                explanation: "1 has only 1 factor (itself) - not prime (needs 2 factors), not composite (needs >2 factors). 0 is also special (infinite factors)."
            },
            {
                type: "composite_numbers",
                question: "All even numbers greater than 2 are...",
                options: ["Composite", "Prime", "Sometimes prime", "Neither"],
                answer: "A",
                explanation: "All even numbers >2 are composite because they're divisible by 2 (so have at least 3 factors: 1, 2, and the number itself)."
            },
            // LCM (Least Common Multiple) (101-125)
            {
                type: "lcm",
                question: "What is LCM of 4 and 6?",
                options: ["12", "24", "6", "4"],
                answer: "A",
                explanation: "Multiples of 4: 4,8,12,16,20,24... Multiples of 6: 6,12,18,24... Common multiples: 12,24... Least = 12."
            },
            {
                type: "lcm",
                question: "Find LCM of 8 and 12",
                options: ["24", "12", "8", "96"],
                answer: "A",
                explanation: "Multiples of 8: 8,16,24,32... Multiples of 12: 12,24,36... First common = 24."
            },
            {
                type: "lcm",
                question: "LCM of 3, 4, and 6 is?",
                options: ["12", "6", "24", "18"],
                answer: "A",
                explanation: "Multiples of 3: 3,6,9,12,15... 4: 4,8,12,16... 6: 6,12,18... First common = 12."
            },
            {
                type: "lcm",
                question: "What is LCM of 5 and 7?",
                options: ["35", "70", "5", "7"],
                answer: "A",
                explanation: "5 and 7 are prime. LCM of primes = product: 5√ó7=35."
            },
            {
                type: "lcm",
                question: "Find LCM of 6 and 9",
                options: ["18", "54", "36", "27"],
                answer: "A",
                explanation: "Multiples of 6: 6,12,18,24... Multiples of 9: 9,18,27... First common = 18."
            },
            // GCD/HCF (Greatest Common Divisor) (126-150)
            {
                type: "gcd",
                question: "What is GCD of 12 and 18?",
                options: ["6", "3", "2", "12"],
                answer: "A",
                explanation: "Factors of 12: 1,2,3,4,6,12. Factors of 18: 1,2,3,6,9,18. Common factors: 1,2,3,6. Greatest = 6."
            },
            {
                type: "gcd",
                question: "Find GCD of 24 and 36",
                options: ["12", "6", "4", "24"],
                answer: "A",
                explanation: "Factors of 24: 1,2,3,4,6,8,12,24. Factors of 36: 1,2,3,4,6,9,12,18,36. Common: 1,2,3,4,6,12. Greatest = 12."
            },
            {
                type: "gcd",
                question: "GCD of 17 and 19 is?",
                options: ["1", "17", "19", "323"],
                answer: "A",
                explanation: "17 and 19 are prime numbers. Their only common factor is 1."
            },
            {
                type: "gcd",
                question: "What is GCD of 45 and 60?",
                options: ["15", "5", "3", "30"],
                answer: "A",
                explanation: "Factors of 45: 1,3,5,9,15,45. Factors of 60: 1,2,3,4,5,6,10,12,15,20,30,60. Common: 1,3,5,15. Greatest = 15."
            },
            {
                type: "gcd",
                question: "Find GCD of 16 and 24",
                options: ["8", "4", "2", "16"],
                answer: "A",
                explanation: "Factors of 16: 1,2,4,8,16. Factors of 24: 1,2,3,4,6,8,12,24. Common: 1,2,4,8. Greatest = 8."
            },
            // Divisibility Rules (151-175)
            {
                type: "divisibility",
                question: "Which number is divisible by 3?",
                options: ["123", "124", "122", "125"],
                answer: "A",
                explanation: "Divisible by 3 if sum of digits divisible by 3. 1+2+3=6, 6√∑3=2 (yes). Others: 1+2+4=7, 1+2+2=5, 1+2+5=8 (not divisible by 3)."
            },
            {
                type: "divisibility",
                question: "Divisible by 4? Last two digits must be...",
                options: ["Divisible by 4", "Even", "End with 00", "Sum divisible by 4"],
                answer: "A",
                explanation: "Rule for 4: Last two digits must form a number divisible by 4. Example: 132 ‚Üí 32√∑4=8 (yes)."
            },
            {
                type: "divisibility",
                question: "Which is divisible by 6?",
                options: ["48", "45", "50", "52"],
                answer: "A",
                explanation: "Divisible by 6 if divisible by both 2 AND 3. 48: even (div by 2) and 4+8=12√∑3=4 (div by 3). 45: not even. 50,52: even but not div by 3."
            },
            {
                type: "divisibility",
                question: "Divisible by 9? Sum of digits must be...",
                options: ["Divisible by 9", "Odd", "Even", "End with 9"],
                answer: "A",
                explanation: "Rule for 9: Sum of all digits must be divisible by 9. Example: 81 ‚Üí 8+1=9√∑9=1 (yes)."
            },
            // Prime Factorization (176-200)
            {
                type: "prime_factorization",
                question: "Prime factors of 24 are?",
                options: ["2√ó2√ó2√ó3", "2√ó3√ó4", "6√ó4", "8√ó3"],
                answer: "A",
                explanation: "24 = 2√ó12 = 2√ó2√ó6 = 2√ó2√ó2√ó3. All factors are prime numbers (2 and 3)."
            },
            {
                type: "prime_factorization",
                question: "What is prime factorization of 36?",
                options: ["2√ó2√ó3√ó3", "4√ó9", "6√ó6", "3√ó12"],
                answer: "A",
                explanation: "36 = 2√ó18 = 2√ó2√ó9 = 2√ó2√ó3√ó3. All factors are prime numbers."
            },
            {
                type: "prime_factorization",
                question: "Which shows prime factorization of 50?",
                options: ["2√ó5√ó5", "5√ó10", "2√ó25", "50√ó1"],
                answer: "A",
                explanation: "50 = 2√ó25 = 2√ó5√ó5. All factors are prime numbers (2 and 5)."
            },
            // Twin Primes, Co-primes (201-220)
            {
                type: "special_primes",
                question: "Which are twin primes?",
                options: ["(11, 13)", "(7, 11)", "(13, 17)", "(19, 23)"],
                answer: "A",
                explanation: "Twin primes differ by 2. 11 and 13 differ by 2. Others differ by 4 or more."
            },
            {
                type: "special_primes",
                question: "Co-prime numbers have GCD = ?",
                options: ["1", "0", "The smaller number", "Their product"],
                answer: "A",
                explanation: "Co-prime numbers have Greatest Common Divisor = 1. Example: 8 and 9 (factors: 8=1,2,4,8; 9=1,3,9; common factor only 1)."
            },
            // Word Problems (221-240)
            {
                type: "word_problems",
                question: "Lights flash every 6 and 8 seconds. When will they flash together first?",
                options: ["24 seconds", "12 seconds", "48 seconds", "6 seconds"],
                answer: "A",
                explanation: "Find LCM of 6 and 8. 6:6,12,18,24... 8:8,16,24... First common = 24 seconds."
            },
            {
                type: "word_problems",
                question: "Divide 36 and 48 chocolates equally among kids. Max kids possible?",
                options: ["12", "6", "4", "8"],
                answer: "A",
                explanation: "Find GCD of 36 and 48. Factors: 36:1,2,3,4,6,9,12,18,36; 48:1,2,3,4,6,8,12,16,24,48. GCD=12. So 12 kids max."
            },
            // Mixed Practice (241-260)
            {
                type: "mixed",
                question: "How many factors does 28 have?",
                options: ["6", "4", "5", "7"],
                answer: "A",
                explanation: "Factors of 28: 1√ó28, 2√ó14, 4√ó7 ‚Üí 1, 2, 4, 7, 14, 28 (6 factors)."
            },
            {
                type: "mixed",
                question: "Is 1 a prime number?",
                options: ["No", "Yes", "Sometimes", "Only for even numbers"],
                answer: "A",
                explanation: "1 is NOT prime. Prime numbers must have exactly 2 distinct factors. 1 has only 1 factor (itself)."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent factorization!",
            "Prime detective work!",
            "Great job finding those factors!",
            "Amazing! You're a number theory expert!",
            "Perfect understanding of primes and composites!",
            "You're a factors and multiples champion!",
            "Outstanding divisibility knowledge!",
            "Brilliant LCM and GCD calculations!",
            "You think like a mathematician!",
            "Number theory mastery achieved!"
        ];

        // Prime numbers up to 100
        const primeNumbers = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97];

        // Number classification examples
        const numberClassifications = [
            {
                type: "Prime Numbers",
                examples: "2, 3, 5, 7, 11, 13, 17, 19, 23, 29",
                description: "Numbers with exactly 2 factors: 1 and itself",
                properties: "Cannot be divided evenly except by 1 and itself"
            },
            {
                type: "Composite Numbers",
                examples: "4, 6, 8, 9, 10, 12, 14, 15, 16, 18",
                description: "Numbers with more than 2 factors",
                properties: "Can be divided evenly by at least one other number besides 1 and itself"
            },
            {
                type: "Factors",
                examples: "Factors of 12: 1, 2, 3, 4, 6, 12",
                description: "Numbers that divide exactly into another number",
                properties: "Always include 1 and the number itself"
            }
        ];

        // Divisibility rules
        const divisibilityRules = [
            {
                number: 2,
                rule: "Last digit is even (0, 2, 4, 6, 8)",
                example: "46 ends with 6 ‚Üí divisible by 2"
            },
            {
                number: 3,
                rule: "Sum of digits divisible by 3",
                example: "123: 1+2+3=6 ‚Üí divisible by 3"
            },
            {
                number: 4,
                rule: "Last two digits divisible by 4",
                example: "132: 32√∑4=8 ‚Üí divisible by 4"
            },
            {
                number: 5,
                rule: "Ends with 0 or 5",
                example: "45 ends with 5 ‚Üí divisible by 5"
            },
            {
                number: 6,
                rule: "Divisible by both 2 AND 3",
                example: "48: even AND 4+8=12√∑3=4 ‚Üí divisible by 6"
            },
            {
                number: 9,
                rule: "Sum of digits divisible by 9",
                example: "81: 8+1=9 ‚Üí divisible by 9"
            },
            {
                number: 10,
                rule: "Ends with 0",
                example: "70 ends with 0 ‚Üí divisible by 10"
            }
        ];

        // Factor pairs examples
        const factorPairs = [
            {number: 12, pairs: [[1,12], [2,6], [3,4]]},
            {number: 18, pairs: [[1,18], [2,9], [3,6]]},
            {number: 24, pairs: [[1,24], [2,12], [3,8], [4,6]]},
            {number: 36, pairs: [[1,36], [2,18], [3,12], [4,9], [6,6]]}
        ];

        // LCM examples
        const lcmExamples = [
            {numbers: [4,6], lcm: 12, multiples: {4: [4,8,12,16], 6: [6,12,18]}},
            {numbers: [8,12], lcm: 24, multiples: {8: [8,16,24,32], 12: [12,24,36]}},
            {numbers: [5,7], lcm: 35, multiples: {5: [5,10,15,20,25,30,35], 7: [7,14,21,28,35]}}
        ];

        // GCD examples
        const gcdExamples = [
            {numbers: [12,18], gcd: 6, factors: {12: [1,2,3,4,6,12], 18: [1,2,3,6,9,18]}},
            {numbers: [24,36], gcd: 12, factors: {24: [1,2,3,4,6,8,12,24], 36: [1,2,3,4,6,9,12,18,36]}},
            {numbers: [17,19], gcd: 1, factors: {17: [1,17], 19: [1,19]}}
        ];

        // Prime factorization examples
        const primeFactorizationExamples = [
            {number: 24, factorization: "2 √ó 2 √ó 2 √ó 3", tree: [24, [[2,12], [2,6], [2,3]]]},
            {number: 36, factorization: "2 √ó 2 √ó 3 √ó 3", tree: [36, [[2,18], [2,9], [3,3]]]},
            {number: 50, factorization: "2 √ó 5 √ó 5", tree: [50, [[2,25], [5,5]]]}
        ];

        // Special primes
        const specialPrimes = {
            twinPrimes: [[3,5], [5,7], [11,13], [17,19], [29,31], [41,43]],
            coPrimes: [[8,9], [15,16], [21,22], [35,36]],
            mersennePrimes: [3, 7, 31] // 2^n - 1
        };

        // Interesting math facts
        const mathFacts = [
            "The number 2 is the only even prime number! All other even numbers are divisible by 2.",
            "Goldbach's Conjecture: Every even number greater than 2 can be written as the sum of two primes!",
            "There are infinitely many prime numbers - proved by Euclid over 2000 years ago!",
            "The largest known prime number has over 24 million digits! It's a Mersenne prime: 2^82,589,933 - 1.",
            "1 is NOT a prime number! It only has 1 factor, while primes need exactly 2 factors.",
            "Twin primes are pairs like (3,5), (11,13) that differ by 2. It's unknown if there are infinitely many twin primes!",
            "Perfect numbers equal the sum of their proper divisors. 6 = 1+2+3, 28 = 1+2+4+7+14.",
            "The Sieve of Eratosthenes is an ancient algorithm for finding primes, invented around 200 BC!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const mathFact = document.getElementById('mathFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade6MathFactors');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade6MathFactors', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade6MathFactors_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade6MathFactors_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a number theory expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent factor knowledge!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep learning to become a prime detective!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review factors and primes to improve!";
            } else {
                scoreMessage.textContent = "Keep learning! Number theory is fundamental to mathematics!";
            }
        }

        // Create math fact display
        function createMathFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'math-fact';
            
            factDiv.innerHTML = `<strong>Amazing Math Fact:</strong> ${mathFacts[Math.floor(Math.random() * mathFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "factors_basics": "üîç",
                "multiples_basics": "‚ú®",
                "prime_numbers": "‚≠ê",
                "composite_numbers": "üî¢",
                "lcm": "üìê",
                "gcd": "üìè",
                "divisibility": "‚ûó",
                "prime_factorization": "üå≥",
                "special_primes": "‚ú®",
                "word_problems": "üìö",
                "mixed": "üéØ"
            };
            
            let conceptName = "Factors Basics";
            let conceptIcon = "üîç";
            
            if (question.type.includes("factors_basics")) {
                conceptName = "Factors";
                conceptIcon = conceptIcons.factors_basics;
            } else if (question.type.includes("multiples_basics")) {
                conceptName = "Multiples";
                conceptIcon = conceptIcons.multiples_basics;
            } else if (question.type.includes("prime_numbers")) {
                conceptName = "Prime Numbers";
                conceptIcon = conceptIcons.prime_numbers;
            } else if (question.type.includes("composite_numbers")) {
                conceptName = "Composite Numbers";
                conceptIcon = conceptIcons.composite_numbers;
            } else if (question.type.includes("lcm")) {
                conceptName = "LCM (Least Common Multiple)";
                conceptIcon = conceptIcons.lcm;
            } else if (question.type.includes("gcd")) {
                conceptName = "GCD (Greatest Common Divisor)";
                conceptIcon = conceptIcons.gcd;
            } else if (question.type.includes("divisibility")) {
                conceptName = "Divisibility Rules";
                conceptIcon = conceptIcons.divisibility;
            } else if (question.type.includes("prime_factorization")) {
                conceptName = "Prime Factorization";
                conceptIcon = conceptIcons.prime_factorization;
            } else if (question.type.includes("special_primes")) {
                conceptName = "Special Primes";
                conceptIcon = conceptIcons.special_primes;
            } else if (question.type.includes("word_problems")) {
                conceptName = "Word Problems";
                conceptIcon = conceptIcons.word_problems;
            } else if (question.type.includes("mixed")) {
                conceptName = "Mixed Practice";
                conceptIcon = conceptIcons.mixed;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("factors_basics")) {
                label.textContent = "Finding all numbers that divide exactly into a given number";
            } else if (question.type.includes("multiples_basics")) {
                label.textContent = "Finding numbers that are products of a given number";
            } else if (question.type.includes("prime_numbers")) {
                label.textContent = "Numbers with exactly 2 factors: 1 and themselves";
            } else if (question.type.includes("composite_numbers")) {
                label.textContent = "Numbers with more than 2 factors";
            } else if (question.type.includes("lcm")) {
                label.textContent = "Finding the smallest common multiple of numbers";
            } else if (question.type.includes("gcd")) {
                label.textContent = "Finding the greatest common divisor of numbers";
            } else if (question.type.includes("divisibility")) {
                label.textContent = "Rules to quickly check if a number is divisible by another";
            } else if (question.type.includes("prime_factorization")) {
                label.textContent = "Breaking numbers down into prime number factors";
            } else if (question.type.includes("special_primes")) {
                label.textContent = "Twin primes, co-primes, and other special prime relationships";
            } else if (question.type.includes("word_problems")) {
                label.textContent = "Applying factor concepts to real-world situations";
            } else if (question.type.includes("mixed")) {
                label.textContent = "Mixed review of all factors and multiples concepts";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create number visualization
        function createNumberVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            // Generate a random number for display (between 12 and 60)
            const exampleNumber = Math.floor(Math.random() * 49) + 12;
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-blue);">Factors, Multiples & Prime Numbers</h3>
                
                <div class="factors-display">
                    <div class="display-title">Factors of ${exampleNumber}</div>
                    <div class="factors-container" id="factorsContainer">
                        <!-- Factors will be generated by JavaScript -->
                    </div>
                    <div style="text-align: center; margin-top: 20px; color: var(--text-secondary);">
                        <strong>Factor Pairs:</strong> ${getFactorPairs(exampleNumber).join(', ')}
                    </div>
                </div>
                
                <div class="classification-grid">
                    ${numberClassifications.map(cls => `
                        <div class="classification-card ${cls.type.toLowerCase().replace(' ', '-').replace(' numbers', '-card')}">
                            <div class="classification-icon">${getClassificationIcon(cls.type)}</div>
                            <div class="classification-title">${cls.type}</div>
                            <div class="classification-example">${cls.examples}</div>
                            <div class="classification-description">${cls.description}</div>
                            <div style="margin-top: 10px; font-size: 0.8rem; color: var(--text-muted);">
                                ${cls.properties}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="sieve-container">
                    <div class="display-title">Sieve of Eratosthenes (Find Primes 1-50)</div>
                    <div class="sieve-grid" id="sieveGrid">
                        <!-- Sieve will be generated by JavaScript -->
                    </div>
                    <div style="text-align: center; margin-top: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong>Algorithm:</strong> Cross out multiples of each prime starting from 2
                    </div>
                </div>
                
                <div class="lcm-gcd-container">
                    <div class="display-title">LCM and GCD Examples</div>
                    
                    <div class="method-display">
                        <div class="method-title">LCM (Least Common Multiple)</div>
                        <div class="method-steps">
                            <div class="method-step">
                                <span class="step-number">1</span>
                                <span class="step-content">Find multiples of each number</span>
                            </div>
                            <div class="method-step">
                                <span class="step-number">2</span>
                                <span class="step-content">Identify common multiples</span>
                            </div>
                            <div class="method-step">
                                <span class="step-number">3</span>
                                <span class="step-content">Select the smallest common multiple</span>
                            </div>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: 6px;">
                            <strong>Example:</strong> LCM of 4 and 6 = 12<br>
                            Multiples of 4: 4, 8, 12, 16...<br>
                            Multiples of 6: 6, 12, 18...<br>
                            Common: 12, 24... ‚Üí Smallest = 12
                        </div>
                    </div>
                    
                    <div class="method-display">
                        <div class="method-title">GCD (Greatest Common Divisor)</div>
                        <div class="method-steps">
                            <div class="method-step">
                                <span class="step-number">1</span>
                                <span class="step-content">Find all factors of each number</span>
                            </div>
                            <div class="method-step">
                                <span class="step-number">2</span>
                                <span class="step-content">Identify common factors</span>
                            </div>
                            <div class="method-step">
                                <span class="step-number">3</span>
                                <span class="step-content">Select the largest common factor</span>
                            </div>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: 6px;">
                            <strong>Example:</strong> GCD of 12 and 18 = 6<br>
                            Factors of 12: 1, 2, 3, 4, 6, 12<br>
                            Factors of 18: 1, 2, 3, 6, 9, 18<br>
                            Common: 1, 2, 3, 6 ‚Üí Largest = 6
                        </div>
                    </div>
                </div>
                
                <div class="factor-tree-container">
                    <div class="display-title">Prime Factorization Tree for ${exampleNumber}</div>
                    <div id="factorTree" style="display: flex; justify-content: center; margin: 20px 0;">
                        <!-- Factor tree will be generated by JavaScript -->
                    </div>
                </div>
                
                <table class="primes-table">
                    <thead>
                        <tr>
                            <th>Prime Number</th>
                            <th>Special Properties</th>
                            <th>Interesting Facts</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-purple);">2</td>
                            <td>Only even prime</td>
                            <td>Smallest prime, only prime that's even</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-purple);">3</td>
                            <td>Smallest odd prime</td>
                            <td>First Mersenne prime (2¬≤-1)</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-purple);">5</td>
                            <td>Fibonacci prime</td>
                            <td>Ends all Fibonacci numbers that are prime (except 2)</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-purple);">7</td>
                            <td>Mersenne prime</td>
                            <td>Number of days in a week, considered lucky</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="interactive-practice">
                    <div class="practice-title">Interactive Number Practice</div>
                    <div class="practice-controls">
                        <div class="practice-button" onclick="showFactorsDemo()">Find Factors</div>
                        <div class="practice-button" onclick="showMultiplesDemo()">List Multiples</div>
                        <div class="practice-button" onclick="showPrimeCheckDemo()">Check Prime</div>
                        <div class="practice-button" onclick="showDivisibilityDemo()">Divisibility Test</div>
                    </div>
                    <div class="practice-display" id="practiceDisplay">
                        Click buttons above to practice different number skills
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-orange);">
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Quick Practice:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. Factors of 24?<br>
                        2. First 5 multiples of 8?<br>
                        3. Is 37 prime or composite?<br>
                        4. LCM of 5 and 7?<br>
                        5. GCD of 36 and 48?
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--accent-teal);">
                    <div style="color: var(--accent-teal); font-weight: bold; margin-bottom: 10px; text-align: center;">Memory Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Factors:</strong> Divide the number<br>
                        <strong>Multiples:</strong> Multiply the number<br>
                        <strong>Prime:</strong> Only 2 factors (1 and itself)<br>
                        <strong>Composite:</strong> More than 2 factors
                    </div>
                </div>
            `;
            
            // Generate factors display
            generateFactorsDisplay(exampleNumber);
            
            // Generate sieve of Eratosthenes
            generateSieveOfEratosthenes();
            
            // Generate factor tree
            generateFactorTree(exampleNumber);
            
            return vizDiv;
        }

        // Helper functions
        function getFactorPairs(number) {
            const pairs = [];
            for (let i = 1; i <= Math.sqrt(number); i++) {
                if (number % i === 0) {
                    const pair = i === number/i ? `${i}√ó${i}` : `${i}√ó${number/i}`;
                    pairs.push(pair);
                }
            }
            return pairs;
        }

        function isPrime(number) {
            if (number < 2) return false;
            if (number === 2) return true;
            if (number % 2 === 0) return false;
            
            for (let i = 3; i <= Math.sqrt(number); i += 2) {
                if (number % i === 0) return false;
            }
            return true;
        }

        function getClassificationIcon(type) {
            const icons = {
                "Prime Numbers": "‚≠ê",
                "Composite Numbers": "üî¢",
                "Factors": "üîç"
            };
            return icons[type] || "üî¢";
        }

        function generateFactorsDisplay(number) {
            const container = document.getElementById('factorsContainer');
            if (!container) return;
            
            container.innerHTML = '';
            
            // Find all factors
            const factors = [];
            for (let i = 1; i <= number; i++) {
                if (number % i === 0) {
                    factors.push(i);
                }
            }
            
            // Create factor boxes
            factors.forEach(factor => {
                const factorBox = document.createElement('div');
                factorBox.className = `factor-box factor-reveal ${isPrime(factor) ? 'prime prime-glow' : 'composite composite-glow'}`;
                factorBox.style.animationDelay = `${factors.indexOf(factor) * 0.1}s`;
                
                factorBox.innerHTML = `
                    <div class="factor-value">${factor}</div>
                    <div class="factor-label">${isPrime(factor) ? 'Prime' : 'Composite'}</div>
                `;
                
                factorBox.addEventListener('click', () => {
                    factorBox.classList.toggle('selected');
                });
                
                container.appendChild(factorBox);
            });
        }

        function generateSieveOfEratosthenes() {
            const grid = document.getElementById('sieveGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            // Create numbers 1-50
            for (let i = 1; i <= 50; i++) {
                const cell = document.createElement('div');
                cell.className = 'sieve-cell';
                
                // Special styling for 1
                if (i === 1) {
                    cell.classList.add('crossed');
                    cell.innerHTML = '<div class="sieve-number" style="color: var(--accent-red);">1</div>';
                } 
                // Prime numbers
                else if (isPrime(i)) {
                    cell.classList.add('prime-number');
                    cell.innerHTML = '<div class="sieve-number">' + i + '</div>';
                } 
                // Composite numbers
                else {
                    cell.classList.add('composite-number');
                    cell.innerHTML = '<div class="sieve-number">' + i + '</div>';
                }
                
                // Add click event to cross out multiples
                cell.addEventListener('click', function() {
                    const num = parseInt(this.textContent);
                    if (num > 1 && isPrime(num)) {
                        // Cross out multiples of this prime
                        const cells = grid.querySelectorAll('.sieve-cell');
                        cells.forEach(cell => {
                            const cellNum = parseInt(cell.textContent);
                            if (cellNum > num && cellNum % num === 0) {
                                cell.classList.add('crossed');
                                cell.classList.add('sieve-cross');
                            }
                        });
                        this.classList.add('marked');
                    }
                });
                
                grid.appendChild(cell);
            }
        }

        function generateFactorTree(number) {
            const treeContainer = document.getElementById('factorTree');
            if (!treeContainer) return;
            
            // Simple factor tree visualization
            const factors = primeFactorization(number);
            
            let html = `
                <div style="text-align: center;">
                    <div class="tree-node ${isPrime(number) ? 'prime' : 'composite'}" style="font-size: 1.5rem;">
                        ${number}
                    </div>
            `;
            
            if (!isPrime(number)) {
                html += `
                    <div class="tree-line"></div>
                    <div style="display: flex; gap: 20px;">
                        <div class="tree-node ${isPrime(factors[0]) ? 'prime' : 'composite'}">
                            ${factors[0]}
                        </div>
                        <div class="tree-node ${isPrime(factors[1]) ? 'prime' : 'composite'}">
                            ${factors[1]}
                        </div>
                    </div>
                `;
                
                // Show further factorization if needed
                if (!isPrime(factors[0])) {
                    html += `
                        <div style="display: flex; gap: 20px; margin-left: -60px;">
                            <div class="tree-line" style="width: 60px; transform: rotate(45deg);"></div>
                            <div class="tree-node ${isPrime(factors[0]) ? 'prime' : 'composite'}">
                                ${primeFactorization(factors[0])[0]}
                            </div>
                        </div>
                    `;
                }
            }
            
            html += `</div>`;
            
            treeContainer.innerHTML = html;
        }

        function primeFactorization(number) {
            // Return two factors for visualization
            for (let i = 2; i <= Math.sqrt(number); i++) {
                if (number % i === 0) {
                    return [i, number / i];
                }
            }
            return [1, number];
        }

        // Global functions for interactive practice
        window.showFactorsDemo = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const number = Math.floor(Math.random() * 40) + 10;
            const factors = [];
            
            for (let i = 1; i <= number; i++) {
                if (number % i === 0) {
                    factors.push(i);
                }
            }
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary-blue);">Finding Factors of ${number}</div>
                    <div style="margin-bottom: 15px;">
                        <strong>Definition:</strong> Factors are numbers that divide ${number} exactly (no remainder)
                    </div>
                    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 15px;">
                        ${factors.map(factor => `
                            <div class="factor-box ${isPrime(factor) ? 'prime' : 'composite'}" style="animation-delay: ${factors.indexOf(factor) * 0.1}s;">
                                <div class="factor-value">${factor}</div>
                                <div class="factor-label">${number} √∑ ${factor} = ${number / factor}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="margin-top: 20px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Total factors:</strong> ${factors.length} (${factors.join(', ')})
                    </div>
                </div>
            `;
        };

        window.showMultiplesDemo = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const number = Math.floor(Math.random() * 9) + 2;
            const multiples = [];
            
            for (let i = 1; i <= 10; i++) {
                multiples.push(number * i);
            }
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-teal);">First 10 Multiples of ${number}</div>
                    <div style="margin-bottom: 15px;">
                        <strong>Definition:</strong> Multiples are the products of ${number} √ó 1, ${number} √ó 2, ${number} √ó 3, ...
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 15px;">
                        ${multiples.map((multiple, index) => `
                            <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.2rem; font-weight: bold; color: var(--accent-orange);">${multiple}</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">${number} √ó ${index + 1}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="margin-top: 20px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Pattern:</strong> ${multiples.join(', ')}<br>
                        Every multiple of ${number} can be divided by ${number} with no remainder
                    </div>
                </div>
            `;
        };

        window.showPrimeCheckDemo = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const number = Math.floor(Math.random() * 50) + 10;
            const isNumPrime = isPrime(number);
            const factors = [];
            
            for (let i = 1; i <= number; i++) {
                if (number % i === 0) {
                    factors.push(i);
                }
            }
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-purple);">Is ${number} a Prime Number?</div>
                    <div style="margin-bottom: 15px;">
                        <strong>Rule:</strong> Prime numbers have exactly 2 factors: 1 and themselves
                    </div>
                    <div style="background: ${isNumPrime ? 'rgba(156, 39, 176, 0.1)' : 'rgba(76, 175, 80, 0.1)'}; padding: 20px; border-radius: 8px; margin: 15px 0; border: 2px solid ${isNumPrime ? 'var(--accent-purple)' : 'var(--secondary-green)'};">
                        <div style="font-size: 2rem; font-weight: bold; color: ${isNumPrime ? 'var(--accent-purple)' : 'var(--secondary-green)'};">
                            ${isNumPrime ? 'PRIME' : 'COMPOSITE'}
                        </div>
                        <div style="margin-top: 10px;">
                            <strong>Factors of ${number}:</strong> ${factors.join(', ')}
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9rem; color: var(--text-secondary);">
                            ${number} has ${factors.length} factor(s)
                        </div>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Check:</strong> Try dividing by numbers from 2 to ${Math.floor(Math.sqrt(number))}<br>
                        If no exact divisions found (except 1 and ${number}), it's prime!
                    </div>
                </div>
            `;
        };

        window.showDivisibilityDemo = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const number = Math.floor(Math.random() * 900) + 100;
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-orange);">Divisibility Test for ${number}</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 20px 0;">
                        ${divisibilityRules.map(rule => {
                            let result = false;
                            let reason = '';
                            
                            switch(rule.number) {
                                case 2:
                                    result = number % 2 === 0;
                                    reason = number + ' ends with ' + (number % 10);
                                    break;
                                case 3:
                                    const sum3 = number.toString().split('').reduce((a,b) => parseInt(a) + parseInt(b), 0);
                                    result = sum3 % 3 === 0;
                                    reason = number + ' ‚Üí ' + number.toString().split('').join('+') + ' = ' + sum3;
                                    break;
                                case 4:
                                    const lastTwo4 = parseInt(number.toString().slice(-2));
                                    result = lastTwo4 % 4 === 0;
                                    reason = 'Last two digits: ' + lastTwo4;
                                    break;
                                case 5:
                                    result = number % 5 === 0;
                                    reason = number + ' ends with ' + (number % 10);
                                    break;
                                case 6:
                                    result = (number % 2 === 0) && ((number.toString().split('').reduce((a,b) => parseInt(a) + parseInt(b), 0)) % 3 === 0);
                                    reason = 'Even? ' + (number % 2 === 0) + ', Div by 3? ' + ((number.toString().split('').reduce((a,b) => parseInt(a) + parseInt(b), 0)) % 3 === 0);
                                    break;
                                case 9:
                                    const sum9 = number.toString().split('').reduce((a,b) => parseInt(a) + parseInt(b), 0);
                                    result = sum9 % 9 === 0;
                                    reason = number + ' ‚Üí ' + number.toString().split('').join('+') + ' = ' + sum9;
                                    break;
                                case 10:
                                    result = number % 10 === 0;
                                    reason = number + ' ends with ' + (number % 10);
                                    break;
                            }
                            
                            return `
                                <div style="background: ${result ? 'rgba(76, 175, 80, 0.1)' : 'rgba(244, 67, 54, 0.1)'}; padding: 10px; border-radius: 8px; border: 2px solid ${result ? 'var(--secondary-green)' : 'var(--accent-red)'};">
                                    <div style="font-weight: bold; color: ${result ? 'var(--secondary-green)' : 'var(--accent-red)'};">Divisible by ${rule.number}?</div>
                                    <div style="font-size: 1.2rem; font-weight: bold; margin: 5px 0;">${result ? '‚úì YES' : '‚úó NO'}</div>
                                    <div style="font-size: 0.8rem; color: var(--text-secondary);">${rule.rule}</div>
                                    <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 5px;">${reason}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        };

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            mathFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            mathFact.appendChild(createMathFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createNumberVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
