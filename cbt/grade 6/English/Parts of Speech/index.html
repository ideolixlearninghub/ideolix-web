<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 English - Parts of Speech | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Language Arts Theme */
        :root {
            --primary-indigo: #3F51B5;
            --secondary-pink: #E91E63;
            --accent-teal: #009688;
            --accent-amber: #FFC107;
            --accent-green: #4CAF50;
            --accent-deep-orange: #FF5722;
            --accent-purple: #9C27B0;
            --accent-blue: #2196F3;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(63, 81, 181, 0.3);
            --noun-glow: 0 0 15px rgba(63, 81, 181, 0.2);
            --verb-glow: 0 0 15px rgba(233, 30, 99, 0.2);
            --adjective-glow: 0 0 15px rgba(76, 175, 80, 0.2);
            --adverb-glow: 0 0 15px rgba(255, 193, 7, 0.2);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Language Arts Pattern Background */
        .language-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(63, 81, 181, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(233, 30, 99, 0.1) 0%, transparent 50%),
                repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(0, 150, 136, 0.05) 2px, rgba(0, 150, 136, 0.05) 4px);
            opacity: 0.3;
        }

        .floating-letter {
            position: absolute;
            color: rgba(255, 255, 255, 0.05);
            font-size: 3rem;
            animation: floatLetter 20s linear infinite;
        }

        .floating-word {
            position: absolute;
            color: rgba(255, 255, 255, 0.05);
            font-size: 2rem;
            animation: floatWord 15s linear infinite;
        }

        @keyframes floatLetter {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0.1; }
            25% { transform: translate(-100px, -50px) rotate(90deg); opacity: 0.05; }
            50% { transform: translate(50px, -100px) rotate(180deg); opacity: 0.1; }
            75% { transform: translate(100px, 50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translate(0, 0) rotate(360deg); opacity: 0.1; }
        }

        @keyframes floatWord {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0.1; }
            25% { transform: translate(80px, -60px) rotate(-90deg); opacity: 0.05; }
            50% { transform: translate(-40px, -80px) rotate(-180deg); opacity: 0.1; }
            75% { transform: translate(-80px, 60px) rotate(-270deg); opacity: 0.05; }
            100% { transform: translate(0, 0) rotate(-360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(63, 81, 181, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-indigo);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-indigo);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-indigo);
            box-shadow: 0 0 0 3px rgba(63, 81, 181, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-indigo);
            color: white;
            box-shadow: 0 4px 15px rgba(63, 81, 181, 0.4);
        }

        .btn-primary:hover {
            background: #303F9F;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(63, 81, 181, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-pink);
            color: white;
            box-shadow: 0 4px 15px rgba(233, 30, 99, 0.4);
        }

        .btn-secondary:hover {
            background: #C2185B;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-indigo);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-indigo), var(--secondary-pink));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(63, 81, 181, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .language-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-amber);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-pink));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(63, 81, 181, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-indigo);
            background: rgba(63, 81, 181, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(63, 81, 181, 0.1);
            border-color: var(--primary-indigo);
            color: var(--primary-indigo);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-pink);
        }

        .option.correct .option-letter {
            background: var(--primary-indigo);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(63, 81, 181, 0.1);
            border-left: 5px solid var(--primary-indigo);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-indigo);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-indigo);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Parts of Speech Overview */
        .parts-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid var(--primary-indigo);
            box-shadow: var(--glow);
        }

        .display-title {
            color: var(--primary-indigo);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        .parts-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 992px) {
            .parts-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 576px) {
            .parts-grid {
                grid-template-columns: 1fr;
            }
        }

        .part-card {
            background: var(--dark-surface);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .part-card.noun {
            border-color: var(--primary-indigo);
            background: rgba(63, 81, 181, 0.1);
        }

        .part-card.verb {
            border-color: var(--secondary-pink);
            background: rgba(233, 30, 99, 0.1);
        }

        .part-card.adjective {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .part-card.adverb {
            border-color: var(--accent-amber);
            background: rgba(255, 193, 7, 0.1);
        }

        .part-card.pronoun {
            border-color: var(--accent-teal);
            background: rgba(0, 150, 136, 0.1);
        }

        .part-card.preposition {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .part-card.conjunction {
            border-color: var(--accent-deep-orange);
            background: rgba(255, 87, 34, 0.1);
        }

        .part-card.interjection {
            border-color: var(--accent-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .part-card:hover {
            transform: translateY(-8px);
        }

        .part-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .part-name {
            font-weight: bold;
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .part-noun .part-name { color: var(--primary-indigo); }
        .part-verb .part-name { color: var(--secondary-pink); }
        .part-adjective .part-name { color: var(--accent-green); }
        .part-adverb .part-name { color: var(--accent-amber); }
        .part-pronoun .part-name { color: var(--accent-teal); }
        .part-preposition .part-name { color: var(--accent-purple); }
        .part-conjunction .part-name { color: var(--accent-deep-orange); }
        .part-interjection .part-name { color: var(--accent-blue); }

        .part-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        /* Sentence Analysis */
        .sentence-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
        }

        .sentence-display {
            background: var(--dark-surface);
            padding: 25px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 1.3rem;
            line-height: 1.8;
            text-align: center;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sentence-word {
            padding: 5px 10px;
            margin: 0 3px;
            border-radius: 4px;
            transition: all 0.3s ease;
            cursor: pointer;
            display: inline-block;
        }

        .sentence-word:hover {
            transform: translateY(-2px);
        }

        .word-noun { 
            background: rgba(63, 81, 181, 0.2);
            border: 1px solid var(--primary-indigo);
        }
        .word-verb { 
            background: rgba(233, 30, 99, 0.2);
            border: 1px solid var(--secondary-pink);
        }
        .word-adjective { 
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid var(--accent-green);
        }
        .word-adverb { 
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid var(--accent-amber);
        }
        .word-pronoun { 
            background: rgba(0, 150, 136, 0.2);
            border: 1px solid var(--accent-teal);
        }
        .word-preposition { 
            background: rgba(156, 39, 176, 0.2);
            border: 1px solid var(--accent-purple);
        }

        /* Parts Comparison */
        .comparison-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-amber);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: var(--dark-surface);
            border-radius: 8px;
            overflow: hidden;
        }

        .comparison-table th {
            background: var(--dark-card);
            padding: 12px;
            text-align: left;
            color: var(--accent-amber);
            border-bottom: 2px solid var(--accent-amber);
        }

        .comparison-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .comparison-table tr:hover {
            background: rgba(255, 193, 7, 0.05);
        }

        /* Interactive Grammar Lab */
        .grammar-lab {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-teal);
        }

        .lab-controls {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .lab-button {
            padding: 10px 15px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-teal);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lab-button:hover {
            background: rgba(0, 150, 136, 0.1);
            transform: translateY(-2px);
        }

        .lab-area {
            background: var(--dark-surface);
            min-height: 200px;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: center;
        }

        .lab-word {
            background: var(--dark-card);
            padding: 12px 18px;
            border-radius: 6px;
            border: 2px solid transparent;
            cursor: move;
            transition: all 0.3s ease;
            text-align: center;
            min-width: 80px;
        }

        .lab-word.noun-word {
            border-color: var(--primary-indigo);
            background: rgba(63, 81, 181, 0.1);
        }

        .lab-word.verb-word {
            border-color: var(--secondary-pink);
            background: rgba(233, 30, 99, 0.1);
        }

        .lab-word.adjective-word {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .lab-word.adverb-word {
            border-color: var(--accent-amber);
            background: rgba(255, 193, 7, 0.1);
        }

        .lab-word:hover {
            transform: scale(1.05);
        }

        .drop-zone {
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed var(--text-muted);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            flex-direction: column;
            gap: 10px;
        }

        .drop-zone.active {
            border-color: var(--accent-teal);
            background: rgba(0, 150, 136, 0.05);
        }

        .lab-result {
            text-align: center;
            margin-top: 15px;
            min-height: 30px;
            color: var(--text-secondary);
            font-weight: bold;
        }

        /* Word Categories */
        .categories-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-green);
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .category-grid {
                grid-template-columns: 1fr;
            }
        }

        .category-card {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--accent-green);
        }

        .category-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--accent-green);
            font-size: 1.2rem;
            text-align: center;
        }

        .category-examples {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .category-example {
            background: var(--dark-card);
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        /* Sentence Building */
        .sentence-builder {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--secondary-pink);
        }

        .builder-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .builder-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--secondary-pink);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .builder-button:hover {
            background: rgba(233, 30, 99, 0.1);
            transform: translateY(-2px);
        }

        .builder-area {
            background: var(--dark-surface);
            min-height: 150px;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        /* Interactive Practice */
        .interactive-practice {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .practice-title {
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .practice-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .practice-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-purple);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-button:hover {
            background: rgba(156, 39, 176, 0.1);
            transform: translateY(-2px);
        }

        .practice-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-indigo), var(--secondary-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-indigo);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .parts-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .category-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes wordGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(63, 81, 181, 0.4); }
            50% { box-shadow: 0 0 10px 5px rgba(63, 81, 181, 0.2); }
        }
        
        .word-glow {
            animation: wordGlow 2s ease-in-out infinite;
        }
        
        @keyframes sentenceBuild {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .sentence-build {
            animation: sentenceBuild 0.3s ease forwards;
        }
        
        @keyframes correctGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.4); }
            50% { box-shadow: 0 0 15px 5px rgba(76, 175, 80, 0.2); }
        }
        
        .correct-glow {
            animation: correctGlow 1s ease-in-out;
        }
    </style>
</head>
<body>
    <!-- Language Arts Pattern Background -->
    <div class="language-bg" id="languageBg">
        <!-- Letters and words will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 6 English</h1>
            <p class="welcome-subtitle">Master the building blocks of language! Learn about nouns, verbs, adjectives, adverbs, pronouns, and prepositions. Discover how each part of speech functions in sentences and improve your writing and communication skills!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üìö‚úèÔ∏èüî§</span>
                <span class="topic-name">Parts of Speech</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Language Exploration</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 120</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0.8%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Language fact display -->
                <div id="languageFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Language Arts Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const languageBg = document.getElementById('languageBg');
            
            // Create floating letters
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            for (let i = 0; i < 15; i++) {
                const letter = document.createElement('div');
                letter.className = 'floating-letter';
                letter.textContent = letters[Math.floor(Math.random() * letters.length)];
                letter.style.left = `${Math.random() * 100}%`;
                letter.style.top = `${Math.random() * 100}%`;
                letter.style.animationDelay = `${Math.random() * 20}s`;
                letter.style.fontSize = `${2 + Math.random() * 2}rem`;
                letter.style.color = 'rgba(63, 81, 181, 0.1)';
                languageBg.appendChild(letter);
            }
            
            // Create floating words
            const words = ['NOUN', 'VERB', 'ADJECTIVE', 'ADVERB', 'PRONOUN', 'PREPOSITION'];
            for (let i = 0; i < 10; i++) {
                const word = document.createElement('div');
                word.className = 'floating-word';
                word.textContent = words[Math.floor(Math.random() * words.length)];
                word.style.left = `${Math.random() * 100}%`;
                word.style.top = `${Math.random() * 100}%`;
                word.style.animationDelay = `${Math.random() * 15}s`;
                word.style.fontSize = `${1.5 + Math.random() * 1}rem`;
                word.style.color = 'rgba(233, 30, 99, 0.1)';
                languageBg.appendChild(word);
            }
        }

        // Questions array - 120+ Grade 6 Parts of Speech questions
        const questions = [
            // Nouns (1-20)
            {
                type: "nouns",
                question: "What is a noun?",
                options: ["A person, place, thing, or idea", "An action word", "A describing word", "A word that replaces a noun"],
                answer: "A",
                explanation: "A noun is a word that names a person, place, thing, or idea. Examples: teacher, school, book, happiness."
            },
            {
                type: "nouns",
                question: "Which word is a proper noun?",
                options: ["London", "city", "big", "run"],
                answer: "A",
                explanation: "Proper nouns name specific people, places, or things and are always capitalized. London is a proper noun."
            },
            {
                type: "nouns",
                question: "Which word is a common noun?",
                options: ["dog", "Rover", "Monday", "Christmas"],
                answer: "A",
                explanation: "Common nouns name general people, places, or things. 'dog' is a common noun, while Rover (specific name) is proper."
            },
            {
                type: "nouns",
                question: "What is a collective noun?",
                options: ["Names a group of things", "Names one thing", "Names an action", "Names a quality"],
                answer: "A",
                explanation: "Collective nouns name groups: team, flock, class, family."
            },
            {
                type: "nouns",
                question: "Which is an abstract noun?",
                options: ["Happiness", "Table", "Run", "Blue"],
                answer: "A",
                explanation: "Abstract nouns name ideas, qualities, or feelings that can't be seen or touched: love, courage, freedom."
            },
            // Verbs (21-40)
            {
                type: "verbs",
                question: "What is a verb?",
                options: ["An action or state of being", "A person or place", "A describing word", "A connecting word"],
                answer: "A",
                explanation: "A verb expresses action (run, jump) or state of being (is, seem, become)."
            },
            {
                type: "verbs",
                question: "Which is an action verb?",
                options: ["Jump", "Happy", "Quickly", "Under"],
                answer: "A",
                explanation: "Action verbs show physical or mental action: run, think, create, build."
            },
            {
                type: "verbs",
                question: "Which is a linking verb?",
                options: ["Is", "Run", "Jump", "Write"],
                answer: "A",
                explanation: "Linking verbs connect subjects to complements: am, is, are, was, were, seem, become."
            },
            {
                type: "verbs",
                question: "What is a helping verb?",
                options: ["Helps main verb express action", "Shows action alone", "Describes a noun", "Connects words"],
                answer: "A",
                explanation: "Helping verbs (auxiliary verbs) help main verbs: am, is, are, was, were, have, has, had, will, shall, may, can."
            },
            {
                type: "verbs",
                question: "Which sentence has a transitive verb?",
                options: ["She reads books.", "She sleeps.", "They arrived.", "Birds fly."],
                answer: "A",
                explanation: "Transitive verbs have direct objects. 'reads' is transitive (reads what? books)."
            },
            // Adjectives (41-60)
            {
                type: "adjectives",
                question: "What is an adjective?",
                options: ["Describes a noun or pronoun", "Names a person", "Shows action", "Connects words"],
                answer: "A",
                explanation: "Adjectives describe or modify nouns and pronouns: tall, happy, three, blue."
            },
            {
                type: "adjectives",
                question: "Which word is an adjective?",
                options: ["Beautiful", "Run", "Quickly", "She"],
                answer: "A",
                explanation: "'Beautiful' describes how something looks. It modifies nouns: beautiful flower, beautiful day."
            },
            {
                type: "adjectives",
                question: "What do comparative adjectives do?",
                options: ["Compare two things", "Describe one thing", "Compare three or more", "Show ownership"],
                answer: "A",
                explanation: "Comparative adjectives compare two things, usually ending in -er or using 'more': taller, more interesting."
            },
            {
                type: "adjectives",
                question: "What do superlative adjectives do?",
                options: ["Compare three or more things", "Compare two things", "Describe one thing", "Show action"],
                answer: "A",
                explanation: "Superlative adjectives compare three or more things, usually ending in -est or using 'most': tallest, most interesting."
            },
            // Adverbs (61-80)
            {
                type: "adverbs",
                question: "What is an adverb?",
                options: ["Modifies a verb, adjective, or other adverb", "Names a person", "Shows action", "Connects words"],
                answer: "A",
                explanation: "Adverbs tell how, when, where, or to what extent: quickly, yesterday, here, very."
            },
            {
                type: "adverbs",
                question: "Which word is an adverb?",
                options: ["Quickly", "Run", "Happy", "Dog"],
                answer: "A",
                explanation: "'Quickly' tells how an action is done. It modifies verbs: run quickly, speak quickly."
            },
            {
                type: "adverbs",
                question: "What question do adverbs answer?",
                options: ["How? When? Where? To what extent?", "Who? What?", "Which one? How many?", "Whose?"],
                answer: "A",
                explanation: "Adverbs answer: How? (quickly), When? (yesterday), Where? (here), To what extent? (very)."
            },
            // Pronouns (81-100)
            {
                type: "pronouns",
                question: "What is a pronoun?",
                options: ["Replaces a noun", "Describes a noun", "Shows action", "Connects words"],
                answer: "A",
                explanation: "Pronouns replace nouns to avoid repetition: he, she, it, they, we, you, I."
            },
            {
                type: "pronouns",
                question: "Which is a personal pronoun?",
                options: ["She", "This", "Who", "Myself"],
                answer: "A",
                explanation: "Personal pronouns refer to people or things: I, you, he, she, it, we, they."
            },
            {
                type: "pronouns",
                question: "What is a possessive pronoun?",
                options: ["Shows ownership", "Refers back to subject", "Asks questions", "Points out something"],
                answer: "A",
                explanation: "Possessive pronouns show ownership: mine, yours, his, hers, its, ours, theirs."
            },
            // Prepositions (101-120)
            {
                type: "prepositions",
                question: "What is a preposition?",
                options: ["Shows relationship between words", "Names a person", "Shows action", "Describes a noun"],
                answer: "A",
                explanation: "Prepositions show relationships of time, place, or direction: in, on, at, under, over, between."
            },
            {
                type: "prepositions",
                question: "Which is a preposition?",
                options: ["Under", "Run", "Quickly", "Happy"],
                answer: "A",
                explanation: "'Under' shows position: under the table, under the bed."
            },
            {
                type: "prepositions",
                question: "What does a prepositional phrase contain?",
                options: ["Preposition + object", "Subject + verb", "Noun + adjective", "Verb + adverb"],
                answer: "A",
                explanation: "Prepositional phrase = preposition + its object (noun/pronoun): in the house, with friends."
            },
            // Mixed Practice (121-140)
            {
                type: "mixed",
                question: "In 'The quick brown fox jumps over the lazy dog', what part of speech is 'quick'?",
                options: ["Adjective", "Adverb", "Noun", "Verb"],
                answer: "A",
                explanation: "'Quick' describes the noun 'fox', so it's an adjective."
            },
            {
                type: "mixed",
                question: "In the same sentence, what part of speech is 'jumps'?",
                options: ["Verb", "Noun", "Adjective", "Preposition"],
                answer: "A",
                explanation: "'Jumps' shows the action of the fox, so it's a verb."
            },
            {
                type: "mixed",
                question: "What part of speech is 'over' in that sentence?",
                options: ["Preposition", "Adverb", "Conjunction", "Interjection"],
                answer: "A",
                explanation: "'Over' shows the relationship between 'jumps' and 'dog', so it's a preposition."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: "",
            currentPart: "all"
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent grammar knowledge!",
            "Perfect parts of speech identification!",
            "Great sentence analysis!",
            "Amazing! You're a language expert!",
            "Perfect noun recognition!",
            "You're a grammar champion!",
            "Outstanding verb identification!",
            "Brilliant adjective analysis!",
            "You think like a linguist!",
            "Parts of speech mastery achieved!"
        ];

        // Language arts terms
        const grammarTerms = [
            {
                term: "Noun",
                definition: "Names a person, place, thing, or idea",
                examples: "teacher, school, book, happiness"
            },
            {
                term: "Verb",
                definition: "Shows action or state of being",
                examples: "run, think, is, become"
            },
            {
                term: "Adjective",
                definition: "Describes or modifies a noun",
                examples: "happy, three, blue, tall"
            },
            {
                term: "Adverb",
                definition: "Modifies verb, adjective, or other adverb",
                examples: "quickly, very, here, yesterday"
            },
            {
                term: "Pronoun",
                definition: "Replaces a noun",
                examples: "he, she, it, they, we"
            },
            {
                term: "Preposition",
                definition: "Shows relationship between words",
                examples: "in, on, at, under, between"
            },
            {
                term: "Conjunction",
                definition: "Connects words, phrases, or clauses",
                examples: "and, but, or, because"
            },
            {
                term: "Interjection",
                definition: "Expresses strong emotion",
                examples: "Wow! Ouch! Hey! Oh!"
            }
        ];

        // Parts of speech with details
        const partsOfSpeech = [
            {
                name: "Noun",
                description: "Names a person, place, thing, or idea",
                function: "Subject or object in sentence",
                examples: "dog, city, love, teacher, happiness",
                icon: "üìö",
                color: "#3F51B5",
                categories: ["Common", "Proper", "Collective", "Abstract"]
            },
            {
                name: "Verb",
                description: "Shows action or state of being",
                function: "Expresses what subject does or is",
                examples: "run, think, is, become, write, speak",
                icon: "‚ö°",
                color: "#E91E63",
                categories: ["Action", "Linking", "Helping", "Transitive", "Intransitive"]
            },
            {
                name: "Adjective",
                description: "Describes or modifies a noun",
                function: "Tells what kind, which one, how many",
                examples: "happy, tall, three, blue, beautiful",
                icon: "üé®",
                color: "#4CAF50",
                categories: ["Descriptive", "Quantitative", "Demonstrative", "Comparative", "Superlative"]
            },
            {
                name: "Adverb",
                description: "Modifies verb, adjective, or other adverb",
                function: "Tells how, when, where, to what extent",
                examples: "quickly, very, here, yesterday, well",
                icon: "üìà",
                color: "#FFC107",
                categories: ["Manner", "Time", "Place", "Degree", "Frequency"]
            },
            {
                name: "Pronoun",
                description: "Replaces a noun to avoid repetition",
                function: "Takes place of noun in sentence",
                examples: "he, she, it, they, we, you, I",
                icon: "üîÑ",
                color: "#009688",
                categories: ["Personal", "Possessive", "Reflexive", "Demonstrative", "Interrogative"]
            },
            {
                name: "Preposition",
                description: "Shows relationship between words",
                function: "Links noun/pronoun to other words",
                examples: "in, on, at, under, over, between, with",
                icon: "üìç",
                color: "#9C27B0",
                categories: ["Time", "Place", "Direction", "Agent", "Instrument"]
            },
            {
                name: "Conjunction",
                description: "Connects words, phrases, or clauses",
                function: "Joins sentence elements together",
                examples: "and, but, or, because, although, if",
                icon: "üîó",
                color: "#FF5722",
                categories: ["Coordinating", "Subordinating", "Correlative"]
            },
            {
                name: "Interjection",
                description: "Expresses strong emotion or surprise",
                function: "Stands alone or at beginning of sentence",
                examples: "Wow! Ouch! Hey! Oh! Alas! Hurray!",
                icon: "üí•",
                color: "#2196F3",
                categories: ["Emotion", "Greeting", "Response", "Exclamation"]
            }
        ];

        // Example sentences with color-coded parts
        const exampleSentences = [
            {
                sentence: "The quick brown fox jumps over the lazy dog.",
                analysis: [
                    {word: "The", part: "article"},
                    {word: "quick", part: "adjective"},
                    {word: "brown", part: "adjective"},
                    {word: "fox", part: "noun"},
                    {word: "jumps", part: "verb"},
                    {word: "over", part: "preposition"},
                    {word: "the", part: "article"},
                    {word: "lazy", part: "adjective"},
                    {word: "dog", part: "noun"}
                ]
            },
            {
                sentence: "She quickly reads interesting books in the library.",
                analysis: [
                    {word: "She", part: "pronoun"},
                    {word: "quickly", part: "adverb"},
                    {word: "reads", part: "verb"},
                    {word: "interesting", part: "adjective"},
                    {word: "books", part: "noun"},
                    {word: "in", part: "preposition"},
                    {word: "the", part: "article"},
                    {word: "library", part: "noun"}
                ]
            },
            {
                sentence: "My three friends and I happily played outside yesterday.",
                analysis: [
                    {word: "My", part: "pronoun"},
                    {word: "three", part: "adjective"},
                    {word: "friends", part: "noun"},
                    {word: "and", part: "conjunction"},
                    {word: "I", part: "pronoun"},
                    {word: "happily", part: "adverb"},
                    {word: "played", part: "verb"},
                    {word: "outside", part: "adverb"},
                    {word: "yesterday", part: "adverb"}
                ]
            }
        ];

        // Word categories examples
        const wordCategories = {
            nouns: {
                common: ["dog", "city", "book", "teacher", "river"],
                proper: ["London", "Monday", "Christmas", "Sarah", "Amazon"],
                collective: ["team", "flock", "class", "family", "herd"],
                abstract: ["love", "freedom", "happiness", "courage", "beauty"]
            },
            verbs: {
                action: ["run", "jump", "write", "think", "build"],
                linking: ["is", "am", "are", "was", "were", "seem", "become"],
                helping: ["have", "has", "had", "will", "shall", "may", "can", "could"]
            },
            adjectives: {
                descriptive: ["happy", "tall", "blue", "soft", "loud"],
                quantitative: ["three", "many", "few", "some", "several"],
                demonstrative: ["this", "that", "these", "those"]
            },
            adverbs: {
                manner: ["quickly", "slowly", "carefully", "happily"],
                time: ["now", "then", "yesterday", "soon", "already"],
                place: ["here", "there", "everywhere", "outside"],
                degree: ["very", "quite", "too", "almost", "completely"]
            },
            pronouns: {
                personal: ["I", "you", "he", "she", "it", "we", "they"],
                possessive: ["mine", "yours", "his", "hers", "its", "ours", "theirs"],
                reflexive: ["myself", "yourself", "himself", "herself", "itself"]
            },
            prepositions: {
                time: ["at", "on", "in", "during", "after", "before"],
                place: ["in", "on", "at", "under", "over", "between", "beside"],
                direction: ["to", "from", "into", "onto", "toward"]
            }
        };

        // Interesting language facts
        const languageFacts = [
            "English has over 170,000 words in current use, plus another 47,000 obsolete words!",
            "The word 'set' has the most definitions in English - 464 different meanings!",
            "The shortest complete sentence in English is 'I am.'",
            "'The quick brown fox jumps over the lazy dog' uses every letter in the alphabet!",
            "English is the most widely spoken language in the world, with over 1.5 billion speakers!",
            "Shakespeare invented over 1,700 words that we still use today!",
            "The most common letter in English is 'e', appearing in about 11% of all words!",
            "The word 'noun' comes from the Latin word 'nomen', which means 'name'!"
        ];

        // Sentence building words
        const sentenceBuildingWords = [
            {word: "The", type: "article", color: "#3F51B5"},
            {word: "quick", type: "adjective", color: "#4CAF50"},
            {word: "brown", type: "adjective", color: "#4CAF50"},
            {word: "fox", type: "noun", color: "#3F51B5"},
            {word: "jumps", type: "verb", color: "#E91E63"},
            {word: "over", type: "preposition", color: "#9C27B0"},
            {word: "the", type: "article", color: "#3F51B5"},
            {word: "lazy", type: "adjective", color: "#4CAF50"},
            {word: "dog", type: "noun", color: "#3F51B5"},
            {word: "happily", type: "adverb", color: "#FFC107"},
            {word: "yesterday", type: "adverb", color: "#FFC107"},
            {word: "She", type: "pronoun", color: "#009688"},
            {word: "reads", type: "verb", color: "#E91E63"},
            {word: "interesting", type: "adjective", color: "#4CAF50"},
            {word: "books", type: "noun", color: "#3F51B5"},
            {word: "in", type: "preposition", color: "#9C27B0"},
            {word: "library", type: "noun", color: "#3F51B5"}
        ];

        // Common errors and tips
        const grammarTips = [
            {
                tip: "Use adjectives to describe nouns, adverbs to describe verbs",
                example: "She sings beautifully (not beautiful)",
                explanation: "'Beautifully' describes how she sings (verb), so use adverb, not adjective"
            },
            {
                tip: "Pronouns must agree with their antecedents",
                example: "Each student must bring his or her book (not their)",
                explanation: "Singular antecedent needs singular pronoun"
            },
            {
                tip: "Prepositions usually come before their objects",
                example: "The book is on the table (not The book is the table on)",
                explanation: "Preposition 'on' comes before its object 'table'"
            },
            {
                tip: "Use subject pronouns as subjects, object pronouns as objects",
                example: "She and I went shopping (not Her and me)",
                explanation: "'She' and 'I' are subjects, so use subject pronouns"
            }
        ];

        // Interactive grammar exercises
        const grammarExercises = [
            {
                type: "identify",
                sentence: "The cat sleeps peacefully on the soft mat.",
                questions: [
                    {word: "cat", answer: "noun", hint: "Names an animal"},
                    {word: "sleeps", answer: "verb", hint: "Shows action"},
                    {word: "peacefully", answer: "adverb", hint: "Describes how"},
                    {word: "on", answer: "preposition", hint: "Shows position"},
                    {word: "soft", answer: "adjective", hint: "Describes mat"}
                ]
            },
            {
                type: "identify",
                sentence: "My brother quickly solved the difficult puzzle.",
                questions: [
                    {word: "My", answer: "pronoun", hint: "Shows possession"},
                    {word: "brother", answer: "noun", hint: "Names a person"},
                    {word: "quickly", answer: "adverb", hint: "Describes how"},
                    {word: "solved", answer: "verb", hint: "Shows action"},
                    {word: "difficult", answer: "adjective", hint: "Describes puzzle"}
                ]
            }
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const languageFact = document.getElementById('languageFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade6EnglishPartsOfSpeech');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade6EnglishPartsOfSpeech', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade6EnglishPartsOfSpeech_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade6EnglishPartsOfSpeech_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a grammar expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent knowledge of parts of speech!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep learning to master grammar concepts!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Practice more with nouns, verbs, and adjectives!";
            } else {
                scoreMessage.textContent = "Keep learning! Understanding parts of speech helps you write and communicate better!";
            }
        }

        // Create language fact display
        function createLanguageFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'language-fact';
            
            factDiv.innerHTML = `<strong>Amazing Language Fact:</strong> ${languageFacts[Math.floor(Math.random() * languageFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "nouns": "üìö",
                "verbs": "‚ö°",
                "adjectives": "üé®",
                "adverbs": "üìà",
                "pronouns": "üîÑ",
                "prepositions": "üìç",
                "mixed": "üéØ"
            };
            
            let conceptName = "Nouns";
            let conceptIcon = "üìö";
            
            if (question.type.includes("nouns")) {
                conceptName = "Nouns";
                conceptIcon = conceptIcons.nouns;
            } else if (question.type.includes("verbs")) {
                conceptName = "Verbs";
                conceptIcon = conceptIcons.verbs;
            } else if (question.type.includes("adjectives")) {
                conceptName = "Adjectives";
                conceptIcon = conceptIcons.adjectives;
            } else if (question.type.includes("adverbs")) {
                conceptName = "Adverbs";
                conceptIcon = conceptIcons.adverbs;
            } else if (question.type.includes("pronouns")) {
                conceptName = "Pronouns";
                conceptIcon = conceptIcons.pronouns;
            } else if (question.type.includes("prepositions")) {
                conceptName = "Prepositions";
                conceptIcon = conceptIcons.prepositions;
            } else if (question.type.includes("mixed")) {
                conceptName = "Mixed Practice";
                conceptIcon = conceptIcons.mixed;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("nouns")) {
                label.textContent = "Naming words: people, places, things, ideas";
            } else if (question.type.includes("verbs")) {
                label.textContent = "Action words or state of being";
            } else if (question.type.includes("adjectives")) {
                label.textContent = "Describing words for nouns";
            } else if (question.type.includes("adverbs")) {
                label.textContent = "Words that modify verbs, adjectives, or other adverbs";
            } else if (question.type.includes("pronouns")) {
                label.textContent = "Words that replace nouns";
            } else if (question.type.includes("prepositions")) {
                label.textContent = "Words that show relationships between other words";
            } else if (question.type.includes("mixed")) {
                label.textContent = "Mixed review of all parts of speech";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create language visualization
        function createLanguageVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-indigo);">Parts of Speech</h3>
                
                <div class="parts-container">
                    <div class="display-title">Eight Parts of Speech</div>
                    <div class="parts-grid">
                        ${partsOfSpeech.map(part => `
                            <div class="part-card ${part.name.toLowerCase()}" onclick="showPartDetails('${part.name}')">
                                <div class="part-icon">${part.icon}</div>
                                <div class="part-name">${part.name}</div>
                                <div class="part-description">${part.description}</div>
                                <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px;">
                                    Example: ${part.examples.split(', ')[0]}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="sentence-container">
                    <div class="display-title">Sentence Analysis</div>
                    <div class="sentence-display" id="sentenceDisplay">
                        ${exampleSentences[0].analysis.map(word => `
                            <span class="sentence-word word-${word.part === 'article' ? 'noun' : word.part}" 
                                  onclick="showWordInfo('${word.word}', '${word.part}')"
                                  title="${word.part}">
                                ${word.word}
                            </span>
                        `).join('')}
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="lab-button" onclick="changeSentence()">Next Sentence</button>
                        <button class="lab-button" onclick="analyzeSentence()">Analyze Parts</button>
                    </div>
                    <div id="sentenceAnalysis" style="margin-top: 15px; padding: 15px; background: var(--dark-surface); border-radius: 8px; display: none;">
                        <!-- Analysis will appear here -->
                    </div>
                </div>
                
                <div class="comparison-container">
                    <div class="display-title">Parts of Speech Comparison</div>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Part</th>
                                <th>Function</th>
                                <th>Questions Answered</th>
                                <th>Examples</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="font-weight: bold; color: var(--primary-indigo);">Noun</td>
                                <td>Names something</td>
                                <td>Who? What?</td>
                                <td>dog, city, love</td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold; color: var(--secondary-pink);">Verb</td>
                                <td>Shows action/state</td>
                                <td>What is done? What happens?</td>
                                <td>run, think, is</td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold; color: var(--accent-green);">Adjective</td>
                                <td>Describes noun</td>
                                <td>What kind? Which one? How many?</td>
                                <td>happy, tall, three</td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold; color: var(--accent-amber);">Adverb</td>
                                <td>Modifies verb/adj/adv</td>
                                <td>How? When? Where? To what extent?</td>
                                <td>quickly, very, here</td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold; color: var(--accent-teal);">Pronoun</td>
                                <td>Replaces noun</td>
                                <td>Who? What? (replaces)</td>
                                <td>he, she, they, we</td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold; color: var(--accent-purple);">Preposition</td>
                                <td>Shows relationship</td>
                                <td>Where? When? How?</td>
                                <td>in, on, at, under</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="categories-container">
                    <div class="display-title">Word Categories</div>
                    <div class="category-grid">
                        <div class="category-card">
                            <div class="category-title">Nouns</div>
                            <div class="category-examples">
                                ${wordCategories.nouns.common.map(word => `<div class="category-example">${word}</div>`).join('')}
                                ${wordCategories.nouns.proper.map(word => `<div class="category-example" style="border-color: var(--primary-indigo);">${word}</div>`).join('')}
                            </div>
                        </div>
                        <div class="category-card">
                            <div class="category-title">Verbs</div>
                            <div class="category-examples">
                                ${wordCategories.verbs.action.map(word => `<div class="category-example">${word}</div>`).join('')}
                                ${wordCategories.verbs.linking.map(word => `<div class="category-example" style="border-color: var(--secondary-pink);">${word}</div>`).join('')}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="grammar-lab">
                    <div class="display-title">Interactive Grammar Lab</div>
                    <div class="lab-controls">
                        <div class="lab-button" onclick="startWordSorting()">Sort Words</div>
                        <div class="lab-button" onclick="startSentenceBuilding()">Build Sentences</div>
                        <div class="lab-button" onclick="startPartIdentification()">Identify Parts</div>
                        <div class="lab-button" onclick="resetLab()">Reset Lab</div>
                    </div>
                    <div class="lab-area" id="labArea">
                        <div style="text-align: center; width: 100%; color: var(--text-secondary);">
                            Click a lab activity to begin
                        </div>
                    </div>
                    <div class="lab-result" id="labResult"></div>
                </div>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Grammar Term</th>
                            <th>Definition</th>
                            <th>Examples</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${grammarTerms.map(term => `
                            <tr>
                                <td style="font-weight: bold; color: var(--accent-teal);">${term.term}</td>
                                <td>${term.definition}</td>
                                <td>${term.examples}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
                
                <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid var(--accent-amber);">
                    <div class="display-title">Grammar Tips</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0;">
                        ${grammarTips.map(tip => `
                            <div style="background: var(--dark-surface); padding: 15px; border-radius: 8px; border-left: 4px solid var(--accent-amber);">
                                <div style="font-weight: bold; color: var(--accent-amber); margin-bottom: 10px;">${tip.tip}</div>
                                <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 8px;">
                                    <strong>Example:</strong> ${tip.example}
                                </div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">${tip.explanation}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="sentence-builder">
                    <div class="display-title">Sentence Builder</div>
                    <div class="builder-controls">
                        <div class="builder-button" onclick="addNoun()">Add Noun</div>
                        <div class="builder-button" onclick="addVerb()">Add Verb</div>
                        <div class="builder-button" onclick="addAdjective()">Add Adjective</div>
                        <div class="builder-button" onclick="addAdverb()">Add Adverb</div>
                        <div class="builder-button" onclick="clearBuilder()">Clear</div>
                    </div>
                    <div class="builder-area" id="builderArea">
                        <div style="color: var(--text-secondary);">Build your sentence here...</div>
                    </div>
                    <div id="builderAnalysis" style="text-align: center; margin-top: 15px; color: var(--text-secondary);">
                        <!-- Analysis will appear here -->
                    </div>
                </div>
                
                <div class="interactive-practice">
                    <div class="practice-title">Interactive Practice</div>
                    <div class="practice-controls">
                        <div class="practice-button" onclick="practiceNounID()">Identify Nouns</div>
                        <div class="practice-button" onclick="practiceVerbID()">Identify Verbs</div>
                        <div class="practice-button" onclick="practiceAdjectiveID()">Identify Adjectives</div>
                        <div class="practice-button" onclick="practiceMixedID()">Mixed Identification</div>
                    </div>
                    <div class="practice-display" id="practiceDisplay">
                        Click buttons above to practice parts of speech
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-orange);">
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Quick Practice:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. What part of speech names a person, place, or thing?<br>
                        2. What part of speech shows action?<br>
                        3. What part of speech describes a noun?<br>
                        4. What part of speech replaces a noun?<br>
                        5. What part of speech shows relationship between words?
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--accent-teal);">
                    <div style="color: var(--accent-teal); font-weight: bold; margin-bottom: 10px; text-align: center;">Parts of Speech Cheat Sheet</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Noun:</strong> Names something (dog, city)<br>
                        <strong>Verb:</strong> Shows action (run, think)<br>
                        <strong>Adjective:</strong> Describes noun (happy, tall)<br>
                        <strong>Adverb:</strong> Modifies verb/adj (quickly, very)<br>
                        <strong>Pronoun:</strong> Replaces noun (he, she, they)<br>
                        <strong>Preposition:</strong> Shows relationship (in, on, at)
                    </div>
                </div>
            `;
            
            return vizDiv;
        }

        // Interactive functions
        let currentSentenceIndex = 0;
        
        function showPartDetails(partName) {
            const part = partsOfSpeech.find(p => p.name === partName);
            
            if (part) {
                alert(`${part.name}\n\nDescription: ${part.description}\n\nFunction: ${part.function}\n\nExamples: ${part.examples}\n\nCategories: ${part.categories.join(', ')}`);
            }
        }
        
        function showWordInfo(word, part) {
            let info = "";
            
            switch(part) {
                case "noun":
                    info = `${word} is a NOUN.\n\nNouns name people, places, things, or ideas.`;
                    break;
                case "verb":
                    info = `${word} is a VERB.\n\nVerbs show action or state of being.`;
                    break;
                case "adjective":
                    info = `${word} is an ADJECTIVE.\n\nAdjectives describe or modify nouns.`;
                    break;
                case "adverb":
                    info = `${word} is an ADVERB.\n\nAdverbs modify verbs, adjectives, or other adverbs.`;
                    break;
                case "pronoun":
                    info = `${word} is a PRONOUN.\n\nPronouns replace nouns to avoid repetition.`;
                    break;
                case "preposition":
                    info = `${word} is a PREPOSITION.\n\nPrepositions show relationships between words.`;
                    break;
                case "article":
                    info = `${word} is an ARTICLE.\n\nArticles (a, an, the) introduce nouns.`;
                    break;
                case "conjunction":
                    info = `${word} is a CONJUNCTION.\n\nConjunctions connect words, phrases, or clauses.`;
                    break;
            }
            
            if (info) {
                alert(info);
            }
        }
        
        function changeSentence() {
            currentSentenceIndex = (currentSentenceIndex + 1) % exampleSentences.length;
            const sentenceDisplay = document.getElementById('sentenceDisplay');
            
            if (sentenceDisplay) {
                const sentence = exampleSentences[currentSentenceIndex];
                sentenceDisplay.innerHTML = sentence.analysis.map(word => `
                    <span class="sentence-word word-${word.part === 'article' ? 'noun' : word.part}" 
                          onclick="showWordInfo('${word.word}', '${word.part}')"
                          title="${word.part}">
                        ${word.word}
                    </span>
                `).join('');
                
                // Hide any previous analysis
                const analysisDiv = document.getElementById('sentenceAnalysis');
                if (analysisDiv) {
                    analysisDiv.style.display = 'none';
                }
            }
        }
        
        function analyzeSentence() {
            const analysisDiv = document.getElementById('sentenceAnalysis');
            const sentence = exampleSentences[currentSentenceIndex];
            
            if (analysisDiv) {
                let analysisHTML = '<div style="font-weight: bold; margin-bottom: 10px; color: var(--primary-indigo);">Sentence Analysis:</div>';
                
                // Group words by part of speech
                const partsMap = {};
                sentence.analysis.forEach(word => {
                    const part = word.part === 'article' ? 'noun' : word.part;
                    if (!partsMap[part]) {
                        partsMap[part] = [];
                    }
                    partsMap[part].push(word.word);
                });
                
                // Create analysis display
                for (const part in partsMap) {
                    const partColor = {
                        'noun': 'var(--primary-indigo)',
                        'verb': 'var(--secondary-pink)',
                        'adjective': 'var(--accent-green)',
                        'adverb': 'var(--accent-amber)',
                        'pronoun': 'var(--accent-teal)',
                        'preposition': 'var(--accent-purple)',
                        'conjunction': 'var(--accent-deep-orange)'
                    }[part] || 'var(--text-primary)';
                    
                    analysisHTML += `
                        <div style="margin-bottom: 8px;">
                            <span style="font-weight: bold; color: ${partColor};">${part.toUpperCase()}:</span>
                            <span style="margin-left: 10px;">${partsMap[part].join(', ')}</span>
                        </div>
                    `;
                }
                
                analysisDiv.innerHTML = analysisHTML;
                analysisDiv.style.display = 'block';
            }
        }

        // Interactive lab functions
        function startWordSorting() {
            const labArea = document.getElementById('labArea');
            const labResult = document.getElementById('labResult');
            
            if (!labArea || !labResult) return;
            
            const words = [
                {word: "dog", type: "noun"},
                {word: "run", type: "verb"},
                {word: "happy", type: "adjective"},
                {word: "quickly", type: "adverb"},
                {word: "she", type: "pronoun"},
                {word: "under", type: "preposition"},
                {word: "book", type: "noun"},
                {word: "write", type: "verb"},
                {word: "blue", type: "adjective"},
                {word: "very", type: "adverb"}
            ];
            
            // Shuffle words
            const shuffledWords = [...words].sort(() => Math.random() - 0.5);
            
            labArea.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="margin-bottom: 20px; font-size: 1.2rem; color: var(--primary-indigo);">Sort Words by Part of Speech</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 20px;">
                        ${shuffledWords.map(w => `
                            <div class="lab-word ${w.type}-word" draggable="true" data-type="${w.type}" data-word="${w.word}">
                                ${w.word}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px;">
                        <div class="drop-zone" data-type="noun">
                            <div style="font-weight: bold; color: var(--primary-indigo);">NOUNS</div>
                            <div>Person, place, thing</div>
                        </div>
                        <div class="drop-zone" data-type="verb">
                            <div style="font-weight: bold; color: var(--secondary-pink);">VERBS</div>
                            <div>Action words</div>
                        </div>
                        <div class="drop-zone" data-type="adjective">
                            <div style="font-weight: bold; color: var(--accent-green);">ADJECTIVES</div>
                            <div>Describing words</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 15px;">
                        <div class="drop-zone" data-type="adverb">
                            <div style="font-weight: bold; color: var(--accent-amber);">ADVERBS</div>
                            <div>How, when, where</div>
                        </div>
                        <div class="drop-zone" data-type="pronoun">
                            <div style="font-weight: bold; color: var(--accent-teal);">PRONOUNS</div>
                            <div>Replace nouns</div>
                        </div>
                        <div class="drop-zone" data-type="preposition">
                            <div style="font-weight: bold; color: var(--accent-purple);">PREPOSITIONS</div>
                            <div>Show relationships</div>
                        </div>
                    </div>
                </div>
            `;
            
            labResult.textContent = "Drag words to correct categories";
            labResult.style.color = 'var(--text-secondary)';
            
            // Add drag and drop functionality
            setTimeout(() => {
                setupDragAndDrop();
            }, 100);
        }
        
        function setupDragAndDrop() {
            const draggables = document.querySelectorAll('.lab-word');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', () => {
                    draggable.classList.add('dragging');
                });
                
                draggable.addEventListener('dragend', () => {
                    draggable.classList.remove('dragging');
                });
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', e => {
                    e.preventDefault();
                    zone.classList.add('active');
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('active');
                });
                
                zone.addEventListener('drop', e => {
                    e.preventDefault();
                    zone.classList.remove('active');
                    
                    const draggable = document.querySelector('.dragging');
                    const wordType = draggable.dataset.type;
                    const zoneType = zone.dataset.type;
                    
                    if (wordType === zoneType) {
                        zone.appendChild(draggable);
                        draggable.style.opacity = '0.7';
                        draggable.style.cursor = 'default';
                        draggable.draggable = false;
                        
                        updateSortingResult();
                    } else {
                        labResult.innerHTML = `<span style="color: var(--accent-red);">Try again! "${draggable.textContent}" is not a ${zoneType}</span>`;
                    }
                });
            });
        }
        
        function updateSortingResult() {
            const dropZones = document.querySelectorAll('.drop-zone');
            let allCorrect = true;
            let correctCount = 0;
            let totalCount = 0;
            
            dropZones.forEach(zone => {
                const wordsInZone = zone.querySelectorAll('.lab-word');
                wordsInZone.forEach(word => {
                    totalCount++;
                    if (word.dataset.type === zone.dataset.type) {
                        correctCount++;
                    } else {
                        allCorrect = false;
                    }
                });
            });
            
            const labResult = document.getElementById('labResult');
            if (allCorrect && totalCount === 10) {
                labResult.innerHTML = `<span style="color: var(--accent-green);">üéâ Perfect! All words sorted correctly!</span>`;
            } else if (correctCount > 0) {
                labResult.innerHTML = `<span style="color: var(--accent-amber);">${correctCount}/${totalCount} words correctly sorted. Keep going!</span>`;
            }
        }
        
        function startSentenceBuilding() {
            const labArea = document.getElementById('labArea');
            const labResult = document.getElementById('labResult');
            
            if (!labArea || !labResult) return;
            
            labArea.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="margin-bottom: 20px; font-size: 1.2rem; color: var(--secondary-pink);">Build a Sentence</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px;">
                        ${sentenceBuildingWords.map(w => `
                            <div class="lab-word" style="border-color: ${w.color}; background: ${w.color}20;" 
                                 onclick="addToSentence('${w.word}', '${w.type}')">
                                ${w.word}
                                <div style="font-size: 0.7rem; color: ${w.color}; margin-top: 3px;">${w.type}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; min-height: 80px;" id="builtSentence">
                        <div style="color: var(--text-secondary);">Your sentence will appear here...</div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="lab-button" onclick="analyzeBuiltSentence()">Analyze Sentence</button>
                        <button class="lab-button" onclick="clearBuiltSentence()">Clear</button>
                    </div>
                </div>
            `;
            
            labResult.textContent = "Click words to build a sentence, then analyze it";
            labResult.style.color = 'var(--text-secondary)';
        }
        
        let builtSentenceWords = [];
        
        function addToSentence(word, type) {
            const builtSentence = document.getElementById('builtSentence');
            builtSentenceWords.push({word, type});
            
            if (builtSentence) {
                builtSentence.innerHTML = builtSentenceWords.map(w => `
                    <span style="display: inline-block; padding: 5px 10px; margin: 2px; border-radius: 4px; 
                          border: 1px solid ${getColorForType(w.type)}; background: ${getColorForType(w.type)}20;">
                        ${w.word}
                    </span>
                `).join(' ');
                
                // Remove placeholder text
                if (builtSentenceWords.length === 1) {
                    builtSentence.style.color = 'var(--text-primary)';
                }
            }
        }
        
        function getColorForType(type) {
            const colors = {
                'noun': '#3F51B5',
                'verb': '#E91E63',
                'adjective': '#4CAF50',
                'adverb': '#FFC107',
                'pronoun': '#009688',
                'preposition': '#9C27B0',
                'article': '#3F51B5'
            };
            return colors[type] || '#607D8B';
        }
        
        function analyzeBuiltSentence() {
            const labResult = document.getElementById('labResult');
            
            if (builtSentenceWords.length === 0) {
                labResult.innerHTML = `<span style="color: var(--accent-red);">Build a sentence first!</span>`;
                return;
            }
            
            let analysis = `<div style="text-align: left; margin-bottom: 10px;"><strong>Sentence Analysis:</strong></div>`;
            let hasVerb = false;
            let hasNoun = false;
            
            builtSentenceWords.forEach((w, index) => {
                const color = getColorForType(w.type);
                analysis += `<div style="margin-bottom: 5px;">
                    <span style="color: ${color}; font-weight: bold;">${w.word}</span>: ${w.type.toUpperCase()}
                </div>`;
                
                if (w.type === 'verb') hasVerb = true;
                if (w.type === 'noun') hasNoun = true;
            });
            
            if (hasVerb && hasNoun) {
                analysis += `<div style="margin-top: 10px; color: var(--accent-green); font-weight: bold;">‚úì Good sentence structure!</div>`;
            } else {
                analysis += `<div style="margin-top: 10px; color: var(--accent-amber);">
                    ${!hasVerb ? '‚ö†Ô∏è Add a verb (action word)<br>' : ''}
                    ${!hasNoun ? '‚ö†Ô∏è Add a noun (person, place, thing)' : ''}
                </div>`;
            }
            
            labResult.innerHTML = analysis;
        }
        
        function clearBuiltSentence() {
            builtSentenceWords = [];
            const builtSentence = document.getElementById('builtSentence');
            const labResult = document.getElementById('labResult');
            
            if (builtSentence && labResult) {
                builtSentence.innerHTML = '<div style="color: var(--text-secondary);">Your sentence will appear here...</div>';
                labResult.textContent = "Sentence cleared. Build a new sentence!";
            }
        }
        
        function startPartIdentification() {
            const labArea = document.getElementById('labArea');
            const labResult = document.getElementById('labResult');
            
            if (!labArea || !labResult) return;
            
            const exercise = grammarExercises[Math.floor(Math.random() * grammarExercises.length)];
            
            labArea.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="margin-bottom: 20px; font-size: 1.2rem; color: var(--accent-teal);">Identify Parts of Speech</div>
                    
                    <div style="background: var(--dark-card); padding: 25px; border-radius: 8px; margin-bottom: 20px; font-size: 1.3rem;">
                        "${exercise.sentence}"
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        ${exercise.questions.map((q, index) => `
                            <div style="background: var(--dark-surface); padding: 15px; border-radius: 8px;">
                                <div style="margin-bottom: 10px; font-weight: bold;">"${q.word}" is a:</div>
                                <div style="display: flex; gap: 10px; justify-content: center;">
                                    <button class="lab-button" onclick="checkAnswer(${index}, 'noun')">Noun</button>
                                    <button class="lab-button" onclick="checkAnswer(${index}, 'verb')">Verb</button>
                                    <button class="lab-button" onclick="checkAnswer(${index}, 'adjective')">Adjective</button>
                                </div>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">
                                    <button class="lab-button" onclick="checkAnswer(${index}, 'adverb')">Adverb</button>
                                    <button class="lab-button" onclick="checkAnswer(${index}, 'pronoun')">Pronoun</button>
                                    <button class="lab-button" onclick="checkAnswer(${index}, 'preposition')">Preposition</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            labResult.textContent = "Click buttons to identify each word's part of speech";
            labResult.style.color = 'var(--text-secondary)';
            
            // Store current exercise for checking
            window.currentExercise = exercise;
            window.answers = new Array(exercise.questions.length).fill(null);
        }
        
        function checkAnswer(questionIndex, answer) {
            const exercise = window.currentExercise;
            const correctAnswer = exercise.questions[questionIndex].answer;
            const labResult = document.getElementById('labResult');
            
            window.answers[questionIndex] = answer;
            
            if (answer === correctAnswer) {
                // Find and highlight the button
                const buttons = document.querySelectorAll(`button[onclick="checkAnswer(${questionIndex}, '${answer}')"]`);
                buttons.forEach(btn => {
                    btn.style.backgroundColor = 'var(--accent-green)';
                    btn.style.borderColor = 'var(--accent-green)';
                    btn.style.color = 'white';
                });
            } else {
                const buttons = document.querySelectorAll(`button[onclick="checkAnswer(${questionIndex}, '${answer}')"]`);
                buttons.forEach(btn => {
                    btn.style.backgroundColor = 'var(--accent-red)';
                    btn.style.borderColor = 'var(--accent-red)';
                    btn.style.color = 'white';
                });
                
                if (labResult) {
                    labResult.innerHTML = `<span style="color: var(--accent-red);">"${exercise.questions[questionIndex].word}" is a ${correctAnswer}, not ${answer}</span>`;
                }
            }
            
            // Check if all answers are correct
            const allCorrect = window.answers.every((ans, idx) => ans === exercise.questions[idx].answer);
            const allAnswered = window.answers.every(ans => ans !== null);
            
            if (allCorrect && allAnswered && labResult) {
                labResult.innerHTML = `<span style="color: var(--accent-green);">üéâ Perfect! All answers correct!</span>`;
            } else if (allAnswered && labResult) {
                labResult.innerHTML = `<span style="color: var(--accent-amber);">Some answers incorrect. Try again!</span>`;
            }
        }
        
        function resetLab() {
            const labArea = document.getElementById('labArea');
            const labResult = document.getElementById('labResult');
            
            if (labArea && labResult) {
                labArea.innerHTML = `
                    <div style="text-align: center; width: 100%; color: var(--text-secondary);">
                        Click a lab activity to begin
                    </div>
                `;
                labResult.textContent = "";
                builtSentenceWords = [];
                window.currentExercise = null;
                window.answers = null;
            }
        }

        // Sentence builder functions
        function addNoun() {
            const nouns = ["dog", "cat", "teacher", "student", "book", "city", "friend", "computer"];
            const noun = nouns[Math.floor(Math.random() * nouns.length)];
            addToBuilder(noun, "noun");
        }
        
        function addVerb() {
            const verbs = ["runs", "jumps", "reads", "writes", "thinks", "plays", "speaks", "learns"];
            const verb = verbs[Math.floor(Math.random() * verbs.length)];
            addToBuilder(verb, "verb");
        }
        
        function addAdjective() {
            const adjectives = ["happy", "tall", "blue", "quick", "smart", "friendly", "interesting", "beautiful"];
            const adjective = adjectives[Math.floor(Math.random() * adjectives.length)];
            addToBuilder(adjective, "adjective");
        }
        
        function addAdverb() {
            const adverbs = ["quickly", "happily", "carefully", "very", "always", "never", "here", "there"];
            const adverb = adverbs[Math.floor(Math.random() * adverbs.length)];
            addToBuilder(adverb, "adverb");
        }
        
        let builderWords = [];
        
        function addToBuilder(word, type) {
            const builderArea = document.getElementById('builderArea');
            builderWords.push({word, type});
            
            if (builderArea) {
                // Clear placeholder text
                if (builderWords.length === 1) {
                    builderArea.innerHTML = '';
                }
                
                const wordElement = document.createElement('span');
                wordElement.textContent = word;
                wordElement.style.display = 'inline-block';
                wordElement.style.padding = '8px 12px';
                wordElement.style.margin = '5px';
                wordElement.style.borderRadius = '6px';
                wordElement.style.backgroundColor = getColorForType(type) + '20';
                wordElement.style.border = `2px solid ${getColorForType(type)}`;
                wordElement.style.color = 'var(--text-primary)';
                wordElement.style.cursor = 'pointer';
                wordElement.style.transition = 'all 0.3s ease';
                wordElement.title = type;
                
                wordElement.addEventListener('click', () => {
                    wordElement.style.transform = 'scale(1.1)';
                    wordElement.style.boxShadow = `0 0 10px ${getColorForType(type)}`;
                    setTimeout(() => {
                        wordElement.style.transform = '';
                        wordElement.style.boxShadow = '';
                    }, 300);
                });
                
                builderArea.appendChild(wordElement);
                
                // Add space between words
                if (builderWords.length > 1) {
                    builderArea.appendChild(document.createTextNode(' '));
                }
                
                // Update analysis
                updateBuilderAnalysis();
            }
        }
        
        function updateBuilderAnalysis() {
            const analysisDiv = document.getElementById('builderAnalysis');
            if (!analysisDiv) return;
            
            if (builderWords.length === 0) {
                analysisDiv.textContent = "Add words to build a sentence";
                return;
            }
            
            const partsCount = {};
            builderWords.forEach(w => {
                partsCount[w.type] = (partsCount[w.type] || 0) + 1;
            });
            
            let analysis = "Your sentence contains: ";
            const parts = [];
            for (const type in partsCount) {
                parts.push(`${partsCount[type]} ${type}${partsCount[type] > 1 ? 's' : ''}`);
            }
            analysis += parts.join(', ');
            
            // Check sentence structure
            const hasNoun = partsCount['noun'] > 0;
            const hasVerb = partsCount['verb'] > 0;
            
            if (hasNoun && hasVerb) {
                analysis += " ‚úì Good structure!";
            } else if (!hasNoun && !hasVerb) {
                analysis += " ‚ö†Ô∏è Add a noun and verb";
            } else if (!hasNoun) {
                analysis += " ‚ö†Ô∏è Add a noun";
            } else if (!hasVerb) {
                analysis += " ‚ö†Ô∏è Add a verb";
            }
            
            analysisDiv.innerHTML = analysis;
        }
        
        function clearBuilder() {
            builderWords = [];
            const builderArea = document.getElementById('builderArea');
            const analysisDiv = document.getElementById('builderAnalysis');
            
            if (builderArea && analysisDiv) {
                builderArea.innerHTML = '<div style="color: var(--text-secondary);">Build your sentence here...</div>';
                analysisDiv.textContent = "Add words to build a sentence";
            }
        }

        // Interactive practice functions
        function practiceNounID() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary-indigo);">Identify the Nouns</div>
                    
                    <div style="margin-bottom: 20px; font-size: 1.2rem;">
                        "The quick brown fox jumps over the lazy dog."
                    </div>
                    
                    <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 15px 0;">
                        <div style="font-size: 1.3rem; color: var(--accent-orange);">
                            Nouns: fox, dog
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Nouns name:</strong><br>
                        ‚Ä¢ People (teacher, student)<br>
                        ‚Ä¢ Places (city, school)<br>
                        ‚Ä¢ Things (book, computer)<br>
                        ‚Ä¢ Ideas (happiness, freedom)
                    </div>
                </div>
            `;
        }
        
        function practiceVerbID() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--secondary-pink);">Identify the Verbs</div>
                    
                    <div style="margin-bottom: 20px; font-size: 1.2rem;">
                        "She quickly reads interesting books in the library."
                    </div>
                    
                    <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 15px 0;">
                        <div style="font-size: 1.3rem; color: var(--accent-orange);">
                            Verb: reads
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Verbs show:</strong><br>
                        ‚Ä¢ Action (run, jump, think)<br>
                        ‚Ä¢ State of being (is, am, are, seem)<br>
                        ‚Ä¢ Occurrence (happen, become)<br>
                        ‚Ä¢ Achievement (win, finish)
                    </div>
                </div>
            `;
        }
        
        function practiceAdjectiveID() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-green);">Identify the Adjectives</div>
                    
                    <div style="margin-bottom: 20px; font-size: 1.2rem;">
                        "My three friends and I happily played outside yesterday."
                    </div>
                    
                    <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 15px 0;">
                        <div style="font-size: 1.3rem; color: var(--accent-orange);">
                            Adjectives: three
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Adjectives describe:</strong><br>
                        ‚Ä¢ What kind? (happy, tall, blue)<br>
                        ‚Ä¢ Which one? (this, that, these)<br>
                        ‚Ä¢ How many? (three, many, some)<br>
                        ‚Ä¢ Whose? (my, your, his)
                    </div>
                </div>
            `;
        }
        
        function practiceMixedID() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-purple);">Mixed Parts of Speech</div>
                    
                    <div style="margin-bottom: 20px; font-size: 1.2rem;">
                        "The beautiful flowers bloom brightly in the spring garden."
                    </div>
                    
                    <div style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 15px 0;">
                        <div style="font-size: 1.1rem; color: var(--accent-orange);">
                            ‚Ä¢ flowers, garden = NOUNS<br>
                            ‚Ä¢ bloom = VERB<br>
                            ‚Ä¢ beautiful = ADJECTIVE<br>
                            ‚Ä¢ brightly = ADVERB<br>
                            ‚Ä¢ in = PREPOSITION<br>
                            ‚Ä¢ the = ARTICLE
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Quick Guide:</strong><br>
                        Noun: names something<br>
                        Verb: shows action<br>
                        Adjective: describes noun<br>
                        Adverb: describes verb/adjective<br>
                        Preposition: shows relationship
                    </div>
                </div>
            `;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            languageFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            languageFact.appendChild(createLanguageFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createLanguageVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
