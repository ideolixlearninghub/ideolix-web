<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 4 Science - Matter & Its Properties | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Matter Theme */
        :root {
            --primary-purple: #7B1FA2;
            --secondary-cyan: #00BCD4;
            --accent-orange: #FF9800;
            --accent-green: #4CAF50;
            --accent-blue: #2196F3;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow: 0 0 20px rgba(123, 31, 162, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Background Slideshow */
        .slideshow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        .slide.active {
            opacity: 1;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(123, 31, 162, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-purple);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-purple);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(123, 31, 162, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(123, 31, 162, 0.4);
        }

        .btn-primary:hover {
            background: #6A1B9A;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(123, 31, 162, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-cyan);
            color: #1a1a1a;
            box-shadow: 0 4px 15px rgba(0, 188, 212, 0.4);
        }

        .btn-secondary:hover {
            background: #00ACC1;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 188, 212, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-purple);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-purple), var(--secondary-cyan));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(123, 31, 162, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .matter-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-orange);
            font-style: italic;
            color: var(--text-secondary);
        }

        .matter-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .matter-box {
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-blue));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(123, 31, 162, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .matter-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .matter-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-purple);
            background: rgba(123, 31, 162, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(123, 31, 162, 0.1);
            border-color: var(--primary-purple);
            color: var(--primary-purple);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-cyan);
            color: #1a1a1a;
        }

        .option.correct .option-letter {
            background: var(--primary-purple);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: none;
        }

        .feedback-correct {
            background: rgba(123, 31, 162, 0.1);
            border-left: 5px solid var(--primary-purple);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-purple);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-purple);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
        }

        /* Matter Diagram */
        .matter-diagram {
            max-width: 400px;
            margin: 20px auto;
            position: relative;
            height: 300px;
        }

        .matter-element {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 100px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .matter-element:hover {
            transform: scale(1.1);
        }

        .matter-element-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            border: 2px solid var(--accent-orange);
            font-size: 1.5rem;
        }

        .matter-element-label {
            font-size: 0.8rem;
            font-weight: 500;
            background: rgba(0, 0, 0, 0.7);
            padding: 3px 8px;
            border-radius: 4px;
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-purple);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* States of Matter Display */
        .states-display {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .state-card {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            min-width: 200px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .state-card.active {
            border-color: var(--primary-purple);
            box-shadow: 0 0 15px rgba(123, 31, 162, 0.3);
        }

        .state-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .state-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-purple);
        }

        .state-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Property Cards */
        .property-cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .property-card {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            width: 180px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .property-card:hover {
            border-color: var(--secondary-cyan);
            transform: translateY(-5px);
        }

        .property-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .property-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--secondary-cyan);
        }

        .property-example {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Measurement Tools Display */
        .tools-display {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        .tool-item {
            background: rgba(0, 188, 212, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            border-left: 3px solid var(--secondary-cyan);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tool-icon {
            font-size: 1.2rem;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .matter-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .matter-diagram {
                height: 250px;
            }
            
            .states-display {
                flex-direction: column;
                align-items: center;
            }
            
            .property-cards {
                flex-direction: column;
                align-items: center;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .float {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .spin {
            animation: spin 2s linear infinite;
        }
        
        @keyframes vibrate {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }
        
        .vibrate {
            animation: vibrate 0.3s ease infinite;
        }
        
        @keyframes melt {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(20px) scale(0.8); opacity: 0; }
        }
        
        .melt {
            animation: melt 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <!-- Background Slideshow -->
    <div class="slideshow" id="slideshow">
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1532094349884-543bc11b234d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1507146153580-69a1fe6d8aa1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1506102383123-c8ef1e872756?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80')"></div>
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 4 Science</h1>
            <p class="welcome-subtitle">Explore the amazing world of matter! Discover what everything around you is made of, learn about solids, liquids, and gases, and understand how matter changes from one state to another through exciting experiments and observations!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">ðŸ”¬</span>
                <span class="topic-name">Matter & Its Properties</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Matter Adventure</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 100</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 1%"></div>
                </div>
            </div>

            <div class="question-container">
                <h2 class="question-text" id="questionText"></h2>
                
                <!-- Matter fact display -->
                <div id="matterFact"></div>
                
                <!-- Matter display area -->
                <div id="matterDisplay"></div>
                
                <!-- Matter diagram -->
                <div id="matterDiagram"></div>
                
                <!-- States display -->
                <div id="statesDisplay"></div>
                
                <!-- Property cards display -->
                <div id="propertyCardsDisplay"></div>
                
                <!-- Tools display -->
                <div id="toolsDisplay"></div>
                
                <div class="options-container" id="optionsContainer"></div>
                
                <div class="feedback-container" id="feedbackContainer">
                    <div class="feedback-header">
                        <div class="feedback-icon"></div>
                        <div class="feedback-title"></div>
                    </div>
                    <div class="feedback-message"></div>
                    <div class="feedback-explanation"></div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Matter Exploration Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize slideshow
        function initSlideshow() {
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }

        // Questions array - 100 Grade 4 Science questions covering matter and its properties
        const questions = [
            // Basic Matter Concepts (1-30)
            {
                type: "basic",
                question: "What is matter?",
                options: ["Anything that has mass and takes up space", "Only solid things", "Only liquids and gases", "Things you can see"],
                answer: "A",
                explanation: "Matter is anything that has mass and volume (takes up space). Everything around you is matter!"
            },
            {
                type: "basic",
                question: "What are the three states of matter?",
                options: ["Solid, liquid, gas", "Hard, soft, medium", "Big, small, medium", "Hot, cold, warm"],
                answer: "A",
                explanation: "The three main states of matter are solid, liquid, and gas."
            },
            {
                type: "basic",
                question: "Which state of matter has a definite shape and volume?",
                options: ["Solid", "Liquid", "Gas", "Plasma"],
                answer: "A",
                explanation: "Solids have a definite shape and definite volume - they don't change shape easily."
            },
            {
                type: "basic",
                question: "Which state of matter has a definite volume but takes the shape of its container?",
                options: ["Liquid", "Solid", "Gas", "Plasma"],
                answer: "A",
                explanation: "Liquids have definite volume but take the shape of whatever container they're in."
            },
            {
                type: "basic",
                question: "Which state of matter has no definite shape or volume?",
                options: ["Gas", "Solid", "Liquid", "Plasma"],
                answer: "A",
                explanation: "Gases have no definite shape or volume - they expand to fill whatever container they're in."
            },
            {
                type: "basic",
                question: "What is an example of a solid?",
                options: ["Rock", "Water", "Air", "Steam"],
                answer: "A",
                explanation: "Rocks are solids - they have definite shape and volume."
            },
            {
                type: "basic",
                question: "What is an example of a liquid?",
                options: ["Water", "Ice", "Oxygen", "Wood"],
                answer: "A",
                explanation: "Water is a liquid at room temperature - it takes the shape of its container."
            },
            {
                type: "basic",
                question: "What is an example of a gas?",
                options: ["Air", "Ice", "Juice", "Table"],
                answer: "A",
                explanation: "Air is a mixture of gases (mostly nitrogen and oxygen)."
            },
            {
                type: "basic",
                question: "What is mass?",
                options: ["The amount of matter in an object", "How much space an object takes up", "How heavy something feels", "The color of an object"],
                answer: "A",
                explanation: "Mass is the amount of matter in an object, measured in grams or kilograms."
            },
            {
                type: "basic",
                question: "What is volume?",
                options: ["The amount of space matter takes up", "The weight of matter", "The color of matter", "The temperature of matter"],
                answer: "A",
                explanation: "Volume is the amount of space that matter occupies, measured in liters or cubic centimeters."
            },
            {
                type: "basic",
                question: "Which tool measures mass?",
                options: ["Balance scale", "Graduated cylinder", "Ruler", "Thermometer"],
                answer: "A",
                explanation: "A balance scale measures mass by comparing an object to known masses."
            },
            {
                type: "basic",
                question: "Which tool measures volume?",
                options: ["Graduated cylinder", "Balance scale", "Ruler", "Thermometer"],
                answer: "A",
                explanation: "A graduated cylinder measures the volume of liquids accurately."
            },
            {
                type: "basic",
                question: "What unit is used to measure mass?",
                options: ["Grams and kilograms", "Liters and milliliters", "Meters and centimeters", "Degrees Celsius"],
                answer: "A",
                explanation: "Mass is measured in grams (g) and kilograms (kg)."
            },
            {
                type: "basic",
                question: "What unit is used to measure volume of liquids?",
                options: ["Liters and milliliters", "Grams and kilograms", "Meters and centimeters", "Degrees Celsius"],
                answer: "A",
                explanation: "Liquid volume is measured in liters (L) and milliliters (mL)."
            },
            {
                type: "basic",
                question: "What is density?",
                options: ["How much mass is in a certain volume", "How heavy something feels", "How much space something takes", "The color of matter"],
                answer: "A",
                explanation: "Density is mass per unit volume - how much 'stuff' is packed into a space."
            },
            {
                type: "basic",
                question: "Which is more dense: a rock or a piece of wood the same size?",
                options: ["Rock", "Wood", "They have same density", "Cannot compare"],
                answer: "A",
                explanation: "A rock has more mass in the same volume, so it's more dense than wood."
            },
            {
                type: "basic",
                question: "What happens when you put a dense object in water?",
                options: ["It sinks", "It floats", "It disappears", "It changes color"],
                answer: "A",
                explanation: "Objects denser than water sink, while objects less dense than water float."
            },
            {
                type: "basic",
                question: "What is weight?",
                options: ["The force of gravity on an object's mass", "The amount of matter", "The volume of matter", "The color of matter"],
                answer: "A",
                explanation: "Weight is the force of gravity pulling on an object's mass. It can change with location."
            },
            {
                type: "basic",
                question: "How is weight different from mass?",
                options: ["Mass is amount of matter, weight is gravity's pull", "They are the same", "Mass changes, weight stays same", "No difference"],
                answer: "A",
                explanation: "Mass stays the same everywhere, while weight changes with gravity (less on Moon)."
            },
            {
                type: "basic",
                question: "What is everything in the universe made of?",
                options: ["Matter", "Energy only", "Light only", "Colors"],
                answer: "A",
                explanation: "Everything you can touch, see, and feel is made of matter!"
            },
            // Properties of Matter (31-60)
            {
                type: "properties",
                question: "What are physical properties?",
                options: ["Characteristics you can observe without changing matter", "How matter reacts with other substances", "When matter changes into new substance", "Only color and shape"],
                answer: "A",
                explanation: "Physical properties can be observed without changing what the matter is (color, texture, size)."
            },
            {
                type: "properties",
                question: "Which is a physical property?",
                options: ["Color", "Flammability", "Rusting", "Exploding"],
                answer: "A",
                explanation: "Color is a physical property you can observe without changing the substance."
            },
            {
                type: "properties",
                question: "What is texture?",
                options: ["How a surface feels", "The color of matter", "The weight of matter", "The smell of matter"],
                answer: "A",
                explanation: "Texture describes how something feels - smooth, rough, bumpy, soft, hard."
            },
            {
                type: "properties",
                question: "What is hardness?",
                options: ["How difficult it is to scratch a material", "How heavy something is", "How much space it takes", "Its color"],
                answer: "A",
                explanation: "Hardness measures how resistant a material is to being scratched."
            },
            {
                type: "properties",
                question: "What is flexibility?",
                options: ["Ability to bend without breaking", "How heavy something is", "How much space it takes", "Its color"],
                answer: "A",
                explanation: "Flexible materials can bend without breaking, like rubber bands."
            },
            {
                type: "properties",
                question: "What is magnetism?",
                options: ["Attraction to magnets", "Ability to float", "How heavy something is", "Its color"],
                answer: "A",
                explanation: "Magnetic materials like iron are attracted to magnets."
            },
            {
                type: "properties",
                question: "What is solubility?",
                options: ["Ability to dissolve in liquid", "Ability to float", "Ability to burn", "Ability to rust"],
                answer: "A",
                explanation: "Soluble substances dissolve in liquids (like sugar in water)."
            },
            {
                type: "properties",
                question: "What is conductivity?",
                options: ["Ability to allow heat or electricity to pass through", "Ability to float", "Ability to burn", "Ability to rust"],
                answer: "A",
                explanation: "Conductive materials let heat or electricity flow through them (metals are good conductors)."
            },
            {
                type: "properties",
                question: "Which material is a good conductor of heat?",
                options: ["Metal", "Wood", "Plastic", "Rubber"],
                answer: "A",
                explanation: "Metals like copper and aluminum are excellent conductors of heat."
            },
            {
                type: "properties",
                question: "Which material is an insulator?",
                options: ["Wood", "Copper", "Aluminum", "Iron"],
                answer: "A",
                explanation: "Wood is a good insulator - it doesn't conduct heat or electricity well."
            },
            {
                type: "properties",
                question: "What is transparency?",
                options: ["Ability to see through a material", "Ability to float", "Ability to burn", "Ability to rust"],
                answer: "A",
                explanation: "Transparent materials let light pass through clearly (glass, clear plastic)."
            },
            {
                type: "properties",
                question: "What is opacity?",
                options: ["Not letting light pass through", "Letting all light through", "Letting some light through", "Reflecting light"],
                answer: "A",
                explanation: "Opaque materials don't let any light pass through (wood, metal, most solids)."
            },
            {
                type: "properties",
                question: "What is translucency?",
                options: ["Letting some light through but not clearly", "Letting all light through clearly", "Not letting any light through", "Absorbing all light"],
                answer: "A",
                explanation: "Translucent materials let some light through but scatter it (wax paper, frosted glass)."
            },
            {
                type: "properties",
                question: "What is luster?",
                options: ["How shiny a material is", "How heavy it is", "How much space it takes", "Its color"],
                answer: "A",
                explanation: "Luster describes how much a material shines or reflects light."
            },
            {
                type: "properties",
                question: "What is malleability?",
                options: ["Ability to be hammered into thin sheets", "Ability to stretch", "Ability to float", "Ability to burn"],
                answer: "A",
                explanation: "Malleable materials can be hammered or pressed into shapes without breaking."
            },
            {
                type: "properties",
                question: "What is ductility?",
                options: ["Ability to be pulled into wires", "Ability to float", "Ability to burn", "Ability to rust"],
                answer: "A",
                explanation: "Ductile materials can be stretched into wires without breaking."
            },
            {
                type: "properties",
                question: "How can you compare the mass of two objects?",
                options: ["Use a balance scale", "Look at them", "Feel their weight", "Measure their volume"],
                answer: "A",
                explanation: "A balance scale compares masses by balancing objects against known masses."
            },
            {
                type: "properties",
                question: "How do you measure the volume of an irregular solid?",
                options: ["Water displacement method", "Using a ruler", "Using a scale", "Looking at it"],
                answer: "A",
                explanation: "Water displacement: measure water volume, add object, measure again, subtract to find object's volume."
            },
            {
                type: "properties",
                question: "What is buoyancy?",
                options: ["Ability to float in a fluid", "Ability to burn", "Ability to conduct electricity", "Ability to rust"],
                answer: "A",
                explanation: "Buoyant objects float because they're less dense than the fluid they're in."
            },
            {
                type: "properties",
                question: "Why do some objects float while others sink?",
                options: ["Objects less dense than water float", "Heavy objects float", "All objects can float", "Objects with air float"],
                answer: "A",
                explanation: "Density determines floating: objects less dense than water float, more dense sink."
            },
            // Changes in Matter (61-80)
            {
                type: "changes",
                question: "What is a physical change?",
                options: ["Change in appearance without becoming new substance", "Change into completely new substance", "Only melting", "Only freezing"],
                answer: "A",
                explanation: "Physical changes alter appearance but not what the substance is (cutting, melting, dissolving)."
            },
            {
                type: "changes",
                question: "Which is a physical change?",
                options: ["Cutting paper", "Burning paper", "Rusting iron", "Cooking egg"],
                answer: "A",
                explanation: "Cutting paper changes its shape/size but it's still paper - a physical change."
            },
            {
                type: "changes",
                question: "What is a chemical change?",
                options: ["Change that produces new substances", "Change only in appearance", "Melting ice", "Breaking glass"],
                answer: "A",
                explanation: "Chemical changes produce new substances with different properties (burning, rusting)."
            },
            {
                type: "changes",
                question: "Which is a chemical change?",
                options: ["Burning wood", "Melting butter", "Cutting vegetables", "Dissolving sugar"],
                answer: "A",
                explanation: "Burning wood produces ash and smoke - new substances (chemical change)."
            },
            {
                type: "changes",
                question: "What is melting?",
                options: ["Solid to liquid", "Liquid to solid", "Liquid to gas", "Gas to liquid"],
                answer: "A",
                explanation: "Melting is when a solid becomes a liquid (ice to water)."
            },
            {
                type: "changes",
                question: "What is freezing?",
                options: ["Liquid to solid", "Solid to liquid", "Liquid to gas", "Gas to liquid"],
                answer: "A",
                explanation: "Freezing is when a liquid becomes a solid (water to ice)."
            },
            {
                type: "changes",
                question: "What is evaporation?",
                options: ["Liquid to gas", "Gas to liquid", "Solid to liquid", "Liquid to solid"],
                answer: "A",
                explanation: "Evaporation is when a liquid becomes a gas (water to water vapor)."
            },
            {
                type: "changes",
                question: "What is condensation?",
                options: ["Gas to liquid", "Liquid to gas", "Solid to liquid", "Liquid to solid"],
                answer: "A",
                explanation: "Condensation is when a gas becomes a liquid (water vapor to water droplets)."
            },
            {
                type: "changes",
                question: "What is sublimation?",
                options: ["Solid directly to gas", "Gas directly to solid", "Liquid to gas", "Gas to liquid"],
                answer: "A",
                explanation: "Sublimation is when a solid turns directly into a gas (dry ice to carbon dioxide gas)."
            },
            {
                type: "changes",
                question: "What is deposition?",
                options: ["Gas directly to solid", "Solid directly to gas", "Liquid to solid", "Solid to liquid"],
                answer: "A",
                explanation: "Deposition is when a gas turns directly into a solid (frost forming from water vapor)."
            },
            {
                type: "changes",
                question: "What temperature does water freeze at?",
                options: ["0Â°C (32Â°F)", "100Â°C (212Â°F)", "50Â°C (122Â°F)", "-10Â°C (14Â°F)"],
                answer: "A",
                explanation: "Pure water freezes at 0Â°C (32Â°F) at sea level."
            },
            {
                type: "changes",
                question: "What temperature does water boil at?",
                options: ["100Â°C (212Â°F)", "0Â°C (32Â°F)", "50Â°C (122Â°F)", "150Â°C (302Â°F)"],
                answer: "A",
                explanation: "Pure water boils at 100Â°C (212Â°F) at sea level."
            },
            {
                type: "changes",
                question: "Is melting a physical or chemical change?",
                options: ["Physical change", "Chemical change", "Both", "Neither"],
                answer: "A",
                explanation: "Melting is physical - water and ice are the same substance (Hâ‚‚O), just different states."
            },
            {
                type: "changes",
                question: "Is burning a physical or chemical change?",
                options: ["Chemical change", "Physical change", "Both", "Neither"],
                answer: "A",
                explanation: "Burning is chemical - it produces new substances (ash, smoke, gases)."
            },
            {
                type: "changes",
                question: "What happens during dissolving?",
                options: ["Particles mix but substance doesn't change", "New substance forms", "Always chemical change", "Substance disappears"],
                answer: "A",
                explanation: "Dissolving is usually physical - particles mix but can be separated (salt in water)."
            },
            {
                type: "changes",
                question: "What is a mixture?",
                options: ["Two or more substances mixed but not chemically combined", "New substance formed", "Only solids mixed", "Only liquids mixed"],
                answer: "A",
                explanation: "Mixtures contain two or more substances physically combined that can be separated."
            },
            {
                type: "changes",
                question: "What is a solution?",
                options: ["Mixture where substances are evenly distributed", "Chemical combination", "Only solids mixed", "Always colored"],
                answer: "A",
                explanation: "A solution is a homogeneous mixture where particles are evenly distributed (salt water)."
            },
            {
                type: "changes",
                question: "What is a reversible change?",
                options: ["Change that can be undone", "Change that cannot be undone", "Only melting", "Only freezing"],
                answer: "A",
                explanation: "Reversible changes can be undone (ice melts to water, water freezes back to ice)."
            },
            {
                type: "changes",
                question: "What is an irreversible change?",
                options: ["Change that cannot be undone", "Change that can be undone", "Only melting", "Only freezing"],
                answer: "A",
                explanation: "Irreversible changes cannot be undone (burning paper, cooking egg)."
            },
            {
                type: "changes",
                question: "What causes matter to change states?",
                options: ["Adding or removing heat energy", "Changing color", "Changing shape", "Moving it"],
                answer: "A",
                explanation: "Adding or removing heat energy causes matter to change between solid, liquid, and gas states."
            },
            // Applications & Real World (81-100)
            {
                type: "applications",
                question: "Why do puddles disappear on sunny days?",
                options: ["Water evaporates into water vapor", "Water sinks into ground", "Water freezes", "Water changes color"],
                answer: "A",
                explanation: "Sunlight provides heat energy that causes water to evaporate into invisible water vapor."
            },
            {
                type: "applications",
                question: "Why do ice cubes melt in a drink?",
                options: ["Drink transfers heat to ice", "Ice dissolves", "Ice evaporates", "Drink freezes"],
                answer: "A",
                explanation: "The warmer drink transfers heat energy to the ice, causing it to melt."
            },
            {
                type: "applications",
                question: "Why do mirrors fog up in the bathroom?",
                options: ["Water vapor condenses on cool surface", "Mirror melts", "Mirror evaporates", "Mirror dissolves"],
                answer: "A",
                explanation: "Hot shower produces water vapor that condenses on the cooler mirror surface."
            },
            {
                type: "applications",
                question: "Why does metal feel colder than wood at same temperature?",
                options: ["Metal conducts heat away from hand faster", "Metal is actually colder", "Wood produces heat", "Metal evaporates"],
                answer: "A",
                explanation: "Metal is a better heat conductor, so it pulls heat from your hand faster, feeling colder."
            },
            {
                type: "applications",
                question: "Why do we use oven mitts?",
                options: ["They are insulators that protect from heat", "They look nice", "They conduct heat", "They absorb heat"],
                answer: "A",
                explanation: "Oven mitts are insulators - they don't conduct heat well, protecting hands from hot pans."
            },
            {
                type: "applications",
                question: "Why do balloons float with helium but not with air?",
                options: ["Helium is less dense than air", "Helium is heavier", "Air makes balloons heavy", "Helium is sticky"],
                answer: "A",
                explanation: "Helium is less dense than air, so helium-filled balloons float upward."
            },
            {
                type: "applications",
                question: "Why does ice float in water?",
                options: ["Ice is less dense than liquid water", "Ice is heavier", "Water pushes it up", "Ice has air bubbles"],
                answer: "A",
                explanation: "Water expands when it freezes, making ice less dense than liquid water, so it floats."
            },
            {
                type: "applications",
                question: "Why do we add salt to icy roads?",
                options: ["Salt lowers freezing point of water", "Salt melts ice chemically", "Salt makes ice evaporate", "Salt colors the ice"],
                answer: "A",
                explanation: "Salt dissolves in water, lowering its freezing point, helping melt ice on roads."
            },
            {
                type: "applications",
                question: "Why does a full soda can float but an empty one sinks?",
                options: ["Air inside makes it less dense than water", "Soda is lighter than water", "Can material changes", "Empty can is heavier"],
                answer: "A",
                explanation: "The air in a sealed soda can makes it less dense than water, so it floats."
            },
            {
                type: "applications",
                question: "Why do clouds form?",
                options: ["Water vapor condenses into tiny droplets", "Air solidifies", "Water evaporates upward", "Clouds are solid"],
                answer: "A",
                explanation: "Warm air rises, cools, and water vapor condenses into tiny droplets that form clouds."
            },
            {
                type: "applications",
                question: "Why does chocolate melt in your hand?",
                options: ["Body heat transfers to chocolate", "Chocolate dissolves", "Hand absorbs chocolate", "Air melts it"],
                answer: "A",
                explanation: "Your hand is warmer than chocolate's melting point, transferring heat that melts it."
            },
            {
                type: "applications",
                question: "Why do we see our breath on cold days?",
                options: ["Water vapor in breath condenses in cold air", "We breathe out smoke", "Air freezes coming out", "Magic"],
                answer: "A",
                explanation: "Warm, moist breath meets cold air, causing water vapor to condense into visible droplets."
            },
            {
                type: "applications",
                question: "Why do bridges have expansion joints?",
                options: ["Metals expand when heated, contract when cooled", "For decoration", "To let water through", "To make noise"],
                answer: "A",
                explanation: "Metal expands in heat and contracts in cold - joints allow movement without damage."
            },
            {
                type: "applications",
                question: "Why do cooks use wooden spoons?",
                options: ["Wood is poor heat conductor so handles stay cool", "Wood tastes better", "Wood is stronger", "Wood dissolves"],
                answer: "A",
                explanation: "Wood is an insulator, so spoon handles don't conduct heat from hot food to cook's hand."
            },
            {
                type: "applications",
                question: "Why does popcorn pop?",
                options: ["Water inside kernel turns to steam and expands", "Kernel explodes chemically", "Heat melts it", "Air inside expands"],
                answer: "A",
                explanation: "Kernel moisture turns to steam when heated, building pressure until kernel pops open."
            },
            {
                type: "applications",
                question: "Why do we see rainbows after rain?",
                options: ["Sunlight refracts through water droplets", "Rain has colors", "Sky changes color", "Magic"],
                answer: "A",
                explanation: "Sunlight bends (refracts) through raindrops, separating into colors of the rainbow."
            },
            {
                type: "applications",
                question: "Why does bread rise when baked?",
                options: ["Yeast produces gas bubbles that expand with heat", "Bread melts", "Bread absorbs water", "Magic"],
                answer: "A",
                explanation: "Yeast produces carbon dioxide gas; heat causes gas bubbles to expand, making bread rise."
            },
            {
                type: "applications",
                question: "Why do mercury thermometers work?",
                options: ["Mercury expands when heated, contracts when cooled", "Mercury changes color", "Mercury evaporates", "Mercury dissolves"],
                answer: "A",
                explanation: "Mercury expands uniformly when heated, rising in narrow tube to show temperature."
            },
            {
                type: "applications",
                question: "Why do we refrigerate food?",
                options: ["Cold slows down chemical changes and bacteria growth", "Cold makes food taste better", "Cold kills all bacteria", "Cold evaporates moisture"],
                answer: "A",
                explanation: "Cold temperatures slow chemical reactions and bacterial growth, keeping food fresh longer."
            },
            {
                type: "applications",
                question: "Why does a candle get shorter as it burns?",
                options: ["Wax melts, then vaporizes and burns", "Wax disappears", "Wax sinks into candle", "Wax evaporates without burning"],
                answer: "A",
                explanation: "Heat melts wax, which travels up wick, vaporizes, and burns - turning into new substances."
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent matter knowledge!",
            "Fantastic properties understanding!",
            "Great job! You're a matter expert!",
            "Amazing! Your physical science skills are impressive!",
            "Well done! Perfect answer!",
            "You're a chemistry champion!",
            "Perfect! You understand matter properties!",
            "Outstanding science knowledge!",
            "Brilliant! You think like a scientist!",
            "You're on fire! Great matter insight!"
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const matterFact = document.getElementById('matterFact');
        const matterDisplay = document.getElementById('matterDisplay');
        const matterDiagram = document.getElementById('matterDiagram');
        const statesDisplay = document.getElementById('statesDisplay');
        const propertyCardsDisplay = document.getElementById('propertyCardsDisplay');
        const toolsDisplay = document.getElementById('toolsDisplay');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initSlideshow();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade4ScienceMatter');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade4ScienceMatter', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade4ScienceMatter_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade4ScienceMatter_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a matter and properties expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent physical science knowledge!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep exploring to become a chemistry master!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review what you missed and try again!";
            } else {
                scoreMessage.textContent = "Keep exploring! Science knowledge grows with curiosity!";
            }
        }

        // Create matter fact display
        function createMatterFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'matter-fact';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "basic") {
                factDiv.innerHTML = `
                    <strong>Science Fact:</strong> All matter is made of tiny particles called atoms! 
                    There are about 100 different types of atoms that combine to make everything in the universe.
                `;
            } else if (question.type === "properties") {
                factDiv.innerHTML = `
                    <strong>Science Fact:</strong> Properties help us identify and classify matter! 
                    Some properties, like density and conductivity, are crucial for materials used in technology.
                `;
            } else if (question.type === "changes") {
                factDiv.innerHTML = `
                    <strong>Science Fact:</strong> Matter can change states with temperature changes! 
                    The same water molecule can be ice (solid), water (liquid), or steam (gas) - just add or remove heat!
                `;
            } else if (question.type === "applications") {
                factDiv.innerHTML = `
                    <strong>Science Fact:</strong> Understanding matter helps us solve real-world problems! 
                    From cooking food to building bridges, we use matter properties every day without realizing it!
                `;
            }
            
            return factDiv;
        }

        // Create matter diagram
        function createMatterDiagram() {
            const container = document.createElement('div');
            container.className = 'matter-diagram';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "basic" || question.type === "changes") {
                container.innerHTML = `
                    <div class="matter-element" style="top: 10%; left: 50%; transform: translateX(-50%);">
                        <div class="matter-element-icon">ðŸ§Š</div>
                        <div class="matter-element-label">Solid</div>
                    </div>
                    <div class="matter-element" style="top: 40%; left: 20%;">
                        <div class="matter-element-icon">ðŸ’§</div>
                        <div class="matter-element-label">Liquid</div>
                    </div>
                    <div class="matter-element" style="top: 40%; left: 80%;">
                        <div class="matter-element-icon">ðŸ’¨</div>
                        <div class="matter-element-label">Gas</div>
                    </div>
                    <div class="matter-element" style="top: 70%; left: 50%; transform: translateX(-50%);">
                        <div class="matter-element-icon">ðŸ”¥</div>
                        <div class="matter-element-label">Heat</div>
                    </div>
                `;
            } else if (question.type === "properties") {
                container.innerHTML = `
                    <div class="matter-element" style="top: 10%; left: 30%;">
                        <div class="matter-element-icon">âš–ï¸</div>
                        <div class="matter-element-label">Mass</div>
                    </div>
                    <div class="matter-element" style="top: 10%; left: 70%;">
                        <div class="matter-element-icon">ðŸ“</div>
                        <div class="matter-element-label">Volume</div>
                    </div>
                    <div class="matter-element" style="top: 50%; left: 50%; transform: translateX(-50%);">
                        <div class="matter-element-icon">ðŸ”</div>
                        <div class="matter-element-label">Properties</div>
                    </div>
                    <div class="matter-element" style="top: 80%; left: 50%; transform: translateX(-50%);">
                        <div class="matter-element-icon">ðŸ§ª</div>
                        <div class="matter-element-label">Experiment</div>
                    </div>
                `;
            } else if (question.type === "applications") {
                container.innerHTML = `
                    <div class="matter-element" style="top: 10%; left: 50%; transform: translateX(-50%);">
                        <div class="matter-element-icon">ðŸ </div>
                        <div class="matter-element-label">Home</div>
                    </div>
                    <div class="matter-element" style="top: 40%; left: 20%;">
                        <div class="matter-element-icon">ðŸ³</div>
                        <div class="matter-element-label">Cooking</div>
                    </div>
                    <div class="matter-element" style="top: 40%; left: 80%;">
                        <div class="matter-element-icon">ðŸš—</div>
                        <div class="matter-element-label">Transport</div>
                    </div>
                    <div class="matter-element" style="top: 70%; left: 50%; transform: translateX(-50%);">
                        <div class="matter-element-icon">ðŸ—ï¸</div>
                        <div class="matter-element-label">Building</div>
                    </div>
                `;
            }
            
            return container;
        }

        // Create matter display
        function createMatterDisplay() {
            const display = document.createElement('div');
            display.className = 'matter-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const matterIcons = {
                "solid": "ðŸ§Š",
                "liquid": "ðŸ’§",
                "gas": "ðŸ’¨",
                "mass": "âš–ï¸",
                "volume": "ðŸ“",
                "density": "ðŸ“Š",
                "property": "ðŸ”",
                "change": "ðŸ”„",
                "physical": "âœ‚ï¸",
                "chemical": "ðŸ”¥",
                "melting": "ðŸ« ",
                "freezing": "â„ï¸",
                "evaporation": "â˜€ï¸",
                "condensation": "ðŸ’¦",
                "matter": "ðŸ”¬"
            };
            
            let matterName = "Matter";
            let matterIcon = "ðŸ”¬";
            
            const questionText = question.question.toLowerCase();
            const options = question.options;
            
            if (questionText.includes("solid") || options.some(opt => opt.includes("solid"))) {
                matterName = "Solid";
                matterIcon = matterIcons.solid;
            } else if (questionText.includes("liquid") || options.some(opt => opt.includes("liquid"))) {
                matterName = "Liquid";
                matterIcon = matterIcons.liquid;
            } else if (questionText.includes("gas") || options.some(opt => opt.includes("gas"))) {
                matterName = "Gas";
                matterIcon = matterIcons.gas;
            } else if (questionText.includes("mass") || options.some(opt => opt.includes("mass"))) {
                matterName = "Mass";
                matterIcon = matterIcons.mass;
            } else if (questionText.includes("volume") || options.some(opt => opt.includes("volume"))) {
                matterName = "Volume";
                matterIcon = matterIcons.volume;
            } else if (questionText.includes("density") || options.some(opt => opt.includes("density"))) {
                matterName = "Density";
                matterIcon = matterIcons.density;
            } else if (questionText.includes("melting") || options.some(opt => opt.includes("melting"))) {
                matterName = "Melting";
                matterIcon = matterIcons.melting;
            } else if (questionText.includes("freezing") || options.some(opt => opt.includes("freezing"))) {
                matterName = "Freezing";
                matterIcon = matterIcons.freezing;
            } else if (questionText.includes("evaporation") || options.some(opt => opt.includes("evaporation"))) {
                matterName = "Evaporation";
                matterIcon = matterIcons.evaporation;
            } else if (questionText.includes("condensation") || options.some(opt => opt.includes("condensation"))) {
                matterName = "Condensation";
                matterIcon = matterIcons.condensation;
            } else if (question.type === "properties") {
                matterName = "Property";
                matterIcon = matterIcons.property;
            } else if (question.type === "changes") {
                matterName = "Change";
                matterIcon = matterIcons.change;
            } else if (question.type === "applications") {
                matterName = "Application";
                matterIcon = matterIcons.matter;
            }
            
            const matterBox = document.createElement('div');
            matterBox.className = 'matter-box grow';
            matterBox.innerHTML = `
                <div class="matter-icon">${matterIcon}</div>
                <div class="matter-text">${matterName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'matter-label';
            
            if (question.type === "basic") {
                label.textContent = "What is this matter concept?";
            } else if (question.type === "properties") {
                label.textContent = "What is this property of matter?";
            } else if (question.type === "changes") {
                label.textContent = "What is this change in matter?";
            } else if (question.type === "applications") {
                label.textContent = "How is this matter principle applied?";
            }
            
            display.appendChild(matterBox);
            display.appendChild(label);
            
            return display;
        }

        // Create states display
        function createStatesDisplay() {
            const display = document.createElement('div');
            display.className = 'states-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "basic" || question.type === "changes") {
                display.innerHTML = `
                    <div class="state-card">
                        <div class="state-icon">ðŸ§Š</div>
                        <div class="state-title">Solid</div>
                        <div class="state-description">Definite shape and volume, particles packed tightly</div>
                    </div>
                    <div class="state-card">
                        <div class="state-icon">ðŸ’§</div>
                        <div class="state-title">Liquid</div>
                        <div class="state-description">Definite volume, takes container shape, particles slide past</div>
                    </div>
                    <div class="state-card">
                        <div class="state-icon">ðŸ’¨</div>
                        <div class="state-title">Gas</div>
                        <div class="state-description">No definite shape or volume, particles move freely</div>
                    </div>
                `;
            } else if (question.type === "properties") {
                display.innerHTML = `
                    <div class="state-card">
                        <div class="state-icon">ðŸ‘ï¸</div>
                        <div class="state-title">Observable</div>
                        <div class="state-description">Color, texture, size, shape - seen without changing matter</div>
                    </div>
                    <div class="state-card">
                        <div class="state-icon">âš–ï¸</div>
                        <div class="state-title">Measurable</div>
                        <div class="state-description">Mass, volume, density - require measurement tools</div>
                    </div>
                    <div class="state-card">
                        <div class="state-icon">ðŸ”¬</div>
                        <div class="state-title">Behavioral</div>
                        <div class="state-description">Magnetism, conductivity, solubility - how matter behaves</div>
                    </div>
                `;
            }
            
            return display;
        }

        // Create property cards display
        function createPropertyCardsDisplay() {
            const display = document.createElement('div');
            display.className = 'property-cards';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "properties") {
                display.innerHTML = `
                    <div class="property-card">
                        <div class="property-icon">ðŸŽ¨</div>
                        <div class="property-name">Color</div>
                        <div class="property-example">Red, blue, yellow, etc.</div>
                    </div>
                    <div class="property-card">
                        <div class="property-icon">âœ‹</div>
                        <div class="property-name">Texture</div>
                        <div class="property-example">Smooth, rough, bumpy</div>
                    </div>
                    <div class="property-card">
                        <div class="property-icon">âš–ï¸</div>
                        <div class="property-name">Mass</div>
                        <div class="property-example">Amount of matter</div>
                    </div>
                    <div class="property-card">
                        <div class="property-icon">ðŸ“</div>
                        <div class="property-name">Volume</div>
                        <div class="property-example">Space occupied</div>
                    </div>
                `;
            } else if (question.type === "changes") {
                display.innerHTML = `
                    <div class="property-card">
                        <div class="property-icon">ðŸ« </div>
                        <div class="property-name">Melting</div>
                        <div class="property-example">Solid â†’ Liquid</div>
                    </div>
                    <div class="property-card">
                        <div class="property-icon">â„ï¸</div>
                        <div class="property-name">Freezing</div>
                        <div class="property-example">Liquid â†’ Solid</div>
                    </div>
                    <div class="property-card">
                        <div class="property-icon">â˜€ï¸</div>
                        <div class="property-name">Evaporation</div>
                        <div class="property-example">Liquid â†’ Gas</div>
                    </div>
                    <div class="property-card">
                        <div class="property-icon">ðŸ’¦</div>
                        <div class="property-name">Condensation</div>
                        <div class="property-example">Gas â†’ Liquid</div>
                    </div>
                `;
            }
            
            return display;
        }

        // Create tools display
        function createToolsDisplay() {
            const display = document.createElement('div');
            display.className = 'tools-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            if (question.type === "basic" || question.type === "properties") {
                display.innerHTML = `
                    <div class="tool-item">
                        <span class="tool-icon">âš–ï¸</span>
                        <span>Balance Scale - measures mass</span>
                    </div>
                    <div class="tool-item">
                        <span class="tool-icon">ðŸ§ª</span>
                        <span>Graduated Cylinder - measures volume</span>
                    </div>
                    <div class="tool-item">
                        <span class="tool-icon">ðŸ“</span>
                        <span>Ruler - measures length</span>
                    </div>
                    <div class="tool-item">
                        <span class="tool-icon">ðŸŒ¡ï¸</span>
                        <span>Thermometer - measures temperature</span>
                    </div>
                `;
            } else if (question.type === "changes") {
                display.innerHTML = `
                    <div class="tool-item">
                        <span class="tool-icon">ðŸ”¥</span>
                        <span>Heat Source - causes state changes</span>
                    </div>
                    <div class="tool-item">
                        <span class="tool-icon">â„ï¸</span>
                        <span>Cold Source - causes freezing</span>
                    </div>
                    <div class="tool-item">
                        <span class="tool-icon">ðŸ”</span>
                        <span>Microscope - observes particles</span>
                    </div>
                    <div class="tool-item">
                        <span class="tool-icon">âš—ï¸</span>
                        <span>Beaker - holds substances</span>
                    </div>
                `;
            }
            
            return display;
        }

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            matterFact.innerHTML = '';
            matterDisplay.innerHTML = '';
            matterDiagram.innerHTML = '';
            statesDisplay.innerHTML = '';
            propertyCardsDisplay.innerHTML = '';
            toolsDisplay.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            matterFact.appendChild(createMatterFact());
            matterDisplay.appendChild(createMatterDisplay());
            matterDiagram.appendChild(createMatterDiagram());
            
            if (question.type === "basic" || question.type === "properties" || question.type === "changes") {
                statesDisplay.appendChild(createStatesDisplay());
            }
            
            if (question.type === "properties" || question.type === "changes") {
                propertyCardsDisplay.appendChild(createPropertyCardsDisplay());
            }
            
            toolsDisplay.appendChild(createToolsDisplay());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = 'âœ“';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = 'âœ—';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
