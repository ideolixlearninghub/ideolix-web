<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade 6 English - Punctuation & Capitalization | Ideolix Learning Hub</title>
    <style>
        /* CSS Variables for Punctuation Theme */
        :root {
            --primary-blue: #2196F3;
            --secondary-teal: #009688;
            --accent-yellow: #FFEB3B;
            --accent-green: #4CAF50;
            --accent-orange: #FF9800;
            --accent-purple: #9C27B0;
            --accent-red: #F44336;
            --dark-bg: #121212;
            --dark-surface: #1E1E1E;
            --dark-card: #252525;
            --dark-border: #333;
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0B0;
            --text-muted: #888;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --punctuation-glow: 0 0 20px rgba(33, 150, 243, 0.4);
            --capitalization-glow: 0 0 20px rgba(0, 150, 136, 0.4);
            --correction-glow: 0 0 20px rgba(255, 235, 59, 0.4);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Punctuation Pattern Background */
        .punctuation-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 30%, rgba(33, 150, 243, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 150, 136, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 235, 59, 0.1) 0%, transparent 50%);
            opacity: 0.3;
        }

        .floating-element {
            position: absolute;
            font-size: 3rem;
            font-weight: bold;
            animation: floatElement 25s linear infinite;
        }

        @keyframes floatElement {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.1; }
            25% { transform: translateY(-150px) translateX(100px) rotate(90deg); opacity: 0.05; }
            50% { transform: translateY(-50px) translateX(-150px) rotate(180deg); opacity: 0.1; }
            75% { transform: translateY(150px) translateX(50px) rotate(270deg); opacity: 0.05; }
            100% { transform: translateY(0) translateX(0) rotate(360deg); opacity: 0.1; }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: -1;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            background: var(--dark-surface);
            padding: 15px 25px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(10px);
        }

        .logo {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--dark-card);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-info {
            flex: 1;
        }

        .brand-info h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .brand-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        /* Card Styles */
        .card {
            background: var(--dark-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--dark-border);
            backdrop-filter: blur(5px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--punctuation-glow);
        }

        /* Welcome Page */
        .welcome-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-logo {
            width: 140px;
            height: 140px;
            margin-bottom: 25px;
            border-radius: 20px;
            overflow: hidden;
            background-color: var(--dark-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .welcome-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .welcome-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
        }

        .topic-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(33, 150, 243, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            margin-bottom: 25px;
            border: 1px solid var(--primary-blue);
        }

        .topic-icon {
            font-size: 1.5rem;
        }

        .topic-name {
            font-weight: 600;
            color: var(--primary-blue);
        }

        .input-group {
            width: 100%;
            max-width: 500px;
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            text-align: left;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            font-size: 1.1rem;
            background: var(--dark-surface);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        /* Buttons */
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        .btn-primary:hover {
            background: #1976D2;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.5);
        }

        .btn-secondary {
            background: var(--secondary-teal);
            color: #212121;
            box-shadow: 0 4px 15px rgba(0, 150, 136, 0.4);
        }

        .btn-secondary:hover {
            background: #00796B;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 150, 136, 0.5);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-blue);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Practice Mode */
        .practice-page {
            display: none;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar {
            height: 12px;
            background: var(--dark-surface);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-blue), var(--secondary-teal));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 25px;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .language-fact {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-yellow);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 992px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }

        .question-side {
            display: flex;
            flex-direction: column;
        }

        .visualization-side {
            display: flex;
            flex-direction: column;
        }

        .concept-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .concept-box {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal));
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .concept-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .concept-label {
            font-size: 1rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 5px;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }

        .option {
            padding: 18px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.05);
            transform: translateY(-2px);
        }

        .option.correct {
            background: rgba(33, 150, 243, 0.1);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .option.incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-color: #F44336;
            color: #F44336;
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--dark-card);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
            background: var(--secondary-teal);
            color: #212121;
        }

        .option.correct .option-letter {
            background: var(--primary-blue);
            color: white;
        }

        .option.incorrect .option-letter {
            background: #F44336;
            color: white;
        }

        .feedback-container {
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            display: none;
        }

        .feedback-correct {
            background: rgba(33, 150, 243, 0.1);
            border-left: 5px solid var(--primary-blue);
        }

        .feedback-incorrect {
            background: rgba(244, 67, 54, 0.1);
            border-left: 5px solid #F44336;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .feedback-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }

        .feedback-correct .feedback-icon {
            background: var(--primary-blue);
        }

        .feedback-incorrect .feedback-icon {
            background: #F44336;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct .feedback-title {
            color: var(--primary-blue);
        }

        .feedback-incorrect .feedback-title {
            color: #F44336;
        }

        .feedback-message {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feedback-explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: var(--text-secondary);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Visualization Components */
        .visualization-container {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 25px;
            height: 100%;
            border: 1px solid var(--dark-border);
            overflow: auto;
            backdrop-filter: blur(5px);
        }

        /* Punctuation Display */
        .punctuation-display {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid var(--accent-yellow);
            text-align: center;
        }

        .display-title {
            color: var(--primary-blue);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
            font-size: 1.3rem;
        }

        /* Punctuation vs Capitalization Comparison */
        .comparison-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .comparison-box {
            background: var(--dark-card);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            min-width: 200px;
            transition: transform 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .comparison-box.punctuation {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .comparison-box.capitalization {
            border-color: var(--secondary-teal);
            background: rgba(0, 150, 136, 0.1);
        }

        .comparison-box:hover {
            transform: scale(1.05);
        }

        .comparison-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .comparison-box.punctuation .comparison-name {
            color: var(--primary-blue);
        }

        .comparison-box.capitalization .comparison-name {
            color: var(--secondary-teal);
        }

        .comparison-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        /* Punctuation Marks */
        .punctuation-marks-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-green);
        }

        .marks-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .marks-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .mark-box {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .mark-box:hover {
            transform: translateY(-3px);
        }

        .mark-box.period {
            border-color: var(--primary-blue);
            background: rgba(33, 150, 243, 0.1);
        }

        .mark-box.comma {
            border-color: var(--secondary-teal);
            background: rgba(0, 150, 136, 0.1);
        }

        .mark-box.question {
            border-color: var(--accent-orange);
            background: rgba(255, 152, 0, 0.1);
        }

        .mark-box.exclamation {
            border-color: var(--accent-red);
            background: rgba(244, 67, 54, 0.1);
        }

        .mark-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .mark-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .mark-box.period .mark-name {
            color: var(--primary-blue);
        }

        .mark-box.comma .mark-name {
            color: var(--secondary-teal);
        }

        .mark-box.question .mark-name {
            color: var(--accent-orange);
        }

        .mark-box.exclamation .mark-name {
            color: var(--accent-red);
        }

        .mark-usage {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Capitalization Rules */
        .capitalization-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-orange);
        }

        .capitalization-rules {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .capitalization-rules {
                grid-template-columns: 1fr;
            }
        }

        .rule-box {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .rule-box:hover {
            transform: translateY(-3px);
        }

        .rule-box.proper-noun {
            border-color: var(--accent-green);
            background: rgba(76, 175, 80, 0.1);
        }

        .rule-box.sentence-start {
            border-color: var(--accent-orange);
            background: rgba(255, 152, 0, 0.1);
        }

        .rule-box.title {
            border-color: var(--accent-purple);
            background: rgba(156, 39, 176, 0.1);
        }

        .rule-box.pronoun-i {
            border-color: var(--accent-yellow);
            background: rgba(255, 235, 59, 0.1);
        }

        .rule-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .rule-name {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .rule-box.proper-noun .rule-name {
            color: var(--accent-green);
        }

        .rule-box.sentence-start .rule-name {
            color: var(--accent-orange);
        }

        .rule-box.title .rule-name {
            color: var(--accent-purple);
        }

        .rule-box.pronoun-i .rule-name {
            color: var(--accent-yellow);
        }

        .rule-example {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Sentence Correction */
        .correction-container {
            background: var(--dark-card);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--accent-purple);
        }

        .sentence-display {
            background: var(--dark-surface);
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 1.3rem;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--dark-border);
        }

        .correction-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .correction-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-purple);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .correction-button:hover {
            background: rgba(156, 39, 176, 0.1);
            transform: translateY(-2px);
        }

        /* Punctuation Table */
        .punctuation-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--dark-card);
            border-radius: 8px;
            overflow: hidden;
        }

        .punctuation-table th {
            background: var(--dark-surface);
            padding: 12px;
            text-align: left;
            color: var(--accent-yellow);
            border-bottom: 2px solid var(--accent-yellow);
        }

        .punctuation-table td {
            padding: 10px;
            border-bottom: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        .punctuation-table tr:hover {
            background: rgba(255, 235, 59, 0.05);
        }

        /* Interactive Practice */
        .interactive-practice {
            background: var(--dark-card);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid var(--accent-red);
        }

        .practice-title {
            color: var(--accent-red);
            margin-bottom: 15px;
            font-weight: bold;
            text-align: center;
        }

        .practice-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .practice-button {
            padding: 10px 20px;
            background: var(--dark-surface);
            border: 2px solid var(--accent-red);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-button:hover {
            background: rgba(244, 67, 54, 0.1);
            transform: translateY(-2px);
        }

        .practice-display {
            background: var(--dark-surface);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Results Page */
        .results-page {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .results-title {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .score-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--dark-border);
        }

        .score-value {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .score-percentage {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .score-message {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: var(--dark-surface);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .score-value {
                font-size: 3rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .concept-box {
                min-width: 140px;
                font-size: 1.5rem;
                padding: 15px 20px;
            }
            
            .marks-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .capitalization-rules {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease;
        }
        
        @keyframes grow {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .grow {
            animation: grow 0.5s ease forwards;
        }
        
        @keyframes punctuationBounce {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.1); }
            100% { transform: translateY(0) scale(1); }
        }
        
        .punctuation-bounce {
            animation: punctuationBounce 1s ease infinite;
        }
        
        @keyframes capitalizationGlow {
            0% { box-shadow: 0 0 5px rgba(0, 150, 136, 0.5); }
            50% { box-shadow: 0 0 20px rgba(0, 150, 136, 0.8); }
            100% { box-shadow: 0 0 5px rgba(0, 150, 136, 0.5); }
        }
        
        .capitalization-glow {
            animation: capitalizationGlow 2s ease-in-out infinite;
        }
        
        @keyframes correctionSlide {
            0% { transform: translateX(-100px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .correction-slide {
            animation: correctionSlide 0.5s ease forwards;
        }
        
        @keyframes markHighlight {
            0% { background-color: rgba(33, 150, 243, 0.1); }
            50% { background-color: rgba(33, 150, 243, 0.3); }
            100% { background-color: rgba(33, 150, 243, 0.1); }
        }
        
        .mark-highlight {
            animation: markHighlight 1.5s ease infinite;
        }
    </style>
</head>
<body>
    <!-- Punctuation Pattern Background -->
    <div class="punctuation-bg" id="punctuationBg">
        <!-- Elements will be generated by JavaScript -->
    </div>
    <div class="overlay"></div>

    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <div class="brand-info">
                <h1>Ideolix Learning Hub</h1>
                <p>Building learners for a digital future.</p>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-outline btn-small" id="backToTopics">Other Topics</button>
                <button class="btn btn-outline btn-small" id="backToHome">Home</button>
            </div>
        </header>

        <!-- Welcome Page -->
        <div class="welcome-page card fade-in" id="welcomePage">
            <div class="welcome-logo">
                <img src="https://raw.githubusercontent.com/ideolixlearninghub/ideolix-web/main/ideolix%20LOGO.jpg" alt="Ideolix Logo">
            </div>
            <h1 class="welcome-title">Grade 6 English</h1>
            <p class="welcome-subtitle">Master the art of clear writing! Explore punctuation marks and capitalization rules - learn how to use them correctly to make your writing clear, organized, and professional. Discover when to use commas, periods, question marks, and exclamation points. Learn the rules for capitalizing proper nouns, titles, and the beginning of sentences!</p>
            
            <div class="topic-badge">
                <span class="topic-icon">üî§‚ú®üìù</span>
                <span class="topic-name">Punctuation & Capitalization</span>
            </div>
            
            <div class="input-group">
                <label for="studentName">Enter your full name:</label>
                <input type="text" id="studentName" placeholder="Your full name">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="startPractice">
                    <span>Start Writing Journey</span>
                </button>
            </div>
        </div>

        <!-- Practice Page -->
        <div class="practice-page card fade-in" id="practicePage">
            <div class="progress-container">
                <div class="progress-info">
                    <span id="studentNameDisplay"></span>
                    <span id="progressText">Question 1 of 120</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0.8%"></div>
                </div>
            </div>

            <div class="question-container">
                <!-- Language fact display -->
                <div id="languageFact"></div>
                
                <!-- Concept display area -->
                <div id="conceptDisplay"></div>
                
                <!-- Content Wrapper: Questions on left, Visualizations on right -->
                <div class="content-wrapper" id="contentWrapper">
                    <!-- Left side: Question and Options -->
                    <div class="question-side">
                        <h2 class="question-text" id="questionText"></h2>
                        
                        <div class="options-container" id="optionsContainer"></div>
                        
                        <div class="feedback-container" id="feedbackContainer">
                            <div class="feedback-header">
                                <div class="feedback-icon"></div>
                                <div class="feedback-title"></div>
                            </div>
                            <div class="feedback-message"></div>
                            <div class="feedback-explanation"></div>
                        </div>
                    </div>
                    
                    <!-- Right side: Visualizations -->
                    <div class="visualization-side">
                        <div class="visualization-container" id="visualizationContainer">
                            <!-- All visualizations will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="skipQuestion">Skip Question</button>
                    <button class="btn btn-primary" id="nextQuestion" disabled>Next Question</button>
                </div>
            </div>
        </div>

        <!-- Results Page -->
        <div class="results-page card fade-in" id="resultsPage">
            <h2 class="results-title">Writing Mastery Complete!</h2>
            
            <div class="score-card">
                <div class="score-value" id="finalScore">0</div>
                <div class="score-percentage" id="scorePercentage">0%</div>
                <div class="score-message" id="scoreMessage"></div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="incorrectAnswers">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="skippedQuestions">0</div>
                        <div class="stat-label">Skipped Questions</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="highestScore">0</div>
                        <div class="stat-label">Highest Score</div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" id="retryTopic">Try Again</button>
                <button class="btn btn-secondary" id="viewTopics">Explore Other Topics</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize background
        function initBackground() {
            const punctuationBg = document.getElementById('punctuationBg');
            
            // Create floating punctuation symbols
            const elements = ['üî§', '‚ú®', 'üìù', '‚ùó', '‚ùì', '‚è∏Ô∏è', '‚è∫Ô∏è', 'üî†', 'üî°', 'üî£', 'üî§', 'üìÑ', '‚úèÔ∏è', 'üìö', '.', ',', '?', '!', '"', "'", ':', ';', '-', '()'];
            
            for (let i = 0; i < 25; i++) {
                const element = document.createElement('div');
                element.className = 'floating-element';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = `${Math.random() * 100}%`;
                element.style.top = `${Math.random() * 100}%`;
                element.style.animationDelay = `${Math.random() * 20}s`;
                element.style.fontSize = `${2 + Math.random() * 3}rem`;
                
                // Color different types
                if (['.', ',', ';', ':', '‚è∏Ô∏è', '‚è∫Ô∏è'].includes(element.textContent)) {
                    element.style.color = 'rgba(33, 150, 243, 0.1)'; // Blue for punctuation
                } else if (['?', '!', '‚ùì', '‚ùó'].includes(element.textContent)) {
                    element.style.color = 'rgba(255, 152, 0, 0.1)'; // Orange for end marks
                } else if (['üî†', 'üî°', 'üî£', 'üî§'].includes(element.textContent)) {
                    element.style.color = 'rgba(0, 150, 136, 0.1)'; // Teal for capitalization
                } else {
                    element.style.color = 'rgba(33, 150, 243, 0.1)'; // Default blue
                }
                
                punctuationBg.appendChild(element);
            }
        }

        // Questions array - 120+ Grade 6 Punctuation and Capitalization questions
        const questions = [
            // Basic Punctuation Concepts (1-20)
            {
                type: "basic_punctuation",
                question: "Which punctuation mark ends a statement or declarative sentence?",
                options: ["Period (.)", "Question mark (?)", "Exclamation point (!)", "Comma (,)"],
                answer: "A",
                explanation: "Periods (.) end statements and declarative sentences. Example: 'I like pizza.'"
            },
            {
                type: "basic_punctuation",
                question: "Which punctuation mark shows strong emotion or excitement?",
                options: ["Exclamation point (!)", "Period (.)", "Question mark (?)", "Comma (,)"],
                answer: "A",
                explanation: "Exclamation points (!) show strong emotion or excitement. Example: 'Wow! That's amazing!'"
            },
            {
                type: "basic_punctuation",
                question: "Which punctuation mark asks a question?",
                options: ["Question mark (?)", "Period (.)", "Exclamation point (!)", "Semicolon (;)"],
                answer: "A",
                explanation: "Question marks (?) end interrogative sentences (questions). Example: 'What is your name?'"
            },
            {
                type: "basic_punctuation",
                question: "What does a comma (,) do in a sentence?",
                options: ["Shows a pause or separates items", "Ends a sentence", "Shows excitement", "Asks a question"],
                answer: "A",
                explanation: "Commas show pauses, separate items in a list, or separate clauses."
            },
            // Comma Usage (21-40)
            {
                type: "comma_usage",
                question: "Where should commas go in this list: 'I need apples bananas and oranges.'",
                options: ["I need apples, bananas, and oranges.", "I need apples, bananas and oranges.", "I need apples bananas, and oranges.", "I need apples bananas and, oranges."],
                answer: "A",
                explanation: "Use commas to separate three or more items in a list (Oxford comma optional but recommended)."
            },
            {
                type: "comma_usage",
                question: "Correct the comma usage: 'After school I will do my homework.'",
                options: ["After school, I will do my homework.", "After, school I will do my homework.", "After school I, will do my homework.", "After school I will do, my homework."],
                answer: "A",
                explanation: "Use a comma after an introductory phrase like 'After school'."
            },
            // Quotation Marks (41-60)
            {
                type: "quotation_marks",
                question: "Which sentence uses quotation marks correctly?",
                options: [`She said, "I'll be there soon."`, `She said "I'll be there soon."`, `She said, I'll be there soon.`, `"She said, I'll be there soon."`],
                answer: "A",
                explanation: "Use quotation marks around direct speech, with a comma before the quote."
            },
            {
                type: "quotation_marks",
                question: "Where does the period go with quotation marks?",
                options: ["Inside the quotation marks", "Outside the quotation marks", "It doesn't matter", "Before the quotation marks"],
                answer: "A",
                explanation: "In American English, periods and commas go inside quotation marks."
            },
            // Apostrophes (61-80)
            {
                type: "apostrophes",
                question: "Which shows possession correctly?",
                options: ["The dog's bone", "The dogs' bone", "The dogs bone", "The dog's's bone"],
                answer: "A",
                explanation: "For singular nouns, add 's to show possession. Example: dog ‚Üí dog's"
            },
            {
                type: "apostrophes",
                question: "Which contraction is correct?",
                options: ["I'll (I will)", "Ill (I will)", "I'will (I will)", "I'lll (I will)"],
                answer: "A",
                explanation: "Apostrophes show where letters are missing in contractions: I will ‚Üí I'll"
            },
            // Capitalization Rules (81-100)
            {
                type: "capitalization",
                question: "Which should always be capitalized?",
                options: ["The beginning of a sentence", "Common nouns", "Seasons of the year", "Directions like north or south"],
                answer: "A",
                explanation: "Always capitalize the first letter of a sentence."
            },
            {
                type: "capitalization",
                question: "Which proper noun is capitalized correctly?",
                options: ["Mount Everest", "mount Everest", "mount everest", "Mount everest"],
                answer: "A",
                explanation: "Capitalize proper nouns - specific names of people, places, and things."
            },
            {
                type: "capitalization",
                question: "Which pronoun is always capitalized?",
                options: ["I", "me", "my", "mine"],
                answer: "A",
                explanation: "The pronoun 'I' is always capitalized, no matter where it appears in a sentence."
            },
            {
                type: "capitalization",
                question: "Which title is capitalized correctly?",
                options: ["Harry Potter and the Sorcerer's Stone", "harry potter and the sorcerer's stone", "Harry Potter And The Sorcerer's Stone", "Harry potter and the Sorcerer's Stone"],
                answer: "A",
                explanation: "Capitalize the first, last, and important words in titles (articles, short prepositions, and conjunctions are usually lowercase unless they're the first or last word)."
            },
            // Colon and Semicolon (101-120)
            {
                type: "colon_semicolon",
                question: "What does a colon (:) usually do?",
                options: ["Introduces a list or explanation", "Ends a sentence", "Shows a pause", "Asks a question"],
                answer: "A",
                explanation: "Colons introduce lists, explanations, or quotations."
            },
            {
                type: "colon_semicolon",
                question: "Which sentence uses a semicolon correctly?",
                options: ["I have a test tomorrow; I need to study.", "I have a test tomorrow, I need to study.", "I have a test tomorrow; and I need to study.", "I have a test tomorrow I need to study."],
                answer: "A",
                explanation: "Semicolons connect closely related independent clauses without a conjunction."
            },
            // Common Errors (121-140)
            {
                type: "common_errors",
                question: "What's wrong: 'i went to the store.'",
                options: ["'i' should be capitalized", "Needs a question mark", "Needs an exclamation point", "Nothing wrong"],
                answer: "A",
                explanation: "The pronoun 'I' is always capitalized."
            },
            {
                type: "common_errors",
                question: "What's missing: 'She said Hello'",
                options: ["Quotation marks", "Period", "Comma", "Question mark"],
                answer: "A",
                explanation: "Direct speech needs quotation marks: She said, 'Hello.'"
            }
        ];

        // App state
        let appState = {
            currentQuestionIndex: 0,
            score: 0,
            skipped: 0,
            answered: 0,
            currentQuestions: [],
            studentName: ""
        };

        // Positive feedback messages
        const positiveMessages = [
            "Excellent punctuation skills!",
            "Perfect capitalization!",
            "Great understanding of comma rules!",
            "You're a punctuation expert!",
            "Perfect apostrophe usage!",
            "You're a writing champion!",
            "Outstanding grammar skills!",
            "Brilliant understanding of punctuation!",
            "You think like an editor!",
            "Writing mastery achieved!"
        ];

        // Language terms and definitions
        const languageTerms = [
            {
                term: "Period",
                definition: "Ends a statement or declarative sentence",
                example: "I like to read books."
            },
            {
                term: "Question Mark",
                definition: "Ends an interrogative sentence (question)",
                example: "What is your favorite color?"
            },
            {
                term: "Exclamation Point",
                definition: "Shows strong emotion or excitement",
                example: "Wow! That's incredible!"
            },
            {
                term: "Comma",
                definition: "Shows a pause or separates items in a list",
                example: "I need milk, eggs, and bread."
            },
            {
                term: "Apostrophe",
                definition: "Shows possession or missing letters in contractions",
                example: "Sarah's book, don't (do not)"
            }
        ];

        // Punctuation examples by category
        const punctuationExamples = [
            {
                category: "End Marks",
                examples: [
                    { mark: "Period", usage: "Ends statements", example: "The sun is shining." },
                    { mark: "Question Mark", usage: "Ends questions", example: "Is it raining outside?" },
                    { mark: "Exclamation Point", usage: "Shows excitement", example: "I won the game!" }
                ]
            },
            {
                category: "Pause Marks",
                examples: [
                    { mark: "Comma", usage: "Separates items or clauses", example: "I like apples, oranges, and bananas." },
                    { mark: "Semicolon", usage: "Connects related clauses", example: "She loves reading; he prefers movies." },
                    { mark: "Colon", usage: "Introduces lists or explanations", example: "Bring these items: pencil, paper, and eraser." }
                ]
            },
            {
                category: "Special Marks",
                examples: [
                    { mark: "Quotation Marks", usage: "Shows direct speech", example: 'He said, "Hello there!"' },
                    { mark: "Apostrophe", usage: "Shows possession", example: "The cat's toy is under the chair." },
                    { mark: "Hyphen", usage: "Connects compound words", example: "well-known, sister-in-law" }
                ]
            }
        ];

        // Capitalization rules
        const capitalizationRules = [
            {
                rule: "Sentence Beginning",
                explanation: "Capitalize the first letter of every sentence",
                examples: ["The dog barked.", "Where are you going?", "What a beautiful day!"],
                icon: "üî†"
            },
            {
                rule: "Proper Nouns",
                explanation: "Capitalize specific names of people, places, and things",
                examples: ["John Smith", "New York City", "Mount Everest", "Monday"],
                icon: "üìç"
            },
            {
                rule: "Titles",
                explanation: "Capitalize important words in titles",
                examples: ["Harry Potter and the Chamber of Secrets", "The Lion King", "National Geographic"],
                icon: "üìö"
            },
            {
                rule: "Pronoun I",
                explanation: "Always capitalize the pronoun 'I'",
                examples: ["My sister and I went shopping.", "I think therefore I am."],
                icon: "üë§"
            },
            {
                rule: "Days & Months",
                explanation: "Capitalize days of the week and months",
                examples: ["Monday, Tuesday, Wednesday", "January, February, March"],
                icon: "üìÖ"
            },
            {
                rule: "Holidays",
                explanation: "Capitalize names of holidays",
                examples: ["Christmas", "Thanksgiving", "Halloween", "Independence Day"],
                icon: "üéâ"
            }
        ];

        // Common punctuation marks
        const punctuationMarks = [
            {
                name: "Period",
                symbol: ".",
                usage: "Ends declarative sentences",
                example: "I am learning.",
                icon: "‚è∫Ô∏è"
            },
            {
                name: "Comma",
                symbol: ",",
                usage: "Shows pause or separates items",
                example: "Apples, bananas, and oranges",
                icon: "‚è∏Ô∏è"
            },
            {
                name: "Question Mark",
                symbol: "?",
                usage: "Ends interrogative sentences",
                example: "How are you?",
                icon: "‚ùì"
            },
            {
                name: "Exclamation Point",
                symbol: "!",
                usage: "Shows strong emotion",
                example: "What a surprise!",
                icon: "‚ùó"
            },
            {
                name: "Quotation Marks",
                symbol: '" "',
                usage: "Shows direct speech",
                example: 'She said, "Hello!"',
                icon: "üí¨"
            },
            {
                name: "Apostrophe",
                symbol: "'",
                usage: "Shows possession or contraction",
                example: "Sarah's book, don't",
                icon: "üìù"
            },
            {
                name: "Colon",
                symbol: ":",
                usage: "Introduces lists or explanations",
                example: "Ingredients: flour, sugar, eggs",
                icon: "üëâ"
            },
            {
                name: "Semicolon",
                symbol: ";",
                usage: "Connects related clauses",
                example: "I study hard; I want good grades.",
                icon: "üîó"
            }
        ];

        // Interesting language facts
        const languageFacts = [
            "The exclamation point was originally called the 'note of admiration'!",
            "In Spanish, question marks and exclamation points come in pairs: ¬ø? and ¬°!",
            "The word 'punctuation' comes from Latin 'punctus' meaning 'point'!",
            "The Oxford comma (the comma before 'and' in a list) is often debated by writers!",
            "Early Greek writing had no spaces or punctuation between words!",
            "The @ symbol was originally used in accounting to mean 'at the rate of'!",
            "Capital letters are also called 'uppercase' from when type was set by hand!",
            "The hashtag (#) was originally called the pound sign or number sign!"
        ];

        // Sentence correction examples
        const correctionExamples = [
            {
                incorrect: "i went to the store to buy milk eggs and bread",
                correct: "I went to the store to buy milk, eggs, and bread.",
                issues: ["Capitalization", "Commas in list"]
            },
            {
                incorrect: "sarah said can you come to my party on friday",
                correct: 'Sarah said, "Can you come to my party on Friday?"',
                issues: ["Capitalization", "Quotation marks", "Question mark", "Proper noun"]
            },
            {
                incorrect: "my favorite books are harry potter the hobbit and charlottes web",
                correct: "My favorite books are Harry Potter, The Hobbit, and Charlotte's Web.",
                issues: ["Capitalization", "Proper nouns", "Apostrophe", "Commas"]
            },
            {
                incorrect: "wow that was an amazing game",
                correct: "Wow! That was an amazing game!",
                issues: ["Capitalization", "Exclamation points"]
            }
        ];

        // DOM elements
        const welcomePage = document.getElementById('welcomePage');
        const practicePage = document.getElementById('practicePage');
        const resultsPage = document.getElementById('resultsPage');
        const studentNameInput = document.getElementById('studentName');
        const startPracticeBtn = document.getElementById('startPractice');
        const studentNameDisplay = document.getElementById('studentNameDisplay');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const languageFact = document.getElementById('languageFact');
        const conceptDisplay = document.getElementById('conceptDisplay');
        const visualizationContainer = document.getElementById('visualizationContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryTopicBtn = document.getElementById('retryTopic');
        const backToHomeBtn = document.getElementById('backToHome');
        const backToTopicsBtn = document.getElementById('backToTopics');
        const viewTopicsBtn = document.getElementById('viewTopics');
        const finalScore = document.getElementById('finalScore');
        const scorePercentage = document.getElementById('scorePercentage');
        const scoreMessage = document.getElementById('scoreMessage');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const skippedQuestions = document.getElementById('skippedQuestions');
        const highestScore = document.getElementById('highestScore');

        // Initialize the app
        function initApp() {
            initBackground();
            loadStateFromStorage();
            setupEventListeners();
            
            if (appState.studentName && appState.currentQuestions.length > 0) {
                showPracticePage();
            } else {
                showWelcomePage();
            }
        }

        // Load state from localStorage
        function loadStateFromStorage() {
            const savedState = localStorage.getItem('ideolixGrade6EnglishPunctuation');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                appState.studentName = parsed.studentName || "";
                appState.currentQuestionIndex = parsed.currentQuestionIndex || 0;
                appState.score = parsed.score || 0;
                appState.skipped = parsed.skipped || 0;
                appState.answered = parsed.answered || 0;
                appState.currentQuestions = parsed.currentQuestions || [];
                
                if (appState.currentQuestions.length === 0) {
                    initializeQuestions();
                }
            }
        }

        // Save state to localStorage
        function saveStateToStorage() {
            localStorage.setItem('ideolixGrade6EnglishPunctuation', JSON.stringify(appState));
        }

        // Initialize and shuffle questions
        function initializeQuestions() {
            appState.currentQuestions = [...questions];
            shuffleArray(appState.currentQuestions);
        }

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Setup event listeners
        function setupEventListeners() {
            startPracticeBtn.addEventListener('click', startPractice);
            nextQuestionBtn.addEventListener('click', nextQuestion);
            skipQuestionBtn.addEventListener('click', skipQuestion);
            retryTopicBtn.addEventListener('click', retryTopic);
            backToHomeBtn.addEventListener('click', backToHome);
            backToTopicsBtn.addEventListener('click', backToTopics);
            viewTopicsBtn.addEventListener('click', backToTopics);
            
            studentNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startPractice();
                }
            });
        }

        // Show welcome page
        function showWelcomePage() {
            welcomePage.style.display = 'flex';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'none';
            studentNameInput.value = appState.studentName || '';
        }

        // Show practice page
        function showPracticePage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'block';
            resultsPage.style.display = 'none';
            studentNameDisplay.textContent = appState.studentName;
            loadQuestion();
        }

        // Show results page
        function showResultsPage() {
            welcomePage.style.display = 'none';
            practicePage.style.display = 'none';
            resultsPage.style.display = 'block';
            
            const totalQuestions = appState.currentQuestions.length;
            const percentage = Math.round((appState.score / totalQuestions) * 100);
            
            finalScore.textContent = appState.score;
            scorePercentage.textContent = `${percentage}%`;
            correctAnswers.textContent = appState.score;
            incorrectAnswers.textContent = appState.answered - appState.score;
            skippedQuestions.textContent = appState.skipped;
            
            const highest = localStorage.getItem('ideolixGrade6EnglishPunctuation_highestScore') || 0;
            highestScore.textContent = Math.max(highest, appState.score);
            
            if (appState.score > highest) {
                localStorage.setItem('ideolixGrade6EnglishPunctuation_highestScore', appState.score);
            }
            
            if (percentage >= 90) {
                scoreMessage.textContent = "Outstanding! You're a punctuation and capitalization expert!";
            } else if (percentage >= 80) {
                scoreMessage.textContent = "Great job! You have excellent writing skills!";
            } else if (percentage >= 70) {
                scoreMessage.textContent = "Good work! Keep practicing punctuation and capitalization!";
            } else if (percentage >= 60) {
                scoreMessage.textContent = "Not bad! Review punctuation marks and capitalization rules!";
            } else {
                scoreMessage.textContent = "Keep exploring! Mastering punctuation will make your writing clear and professional!";
            }
        }

        // Create language fact display
        function createLanguageFact() {
            const factDiv = document.createElement('div');
            factDiv.className = 'language-fact';
            
            factDiv.innerHTML = `<strong>Amazing Writing Fact:</strong> ${languageFacts[Math.floor(Math.random() * languageFacts.length)]}`;
            
            return factDiv;
        }

        // Create concept display
        function createConceptDisplay() {
            const display = document.createElement('div');
            display.className = 'concept-display';
            
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            const conceptIcons = {
                "basic_punctuation": "üî§",
                "comma_usage": "‚è∏Ô∏è",
                "quotation_marks": "üí¨",
                "apostrophes": "üìù",
                "capitalization": "üî†",
                "colon_semicolon": "üîó",
                "common_errors": "‚ö†Ô∏è"
            };
            
            let conceptName = "Basic Punctuation";
            let conceptIcon = "üî§";
            
            if (question.type.includes("basic_punctuation")) {
                conceptName = "Basic Punctuation";
                conceptIcon = conceptIcons.basic_punctuation;
            } else if (question.type.includes("comma_usage")) {
                conceptName = "Comma Usage";
                conceptIcon = conceptIcons.comma_usage;
            } else if (question.type.includes("quotation_marks")) {
                conceptName = "Quotation Marks";
                conceptIcon = conceptIcons.quotation_marks;
            } else if (question.type.includes("apostrophes")) {
                conceptName = "Apostrophes";
                conceptIcon = conceptIcons.apostrophes;
            } else if (question.type.includes("capitalization")) {
                conceptName = "Capitalization";
                conceptIcon = conceptIcons.capitalization;
            } else if (question.type.includes("colon_semicolon")) {
                conceptName = "Colon & Semicolon";
                conceptIcon = conceptIcons.colon_semicolon;
            } else if (question.type.includes("common_errors")) {
                conceptName = "Common Errors";
                conceptIcon = conceptIcons.common_errors;
            }
            
            const conceptBox = document.createElement('div');
            conceptBox.className = 'concept-box grow';
            conceptBox.innerHTML = `
                <div class="concept-icon">${conceptIcon}</div>
                <div class="concept-text">${conceptName.toUpperCase()}</div>
            `;
            
            const label = document.createElement('div');
            label.className = 'concept-label';
            
            if (question.type.includes("basic_punctuation")) {
                label.textContent = "Understanding basic punctuation marks";
            } else if (question.type.includes("comma_usage")) {
                label.textContent = "Using commas correctly in sentences";
            } else if (question.type.includes("quotation_marks")) {
                label.textContent = "Using quotation marks for direct speech";
            } else if (question.type.includes("apostrophes")) {
                label.textContent = "Apostrophes for possession and contractions";
            } else if (question.type.includes("capitalization")) {
                label.textContent = "Rules for capitalizing words";
            } else if (question.type.includes("colon_semicolon")) {
                label.textContent = "Using colons and semicolons";
            } else if (question.type.includes("common_errors")) {
                label.textContent = "Avoiding common punctuation mistakes";
            }
            
            display.appendChild(conceptBox);
            display.appendChild(label);
            
            return display;
        }

        // Create punctuation visualization
        function createPunctuationVisualization() {
            const vizDiv = document.createElement('div');
            vizDiv.className = 'visualization-container';
            
            const punctuationCategory = punctuationExamples[Math.floor(Math.random() * punctuationExamples.length)];
            const capitalizationRule = capitalizationRules[Math.floor(Math.random() * capitalizationRules.length)];
            const correctionExample = correctionExamples[Math.floor(Math.random() * correctionExamples.length)];
            
            vizDiv.innerHTML = `
                <h3 style="text-align: center; margin-bottom: 20px; color: var(--accent-yellow);">Punctuation & Capitalization Explorer</h3>
                
                <div class="comparison-container">
                    <div class="comparison-box punctuation punctuation-bounce" onclick="showPunctuationDetails('Punctuation')">
                        <div class="comparison-icon">üî§</div>
                        <div class="comparison-name">Punctuation</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Marks that organize writing
                        </div>
                    </div>
                    <div class="comparison-box capitalization capitalization-glow" onclick="showPunctuationDetails('Capitalization')">
                        <div class="comparison-icon">üî†</div>
                        <div class="comparison-name">Capitalization</div>
                        <div class="comparison-label" style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 5px;">
                            Rules for capital letters
                        </div>
                    </div>
                </div>
                
                <div class="punctuation-display mark-highlight">
                    <div style="font-size: 1.5rem; margin-bottom: 15px;">
                        Category: <span style="color: var(--primary-blue); font-weight: bold;">${punctuationCategory.category}</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 20px 0;">
                        ${punctuationCategory.examples.map(example => `
                            <div style="text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">${example.mark}</div>
                                <div style="font-size: 0.9rem; color: var(--text-secondary);">${example.usage}</div>
                                <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 10px; font-style: italic;">${example.example}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(255, 235, 59, 0.1); border-radius: 6px; border-left: 3px solid var(--accent-yellow);">
                        <div style="font-size: 0.9rem; color: var(--accent-yellow);"><strong>Tip:</strong> Punctuation helps readers understand your writing clearly!</div>
                    </div>
                </div>
                
                <div class="punctuation-marks-container">
                    <div class="display-title">Punctuation Marks - The Writing Tools</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        Common punctuation marks and their uses
                    </div>
                    
                    <div class="marks-grid">
                        ${punctuationMarks.slice(0, 8).map((mark, idx) => `
                            <div class="mark-box ${mark.name.toLowerCase().replace(' ', '-')}" onclick="showMarkDetails('${mark.name}')">
                                <div class="mark-icon">${mark.icon}</div>
                                <div class="mark-name">${mark.name}</div>
                                <div style="font-size: 2rem; margin: 10px 0;">${mark.symbol}</div>
                                <div class="mark-usage">${mark.usage}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="capitalization-container">
                    <div class="display-title">Capitalization Rules - When to Use Capital Letters</div>
                    <div style="text-align: center; margin-bottom: 15px; color: var(--text-secondary);">
                        ${capitalizationRule.rule}: ${capitalizationRule.explanation}
                    </div>
                    
                    <div class="capitalization-rules">
                        ${capitalizationRules.slice(0, 4).map((rule, idx) => `
                            <div class="rule-box ${rule.rule.toLowerCase().replace(/ & /g, '-').replace(/ /g, '-')}" onclick="showCapitalizationRule('${rule.rule}')">
                                <div class="rule-icon">${rule.icon}</div>
                                <div class="rule-name">${rule.rule}</div>
                                <div class="rule-example">${rule.examples[0]}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(255, 152, 0, 0.1); border-radius: 8px; border: 1px solid var(--accent-orange);">
                        <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Remember:</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            ‚Ä¢ Always capitalize the first word of a sentence<br>
                            ‚Ä¢ Always capitalize the pronoun "I"<br>
                            ‚Ä¢ Capitalize proper nouns (specific names)<br>
                            ‚Ä¢ Capitalize titles before names (Dr., Mr., Ms.)
                        </div>
                    </div>
                </div>
                
                <div class="correction-container correction-slide">
                    <div class="display-title">Sentence Correction - Fix Common Mistakes</div>
                    
                    <div class="sentence-display" id="sentenceDisplay">
                        "${correctionExample.incorrect}"
                    </div>
                    
                    <div style="text-align: center; margin: 15px 0; color: var(--text-secondary);">
                        Can you spot the errors? Click "Show Correction" to see the fixed version.
                    </div>
                    
                    <div class="correction-controls">
                        <div class="correction-button" onclick="showCorrection()">Show Correction</div>
                        <div class="correction-button" onclick="explainCorrection()">Explain Errors</div>
                        <div class="correction-button" onclick="newCorrection()">New Sentence</div>
                    </div>
                    
                    <div id="correctionResult" style="margin-top: 20px; padding: 15px; background: var(--dark-surface); border-radius: 8px; display: none;"></div>
                </div>
                
                <table class="punctuation-table">
                    <thead>
                        <tr>
                            <th>Punctuation Mark</th>
                            <th>Symbol</th>
                            <th>Main Use</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="font-weight: bold; color: var(--primary-blue);">Period</td>
                            <td style="font-size: 1.5rem; text-align: center;">.</td>
                            <td>Ends a statement</td>
                            <td style="font-style: italic;">I like pizza.</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--secondary-teal);">Comma</td>
                            <td style="font-size: 1.5rem; text-align: center;">,</td>
                            <td>Shows pause, separates items</td>
                            <td style="font-style: italic;">Apples, oranges, bananas</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-orange);">Question Mark</td>
                            <td style="font-size: 1.5rem; text-align: center;">?</td>
                            <td>Ends a question</td>
                            <td style="font-style: italic;">How are you?</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-red);">Exclamation Point</td>
                            <td style="font-size: 1.5rem; text-align: center;">!</td>
                            <td>Shows excitement</td>
                            <td style="font-style: italic;">What a surprise!</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-purple);">Quotation Marks</td>
                            <td style="font-size: 1.5rem; text-align: center;">" "</td>
                            <td>Shows direct speech</td>
                            <td style="font-style: italic;">She said, "Hello!"</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold; color: var(--accent-green);">Apostrophe</td>
                            <td style="font-size: 1.5rem; text-align: center;">'</td>
                            <td>Shows possession</td>
                            <td style="font-style: italic;">Sarah's book</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="real-world-example" style="background: var(--dark-card); padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid var(--accent-orange); font-style: italic; color: var(--text-secondary);">
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Real-World Writing:</div>
                    "In emails: 'Dear Mr. Smith, Thank you for your email. I will respond to your questions by Friday. Sincerely, Jane Doe.' (Notice capitalization of names, titles, and sentence beginnings, plus commas after greeting and closing). In stories: 'Suddenly, a loud noise echoed through the dark, empty hallway. 'Who's there?' whispered Sarah, her heart pounding.' (Uses commas for pauses, quotation marks for speech, question mark, period). In lists: 'For the party, we need: plates, cups, napkins, balloons, and cake.' (Uses colon to introduce list, commas to separate items, period to end)."
                    <div style="margin-top: 10px;">
                        <strong>Key concepts:</strong> Punctuation organizes ideas; capitalization shows importance; both make writing clear.
                    </div>
                </div>
                
                <div class="interactive-practice">
                    <div class="practice-title">Interactive Writing Practice</div>
                    <div class="practice-controls">
                        <div class="practice-button" onclick="identifyErrors()">Identify Errors</div>
                        <div class="practice-button" onclick="addPunctuation()">Add Punctuation</div>
                        <div class="practice-button" onclick="capitalizeCorrectly()">Capitalize Correctly</div>
                        <div class="practice-button" onclick="writingChallenge()">Writing Challenge</div>
                    </div>
                    <div class="practice-display" id="practiceDisplay">
                        Click buttons above to practice writing skills
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 4px solid var(--accent-red);">
                    <div style="color: var(--accent-red); font-weight: bold; margin-bottom: 10px;">Quick Practice:</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">
                        1. Add punctuation: "wow that was amazing"<br>
                        2. Correct capitalization: "i went to paris, france in july"<br>
                        3. Add commas: "I need milk eggs bread and cheese"<br>
                        4. Fix apostrophes: "The dogs toy is under the chair"<br>
                        5. Add quotation marks: She said I'll be there soon
                    </div>
                </div>
                
                <div style="background: var(--dark-card); padding: 15px; border-radius: 8px; margin-top: 20px; border: 2px solid var(--primary-blue);">
                    <div style="color: var(--primary-blue); font-weight: bold; margin-bottom: 10px; text-align: center;">Writing Tips</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; text-align: center;">
                        <strong>Period:</strong> Ends statements<br>
                        <strong>Comma:</strong> Pause or separate items<br>
                        <strong>Question Mark:</strong> Ends questions<br>
                        <strong>Exclamation Point:</strong> Shows excitement<br>
                        <strong>Capitalize:</strong> Sentence start, proper nouns, "I"
                    </div>
                </div>
            `;
            
            // Store current correction example for interactive functions
            window.currentCorrectionExample = correctionExample;
            
            return vizDiv;
        }

        // Helper functions
        function getIconForMark(markName) {
            const iconMap = {
                "Period": "‚è∫Ô∏è",
                "Comma": "‚è∏Ô∏è",
                "Question Mark": "‚ùì",
                "Exclamation Point": "‚ùó",
                "Quotation Marks": "üí¨",
                "Apostrophe": "üìù",
                "Colon": "üëâ",
                "Semicolon": "üîó"
            };
            return iconMap[markName] || "üî§";
        }

        // Global functions for interactive practice
        window.showPunctuationDetails = function(type) {
            if (type === 'Punctuation') {
                alert(`üî§ Punctuation\n\nPunctuation marks are symbols that help organize writing and make it clear.\n\nMain purposes:\n‚Ä¢ End sentences (., ?, !)\n‚Ä¢ Show pauses (, ;)\n‚Ä¢ Show speech (" ")\n‚Ä¢ Show possession (')\n‚Ä¢ Introduce lists (:)\n\nWithout punctuation, writing would be confusing and hard to read!`);
            } else {
                alert(`üî† Capitalization\n\nCapitalization rules tell us when to use capital (uppercase) letters.\n\nAlways capitalize:\n‚Ä¢ First word of a sentence\n‚Ä¢ Proper nouns (specific names)\n‚Ä¢ The pronoun "I"\n‚Ä¢ Titles before names\n‚Ä¢ Days, months, holidays\n‚Ä¢ Important words in titles\n\nCapitalization shows importance and helps identify proper nouns!`);
            }
        };

        window.showMarkDetails = function(markName) {
            const mark = punctuationMarks.find(m => m.name === markName);
            if (!mark) return;
            
            alert(`${mark.name} ${mark.symbol}\n\nUse: ${mark.usage}\n\nExample: ${mark.example}\n\n${mark.name === 'Apostrophe' ? "Remember: Its (belonging to it) vs. It's (it is)" : ""}${mark.name === 'Comma' ? "Common uses: lists, after introductory phrases, between adjectives, dates" : ""}`);
        };

        window.showCapitalizationRule = function(ruleName) {
            const rule = capitalizationRules.find(r => r.rule === ruleName);
            if (!rule) return;
            
            alert(`${rule.rule}\n\n${rule.explanation}\n\nExamples:\n${rule.examples.map(ex => `‚Ä¢ ${ex}`).join('\n')}\n\n${rule.rule === 'Proper Nouns' ? "Proper nouns vs. common nouns: 'city' (common) vs. 'New York City' (proper)" : ""}`);
        };

        window.showCorrection = function() {
            const resultDiv = document.getElementById('correctionResult');
            if (resultDiv && window.currentCorrectionExample) {
                resultDiv.innerHTML = `
                    <div style="color: var(--secondary-teal); font-weight: bold; margin-bottom: 10px;">Corrected Sentence:</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        "${window.currentCorrectionExample.correct}"
                    </div>
                    <div style="color: var(--accent-yellow); font-size: 0.9rem;">
                        The sentence had issues with: ${window.currentCorrectionExample.issues.join(', ')}
                    </div>
                `;
                resultDiv.style.display = 'block';
            }
        };

        window.explainCorrection = function() {
            const resultDiv = document.getElementById('correctionResult');
            if (resultDiv && window.currentCorrectionExample) {
                resultDiv.innerHTML = `
                    <div style="color: var(--accent-orange); font-weight: bold; margin-bottom: 10px;">Error Explanation:</div>
                    <div style="color: var(--text-secondary); margin-bottom: 10px;">
                        ${window.currentCorrectionExample.issues.map(issue => {
                            if (issue === "Capitalization") return "‚Ä¢ <strong>Capitalization:</strong> Missing capital letters at sentence start or for proper nouns";
                            if (issue === "Commas in list") return "‚Ä¢ <strong>Commas:</strong> Missing commas to separate items in a list";
                            if (issue === "Quotation marks") return "‚Ä¢ <strong>Quotation marks:</strong> Missing quotation marks around direct speech";
                            if (issue === "Question mark") return "‚Ä¢ <strong>Question mark:</strong> Missing question mark at end of question";
                            if (issue === "Proper noun") return "‚Ä¢ <strong>Proper noun:</strong> Proper nouns (specific names) should be capitalized";
                            if (issue === "Apostrophe") return "‚Ä¢ <strong>Apostrophe:</strong> Missing apostrophe to show possession";
                            if (issue === "Exclamation points") return "‚Ä¢ <strong>Exclamation points:</strong> Missing exclamation points to show excitement";
                            return `‚Ä¢ <strong>${issue}:</strong> Error in this area`;
                        }).join('<br>')}
                    </div>
                `;
                resultDiv.style.display = 'block';
            }
        };

        window.newCorrection = function() {
            const sentenceDisplay = document.getElementById('sentenceDisplay');
            const resultDiv = document.getElementById('correctionResult');
            
            if (sentenceDisplay && resultDiv) {
                const newExample = correctionExamples[Math.floor(Math.random() * correctionExamples.length)];
                sentenceDisplay.textContent = `"${newExample.incorrect}"`;
                window.currentCorrectionExample = newExample;
                resultDiv.style.display = 'none';
            }
        };

        window.identifyErrors = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const errorExamples = [
                {
                    sentence: "my dog max loves to play fetch in the park",
                    errors: ["Capitalization (sentence start)", "Capitalization (proper noun 'Max')", "Missing period"],
                    fixed: "My dog Max loves to play fetch in the park."
                },
                {
                    sentence: "sarah asked can you come to my party",
                    errors: ["Capitalization (sentence start)", "Capitalization (proper noun 'Sarah')", "Missing quotation marks", "Missing question mark"],
                    fixed: 'Sarah asked, "Can you come to my party?"'
                },
                {
                    sentence: "i need to buy milk eggs bread and cheese at the store",
                    errors: ["Capitalization (pronoun 'I')", "Missing commas in list", "Missing period"],
                    fixed: "I need to buy milk, eggs, bread, and cheese at the store."
                }
            ];
            
            const currentExample = errorExamples[Math.floor(Math.random() * errorExamples.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--primary-blue);">Identify Errors</div>
                    <div style="font-size: 1.3rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        "${currentExample.sentence}"
                    </div>
                    
                    <div style="text-align: left; margin: 20px 0;">
                        <div style="color: var(--text-secondary); margin-bottom: 10px;">What errors do you see? (Select all that apply)</div>
                        ${["Capitalization", "Missing punctuation", "Apostrophe error", "Comma error", "Quotation mark error"].map((errorType, idx) => `
                            <div style="margin: 10px 0; display: flex; align-items: center;">
                                <input type="checkbox" id="error${idx}" style="margin-right: 10px;">
                                <label for="error${idx}" style="color: var(--text-secondary); cursor: pointer;">${errorType}</label>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="checkErrorIdentification()">Check Answer</button>
                        <button class="btn btn-small btn-outline" onclick="showErrorAnswer()">Show Answer</button>
                    </div>
                    
                    <div id="errorIdentificationResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                </div>
            `;
            
            window.currentErrorExample = currentExample;
        };

        window.checkErrorIdentification = function() {
            const resultDiv = document.getElementById('errorIdentificationResult');
            if (!resultDiv || !window.currentErrorExample) return;
            
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const selectedErrors = Array.from(checkboxes)
                .filter(cb => cb.checked)
                .map(cb => cb.nextElementSibling.textContent);
            
            // Simple checking - just see if they selected at least one correct error type
            const correctErrorTypes = window.currentErrorExample.errors.map(e => e.split(' ')[0]);
            const selectedCorrect = selectedErrors.filter(err => 
                correctErrorTypes.some(correct => err.toLowerCase().includes(correct.toLowerCase()))
            );
            
            if (selectedCorrect.length > 0) {
                resultDiv.textContent = `Good job! You found some errors. There were ${window.currentErrorExample.errors.length} total errors.`;
                resultDiv.style.color = 'var(--secondary-teal)';
            } else if (selectedErrors.length > 0) {
                resultDiv.textContent = "Not quite. Look for capitalization and punctuation issues.";
                resultDiv.style.color = 'var(--accent-orange)';
            } else {
                resultDiv.textContent = "Please select at least one error type.";
                resultDiv.style.color = 'var(--accent-red)';
            }
        };

        window.showErrorAnswer = function() {
            const resultDiv = document.getElementById('errorIdentificationResult');
            if (resultDiv && window.currentErrorExample) {
                resultDiv.innerHTML = `
                    <div>
                        <div style="color: var(--secondary-teal); margin-bottom: 5px;"><strong>Errors found:</strong></div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            ${window.currentErrorExample.errors.map(err => `‚Ä¢ ${err}`).join('<br>')}
                        </div>
                        <div style="color: var(--accent-yellow); margin-top: 10px;"><strong>Corrected:</strong> ${window.currentErrorExample.fixed}</div>
                    </div>
                `;
            }
        };

        window.addPunctuation = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const punctuationExamples = [
                {
                    sentence: "wow that was an amazing game",
                    punctuationNeeded: ["Capitalization", "Exclamation point", "Period"],
                    answer: "Wow! That was an amazing game."
                },
                {
                    sentence: "do you want to go to the movies on friday",
                    punctuationNeeded: ["Capitalization", "Question mark"],
                    answer: "Do you want to go to the movies on Friday?"
                },
                {
                    sentence: "my favorite colors are blue green and red",
                    punctuationNeeded: ["Capitalization", "Commas", "Period"],
                    answer: "My favorite colors are blue, green, and red."
                }
            ];
            
            const currentExample = punctuationExamples[Math.floor(Math.random() * punctuationExamples.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--secondary-teal);">Add Punctuation</div>
                    <div style="font-size: 1.3rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        ${currentExample.sentence}
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <textarea id="punctuationAnswer" placeholder="Type the corrected sentence with proper punctuation..." style="width: 100%; min-height: 80px; padding: 15px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary); font-size: 1rem; resize: vertical;"></textarea>
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="checkPunctuation()">Check Answer</button>
                        <button class="btn btn-small btn-outline" onclick="showPunctuationAnswer()">Show Answer</button>
                    </div>
                    
                    <div id="punctuationResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Remember:</strong> Capitalize sentence beginnings, use proper end marks, add commas where needed.
                    </div>
                </div>
            `;
            
            window.currentPunctuationAnswer = currentExample.answer;
        };

        window.checkPunctuation = function() {
            const answerInput = document.getElementById('punctuationAnswer');
            const resultDiv = document.getElementById('punctuationResult');
            
            if (!answerInput || !resultDiv) return;
            
            const userAnswer = answerInput.value.trim();
            const correctAnswer = window.currentPunctuationAnswer;
            
            // Check for key elements
            const hasCapitalStart = /^[A-Z]/.test(userAnswer);
            const hasProperEnd = /[.!?]$/.test(userAnswer);
            const hasFridayCapitalized = userAnswer.includes('Friday') || userAnswer.includes('friday');
            
            if (hasCapitalStart && hasProperEnd) {
                resultDiv.textContent = "Excellent! You added proper punctuation!";
                resultDiv.style.color = 'var(--primary-blue)';
            } else if (hasCapitalStart || hasProperEnd) {
                resultDiv.textContent = "Good start! Check if you have both a capital letter and proper end mark.";
                resultDiv.style.color = 'var(--secondary-teal)';
            } else {
                resultDiv.textContent = "Try again. Remember to capitalize the first letter and add proper punctuation at the end.";
                resultDiv.style.color = 'var(--accent-orange)';
            }
        };

        window.showPunctuationAnswer = function() {
            const resultDiv = document.getElementById('punctuationResult');
            if (resultDiv && window.currentPunctuationAnswer) {
                resultDiv.innerHTML = `
                    <div>
                        <div style="color: var(--secondary-teal); margin-bottom: 5px;"><strong>Correct answer:</strong> ${window.currentPunctuationAnswer}</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">Compare with your answer to see if you got it right!</div>
                    </div>
                `;
            }
        };

        window.capitalizeCorrectly = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const capitalizationExamples = [
                {
                    sentence: "i went to paris, france in july with my friend sarah",
                    answer: "I went to Paris, France in July with my friend Sarah.",
                    rules: ["Pronoun 'I'", "Proper nouns (Paris, France)", "Month (July)", "Proper name (Sarah)"]
                },
                {
                    sentence: "dr. smith works at city hospital on main street",
                    answer: "Dr. Smith works at City Hospital on Main Street.",
                    rules: ["Title (Dr.)", "Proper name (Smith)", "Proper place names (City Hospital, Main Street)"]
                },
                {
                    sentence: "on monday, we celebrate thanksgiving with family",
                    answer: "On Monday, we celebrate Thanksgiving with family.",
                    rules: ["Sentence start", "Day of week (Monday)", "Holiday (Thanksgiving)"]
                }
            ];
            
            const currentExample = capitalizationExamples[Math.floor(Math.random() * capitalizationExamples.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-orange);">Capitalize Correctly</div>
                    <div style="font-size: 1.3rem; margin-bottom: 15px; font-style: italic; color: var(--text-primary);">
                        ${currentExample.sentence}
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <textarea id="capitalizationAnswer" placeholder="Type the sentence with correct capitalization..." style="width: 100%; min-height: 80px; padding: 15px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary); font-size: 1rem; resize: vertical;"></textarea>
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="checkCapitalization()">Check Answer</button>
                        <button class="btn btn-small btn-outline" onclick="showCapitalizationAnswer()">Show Answer</button>
                    </div>
                    
                    <div id="capitalizationResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                </div>
            `;
            
            window.currentCapitalizationAnswer = currentExample.answer;
            window.currentCapitalizationRules = currentExample.rules;
        };

        window.checkCapitalization = function() {
            const answerInput = document.getElementById('capitalizationAnswer');
            const resultDiv = document.getElementById('capitalizationResult');
            
            if (!answerInput || !resultDiv) return;
            
            const userAnswer = answerInput.value.trim();
            const correctAnswer = window.currentCapitalizationAnswer;
            
            // Check for key capitalizations
            const hasCapitalStart = /^[A-Z]/.test(userAnswer);
            const hasICapitalized = userAnswer.includes(' I ') || userAnswer.startsWith('I ');
            
            if (hasCapitalStart && hasICapitalized) {
                resultDiv.textContent = "Great capitalization! You remembered the important rules!";
                resultDiv.style.color = 'var(--primary-blue)';
            } else if (hasCapitalStart || hasICapitalized) {
                resultDiv.textContent = "Good! You got some capitalization right. Check all the rules.";
                resultDiv.style.color = 'var(--secondary-teal)';
            } else {
                resultDiv.textContent = "Try again. Remember to capitalize the first letter and the pronoun 'I'.";
                resultDiv.style.color = 'var(--accent-orange)';
            }
        };

        window.showCapitalizationAnswer = function() {
            const resultDiv = document.getElementById('capitalizationResult');
            if (resultDiv && window.currentCapitalizationAnswer) {
                resultDiv.innerHTML = `
                    <div>
                        <div style="color: var(--secondary-teal); margin-bottom: 5px;"><strong>Correct answer:</strong> ${window.currentCapitalizationAnswer}</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">
                            <strong>Rules applied:</strong> ${window.currentCapitalizationRules.join(', ')}
                        </div>
                    </div>
                `;
            }
        };

        window.writingChallenge = function() {
            const practiceDisplay = document.getElementById('practiceDisplay');
            if (!practiceDisplay) return;
            
            const challenges = [
                {
                    type: "Complete Correction",
                    challenge: "Correct all errors: 'my dogs toy is under the chair said tim'",
                    answer: '"My dog\'s toy is under the chair," said Tim.',
                    explanation: "Capitalization, apostrophe, comma, quotation marks, proper name"
                },
                {
                    type: "Multiple Errors",
                    challenge: "Find and fix 5+ errors: 'i want to visit london england and see big ben on tuesday'",
                    answer: "I want to visit London, England, and see Big Ben on Tuesday.",
                    explanation: "Pronoun I, proper nouns (London, England, Big Ben), comma, day of week"
                },
                {
                    type: "Complex Sentence",
                    challenge: "Punctuate correctly: 'john said can we go to the park after school it closes at 500 pm'",
                    answer: 'John said, "Can we go to the park after school? It closes at 5:00 p.m."',
                    explanation: "Capitalization, quotation marks, comma, question mark, time format"
                }
            ];
            
            const currentChallenge = challenges[Math.floor(Math.random() * challenges.length)];
            
            practiceDisplay.innerHTML = `
                <div style="text-align: center; width: 100%;">
                    <div style="font-size: 1.5rem; margin-bottom: 15px; color: var(--accent-purple);">Writing Challenge: ${currentChallenge.type}</div>
                    <div style="font-size: 1.2rem; margin-bottom: 15px; font-style: italic;">
                        "${currentChallenge.challenge}"
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <textarea id="challengeAnswer" placeholder="Type your corrected sentence here..." style="width: 100%; min-height: 100px; padding: 15px; background: var(--dark-surface); border: 2px solid var(--dark-border); border-radius: 8px; color: var(--text-primary); font-size: 1rem; resize: vertical;"></textarea>
                    </div>
                    
                    <div>
                        <button class="btn btn-small btn-secondary" onclick="checkWritingChallenge()">Check Answer</button>
                        <button class="btn btn-small btn-outline" onclick="showWritingChallengeAnswer()">Show Answer</button>
                    </div>
                    
                    <div id="writingChallengeResult" style="margin-top: 20px; min-height: 30px; font-weight: bold;"></div>
                </div>
            `;
            
            window.currentWritingChallengeAnswer = currentChallenge.answer;
            window.currentWritingChallengeExplanation = currentChallenge.explanation;
        };

        window.checkWritingChallenge = function() {
            const answerInput = document.getElementById('challengeAnswer');
            const resultDiv = document.getElementById('writingChallengeResult');
            
            if (!answerInput || !resultDiv) return;
            
            const userAnswer = answerInput.value.trim();
            
            // Simple feedback based on common elements
            const hasCapitalStart = /^[A-Z]/.test(userAnswer);
            const hasProperEnd = /[.!?]$/.test(userAnswer);
            const hasQuotes = userAnswer.includes('"') || userAnswer.includes("'");
            
            let score = 0;
            if (hasCapitalStart) score++;
            if (hasProperEnd) score++;
            if (hasQuotes) score++;
            
            if (score === 3) {
                resultDiv.textContent = "Excellent! You included all key punctuation elements!";
                resultDiv.style.color = 'var(--primary-blue)';
            } else if (score === 2) {
                resultDiv.textContent = "Good job! You're almost there. Check the answer for comparison.";
                resultDiv.style.color = 'var(--secondary-teal)';
            } else if (score === 1) {
                resultDiv.textContent = "You have some elements right. Review punctuation rules.";
                resultDiv.style.color = 'var(--accent-orange)';
            } else {
                resultDiv.textContent = "Try again! Remember capitalization and end punctuation.";
                resultDiv.style.color = 'var(--accent-red)';
            }
        };

        window.showWritingChallengeAnswer = function() {
            const resultDiv = document.getElementById('writingChallengeResult');
            if (resultDiv && window.currentWritingChallengeAnswer) {
                resultDiv.innerHTML = `
                    <div>
                        <div style="color: var(--secondary-teal); margin-bottom: 5px;"><strong>Suggested answer:</strong> ${window.currentWritingChallengeAnswer}</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem;">${window.currentWritingChallengeExplanation}</div>
                    </div>
                `;
            }
        };

        // Load current question
        function loadQuestion() {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            
            progressText.textContent = `Question ${appState.currentQuestionIndex + 1} of ${appState.currentQuestions.length}`;
            progressFill.style.width = `${((appState.currentQuestionIndex + 1) / appState.currentQuestions.length) * 100}%`;
            
            questionText.textContent = question.question;
            
            languageFact.innerHTML = '';
            conceptDisplay.innerHTML = '';
            visualizationContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            feedbackContainer.style.display = 'none';
            nextQuestionBtn.disabled = true;
            
            languageFact.appendChild(createLanguageFact());
            conceptDisplay.appendChild(createConceptDisplay());
            visualizationContainer.appendChild(createPunctuationVisualization());
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="option-text">${option}</div>
                `;
                
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsContainer.appendChild(optionElement);
            });
        }

        // Handle option selection
        function selectOption(optionElement, selectedIndex) {
            const question = appState.currentQuestions[appState.currentQuestionIndex];
            const correctIndex = question.answer.charCodeAt(0) - 65;
            
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            allOptions[correctIndex].classList.add('correct');
            
            if (selectedIndex === correctIndex) {
                optionElement.classList.add('correct');
                appState.score++;
                appState.answered++;
                optionElement.classList.add('pulse');
                showFeedback(true, question.explanation);
            } else {
                optionElement.classList.add('incorrect');
                appState.answered++;
                showFeedback(false, question.explanation, question.answer);
            }
            
            nextQuestionBtn.disabled = false;
            saveStateToStorage();
        }

        // Show feedback
        function showFeedback(isCorrect, explanation, correctAnswer = null) {
            const feedbackTitle = feedbackContainer.querySelector('.feedback-title');
            const feedbackMessage = feedbackContainer.querySelector('.feedback-message');
            const feedbackExplanation = feedbackContainer.querySelector('.feedback-explanation');
            const feedbackIcon = feedbackContainer.querySelector('.feedback-icon');
            
            if (isCorrect) {
                feedbackContainer.className = 'feedback-container feedback-correct';
                feedbackIcon.textContent = '‚úì';
                feedbackTitle.textContent = 'Correct!';
                feedbackMessage.textContent = positiveMessages[Math.floor(Math.random() * positiveMessages.length)];
            } else {
                feedbackContainer.className = 'feedback-container feedback-incorrect';
                feedbackIcon.textContent = '‚úó';
                feedbackTitle.textContent = 'Incorrect';
                if (correctAnswer) {
                    const correctOption = String.fromCharCode(65 + (correctAnswer.charCodeAt(0) - 65));
                    const correctText = questions.find(q => 
                        appState.currentQuestions[appState.currentQuestionIndex].question === q.question
                    )?.options[correctAnswer.charCodeAt(0) - 65];
                    
                    feedbackMessage.textContent = `Correct answer: ${correctOption} (${correctText})`;
                }
            }
            
            feedbackExplanation.textContent = explanation;
            feedbackContainer.style.display = 'block';
            feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Move to next question
        function nextQuestion() {
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Skip current question
        function skipQuestion() {
            appState.skipped++;
            appState.currentQuestionIndex++;
            
            if (appState.currentQuestionIndex < appState.currentQuestions.length) {
                loadQuestion();
            } else {
                showResultsPage();
            }
            
            saveStateToStorage();
        }

        // Retry the topic
        function retryTopic() {
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            initializeQuestions();
            
            saveStateToStorage();
            showPracticePage();
        }

        // Go back to home page
        function backToHome() {
            showWelcomePage();
        }

        // Go back to topics page
        function backToTopics() {
            alert("In a complete implementation, this would navigate to the topics selection page.");
        }

        // Start practice session
        function startPractice() {
            const name = studentNameInput.value.trim();
            if (!name) {
                alert("Please enter your name to begin!");
                studentNameInput.focus();
                return;
            }
            
            appState.studentName = name;
            appState.currentQuestionIndex = 0;
            appState.score = 0;
            appState.skipped = 0;
            appState.answered = 0;
            
            if (appState.currentQuestions.length === 0) {
                initializeQuestions();
            }
            
            saveStateToStorage();
            showPracticePage();
        }

        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
